<!-- cards/breaker-sizing-calculator.html -->
<h2 id="breaker-sizing-calculator-title">Breaker Sizing Calculator (General Advice)</h2>

<div class="description">
  Estimate breaker size for a circuit. Always verify with a qualified electrician and local electrical codes.
  <span class="disclaimer">‚ö†Ô∏è Educational only ‚Äî not for actual electrical installations.</span>
</div>

<div class="tool-body">
  <!-- INPUT SECTION -->
  <div style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px; margin-bottom: 25px;">
    <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 15px;">
      ‚ö° Circuit Parameters
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
      <div>
        <label for="bsc-load-current" style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">
          <span style="color: #ffa500;">Load Current (A)</span>
        </label>
        <input id="bsc-load-current" type="number" placeholder="e.g. 20" min="0.1" step="0.1"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,165,0,0.3); background: rgba(255,165,0,0.05); color: #e6faff;">
        <div style="margin-top: 6px; color: rgba(255,165,0,0.7); font-size: 13px;">
          Current drawn by the load
        </div>
      </div>
      
      <div>
        <label for="bsc-conductor-ampacity" style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">
          <span style="color: #39ff14;">Conductor Ampacity (A)</span>
        </label>
        <input id="bsc-conductor-ampacity" type="number" placeholder="e.g. 25" min="1" step="1"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(57,255,20,0.3); background: rgba(57,255,20,0.05); color: #e6faff;">
        <div style="margin-top: 6px; color: rgba(57,255,20,0.7); font-size: 13px;">
          Wire current carrying capacity
        </div>
      </div>
      
      <div>
        <label for="bsc-load-type" style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">
          <span style="color: #ff4081;">Load Type</span>
        </label>
        <select id="bsc-load-type" 
                style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,64,129,0.3); background: rgba(255,64,129,0.05); color: #e6faff; cursor: pointer;">
          <option value="continuous">Continuous Load (125% rule)</option>
          <option value="non-continuous" selected>Non‚ÄëContinuous Load</option>
          <option value="motor">Motor Load (varies)</option>
          <option value="heating">Heating Load</option>
          <option value="lighting">Lighting Circuit</option>
        </select>
      </div>
    </div>
    
    <!-- QUICK EXAMPLES -->
    <div>
      <div style="color: rgba(230,250,255,0.8); margin-bottom: 10px; font-size: 14px;">Quick Examples:</div>
      <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button class="bsc-example-btn" data-current="15" data-ampacity="20" data-type="non-continuous"
                style="padding: 8px 12px; background: rgba(45,212,255,0.1); border: 1px solid rgba(45,212,255,0.3); border-radius: 6px; cursor: pointer; color: #2dd4ff; font-size: 13px;">
          üí° Standard Outlet
        </button>
        <button class="bsc-example-btn" data-current="12" data-ampacity="20" data-type="continuous"
                style="padding: 8px 12px; background: rgba(255,165,0,0.1); border: 1px solid rgba(255,165,0,0.3); border-radius: 6px; cursor: pointer; color: #ffa500; font-size: 13px;">
          üè≠ Equipment Circuit
        </button>
        <button class="bsc-example-btn" data-current="30" data-ampacity="40" data-type="motor"
                style="padding: 8px 12px; background: rgba(57,255,20,0.1); border: 1px solid rgba(57,255,20,0.3); border-radius: 6px; cursor: pointer; color: #39ff14; font-size: 13px;">
          üîß Motor Circuit
        </button>
        <button class="bsc-example-btn" data-current="20" data-ampacity="25" data-type="heating"
                style="padding: 8px 12px; background: rgba(255,64,129,0.1); border: 1px solid rgba(255,64,129,0.3); border-radius: 6px; cursor: pointer; color: #ff4081; font-size: 13px;">
          üî• Heating Circuit
        </button>
      </div>
    </div>
  </div>
  
  <!-- CALCULATE BUTTONS -->
  <div style="text-align: center; margin: 25px 0;">
    <button id="bsc-calculate-btn" 
            style="background: #2dd4ff; color: #000; border: none; padding: 14px 32px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; box-shadow: 0 4px 15px rgba(45,212,255,0.3);">
      ‚ö° CALCULATE BREAKER SIZE
    </button>
    
    <button id="bsc-reset-btn" 
            style="background: rgba(255,255,255,0.08); color: #e6faff; border: 1px solid rgba(255,255,255,0.2); padding: 14px 24px; border-radius: 10px; cursor: pointer; font-size: 16px; margin-left: 12px;">
      Reset
    </button>
  </div>
  
  <!-- RESULTS DISPLAY -->
  <div id="bsc-results" style="display: none;">
    <div style="background: rgba(20,20,20,0.7); border-radius: 10px; padding: 25px; border: 1px solid rgba(57,255,20,0.2); margin-bottom: 25px;">
      <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
        <div style="color: #39ff14; font-size: 18px; font-weight: 600;">üîß Breaker Sizing Results</div>
        <button id="bsc-copy-btn" 
                style="background: rgba(57,255,20,0.1); color: #39ff14; border: 1px solid rgba(57,255,20,0.3); padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">
          Copy Results
        </button>
      </div>
      
      <div id="bsc-result-display" style="font-size: 18px; color: #39ff14; margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px; line-height: 1.6;">
        <!-- Results appear here -->
      </div>
      
      <div id="bsc-recommendations" style="color: #e6faff; font-size: 15px; line-height: 1.6; padding: 15px; background: rgba(30,30,30,0.5); border-radius: 8px;">
        <!-- Recommendations appear here -->
      </div>
    </div>
  </div>
  
  <!-- STANDARD BREAKER SIZES -->
  <div style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px; margin-bottom: 25px;">
    <div style="color: #ffa500; font-weight: 600; margin-bottom: 15px; font-size: 16px;">
      üìä Standard Breaker Sizes (Typical)
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 10px; text-align: center;">
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">10A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Lighting</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">16A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">General Circuits</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">20A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Kitchen/Outlet</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">32A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Heavy Loads</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">40A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Ranges/Ovens</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">50A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">EV Chargers</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">63A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Subpanels</div>
      </div>
      <div style="background: rgba(20,20,20,0.7); padding: 8px; border-radius: 6px;">
        <div style="color: #2dd4ff; font-weight: 600;">100A</div>
        <div style="color: rgba(230,250,255,0.7); font-size: 12px;">Main Service</div>
      </div>
    </div>
  </div>
  
  <!-- SAFETY INFORMATION -->
  <div style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px; margin-bottom: 25px; border: 1px solid rgba(255,77,77,0.3);">
    <div style="color: #ff4d4d; font-weight: 600; margin-bottom: 15px; font-size: 16px;">
      ‚ö†Ô∏è Critical Safety Information
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
      <div style="background: rgba(255,77,77,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ff4d4d;">
        <div style="color: #ff4d4d; font-weight: 600; margin-bottom: 5px;">Professional Required</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Always hire a licensed electrician. DIY electrical work is dangerous and illegal in most areas.</div>
      </div>
      
      <div style="background: rgba(255,165,0,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ffa500;">
        <div style="color: #ffa500; font-weight: 600; margin-bottom: 5px;">Code Compliance</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Follow NEC (US), IEC (International), or local electrical codes. Requirements vary by region.</div>
      </div>
      
      <div style="background: rgba(255,152,0,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ff9800;">
        <div style="color: #ff9800; font-weight: 600; margin-bottom: 5px;">Proper Sizing</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Breaker protects wires, not appliances. Must not exceed conductor ampacity.</div>
      </div>
      
      <div style="background: rgba(255,77,77,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ff4d4d;">
        <div style="color: #ff4d4d; font-weight: 600; margin-bottom: 5px;">Warning</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Incorrect breaker sizing can cause fires, equipment damage, or electrocution.</div>
      </div>
    </div>
  </div>
  
  <!-- BREAKER FACTS -->
  <div id="bsc-facts" style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px;">
    <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 15px; font-size: 16px;">
      üìö Breaker Facts & Principles
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
      <div style="background: rgba(45,212,255,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #2dd4ff;">
        <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 5px;">Purpose</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Circuit breakers protect wiring from overheating by interrupting current flow during overloads or short circuits.</div>
      </div>
      
      <div style="background: rgba(255,165,0,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ffa500;">
        <div style="color: #ffa500; font-weight: 600; margin-bottom: 5px;">125% Rule</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">For continuous loads (3+ hours), multiply load current by 1.25 before selecting breaker size.</div>
      </div>
      
      <div style="background: rgba(57,255,20,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #39ff14;">
        <div style="color: #39ff14; font-weight: 600; margin-bottom: 5px;">Conductor Protection</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Breaker size must never exceed the ampacity of the wire it protects (NEC 240.4).</div>
      </div>
      
      <div style="background: rgba(255,64,129,0.05); padding: 12px; border-radius: 8px; border-left: 3px solid #ff4081;">
        <div style="color: #ff4081; font-weight: 600; margin-bottom: 5px;">Types</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Standard, GFCI, AFCI, dual-function. Each has specific applications and requirements.</div>
      </div>
    </div>
  </div>
  
  <!-- ERROR MESSAGE -->
  <div id="bsc-error" style="margin-top: 20px; padding: 15px; background: rgba(255,77,77,0.1); border-radius: 8px; border: 1px solid rgba(255,77,77,0.3); display: none;">
    <div style="color: #ff4d4d; font-weight: 600; margin-bottom: 5px;">‚ö†Ô∏è Calculation Error</div>
    <div id="bsc-error-text" style="color: rgba(255,77,77,0.9);"></div>
  </div>
</div>

<style>
#breaker-sizing-calculator-title { 
  color: #2dd4ff; 
  margin-top: 0;
  margin-bottom: 10px;
}

.description {
  color: rgba(230,250,255,0.8);
  margin-bottom: 20px;
  font-size: 14px;
}

.disclaimer {
  display: block;
  color: rgba(255,77,77,0.8);
  font-size: 12px;
  margin-top: 5px;
  font-style: italic;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .tool-body > div > div {
    grid-template-columns: 1fr !important;
  }
  
  .bsc-example-btn {
    width: calc(50% - 5px);
    margin: 2px 0 !important;
  }
  
  #bsc-calculate-btn, #bsc-reset-btn {
    width: 100%;
    margin: 5px 0 !important;
  }
}
</style>

<script>
// ============================================
// BREAKER SIZING CALCULATOR - PROPERLY SCOPED
// All functions prefixed with "bsc" (breaker sizing calculator)
// ============================================

// Standard breaker sizes (typical values)
const bscStandardBreakers = [10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 150, 200];

// Initialize the tool
function bscInit() {
  console.log("Breaker Sizing Calculator: Initializing...");
  
  // Example buttons
  const exampleBtns = document.querySelectorAll('.bsc-example-btn');
  exampleBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      const current = this.dataset.current;
      const ampacity = this.dataset.ampacity;
      const type = this.dataset.type;
      
      document.getElementById('bsc-load-current').value = current;
      document.getElementById('bsc-conductor-ampacity').value = ampacity;
      document.getElementById('bsc-load-type').value = type;
      
      // Visual feedback
      exampleBtns.forEach(b => {
        b.style.background = '';
        b.style.border = '1px solid rgba(255,255,255,0.1)';
      });
      this.style.background = 'rgba(45,212,255,0.2)';
      this.style.border = '1px solid #2dd4ff';
      
      bscClearResults();
    });
  });
  
  // Calculate button
  document.getElementById('bsc-calculate-btn').addEventListener('click', bscCalculate);
  
  // Reset button
  document.getElementById('bsc-reset-btn').addEventListener('click', bscReset);
  
  // Copy button
  document.getElementById('bsc-copy-btn').addEventListener('click', bscCopyResult);
  
  // Enter key support
  document.querySelectorAll('#bsc-load-current, #bsc-conductor-ampacity').forEach(input => {
    input.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') bscCalculate();
    });
  });
  
  console.log("‚úÖ Breaker Sizing Calculator ready!");
}

// Main calculation function
function bscCalculate() {
  console.log("Calculating breaker size...");
  
  // Hide previous results/errors
  document.getElementById('bsc-results').style.display = 'none';
  document.getElementById('bsc-error').style.display = 'none';
  
  // Get inputs
  const loadCurrent = parseFloat(document.getElementById('bsc-load-current').value);
  const conductorAmpacity = parseFloat(document.getElementById('bsc-conductor-ampacity').value);
  const loadType = document.getElementById('bsc-load-type').value;
  
  // Validate inputs
  if (isNaN(loadCurrent) || isNaN(conductorAmpacity)) {
    bscShowError('Please enter valid numbers for load current and conductor ampacity');
    return;
  }
  
  if (loadCurrent <= 0 || conductorAmpacity <= 0) {
    bscShowError('Values must be greater than zero');
    return;
  }
  
  if (loadCurrent > conductorAmpacity) {
    bscShowError('Load current cannot exceed conductor ampacity');
    return;
  }
  
  // Calculate based on load type
  let requiredCurrent = loadCurrent;
  let loadFactor = 1.0;
  let loadTypeDescription = 'Non‚Äëcontinuous load';
  
  switch(loadType) {
    case 'continuous':
      requiredCurrent *= 1.25;
      loadFactor = 1.25;
      loadTypeDescription = 'Continuous load (125% rule applies)';
      break;
    case 'motor':
      requiredCurrent *= 1.25; // Simplified - motors have special rules
      loadFactor = 1.25;
      loadTypeDescription = 'Motor load (special rules apply)';
      break;
    case 'heating':
      requiredCurrent *= 1.0; // Heating loads often have different rules
      loadFactor = 1.0;
      loadTypeDescription = 'Heating load';
      break;
    case 'lighting':
      requiredCurrent *= 1.0;
      loadFactor = 1.0;
      loadTypeDescription = 'Lighting circuit';
      break;
    default:
      loadTypeDescription = 'Non‚Äëcontinuous load';
  }
  
  // Find next standard breaker size
  let recommendedBreaker = null;
  for (const breakerSize of bscStandardBreakers) {
    if (breakerSize >= requiredCurrent && breakerSize <= conductorAmpacity) {
      recommendedBreaker = breakerSize;
      break;
    }
  }
  
  // If no standard breaker fits within ampacity
  if (!recommendedBreaker) {
    recommendedBreaker = Math.ceil(requiredCurrent);
    if (recommendedBreaker > conductorAmpacity) {
      recommendedBreaker = conductorAmpacity;
    }
  }
  
  // Check if breaker exceeds conductor ampacity
  const breakerExceedsAmpacity = recommendedBreaker > conductorAmpacity;
  
  // Build result text
  let resultText = '';
  let recommendations = '';
  
  if (breakerExceedsAmpacity) {
    resultText = `‚ö†Ô∏è WARNING: CALCULATION EXCEEDS SAFE LIMITS\n\n`;
    resultText += `‚Ä¢ Load current: ${loadCurrent.toFixed(1)} A\n`;
    resultText += `‚Ä¢ Load type: ${loadTypeDescription}\n`;
    resultText += `‚Ä¢ Required current (including factor): ${requiredCurrent.toFixed(1)} A\n`;
    resultText += `‚Ä¢ Conductor ampacity: ${conductorAmpacity} A\n`;
    resultText += `‚Ä¢ Suggested breaker: ${recommendedBreaker} A ‚ö†Ô∏è\n\n`;
    resultText += `‚ùå Breaker exceeds conductor ampacity! This is unsafe.\n`;
    resultText += `üí° Consider using larger wire or reducing load.`;
    
    recommendations = `‚ö†Ô∏è CRITICAL ISSUE: Breaker size (${recommendedBreaker}A) exceeds conductor ampacity (${conductorAmpacity}A). This violates electrical codes and creates a fire hazard. Solutions:\n\n‚Ä¢ Upgrade to larger conductor (higher ampacity)\n‚Ä¢ Reduce circuit load\n‚Ä¢ Split load across multiple circuits\n‚Ä¢ CONSULT LICENSED ELECTRICIAN`;
  } else {
    resultText = `‚úÖ BREAKER SIZING CALCULATION\n\n`;
    resultText += `‚Ä¢ Load current: ${loadCurrent.toFixed(1)} A\n`;
    resultText += `‚Ä¢ Load type: ${loadTypeDescription}\n`;
    resultText += `‚Ä¢ Required current (including factor): ${requiredCurrent.toFixed(1)} A\n`;
    resultText += `‚Ä¢ Conductor ampacity: ${conductorAmpacity} A\n`;
    resultText += `‚Ä¢ Recommended breaker: ${recommendedBreaker} A\n\n`;
    resultText += `‚úÖ Breaker protects conductor properly.`;
    
    recommendations = `üìù RECOMMENDATIONS:\n\n‚Ä¢ Verify local electrical codes (NEC/IEC/BS)\n‚Ä¢ Ensure proper wire size for ${conductorAmpacity}A ampacity\n‚Ä¢ Consider next standard size (${recommendedBreaker}A)\n‚Ä¢ Continuous loads may require derating\n‚Ä¢ Always install AFCI/GFCI where required by code\n\n‚ö†Ô∏è MUST BE INSTALLED BY LICENSED ELECTRICIAN`;
  }
  
  // Display results
  document.getElementById('bsc-result-display').textContent = resultText;
  document.getElementById('bsc-recommendations').textContent = recommendations;
  document.getElementById('bsc-results').style.display = 'block';
}

// Reset function
function bscReset() {
  // Reset inputs
  document.getElementById('bsc-load-current').value = '';
  document.getElementById('bsc-conductor-ampacity').value = '';
  document.getElementById('bsc-load-type').value = 'non-continuous';
  
  // Reset example buttons
  document.querySelectorAll('.bsc-example-btn').forEach(btn => {
    btn.style.background = '';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
  });
  
  // Clear results
  bscClearResults();
  
  console.log("Breaker sizing calculator reset");
}

// Clear results
function bscClearResults() {
  document.getElementById('bsc-results').style.display = 'none';
  document.getElementById('bsc-error').style.display = 'none';
}

// Copy result
function bscCopyResult() {
  const result = document.getElementById('bsc-result-display').textContent;
  const recommendations = document.getElementById('bsc-recommendations').textContent;
  
  const textToCopy = `BREAKER SIZING CALCULATOR RESULTS\n\n${result}\n\n${recommendations}`;
  
  navigator.clipboard.writeText(textToCopy).then(() => {
    const copyBtn = document.getElementById('bsc-copy-btn');
    const originalText = copyBtn.textContent;
    copyBtn.textContent = '‚úÖ Copied!';
    copyBtn.style.background = 'rgba(57,255,20,0.2)';
    
    setTimeout(() => {
      copyBtn.textContent = originalText;
      copyBtn.style.background = '';
    }, 2000);
  }).catch(err => {
    console.error('Copy failed:', err);
    alert('Failed to copy. Please select and copy manually.');
  });
}

// Show error
function bscShowError(message) {
  document.getElementById('bsc-error-text').textContent = message;
  document.getElementById('bsc-error').style.display = 'block';
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', bscInit);
} else {
  setTimeout(bscInit, 100);
}
</script>
