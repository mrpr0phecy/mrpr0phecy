<!-- cards/essay-templates.html -->
<h2 id="essay-templates-title" style="margin-top:0;color:var(--accent);">üìù Essay Writing Assistant</h2>

<form aria-describedby="essay-templates-desc">
  <p id="essay-templates-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.8);">
    Generate structured essay outlines, starter paragraphs, and writing guidance for any topic. 
    <span style="color:var(--accent);font-weight:500;">Perfect for students, writers, and professionals!</span>
  </p>

  <div class="field" style="margin-bottom:16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
      <label for="et-type" style="color:var(--accent);font-weight:500;">Essay Type</label>
      <span id="et-type-hint" class="small" style="color:rgba(45,212,255,0.7);font-size:12px;">Generates argument structure</span>
    </div>
    <select id="et-type" 
            style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:15px;"
            onchange="etUpdateTypeHint()">
      <option value="argumentative" selected>Argumentative Essay</option>
      <option value="persuasive">Persuasive Essay</option>
      <option value="expository">Expository Essay</option>
      <option value="compare">Compare & Contrast</option>
      <option value="literary">Literary Analysis</option>
      <option value="cause">Cause & Effect</option>
      <option value="process">Process / How-to</option>
      <option value="reflective">Reflective Essay</option>
      <option value="narrative">Narrative Essay</option>
      <option value="analytical">Analytical Essay</option>
      <option value="research">Research Paper</option>
      <option value="critical">Critical Analysis</option>
      <option value="admission">College Admission</option>
      <option value="scholarship">Scholarship Essay</option>
    </select>
  </div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
    <div class="field">
      <label for="et-length" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Target Length</label>
      <select id="et-length" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="300">Short (300 words)</option>
        <option value="500" selected>Standard (500 words)</option>
        <option value="800">Long (800 words)</option>
        <option value="1200">Extended (1200 words)</option>
        <option value="2000">Research (2000+ words)</option>
      </select>
    </div>

    <div class="field">
      <label for="et-format" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Format Style</label>
      <select id="et-format" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="standard">Standard (MLA/APA)</option>
        <option value="five-paragraph">Five-Paragraph</option>
        <option value="extended">Extended Essay</option>
        <option value="chicago">Chicago Style</option>
        <option value="simplified">Simplified Outline</option>
      </select>
    </div>
  </div>

  <div class="field" style="margin-bottom:16px;">
    <label for="et-topic" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
      Essay Topic
      <span class="small" style="color:rgba(230,250,255,0.6);font-weight:normal;float:right;">e.g., Impact of AI on education</span>
    </label>
    <input id="et-topic" type="text" placeholder="Enter your essay topic here..." 
           style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:15px;" />
  </div>

  <div class="field" style="margin-bottom:16px;">
    <label for="et-thesis" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
      Thesis Statement
      <button type="button" onclick="etGenerateThesis()" class="small-btn" style="float:right;font-size:11px;padding:3px 8px;">‚ú® Auto-generate</button>
    </label>
    <textarea id="et-thesis" rows="2" placeholder="Enter your central argument or main idea..."
              style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;resize:vertical;"></textarea>
    <div class="small" style="color:rgba(230,250,255,0.6);margin-top:4px;">A strong thesis should be clear, arguable, and specific</div>
  </div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
    <div class="field">
      <label for="et-audience" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Target Audience</label>
      <select id="et-audience" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="general" selected>General Readers</option>
        <option value="academic">Academic/Professors</option>
        <option value="students">High School Students</option>
        <option value="university">University Level</option>
        <option value="professional">Professional Audience</option>
        <option value="admissions">Admissions Committee</option>
      </select>
    </div>

    <div class="field">
      <label for="et-tone" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Writing Tone</label>
      <select id="et-tone" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="formal">Formal Academic</option>
        <option value="neutral">Neutral Analytical</option>
        <option value="persuasive">Persuasive</option>
        <option value="conversational">Conversational</option>
        <option value="descriptive">Descriptive</option>
        <option value="reflective">Reflective</option>
      </select>
    </div>
  </div>

  <!-- Quick Example Topics -->
  <div style="margin-bottom:20px;">
    <div class="small" style="color:var(--accent);margin-bottom:8px;">üí° Quick Topic Ideas:</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
      <button type="button" onclick="etLoadExample('climate')" class="small-btn">Climate Change</button>
      <button type="button" onclick="etLoadExample('social')" class="small-btn">Social Media</button>
      <button type="button" onclick="etLoadExample('education')" class="small-btn">Education Reform</button>
      <button type="button" onclick="etLoadExample('tech')" class="small-btn">Technology Impact</button>
      <button type="button" onclick="etLoadExample('health')" class="small-btn">Mental Health</button>
    </div>
  </div>

  <div class="actions" style="display:flex;gap:10px;">
    <button type="button" onclick="etGenerateEssay(this)" 
            style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(57,255,20,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);font-weight:600;cursor:pointer;font-size:16px;">
      üìù Generate Essay Template
    </button>
    <button type="button" onclick="etReset(this)"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset
    </button>
  </div>
</form>

<div id="et-results" aria-live="polite" style="margin-top:20px;display:none;">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
    <h3 class="small" style="color:var(--accent);margin:0;">Generated Essay Template</h3>
    <div style="display:flex;gap:8px;align-items:center;">
      <div id="et-wordcount" class="small" style="color:rgba(45,212,255,0.8);"></div>
      <div id="et-reading-time" class="small" style="color:rgba(230,250,255,0.6);"></div>
    </div>
  </div>

  <div id="et-output-container" style="min-height:300px;">
    <!-- Template will be inserted here -->
  </div>

  <div style="margin-top:20px;">
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:16px;">
      <button onclick="etCopySection('intro')" 
              style="padding:10px;background:rgba(45,212,255,0.05);border:1px solid rgba(45,212,255,0.2);border-radius:8px;color:var(--accent);cursor:pointer;font-size:12px;">
        üìã Copy Introduction
      </button>
      <button onclick="etCopySection('body')" 
              style="padding:10px;background:rgba(57,255,20,0.05);border:1px solid rgba(57,255,20,0.2);border-radius:8px;color:#39ff14;cursor:pointer;font-size:12px;">
        üìã Copy Body Sections
      </button>
      <button onclick="etCopySection('conclusion')" 
              style="padding:10px;background:rgba(255,165,0,0.05);border:1px solid rgba(255,165,0,0.2);border-radius:8px;color:#ffa500;cursor:pointer;font-size:12px;">
        üìã Copy Conclusion
      </button>
    </div>

    <div class="actions" style="display:flex;gap:10px;">
      <button type="button" onclick="etCopyFullTemplate()" 
              style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);font-weight:600;cursor:pointer;">
        üìÑ Copy Full Template
      </button>
      <button type="button" onclick="etExportPDF()"
              style="padding:12px 16px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:8px;color:#ff4d4d;cursor:pointer;">
        üì§ Export as PDF
      </button>
    </div>
  </div>

  <div id="et-tips-container" style="margin-top:20px;display:none;">
    <h4 class="small" style="color:#39ff14;margin-bottom:12px;">üí° Essay Writing Tips</h4>
    <div id="et-tips-content" class="small" style="color:rgba(230,250,255,0.8);line-height:1.6;"></div>
  </div>

  <div style="margin-top:16px;display:flex;justify-content:space-between;align-items:center;">
    <div id="et-hint" class="small" style="color:#39ff14;"></div>
    <button onclick="etDownloadTemplate()" 
            style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">
      üíæ Download .txt
    </button>
  </div>
</div>

<script>
/* essay-templates.html
   - Comprehensive essay writing assistant
   - Generates structured templates, outlines, and writing guidance
   - Scoped with et- prefix
*/

// Essay type descriptions
const etTypeDescriptions = {
  'argumentative': 'Presents arguments and evidence to support a position',
  'persuasive': 'Aims to convince the reader to adopt a viewpoint',
  'expository': 'Explains or describes a topic objectively',
  'compare': 'Analyzes similarities and differences between subjects',
  'literary': 'Examines literary works through analysis',
  'cause': 'Explores causes and effects of situations',
  'process': 'Describes how to do something or how something works',
  'reflective': 'Shares personal experiences and insights',
  'narrative': 'Tells a story with a purpose',
  'analytical': 'Breaks down complex topics into components',
  'research': 'Presents findings from extensive research',
  'critical': 'Evaluates strengths and weaknesses',
  'admission': 'Personal statement for college applications',
  'scholarship': 'Application essay for funding opportunities'
};

// Example topics with pre-written theses
const etExamples = {
  'climate': {
    topic: 'The Urgency of Addressing Climate Change',
    thesis: 'Immediate global action on climate change is essential not only to protect ecosystems but also to ensure economic stability and social justice for future generations.'
  },
  'social': {
    topic: 'The Impact of Social Media on Mental Health',
    thesis: 'While social media connects people globally, its algorithms and design contribute significantly to increased anxiety, depression, and social comparison among young adults.'
  },
  'education': {
    topic: 'The Future of Education in the Digital Age',
    thesis: 'Traditional education systems must evolve to incorporate digital literacy and personalized learning to prepare students for the demands of the 21st-century workforce.'
  },
  'tech': {
    topic: 'Artificial Intelligence in Healthcare',
    thesis: 'The integration of artificial intelligence in healthcare promises revolutionary improvements in diagnosis accuracy and treatment personalization, yet raises critical ethical concerns about privacy and algorithmic bias.'
  },
  'health': {
    topic: 'Mental Health Awareness in the Workplace',
    thesis: 'Companies that prioritize mental health through supportive policies and destigmatization see measurable benefits in employee productivity, retention, and overall organizational success.'
  }
};

// Common thesis starters for auto-generation
const etThesisStarters = [
  'This essay will argue that...',
  'A critical examination reveals that...',
  'The evidence suggests that...',
  'Contrary to popular belief,...',
  'Through analysis of..., this essay demonstrates...',
  'The central claim of this paper is that...',
  'This analysis will show how...',
  'The primary focus of this essay is to prove that...'
];

// Writing tips by essay type
const etWritingTips = {
  'argumentative': [
    'Start with your strongest argument',
    'Address counterarguments directly',
    'Use credible sources for evidence',
    'Maintain a logical flow between points',
    'Avoid emotional language; stay objective'
  ],
  'persuasive': [
    'Know your audience and their values',
    'Use rhetorical appeals (ethos, pathos, logos)',
    'Include a clear call to action',
    'Use compelling examples and anecdotes',
    'Anticipate and refute objections'
  ],
  'expository': [
    'Focus on clarity and organization',
    'Use definitions and examples',
    'Avoid personal opinions',
    'Include relevant statistics and facts',
    'Use transitions to connect ideas'
  ],
  'compare': [
    'Use consistent criteria for comparison',
    'Choose a clear organizational structure',
    'Balance similarities and differences',
    'Avoid simple listing; analyze significance',
    'Draw meaningful conclusions from comparisons'
  ],
  'literary': [
    'Use textual evidence with citations',
    'Analyze literary devices and techniques',
    'Consider historical and cultural context',
    'Connect analysis to broader themes',
    'Avoid plot summary; focus on analysis'
  ]
};

// Initialize the tool
function etInit() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Set up event listeners
  const typeSelect = card.querySelector('#et-type');
  if (typeSelect) {
    typeSelect.addEventListener('change', etUpdateTypeHint);
  }
  
  // Initialize type hint
  etUpdateTypeHint();
  
  console.log('Essay Templates Assistant initialized');
}

// Update type hint based on selection
function etUpdateTypeHint() {
  const card = document.currentScript?.closest('.card') || document;
  const type = card.querySelector('#et-type').value;
  const hint = card.querySelector('#et-type-hint');
  
  if (hint && etTypeDescriptions[type]) {
    hint.textContent = etTypeDescriptions[type];
  }
}

// Load example topic
function etLoadExample(exampleKey) {
  const card = document.currentScript?.closest('.card') || document;
  const example = etExamples[exampleKey];
  
  if (!example) return;
  
  card.querySelector('#et-topic').value = example.topic;
  card.querySelector('#et-thesis').value = example.thesis;
  
  // Show hint
  const hint = card.querySelector('#et-hint');
  if (hint) {
    hint.textContent = `Loaded "${exampleKey}" example`;
    hint.style.color = '#39ff14';
    setTimeout(() => {
      if (hint.textContent.includes('Loaded')) hint.textContent = '';
    }, 2000);
  }
}

// Auto-generate a thesis based on topic
function etGenerateThesis() {
  const card = document.currentScript?.closest('.card') || document;
  const topic = card.querySelector('#et-topic').value.trim();
  const type = card.querySelector('#et-type').value;
  
  if (!topic) {
    const hint = card.querySelector('#et-hint');
    hint.textContent = 'Please enter a topic first';
    hint.style.color = '#ff2d55';
    setTimeout(() => hint.textContent = '', 2000);
    return;
  }
  
  const starter = etThesisStarters[Math.floor(Math.random() * etThesisStarters.length)];
  let thesis = '';
  
  switch (type) {
    case 'argumentative':
      thesis = `${starter} ${topic} requires immediate attention due to its significant social and economic implications.`;
      break;
    case 'persuasive':
      thesis = `${starter} we must take action on ${topic} to ensure a better future for coming generations.`;
      break;
    case 'expository':
      thesis = `This essay will explore the key aspects of ${topic}, examining its components and significance.`;
      break;
    case 'compare':
      thesis = `By comparing different approaches to ${topic}, this analysis reveals the most effective strategies.`;
      break;
    default:
      thesis = `${starter} ${topic} presents important considerations that warrant careful examination.`;
  }
  
  card.querySelector('#et-thesis').value = thesis;
  
  // Show hint
  const hint = card.querySelector('#et-hint');
  hint.textContent = 'Thesis generated! Edit as needed.';
  hint.style.color = '#39ff14';
  setTimeout(() => {
    if (hint.textContent === 'Thesis generated! Edit as needed.') hint.textContent = '';
  }, 2000);
}

// Main function to generate essay template
function etGenerateEssay(btn) {
  const startTime = performance.now();
  const card = btn.closest('.card') || document;
  
  // Get inputs
  const type = card.querySelector('#et-type').value;
  const topic = card.querySelector('#et-topic').value.trim();
  const thesis = card.querySelector('#et-thesis').value.trim();
  const length = parseInt(card.querySelector('#et-length').value) || 500;
  const audience = card.querySelector('#et-audience').value;
  const tone = card.querySelector('#et-tone').value;
  const format = card.querySelector('#et-format').value;
  
  // Validate inputs
  if (!topic || !thesis) {
    const hint = card.querySelector('#et-hint');
    hint.textContent = 'Please enter both a topic and thesis statement';
    hint.style.color = '#ff2d55';
    return;
  }
  
  // Build the template
  const template = etBuildTemplate({
    type, topic, thesis, length, audience, tone, format
  });
  
  // Display results
  etDisplayTemplate(card, template, length);
  
  // Show writing tips
  etShowWritingTips(card, type);
  
  // Calculate and show execution time
  const endTime = performance.now();
  const timeTaken = (endTime - startTime).toFixed(2);
  
  // Update hint
  const hint = card.querySelector('#et-hint');
  hint.textContent = `Template generated in ${timeTaken}ms`;
  hint.style.color = '#39ff14';
  
  // Show results section
  const resultsDiv = card.querySelector('#et-results');
  resultsDiv.style.display = 'block';
  resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Build comprehensive template
function etBuildTemplate(options) {
  const { type, topic, thesis, length, audience, tone, format } = options;
  
  // Calculate section lengths
  const introWords = Math.round(length * 0.1); // 10%
  const bodyWords = Math.round(length * 0.8);  // 80%
  const conclWords = length - introWords - bodyWords; // 10%
  
  // Get paragraph counts based on length
  let bodyParagraphs = 3;
  if (length >= 800) bodyParagraphs = 4;
  if (length >= 1200) bodyParagraphs = 5;
  if (length >= 2000) bodyParagraphs = 6;
  
  // Generate sections
  const intro = etGenerateIntroduction(topic, thesis, audience, tone, introWords);
  const body = etGenerateBody(type, topic, thesis, bodyParagraphs, bodyWords, format);
  const conclusion = etGenerateConclusion(thesis, topic, tone, conclWords);
  
  // Build full template
  let template = '';
  
  // Header information
  template += `ESSAY TEMPLATE: ${type.toUpperCase().replace(/-/g, ' ')}\n`;
  template += `Topic: ${topic}\n`;
  template += `Target Length: ${length} words\n`;
  template += `Audience: ${audience}\n`;
  template += `Tone: ${tone}\n`;
  template += `Format: ${format}\n`;
  template += `Generated: ${new Date().toLocaleDateString()}\n`;
  template += '='.repeat(60) + '\n\n';
  
  // Add sections
  template += `INTRODUCTION (${introWords} words)\n`;
  template += intro + '\n\n';
  
  template += `BODY (${bodyParagraphs} paragraphs, ${bodyWords} words)\n`;
  template += body + '\n\n';
  
  template += `CONCLUSION (${conclWords} words)\n`;
  template += conclusion + '\n\n';
  
  // Add formatting notes if applicable
  if (format === 'standard' || format === 'chicago') {
    template += 'FORMATTING NOTES:\n';
    template += '- Use 12pt Times New Roman or similar font\n';
    template += '- Double-space all text\n';
    template += '- 1-inch margins on all sides\n';
    template += '- Include page numbers\n';
    if (format === 'standard') {
      template += '- MLA/APA citation style required\n';
    } else if (format === 'chicago') {
      template += '- Chicago style footnotes or endnotes\n';
    }
    template += '\n';
  }
  
  template += 'WRITING TIPS:\n';
  template += '- Write your draft, then revise for clarity\n';
  template += '- Read your essay aloud to catch awkward phrasing\n';
  template += '- Check for consistent tense and point of view\n';
  template += '- Use transition words between paragraphs\n';
  template += '- Proofread for spelling and grammar errors\n';
  
  return template;
}

// Generate introduction section
function etGenerateIntroduction(topic, thesis, audience, introWords) {
  const hooks = [
    `Have you ever considered the profound impact of ${topic}?`,
    `In today's rapidly changing world, ${topic} has become increasingly important.`,
    `The debate surrounding ${topic} continues to spark controversy and discussion.`,
    `${topic} represents one of the most significant challenges/opportunities of our time.`,
    `Recent developments have brought renewed attention to the issue of ${topic}.`
  ];
  
  const hook = hooks[Math.floor(Math.random() * hooks.length)];
  
  return `[HOOK] ${hook}

[BACKGROUND] Provide 2-3 sentences of context about ${topic}. Explain why this topic matters and any relevant history or current events.

[THESIS STATEMENT] ${thesis}

[ROADMAP] Briefly outline the main points you will cover in this essay:
1. First, I will examine...
2. Next, I will analyze...
3. Finally, I will demonstrate...

[TRANSITION] This analysis begins by exploring...`;
}

// Generate body section based on essay type
function etGenerateBody(type, topic, thesis, paragraphCount, totalWords, format) {
  let body = '';
  const wordsPerPara = Math.round(totalWords / paragraphCount);
  
  // Different structures for different essay types
  switch (type) {
    case 'argumentative':
      body = etGenerateArgumentativeBody(topic, thesis, paragraphCount, wordsPerPara);
      break;
    case 'persuasive':
      body = etGeneratePersuasiveBody(topic, thesis, paragraphCount, wordsPerPara);
      break;
    case 'compare':
      body = etGenerateCompareBody(topic, thesis, paragraphCount, wordsPerPara);
      break;
    case 'cause':
      body = etGenerateCauseEffectBody(topic, thesis, paragraphCount, wordsPerPara);
      break;
    default:
      body = etGenerateGenericBody(topic, thesis, paragraphCount, wordsPerPara);
  }
  
  return body;
}

// Generate argumentative essay body
function etGenerateArgumentativeBody(topic, thesis, paragraphCount, wordsPerPara) {
  let body = '';
  
  // Paragraph 1: Strongest argument
  body += `PARAGRAPH 1: Strongest Supporting Argument (${wordsPerPara} words)
[TOPIC SENTENCE] Present your most compelling argument in support of your thesis.

[EVIDENCE] Provide specific evidence, such as statistics, research findings, or expert opinions that support this argument.

[ANALYSIS] Explain how this evidence supports your argument and connects back to your thesis.

[TRANSITION] While this argument is compelling, it is further strengthened by...\n\n`;

  // Paragraph 2: Second argument
  body += `PARAGRAPH 2: Supporting Argument with Example (${wordsPerPara} words)
[TOPIC SENTENCE] Introduce another key argument that supports your position.

[EXAMPLE] Provide a concrete example or case study that illustrates this argument.

[ANALYSIS] Analyze how this example demonstrates your point and relates to the broader topic.

[TRANSITION] Having established these supporting arguments, it's important to address potential counterarguments...\n\n`;

  // Paragraph 3+: Counterargument and rebuttal
  if (paragraphCount >= 3) {
    body += `PARAGRAPH 3: Counterargument and Rebuttal (${wordsPerPara} words)
[TOPIC SENTENCE] Acknowledge a significant counterargument to your position.

[PRESENT COUNTERARGUMENT] Fairly present the opposing viewpoint with its strongest points.

[REBUTTAL] Refute the counterargument by pointing out its weaknesses, presenting contrary evidence, or showing how your position accounts for these concerns.

[TRANSITION] Having addressed these objections, the conclusion will summarize...\n\n`;
  }
  
  // Additional paragraphs for longer essays
  if (paragraphCount >= 4) {
    for (let i = 4; i <= paragraphCount; i++) {
      body += `PARAGRAPH ${i}: Additional Analysis (${wordsPerPara} words)
[TOPIC SENTENCE] Develop another aspect of your argument or provide additional supporting evidence.

[DETAILS] Elaborate with specific details, examples, or data.

[ANALYSIS] Connect this analysis back to your thesis and previous points.

[TRANSITION] This leads to consideration of...\n\n`;
    }
  }
  
  return body;
}

// Generate generic essay body
function etGenerateGenericBody(topic, thesis, paragraphCount, wordsPerPara) {
  let body = '';
  
  for (let i = 1; i <= paragraphCount; i++) {
    body += `PARAGRAPH ${i}: Main Point ${i} (${wordsPerPara} words)
[TOPIC SENTENCE] State the main idea of this paragraph.

[SUPPORTING DETAILS] Provide evidence, examples, or explanations that develop this point.

[ANALYSIS] Explain how these details support your paragraph's main idea and connect to your thesis.

[TRANSITION] ${i < paragraphCount ? 'This leads to the next point...' : 'Having established these points, the conclusion will...'}\n\n`;
  }
  
  return body;
}

// Generate conclusion
function etGenerateConclusion(thesis, topic, tone, conclWords) {
  return `[RESTATE THESIS] Begin by rephrasing your thesis statement in new words, reflecting the arguments made.

[SUMMARIZE MAIN POINTS] Briefly recap the key arguments or points made in your essay, showing how they support your thesis.

[BROADER IMPLICATIONS] Discuss the wider significance of your findings. Why does this matter? What are the implications?

[FINAL THOUGHT] End with a compelling final statement that leaves the reader with something to consider. This could be a call to action, a question for further reflection, or a powerful statement about ${topic}.`;
}

// Display template in a visually appealing way
function etDisplayTemplate(card, template, length) {
  const container = card.querySelector('#et-output-container');
  const wordCount = card.querySelector('#et-wordcount');
  const readingTime = card.querySelector('#et-reading-time');
  
  // Calculate reading time (average 200 words per minute)
  const minutes = Math.ceil(length / 200);
  readingTime.textContent = `~${minutes} min read`;
  
  // Count actual words in template
  const words = template.split(/\s+/).filter(word => word.length > 0).length;
  wordCount.textContent = `${words} words in template`;
  
  // Create formatted display
  const lines = template.split('\n');
  let html = '<div style="font-family:\'Consolas\',\'Monaco\',\'Courier New\',monospace;font-size:13px;line-height:1.6;">';
  
  lines.forEach(line => {
    if (line.includes('ESSAY TEMPLATE:')) {
      html += `<div style="color:var(--accent);font-weight:600;margin-top:8px;">${line}</div>`;
    } else if (line.includes('Topic:') || line.includes('Target Length:') || line.includes('Audience:') || line.includes('Tone:')) {
      html += `<div style="color:rgba(45,212,255,0.8);">${line}</div>`;
    } else if (line.includes('INTRODUCTION') || line.includes('BODY') || line.includes('CONCLUSION') || line.includes('FORMATTING NOTES') || line.includes('WRITING TIPS')) {
      html += `<div style="color:#39ff14;font-weight:600;margin-top:12px;">${line}</div>`;
    } else if (line.includes('PARAGRAPH') && line.includes('words)')) {
      html += `<div style="color:#ffa500;font-weight:600;margin-top:8px;">${line}</div>`;
    } else if (line.startsWith('[') && line.endsWith(']')) {
      html += `<div style="color:var(--accent);margin-top:4px;">${line}</div>`;
    } else if (line.includes('='.repeat(60))) {
      html += `<div style="color:rgba(255,255,255,0.3);margin:8px 0;">${line}</div>`;
    } else if (line.trim() === '') {
      html += '<br>';
    } else {
      html += `<div style="color:rgba(230,250,255,0.9);">${line}</div>`;
    }
  });
  
  html += '</div>';
  container.innerHTML = html;
  
  // Store the plain text template in a data attribute for copying
  container.dataset.template = template;
}

// Show writing tips based on essay type
function etShowWritingTips(card, type) {
  const tipsContainer = card.querySelector('#et-tips-container');
  const tipsContent = card.querySelector('#et-tips-content');
  
  const tips = etWritingTips[type] || [
    'Start with an outline before writing',
    'Write a strong thesis statement',
    'Use evidence to support your points',
    'Revise for clarity and conciseness',
    'Proofread carefully before submitting'
  ];
  
  let tipsHTML = '<div style="display:grid;gap:6px;">';
  tips.forEach(tip => {
    tipsHTML += `
      <div style="display:flex;align-items:start;gap:8px;">
        <span style="color:#39ff14;">‚úì</span>
        <span style="flex:1;">${tip}</span>
      </div>
    `;
  });
  tipsHTML += '</div>';
  
  tipsContent.innerHTML = tipsHTML;
  tipsContainer.style.display = 'block';
}

// Copy specific sections
function etCopySection(section) {
  const card = document.currentScript?.closest('.card') || document;
  const template = card.querySelector('#et-output-container').dataset.template;
  
  if (!template) {
    etShowCopyError('No template available');
    return;
  }
  
  let textToCopy = '';
  const lines = template.split('\n');
  let inSection = false;
  
  for (let line of lines) {
    if (line.includes(`${section.toUpperCase()}`)) {
      inSection = true;
      textToCopy += line + '\n';
    } else if (inSection && (line.includes('INTRODUCTION') || line.includes('BODY') || line.includes('CONCLUSION') || line.includes('FORMATTING NOTES'))) {
      break;
    } else if (inSection) {
      textToCopy += line + '\n';
    }
  }
  
  navigator.clipboard.writeText(textToCopy.trim()).then(() => {
    const hint = card.querySelector('#et-hint');
    hint.textContent = `‚úÖ ${section.charAt(0).toUpperCase() + section.slice(1)} copied!`;
    hint.style.color = '#39ff14';
    setTimeout(() => {
      if (hint.textContent.includes('copied')) hint.textContent = '';
    }, 2000);
  }).catch(err => {
    console.error('Copy failed:', err);
    etShowCopyError('Copy failed');
  });
}

// Copy full template
function etCopyFullTemplate() {
  const card = document.currentScript?.closest('.card') || document;
  const template = card.querySelector('#et-output-container').dataset.template;
  
  if (!template) {
    etShowCopyError('No template available');
    return;
  }
  
  navigator.clipboard.writeText(template).then(() => {
    const hint = card.querySelector('#et-hint');
    hint.textContent = '‚úÖ Full template copied to clipboard!';
    hint.style.color = '#39ff14';
    setTimeout(() => {
      if (hint.textContent.includes('Full template')) hint.textContent = '';
    }, 2000);
  }).catch(err => {
    console.error('Copy failed:', err);
    etShowCopyError('Copy failed');
  });
}

// Export as PDF (simulated - in real implementation would use a library)
function etExportPDF() {
  const card = document.currentScript?.closest('.card') || document;
  const hint = card.querySelector('#et-hint');
  
  hint.textContent = 'PDF export simulated - would generate PDF in real implementation';
  hint.style.color = '#ffa500';
  setTimeout(() => hint.textContent = '', 3000);
}

// Download as text file
function etDownloadTemplate() {
  const card = document.currentScript?.closest('.card') || document;
  const template = card.querySelector('#et-output-container').dataset.template;
  
  if (!template) {
    etShowCopyError('No template available');
    return;
  }
  
  const blob = new Blob([template], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'essay-template.txt';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  const hint = card.querySelector('#et-hint');
  hint.textContent = '‚úÖ Template downloaded as .txt file!';
  hint.style.color = '#39ff14';
  setTimeout(() => hint.textContent = '', 2000);
}

// Reset form
function etReset(btn) {
  const card = btn.closest('.card') || document;
  
  // Reset form
  card.querySelector('form').reset();
  
  // Hide results
  const resultsDiv = card.querySelector('#et-results');
  resultsDiv.style.display = 'none';
  
  // Clear outputs
  const container = card.querySelector('#et-output-container');
  container.innerHTML = '';
  delete container.dataset.template;
  
  // Clear hints
  const hint = card.querySelector('#et-hint');
  hint.textContent = '';
  
  // Hide tips
  const tipsContainer = card.querySelector('#et-tips-container');
  tipsContainer.style.display = 'none';
  
  // Reset type hint
  etUpdateTypeHint();
}

// Helper function for copy errors
function etShowCopyError(message) {
  const card = document.currentScript?.closest('.card') || document;
  const hint = card.querySelector('#et-hint');
  hint.textContent = `‚ùå ${message}`;
  hint.style.color = '#ff2d55';
  setTimeout(() => hint.textContent = '', 2000);
}

// Initialize on load
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', etInit);
} else {
  etInit();
}
</script>

<style>
#essay-templates-title {
  color: var(--accent);
  margin-top: 0;
  font-size: 1.3rem;
}

.small-btn {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: inherit;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 12px;
  padding: 4px 8px;
}

.small-btn:hover {
  background: rgba(45,212,255,0.1);
  border-color: rgba(45,212,255,0.3);
}

@media (max-width: 768px) {
  .field {
    grid-column: 1 / -1 !important;
  }
  
  .actions {
    flex-direction: column;
  }
  
  .actions button {
    width: 100%;
    margin: 4px 0 !important;
  }
}
</style>
