<h2 id="timer-title" style="margin-top:0;">Timer</h2>

<form aria-describedby="timer-desc">
  <p id="timer-desc" class="small">Use as a countdown or stopwatch.</p>

  <div class="row">
    <div class="field">
      <label for="timer-seconds">Countdown (seconds)</label>
      <input id="timer-seconds" type="number" min="1" value="60" />
    </div>
  </div>

  <div class="actions">
    <button type="button" onclick="timerStart(this)">Start</button>
    <button type="button" class="secondary" onclick="timerStop(this)">Stop</button>
    <button type="button" class="secondary" onclick="timerReset(this)">Reset</button>
  </div>
</form>

<div class="results" aria-live="polite">
  <div class="result">
    <div class="label">Status</div>
    <div class="value" id="timer-status">–</div>
  </div>
  <div class="result">
    <div class="label">Time</div>
    <div class="value" id="timer-time">–</div>
  </div>
</div>

<script>
let timerInterval;

function timerStart(btn) {
  const card = btn.closest('.card');
  const secondsInput = parseInt(card.querySelector('#timer-seconds').value) || 0;
  let remaining = secondsInput;

  clearInterval(timerInterval);

  if (secondsInput > 0) {
    card.querySelector('#timer-status').textContent = "Countdown running";
    updateTimer(card, remaining);

    timerInterval = setInterval(() => {
      remaining--;
      updateTimer(card, remaining);

      if (remaining <= 0) {
        clearInterval(timerInterval);
        card.querySelector('#timer-status').textContent = "Time's up!";
      }
    }, 1000);
  } else {
    // Stopwatch mode
    card.querySelector('#timer-status').textContent = "Stopwatch running";
    let elapsed = 0;
    updateTimer(card, elapsed);

    timerInterval = setInterval(() => {
      elapsed++;
      updateTimer(card, elapsed);
    }, 1000);
  }
}

function updateTimer(card, seconds) {
  const m = Math.floor(seconds / 60);
  const s = seconds % 60;
  card.querySelector('#timer-time').textContent = m + "m " + s + "s";
}

function timerStop(btn) {
  clearInterval(timerInterval);
  const card = btn.closest('.card');
  card.querySelector('#timer-status').textContent = "Stopped";
}

function timerReset(btn) {
  clearInterval(timerInterval);
  const card = btn.closest('.card');
  card.querySelector('form').reset();
  card.querySelector('#timer-status').textContent = '–';
  card.querySelector('#timer-time').textContent = '–';
}
</script>
