<h2 id="bmi-title" style="margin-top:0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px;">
  <i class="fas fa-weight-scale"></i> BMI Calculator
</h2>

<form aria-describedby="bmi-desc" style="background: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e1e8ed;">
  <p id="bmi-desc" class="small" style="margin-bottom: 20px; color: #5a6c7d; font-style: italic; border-left: 3px solid #3498db; padding-left: 10px;">
    Calculate your Body Mass Index (BMI) and see which category you fall into.
    <span id="bmi-importance" style="display: block; margin-top: 5px; color: #3498db; font-weight: 500; font-style: normal;">
      BMI is a simple screening tool for weight categories that may lead to health problems.
    </span>
  </p>

  <div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
    <div class="field">
      <label for="bmi-height" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-ruler-vertical"></i> Height
        <span id="height-display" style="float: right; color: #3498db; font-weight: normal;">175 cm</span>
      </label>
      <input id="bmi-height" type="range" min="100" max="250" step="1" value="175" 
             style="width: 100%; margin-bottom: 5px;"
             oninput="updateHeightValue(this.value)" />
      <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
        <span>100 cm</span>
        <span>175 cm</span>
        <span>250 cm</span>
      </div>
      <input id="bmi-height-input" type="number" min="100" max="250" step="0.1" value="175" 
             style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: 1px solid #bdc3c7;"
             oninput="updateHeightSlider(this.value)" />
      <small style="display: block; margin-top: 5px; color: #7f8c8d;">
        Enter height in centimeters or use the slider
      </small>
    </div>

    <div class="field">
      <label for="bmi-weight" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-weight-hanging"></i> Weight
        <span id="weight-display" style="float: right; color: #3498db; font-weight: normal;">70 kg</span>
      </label>
      <input id="bmi-weight" type="range" min="30" max="200" step="0.5" value="70" 
             style="width: 100%; margin-bottom: 5px;"
             oninput="updateWeightValue(this.value)" />
      <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
        <span>30 kg</span>
        <span>70 kg</span>
        <span>200 kg</span>
      </div>
      <input id="bmi-weight-input" type="number" min="30" max="200" step="0.1" value="70" 
             style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: 1px solid #bdc3c7;"
             oninput="updateWeightSlider(this.value)" />
      <small style="display: block; margin-top: 5px; color: #7f8c8d;">
        Enter weight in kilograms or use the slider
      </small>
    </div>
  </div>

  <div class="actions" style="margin-top: 25px; display: flex; gap: 10px;">
    <button type="button" onclick="bmiCalc(this)" 
            style="flex: 1; padding: 14px; background: linear-gradient(135deg, #3498db, #2980b9); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 1em;">
      <i class="fas fa-calculator"></i> Calculate BMI
    </button>
    <button type="button" class="secondary" onclick="bmiReset(this)" 
            style="flex: 1; padding: 14px; background: #f8f9fa; color: #2c3e50; border: 1px solid #bdc3c7; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 1em;">
      <i class="fas fa-redo"></i> Reset
    </button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top: 25px; background: #f8fafc; border-radius: 8px; padding: 20px; border: 1px solid #e1e8ed;">
  <div style="text-align: center; margin-bottom: 20px;">
    <h3 style="margin: 0 0 10px 0; color: #2c3e50;">
      <i class="fas fa-chart-line"></i> Your Results
    </h3>
    <p style="color: #7f8c8d; margin: 0; font-size: 0.95em;">
      Based on the WHO classification system
    </p>
  </div>

  <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 25px;">
    <div class="result" style="flex: 1; min-width: 150px; background: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
      <div class="label" style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 8px;">
        <i class="fas fa-calculator"></i> BMI Value
      </div>
      <div class="value" id="bmi-res" style="font-size: 2.5em; font-weight: 700; color: #2c3e50;">–</div>
      <div id="bmi-formula" style="font-size: 0.8em; color: #95a5a6; margin-top: 5px; font-family: monospace;">
        kg/m²
      </div>
    </div>

    <div class="result" style="flex: 2; min-width: 250px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
      <div class="label" style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 10px;">
        <i class="fas fa-layer-group"></i> Category
      </div>
      <div class="value" id="bmi-category" style="font-size: 1.8em; font-weight: 700; color: #2c3e50; margin-bottom: 10px;">–</div>
      <div id="bmi-range" style="font-size: 0.9em; color: #7f8c8d;">
        Range: <span id="bmi-range-value">–</span>
      </div>
      <div id="bmi-recommendation" style="font-size: 0.9em; color: #3498db; margin-top: 8px;">
        <!-- Recommendations will appear here -->
      </div>
    </div>
  </div>

  <!-- BMI Scale Visualization -->
  <div style="margin-top: 25px;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
      <span style="color: #7f8c8d; font-size: 0.9em;">BMI Scale</span>
      <span style="color: #3498db; font-size: 0.9em;">Your position: <span id="bmi-position">–</span></span>
    </div>
    
    <div id="bmi-scale" style="height: 40px; background: linear-gradient(to right, #3498db, #2ecc71, #f39c12, #e74c3c); border-radius: 20px; position: relative; margin-bottom: 10px;">
      <div id="bmi-marker" style="position: absolute; top: -5px; width: 10px; height: 50px; background: #2c3e50; border-radius: 5px; display: none;"></div>
    </div>
    
    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
      <div style="text-align: center;">
        <div style="color: #3498db; font-weight: 600;">Underweight</div>
        <div>&lt; 18.5</div>
      </div>
      <div style="text-align: center;">
        <div style="color: #2ecc71; font-weight: 600;">Normal</div>
        <div>18.5 – 24.9</div>
      </div>
      <div style="text-align: center;">
        <div style="color: #f39c12; font-weight: 600;">Overweight</div>
        <div>25 – 29.9</div>
      </div>
      <div style="text-align: center;">
        <div style="color: #e74c3c; font-weight: 600;">Obese</div>
        <div>≥ 30</div>
      </div>
    </div>
  </div>

  <!-- Health Information -->
  <div id="bmi-health-info" style="display: none; margin-top: 25px; padding: 15px; background: #e8f4fc; border-radius: 8px; border-left: 4px solid #3498db;">
    <h4 style="margin-top: 0; color: #2c3e50; margin-bottom: 10px;">
      <i class="fas fa-heartbeat"></i> Health Information
    </h4>
    <div id="health-details" style="color: #5a6c7d; font-size: 0.95em;">
      <!-- Health information will appear here -->
    </div>
  </div>
</div>

<details class="small" style="margin-top:20px; background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e1e8ed;">
  <summary style="font-weight: 600; color: #2c3e50; cursor: pointer;">
    <i class="fas fa-info-circle"></i> How BMI Works & Important Notes
  </summary>
  <div style="margin-top: 15px;">
    <p><strong>BMI Formula:</strong> BMI = Weight (kg) ÷ (Height (m)²)</p>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
      <div style="background: white; padding: 10px; border-radius: 4px;">
        <strong style="color: #3498db;">Categories (WHO):</strong>
        <ul style="margin: 8px 0 0 0; padding-left: 20px;">
          <li>Underweight: &lt; 18.5</li>
          <li>Normal: 18.5 – 24.9</li>
          <li>Overweight: 25 – 29.9</li>
          <li>Obese Class I: 30 – 34.9</li>
          <li>Obese Class II: 35 – 39.9</li>
          <li>Obese Class III: ≥ 40</li>
        </ul>
      </div>
      
      <div style="background: white; padding: 10px; border-radius: 4px;">
        <strong style="color: #e74c3c;">Limitations:</strong>
        <ul style="margin: 8px 0 0 0; padding-left: 20px;">
          <li>Doesn't distinguish muscle from fat</li>
          <li>Not suitable for athletes</li>
          <li>Doesn't account for age or sex</li>
          <li>Not accurate for children or elderly</li>
        </ul>
      </div>
    </div>
    
    <p style="color: #e74c3c; font-weight: 600;">
      <i class="fas fa-exclamation-triangle"></i> BMI is a screening tool, not a diagnostic measure. 
      Consult a healthcare professional for personalized advice.
    </p>
  </div>
</details>

<script>
// Initialize sliders and inputs
document.addEventListener('DOMContentLoaded', function() {
  // Set initial values
  updateHeightValue(175);
  updateWeightValue(70);
  
  // Calculate on initial load
  setTimeout(() => bmiCalc(document.querySelector('button')), 100);
});

// Update height slider and input
function updateHeightValue(value) {
  document.getElementById('bmi-height').value = value;
  document.getElementById('bmi-height-input').value = value;
  document.getElementById('height-display').textContent = value + ' cm';
  
  // Auto-calculate if both values are valid
  autoCalculate();
}

// Update height input from manual entry
function updateHeightSlider(value) {
  let numValue = parseFloat(value);
  if (isNaN(numValue) || numValue < 100) numValue = 100;
  if (numValue > 250) numValue = 250;
  
  updateHeightValue(numValue);
}

// Update weight slider and input
function updateWeightValue(value) {
  document.getElementById('bmi-weight').value = value;
  document.getElementById('bmi-weight-input').value = value;
  document.getElementById('weight-display').textContent = value + ' kg';
  
  // Auto-calculate if both values are valid
  autoCalculate();
}

// Update weight input from manual entry
function updateWeightSlider(value) {
  let numValue = parseFloat(value);
  if (isNaN(numValue) || numValue < 30) numValue = 30;
  if (numValue > 200) numValue = 200;
  
  updateWeightValue(numValue);
}

// Auto-calculate when values change
function autoCalculate() {
  const height = parseFloat(document.getElementById('bmi-height').value);
  const weight = parseFloat(document.getElementById('bmi-weight').value);
  
  if (height > 0 && weight > 0) {
    bmiCalc(document.querySelector('button'));
  }
}

// Main BMI calculation function
function bmiCalc(btn) {
  const heightCm = parseFloat(document.getElementById('bmi-height').value) || 0;
  const weightKg = parseFloat(document.getElementById('bmi-weight').value) || 0;

  if (heightCm <= 0 || weightKg <= 0) {
    showError();
    return;
  }

  const heightM = heightCm / 100;
  const bmi = weightKg / (heightM * heightM);
  const bmiRounded = Math.round(bmi * 10) / 10;

  // Determine category and color
  let category = "";
  let categoryColor = "";
  let range = "";
  let recommendation = "";
  let healthInfo = "";
  
  if (bmi < 16) {
    category = "Severely Underweight";
    categoryColor = "#3498db";
    range = "< 16";
    recommendation = "Consult a healthcare provider for guidance on healthy weight gain.";
    healthInfo = "Severely underweight individuals may be at risk for nutritional deficiencies, osteoporosis, and weakened immune system.";
  } else if (bmi < 18.5) {
    category = "Underweight";
    categoryColor = "#3498db";
    range = "16 – 18.4";
    recommendation = "Consider consulting a nutritionist for healthy weight gain strategies.";
    healthInfo = "Being underweight can lead to nutrient deficiencies, weakened immune function, and osteoporosis.";
  } else if (bmi < 25) {
    category = "Normal Weight";
    categoryColor = "#2ecc71";
    range = "18.5 – 24.9";
    recommendation = "Maintain your current weight with a balanced diet and regular exercise.";
    healthInfo = "Congratulations! You're in a healthy weight range. Continue with balanced nutrition and regular physical activity.";
  } else if (bmi < 30) {
    category = "Overweight";
    categoryColor = "#f39c12";
    range = "25 – 29.9";
    recommendation = "Consider increasing physical activity and adopting a balanced diet.";
    healthInfo = "Overweight individuals have increased risk for hypertension, heart disease, and type 2 diabetes.";
  } else if (bmi < 35) {
    category = "Obese (Class I)";
    categoryColor = "#e74c3c";
    range = "30 – 34.9";
    recommendation = "Consult a healthcare provider for personalized weight management advice.";
    healthInfo = "Obesity increases risk of heart disease, stroke, type 2 diabetes, and certain cancers.";
  } else if (bmi < 40) {
    category = "Obese (Class II)";
    categoryColor = "#c0392b";
    range = "35 – 39.9";
    recommendation = "Medical supervision recommended for weight management.";
    healthInfo = "Severe obesity significantly increases health risks. Consult with healthcare professionals.";
  } else {
    category = "Obese (Class III)";
    categoryColor = "#a93226";
    range = "≥ 40";
    recommendation = "Immediate medical consultation recommended.";
    healthInfo = "Morbid obesity requires medical intervention. Please consult with healthcare professionals.";
  }

  // Update results display
  document.getElementById('bmi-res').textContent = bmiRounded;
  document.getElementById('bmi-res').style.color = categoryColor;
  
  document.getElementById('bmi-category').textContent = category;
  document.getElementById('bmi-category').style.color = categoryColor;
  
  document.getElementById('bmi-range-value').textContent = range;
  document.getElementById('bmi-range-value').style.color = categoryColor;
  
  document.getElementById('bmi-recommendation').innerHTML = `<i class="fas fa-lightbulb"></i> ${recommendation}`;
  document.getElementById('bmi-recommendation').style.color = categoryColor;
  
  // Update formula display
  document.getElementById('bmi-formula').innerHTML = 
    `= ${weightKg} / (${heightM.toFixed(2)})² = ${bmiRounded}`;
  
  // Update BMI scale marker
  updateBMIScale(bmi);
  
  // Update position indicator
  document.getElementById('bmi-position').textContent = bmiRounded;
  document.getElementById('bmi-position').style.color = categoryColor;
  
  // Show health information
  document.getElementById('health-details').textContent = healthInfo;
  document.getElementById('bmi-health-info').style.display = 'block';
  document.getElementById('bmi-health-info').style.borderLeftColor = categoryColor;
  
  // Add celebration for normal weight
  if (category === "Normal Weight") {
    celebrateNormalBMI();
  }
}

// Update the BMI scale visualization
function updateBMIScale(bmi) {
  const scale = document.getElementById('bmi-scale');
  const marker = document.getElementById('bmi-marker');
  
  // Calculate position (BMI scale from 15 to 45 for visualization)
  let position = ((bmi - 15) / 30) * 100;
  if (position < 0) position = 0;
  if (position > 100) position = 100;
  
  marker.style.left = `calc(${position}% - 5px)`;
  marker.style.display = 'block';
}

// Show error state
function showError() {
  document.getElementById('bmi-res').textContent = "–";
  document.getElementById('bmi-category').textContent = "Invalid input";
  document.getElementById('bmi-category').style.color = "#e74c3c";
  document.getElementById('bmi-range-value').textContent = "–";
  document.getElementById('bmi-recommendation').innerHTML = "Please enter valid height and weight values.";
  document.getElementById('bmi-recommendation').style.color = "#e74c3c";
  document.getElementById('bmi-position').textContent = "–";
  document.getElementById('bmi-marker').style.display = 'none';
  document.getElementById('bmi-health-info').style.display = 'none';
}

// Reset function
function bmiReset(btn) {
  updateHeightValue(175);
  updateWeightValue(70);
  bmiCalc(btn);
}

// Celebration for normal BMI
function celebrateNormalBMI() {
  const resultDiv = document.querySelector('.result .value');
  resultDiv.style.animation = 'pulse 2s infinite';
  
  // Add CSS animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
  `;
  document.head.appendChild(style);
  
  // Remove animation after 3 seconds
  setTimeout(() => {
    resultDiv.style.animation = '';
  }, 3000);
}
</script>

<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">