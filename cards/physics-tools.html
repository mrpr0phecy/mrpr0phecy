<div class="card">
  <div class="card-header">
    <h2 class="card-title">
      <span class="title-icon">‚öõÔ∏è</span>
      Physics Tools
    </h2>
    <p class="card-subtitle">Calculate basic physics quantities with formulas and step-by-step solutions.</p>
  </div>
  
  <div class="card-content">
    <!-- Tool Selection -->
    <div class="tool-selector">
      <div class="section-title">
        <span class="section-icon">üõ†Ô∏è</span>
        Select Physics Tool
      </div>
      
      <div class="tools-grid">
        <div class="tool-card active" data-tool="force">
          <div class="tool-icon">üî∫</div>
          <div class="tool-name">Force</div>
          <div class="tool-formula">F = m¬∑a</div>
        </div>
        <div class="tool-card" data-tool="work">
          <div class="tool-icon">‚ö°</div>
          <div class="tool-name">Work</div>
          <div class="tool-formula">W = F¬∑d</div>
        </div>
        <div class="tool-card" data-tool="power">
          <div class="tool-icon">‚öôÔ∏è</div>
          <div class="tool-name">Power</div>
          <div class="tool-formula">P = W/t</div>
        </div>
        <div class="tool-card" data-tool="kinetic">
          <div class="tool-icon">üöÄ</div>
          <div class="tool-name">Kinetic Energy</div>
          <div class="tool-formula">KE = ¬Ωmv¬≤</div>
        </div>
        <div class="tool-card" data-tool="potential">
          <div class="tool-icon">‚õ∞Ô∏è</div>
          <div class="tool-name">Potential Energy</div>
          <div class="tool-formula">PE = mgh</div>
        </div>
        <div class="tool-card" data-tool="momentum">
          <div class="tool-icon">‚ÜîÔ∏è</div>
          <div class="tool-name">Momentum</div>
          <div class="tool-formula">p = mv</div>
        </div>
      </div>
    </div>
    
    <!-- Input Section -->
    <div class="input-section">
      <div class="section-header">
        <h3 class="section-title">
          <span class="section-icon">üìù</span>
          <span id="current-tool-name">Force Calculator</span>
        </h3>
        <div class="formula-display" id="formula-display">
          F = m √ó a
        </div>
      </div>
      
      <div class="input-grid">
        <div class="input-group">
          <label for="phys-mass" class="input-label">Mass (m)</label>
          <div class="input-with-unit">
            <input type="number" id="phys-mass" class="card-input" placeholder="e.g., 10">
            <span class="input-unit">kg</span>
          </div>
        </div>
        
        <div class="input-group">
          <label for="phys-acceleration" class="input-label">Acceleration (a)</label>
          <div class="input-with-unit">
            <input type="number" id="phys-acceleration" class="card-input" placeholder="e.g., 9.8">
            <span class="input-unit">m/s¬≤</span>
          </div>
        </div>
        
        <!-- Dynamic inputs will appear here -->
        <div id="dynamic-inputs"></div>
      </div>
      
      <div class="input-options">
        <label class="option-toggle">
          <input type="checkbox" id="phys-show-steps" checked>
          <span class="toggle-slider"></span>
          <span class="option-label">
            <span class="option-icon">üìä</span>
            Show step-by-step solution
          </span>
        </label>
        
        <label class="option-toggle">
          <input type="checkbox" id="phys-show-units" checked>
          <span class="toggle-slider"></span>
          <span class="option-label">
            <span class="option-icon">üìè</span>
            Show unit conversions
          </span>
        </label>
      </div>
    </div>
    
    <!-- Results Section -->
    <div class="results-section">
      <div class="section-header">
        <h3 class="section-title">
          <span class="section-icon">üìä</span>
          Calculation Results
        </h3>
        <button type="button" class="card-btn secondary small" onclick="copyResult()">
          <span class="btn-icon">üìã</span>
          Copy Result
        </button>
      </div>
      
      <div class="result-display">
        <div class="result-value-container">
          <div class="result-label" id="result-label">Force</div>
          <div class="result-value" id="result-value">‚Äì</div>
          <div class="result-unit" id="result-unit">N (Newtons)</div>
        </div>
        
        <div id="result-steps" class="result-steps">
          <!-- Steps will appear here -->
        </div>
        
        <textarea id="phys-output" class="result-output" readonly 
                  placeholder="Enter values and click Calculate to see results..."></textarea>
        
        <div id="phys-hint" class="result-hint"></div>
      </div>
      
      <div class="quick-calculations">
        <div class="quick-title">Quick Calculations:</div>
        <div class="quick-buttons">
          <button type="button" class="quick-btn" onclick="quickCalc('earthGravity')">
            üåç Earth gravity
          </button>
          <button type="button" class="quick-btn" onclick="quickCalc('carKinetic')">
            üöó Car at 60 km/h
          </button>
          <button type="button" class="quick-btn" onclick="quickCalc('waterfallPE')">
            üåä Waterfall energy
          </button>
          <button type="button" class="quick-btn" onclick="quickCalc('humanPower')">
            üèÉ Human power
          </button>
        </div>
      </div>
    </div>
    
    <!-- Physics Reference -->
    <div class="reference-section">
      <div class="section-title">
        <span class="section-icon">üìö</span>
        Physics Formulas Reference
      </div>
      
      <div class="reference-grid">
        <div class="ref-card">
          <div class="ref-formula">F = ma</div>
          <div class="ref-name">Newton's Second Law</div>
          <div class="ref-desc">Force equals mass times acceleration</div>
        </div>
        <div class="ref-card">
          <div class="ref-formula">W = Fd</div>
          <div class="ref-name">Work</div>
          <div class="ref-desc">Work equals force times displacement</div>
        </div>
        <div class="ref-card">
          <div class="ref-formula">P = W/t</div>
          <div class="ref-name">Power</div>
          <div class="ref-desc">Power equals work divided by time</div>
        </div>
        <div class="ref-card">
          <div class="ref-formula">KE = ¬Ωmv¬≤</div>
          <div class="ref-name">Kinetic Energy</div>
          <div class="ref-desc">Energy of motion</div>
        </div>
        <div class="ref-card">
          <div class="ref-formula">PE = mgh</div>
          <div class="ref-name">Potential Energy</div>
          <div class="ref-desc">Gravitational potential energy</div>
        </div>
        <div class="ref-card">
          <div class="ref-formula">p = mv</div>
          <div class="ref-name">Momentum</div>
          <div class="ref-desc">Product of mass and velocity</div>
        </div>
      </div>
    </div>
    
    <!-- Action Buttons -->
    <div class="action-buttons">
      <button type="button" class="card-btn primary" onclick="calculate()">
        <span class="btn-icon">üßÆ</span>
        Calculate
      </button>
      <button type="button" class="card-btn secondary" onclick="resetAll()">
        <span class="btn-icon">üîÑ</span>
        Reset All
      </button>
      <button type="button" class="card-btn" onclick="clearHistory()">
        <span class="btn-icon">üóëÔ∏è</span>
        Clear History
      </button>
    </div>
    
    <!-- History -->
    <div class="history-section">
      <div class="section-header">
        <h3 class="section-title">
          <span class="section-icon">üìú</span>
          Calculation History
        </h3>
        <div class="history-count">
          <span id="history-count">0</span> calculations
        </div>
      </div>
      
      <div id="history-list" class="history-list">
        <div class="empty-state">
          <div class="empty-icon">üìù</div>
          <div>No calculations yet</div>
          <div class="empty-subtitle">Your calculations will appear here</div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  padding: 24px;
  max-width: 900px;
  margin: 0 auto;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  border: 1px solid #e0f2fe;
}

.card-header {
  text-align: center;
  margin-bottom: 24px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f0f9ff;
}

.card-title {
  margin: 0;
  color: #1e3a8a;
  font-size: 28px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.title-icon {
  font-size: 32px;
}

.card-subtitle {
  font-size: 16px;
  color: #64748b;
  margin-top: 8px;
}

.card-content {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Tool Selector */
.tool-selector {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.section-title {
  margin: 0 0 20px 0;
  color: #1e3a8a;
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.section-icon {
  font-size: 20px;
}

.tools-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .tools-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .tools-grid {
    grid-template-columns: 1fr;
  }
}

.tool-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.tool-card:hover {
  transform: translateY(-4px);
  border-color: #93c5fd;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

.tool-card.active {
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  border-color: #3b82f6;
  color: white;
}

.tool-card.active .tool-icon,
.tool-card.active .tool-name,
.tool-card.active .tool-formula {
  color: white;
}

.tool-icon {
  font-size: 32px;
  margin-bottom: 12px;
  color: #3b82f6;
}

.tool-name {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 8px;
}

.tool-formula {
  font-size: 14px;
  font-family: 'Courier New', monospace;
  color: #6b7280;
  font-weight: 500;
}

/* Input Section */
.input-section {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  flex-wrap: wrap;
  gap: 16px;
}

.formula-display {
  font-family: 'Courier New', monospace;
  font-size: 20px;
  font-weight: 600;
  color: #3b82f6;
  background: white;
  padding: 8px 16px;
  border-radius: 8px;
  border: 2px solid #dbeafe;
}

.input-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 24px;
}

@media (max-width: 768px) {
  .input-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .input-grid {
    grid-template-columns: 1fr;
  }
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.input-label {
  font-size: 14px;
  font-weight: 500;
  color: #4b5563;
  display: flex;
  align-items: center;
  gap: 4px;
}

.input-label::after {
  content: '*';
  color: #ef4444;
  font-weight: bold;
}

.input-with-unit {
  position: relative;
}

.input-with-unit .card-input {
  padding-right: 60px;
}

.input-unit {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

.card-input {
  padding: 14px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 16px;
  color: #374151;
  background: white;
  transition: all 0.2s;
  font-family: inherit;
  width: 100%;
}

.card-input:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.card-input::placeholder {
  color: #9ca3af;
}

.input-options {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 16px;
}

.option-toggle {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: white;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  cursor: pointer;
  transition: all 0.2s;
  user-select: none;
}

.option-toggle:hover {
  background: #f9fafb;
  border-color: #d1d5db;
}

.option-toggle input[type="checkbox"] {
  display: none;
}

.toggle-slider {
  width: 44px;
  height: 24px;
  background: #d1d5db;
  border-radius: 12px;
  position: relative;
  transition: all 0.2s;
  flex-shrink: 0;
}

.toggle-slider:after {
  content: '';
  position: absolute;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: white;
  top: 2px;
  left: 2px;
  transition: all 0.2s;
}

.option-toggle input:checked + .toggle-slider {
  background: #3b82f6;
}

.option-toggle input:checked + .toggle-slider:after {
  left: 22px;
}

.option-label {
  font-size: 14px;
  color: #4b5563;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 8px;
}

.option-icon {
  font-size: 16px;
}

/* Results Section */
.results-section {
  background: linear-gradient(135deg, #f0f9ff, #fef7ff);
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #dbeafe;
}

.result-display {
  background: white;
  border-radius: 12px;
  padding: 24px;
  border: 2px solid #e5e7eb;
  margin-bottom: 20px;
}

.result-value-container {
  text-align: center;
  margin-bottom: 24px;
  padding-bottom: 24px;
  border-bottom: 1px solid #e5e7eb;
}

.result-label {
  font-size: 14px;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 8px;
}

.result-value {
  font-size: 48px;
  font-weight: 700;
  color: #1e3a8a;
  margin-bottom: 8px;
  font-family: 'Courier New', monospace;
}

.result-unit {
  font-size: 16px;
  color: #6b7280;
  font-weight: 500;
}

.result-steps {
  margin-bottom: 20px;
  padding: 16px;
  background: #f9fafb;
  border-radius: 8px;
  border-left: 4px solid #3b82f6;
}

.step {
  margin-bottom: 8px;
  font-size: 14px;
  color: #4b5563;
  line-height: 1.5;
}

.step:last-child {
  margin-bottom: 0;
}

.step-formula {
  font-family: 'Courier New', monospace;
  font-weight: 600;
  color: #3b82f6;
  background: white;
  padding: 2px 6px;
  border-radius: 4px;
  border: 1px solid #dbeafe;
  margin: 0 4px;
}

.result-output {
  width: 100%;
  padding: 16px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
  font-family: 'Courier New', monospace;
  color: #374151;
  background: white;
  resize: none;
  min-height: 120px;
  line-height: 1.6;
  margin-bottom: 12px;
}

.result-output:focus {
  outline: none;
  border-color: #3b82f6;
}

.result-hint {
  font-size: 13px;
  color: #10b981;
  text-align: center;
  min-height: 20px;
}

.quick-calculations {
  margin-top: 24px;
}

.quick-title {
  font-size: 14px;
  color: #6b7280;
  margin-bottom: 12px;
  font-weight: 500;
}

.quick-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.quick-btn {
  padding: 8px 16px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  color: #4b5563;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.quick-btn:hover {
  background: #f3f4f6;
  border-color: #d1d5db;
  transform: translateY(-1px);
}

/* Reference Section */
.reference-section {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.reference-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .reference-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .reference-grid {
    grid-template-columns: 1fr;
  }
}

.ref-card {
  background: white;
  border-radius: 8px;
  padding: 20px;
  border: 1px solid #e5e7eb;
  transition: all 0.2s;
}

.ref-card:hover {
  transform: translateY(-2px);
  border-color: #93c5fd;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.ref-formula {
  font-family: 'Courier New', monospace;
  font-size: 20px;
  font-weight: 700;
  color: #1e3a8a;
  margin-bottom: 8px;
}

.ref-name {
  font-size: 14px;
  font-weight: 600;
  color: #4b5563;
  margin-bottom: 4px;
}

.ref-desc {
  font-size: 13px;
  color: #6b7280;
  line-height: 1.4;
}

/* Buttons */
.card-btn {
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.card-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.card-btn.primary {
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  color: white;
}

.card-btn.primary:hover {
  background: linear-gradient(135deg, #1d4ed8, #1e40af);
}

.card-btn.secondary {
  background: #f3f4f6;
  color: #4b5563;
  border: 1px solid #e5e7eb;
}

.card-btn.secondary:hover {
  background: #e5e7eb;
}

.card-btn.small {
  padding: 8px 16px;
  font-size: 13px;
}

.btn-icon {
  font-size: 16px;
}

/* Action Buttons */
.action-buttons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .action-buttons {
    grid-template-columns: 1fr;
  }
}

/* History Section */
.history-section {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.history-count {
  font-size: 14px;
  color: #6b7280;
  font-weight: 500;
}

.history-list {
  min-height: 100px;
  max-height: 300px;
  overflow-y: auto;
  margin-top: 16px;
  padding-right: 8px;
}

.history-list::-webkit-scrollbar {
  width: 6px;
}

.history-list::-webkit-scrollbar-track {
  background: #f1f5f9;
  border-radius: 3px;
}

.history-list::-webkit-scrollbar-thumb {
  background: #cbd5e0;
  border-radius: 3px;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #9ca3af;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-subtitle {
  font-size: 13px;
  margin-top: 8px;
  color: #d1d5db;
}

.history-item {
  background: white;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
  border: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: all 0.2s;
}

.history-item:hover {
  border-color: #93c5fd;
  transform: translateX(4px);
}

.history-content {
  flex: 1;
}

.history-tool {
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 4px;
}

.history-result {
  font-size: 14px;
  color: #6b7280;
  font-family: 'Courier New', monospace;
}

.history-actions {
  display: flex;
  gap: 8px;
}

/* Animations */
@keyframes calculatePulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.calculating {
  animation: calculatePulse 0.5s ease;
}

/* Responsive */
@media (max-width: 768px) {
  .section-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .formula-display {
    width: 100%;
    text-align: center;
  }
}

/* Unit styling */
.unit-superscript {
  font-size: 0.8em;
  vertical-align: super;
}

/* Formula colors */
.formula-var {
  color: #3b82f6;
  font-weight: 600;
}

.formula-op {
  color: #6b7280;
  font-weight: 500;
}
</style>

<script>
/* Physics Tools - Card Version */

let currentTool = 'force';
let calculationHistory = [];

// Tool configurations
const tools = {
  force: {
    name: 'Force Calculator',
    formula: 'F = m √ó a',
    inputs: [
      { id: 'mass', label: 'Mass (m)', unit: 'kg', placeholder: 'e.g., 10' },
      { id: 'acceleration', label: 'Acceleration (a)', unit: 'm/s¬≤', placeholder: 'e.g., 9.8' }
    ],
    calculate: (values) => {
      const m = values.mass;
      const a = values.acceleration;
      if (!m || !a) return null;
      return m * a;
    },
    steps: (values, result) => [
      `Given: mass (m) = ${values.mass} kg, acceleration (a) = ${values.acceleration} m/s¬≤`,
      `Formula: F = m √ó a`,
      `Calculation: F = ${values.mass} √ó ${values.acceleration}`,
      `Result: F = ${result.toFixed(3)} N`
    ],
    resultLabel: 'Force',
    resultUnit: 'N (Newtons)'
  },
  
  work: {
    name: 'Work Calculator',
    formula: 'W = F √ó d',
    inputs: [
      { id: 'force', label: 'Force (F)', unit: 'N', placeholder: 'e.g., 50' },
      { id: 'distance', label: 'Distance (d)', unit: 'm', placeholder: 'e.g., 10' }
    ],
    calculate: (values) => {
      const F = values.force;
      const d = values.distance;
      if (!F || !d) return null;
      return F * d;
    },
    steps: (values, result) => [
      `Given: force (F) = ${values.force} N, distance (d) = ${values.distance} m`,
      `Formula: W = F √ó d`,
      `Calculation: W = ${values.force} √ó ${values.distance}`,
      `Result: W = ${result.toFixed(3)} J`
    ],
    resultLabel: 'Work',
    resultUnit: 'J (Joules)'
  },
  
  power: {
    name: 'Power Calculator',
    formula: 'P = W √∑ t',
    inputs: [
      { id: 'work', label: 'Work (W)', unit: 'J', placeholder: 'e.g., 500' },
      { id: 'time', label: 'Time (t)', unit: 's', placeholder: 'e.g., 10' }
    ],
    calculate: (values) => {
      const W = values.work;
      const t = values.time;
      if (!W || !t) return null;
      return W / t;
    },
    steps: (values, result) => [
      `Given: work (W) = ${values.work} J, time (t) = ${values.time} s`,
      `Formula: P = W √∑ t`,
      `Calculation: P = ${values.work} √∑ ${values.time}`,
      `Result: P = ${result.toFixed(3)} W`
    ],
    resultLabel: 'Power',
    resultUnit: 'W (Watts)'
  },
  
  kinetic: {
    name: 'Kinetic Energy Calculator',
    formula: 'KE = ¬Ω √ó m √ó v¬≤',
    inputs: [
      { id: 'mass', label: 'Mass (m)', unit: 'kg', placeholder: 'e.g., 1000' },
      { id: 'velocity', label: 'Velocity (v)', unit: 'm/s', placeholder: 'e.g., 20' }
    ],
    calculate: (values) => {
      const m = values.mass;
      const v = values.velocity;
      if (!m || !v) return null;
      return 0.5 * m * v * v;
    },
    steps: (values, result) => [
      `Given: mass (m) = ${values.mass} kg, velocity (v) = ${values.velocity} m/s`,
      `Formula: KE = ¬Ω √ó m √ó v¬≤`,
      `Calculation: KE = 0.5 √ó ${values.mass} √ó (${values.velocity})¬≤`,
      `Calculation: KE = 0.5 √ó ${values.mass} √ó ${(values.velocity * values.velocity).toFixed(2)}`,
      `Result: KE = ${result.toFixed(3)} J`
    ],
    resultLabel: 'Kinetic Energy',
    resultUnit: 'J (Joules)'
  },
  
  potential: {
    name: 'Potential Energy Calculator',
    formula: 'PE = m √ó g √ó h',
    inputs: [
      { id: 'mass', label: 'Mass (m)', unit: 'kg', placeholder: 'e.g., 10' },
      { id: 'gravity', label: 'Gravity (g)', unit: 'm/s¬≤', placeholder: '9.81' },
      { id: 'height', label: 'Height (h)', unit: 'm', placeholder: 'e.g., 100' }
    ],
    calculate: (values) => {
      const m = values.mass;
      const g = values.gravity || 9.81;
      const h = values.height;
      if (!m || !h) return null;
      return m * g * h;
    },
    steps: (values, result) => {
      const g = values.gravity || 9.81;
      return [
        `Given: mass (m) = ${values.mass} kg, gravity (g) = ${g} m/s¬≤, height (h) = ${values.height} m`,
        `Formula: PE = m √ó g √ó h`,
        `Calculation: PE = ${values.mass} √ó ${g} √ó ${values.height}`,
        `Result: PE = ${result.toFixed(3)} J`
      ];
    },
    resultLabel: 'Potential Energy',
    resultUnit: 'J (Joules)'
  },
  
  momentum: {
    name: 'Momentum Calculator',
    formula: 'p = m √ó v',
    inputs: [
      { id: 'mass', label: 'Mass (m)', unit: 'kg', placeholder: 'e.g., 5' },
      { id: 'velocity', label: 'Velocity (v)', unit: 'm/s', placeholder: 'e.g., 20' }
    ],
    calculate: (values) => {
      const m = values.mass;
      const v = values.velocity;
      if (!m || !v) return null;
      return m * v;
    },
    steps: (values, result) => [
      `Given: mass (m) = ${values.mass} kg, velocity (v) = ${values.velocity} m/s`,
      `Formula: p = m √ó v`,
      `Calculation: p = ${values.mass} √ó ${values.velocity}`,
      `Result: p = ${result.toFixed(3)} kg¬∑m/s`
    ],
    resultLabel: 'Momentum',
    resultUnit: 'kg¬∑m/s'
  }
};

// Initialize
function init() {
  // Load history
  const savedHistory = localStorage.getItem('physicsHistory');
  if (savedHistory) {
    try {
      calculationHistory = JSON.parse(savedHistory);
    } catch (e) {
      calculationHistory = [];
    }
  }
  
  // Set up tool selection
  document.querySelectorAll('.tool-card').forEach(card => {
    card.addEventListener('click', function() {
      selectTool(this.dataset.tool);
    });
  });
  
  // Initialize with force calculator
  selectTool('force');
  
  // Set up input listeners
  document.querySelectorAll('.card-input').forEach(input => {
    input.addEventListener('input', () => {
      clearResults();
    });
  });
  
  // Load history
  renderHistory();
  
  // Focus first input
  document.getElementById('phys-mass').focus();
}

// Select tool
function selectTool(toolId) {
  currentTool = toolId;
  
  // Update active tool
  document.querySelectorAll('.tool-card').forEach(card => {
    card.classList.remove('active');
  });
  document.querySelector(`[data-tool="${toolId}"]`).classList.add('active');
  
  // Update UI
  const tool = tools[toolId];
  document.getElementById('current-tool-name').textContent = tool.name;
  document.getElementById('formula-display').textContent = tool.formula;
  document.getElementById('result-label').textContent = tool.resultLabel;
  document.getElementById('result-unit').textContent = tool.resultUnit;
  
  // Clear results
  clearResults();
  
  // Update inputs
  updateInputs();
}

// Update inputs based on current tool
function updateInputs() {
  const container = document.getElementById('dynamic-inputs');
  const tool = tools[currentTool];
  
  container.innerHTML = '';
  
  // Add static inputs (mass and acceleration are already in HTML for force)
  if (currentTool !== 'force') {
    // Clear static inputs
    document.getElementById('phys-mass').value = '';
    document.getElementById('phys-acceleration').value = '';
  }
  
  // Add dynamic inputs
  tool.inputs.forEach(input => {
    const div = document.createElement('div');
    div.className = 'input-group';
    div.innerHTML = `
      <label for="phys-${input.id}" class="input-label">${input.label}</label>
      <div class="input-with-unit">
        <input type="number" id="phys-${input.id}" class="card-input" 
               placeholder="${input.placeholder}" step="any">
        <span class="input-unit">${input.unit}</span>
      </div>
    `;
    container.appendChild(div);
    
    // Add input listener
    document.getElementById(`phys-${input.id}`).addEventListener('input', () => {
      clearResults();
    });
  });
  
  // Clear results
  clearResults();
}

// Clear results
function clearResults() {
  document.getElementById('result-value').textContent = '‚Äì';
  document.getElementById('result-steps').innerHTML = '';
  document.getElementById('phys-output').value = '';
  document.getElementById('phys-hint').textContent = '';
}

// Calculate
function calculate() {
  const tool = tools[currentTool];
  const showSteps = document.getElementById('phys-show-steps').checked;
  const showUnits = document.getElementById('phys-show-units').checked;
  
  // Get input values
  const values = {};
  let hasAllValues = true;
  
  // Get static inputs
  const mass = parseFloat(document.getElementById('phys-mass').value);
  const acceleration = parseFloat(document.getElementById('phys-acceleration').value);
  
  if (mass) values.mass = mass;
  if (acceleration) values.acceleration = acceleration;
  
  // Get dynamic inputs
  tool.inputs.forEach(input => {
    const inputEl = document.getElementById(`phys-${input.id}`);
    if (inputEl) {
      const value = parseFloat(inputEl.value);
      if (value || value === 0) {
        values[input.id] = value;
      } else {
        hasAllValues = false;
      }
    }
  });
  
  // Check if we have all required values
  const requiredCount = currentTool === 'force' ? 2 : tool.inputs.length;
  if (Object.keys(values).length < requiredCount) {
    showHint('Please fill all required fields', 'error');
    return;
  }
  
  // Perform calculation
  const result = tool.calculate(values);
  if (result === null) {
    showHint('Invalid calculation', 'error');
    return;
  }
  
  // Display result
  document.getElementById('result-value').textContent = result.toFixed(3);
  
  // Show steps
  const stepsContainer = document.getElementById('result-steps');
  if (showSteps) {
    stepsContainer.innerHTML = '';
    const steps = tool.steps(values, result);
    steps.forEach(step => {
      const stepEl = document.createElement('div');
      stepEl.className = 'step';
      stepEl.textContent = step;
      stepsContainer.appendChild(stepEl);
    });
  } else {
    stepsContainer.innerHTML = '';
  }
  
  // Generate output
  let output = `=== ${tool.name} ===\n\n`;
  output += `Formula: ${tool.formula}\n\n`;
  output += 'Input Values:\n';
  Object.entries(values).forEach(([key, value]) => {
    output += `${key} = ${value}\n`;
  });
  output += `\nResult: ${result.toFixed(3)} ${tool.resultUnit}\n\n`;
  
  if (showSteps) {
    output += 'Calculation Steps:\n';
    tool.steps(values, result).forEach(step => {
      output += `‚Ä¢ ${step}\n`;
    });
  }
  
  if (showUnits) {
    output += '\nUnit Information:\n';
    output += getUnitInfo(currentTool, result);
  }
  
  document.getElementById('phys-output').value = output;
  
  // Add to history
  addToHistory(tool.name, result.toFixed(3), tool.resultUnit);
  
  // Show success hint
  showHint('Calculation complete!', 'success');
  
  // Animation
  document.getElementById('result-value').classList.add('calculating');
  setTimeout(() => {
    document.getElementById('result-value').classList.remove('calculating');
  }, 500);
}

// Get unit information
function getUnitInfo(tool, result) {
  const info = {
    force: `1 N = 1 kg¬∑m/s¬≤ (Force needed to accelerate 1 kg at 1 m/s¬≤)\n${result} N ‚âà ${(result / 9.81).toFixed(3)} kg-weight`,
    work: `1 J = 1 N¬∑m (Work done by 1 N force over 1 m)\n${result} J ‚âà ${(result / 4184).toFixed(3)} dietary calories`,
    power: `1 W = 1 J/s (Rate of energy transfer)\n${result} W ‚âà ${(result / 745.7).toFixed(3)} horsepower`,
    kinetic: `1 J = 1 kg¬∑m¬≤/s¬≤ (Energy of motion)\n${result} J could lift ${(result / 9.81).toFixed(3)} kg by 1 m`,
    potential: `1 J = 1 kg¬∑m¬≤/s¬≤ (Energy of position)\n${result} J stored at height`,
    momentum: `1 kg¬∑m/s (Product of mass and velocity)\n${result} kg¬∑m/s momentum`
  };
  return info[tool] || '';
}

// Show hint
function showHint(message, type = 'info') {
  const hint = document.getElementById('phys-hint');
  hint.textContent = message;
  hint.style.color = type === 'error' ? '#ef4444' : 
                     type === 'success' ? '#10b981' : '#6b7280';
  
  if (type !== 'error') {
    setTimeout(() => {
      hint.textContent = '';
    }, 3000);
  }
}

// Copy result
function copyResult() {
  const output = document.getElementById('phys-output').value;
  if (!output.trim()) {
    showHint('No results to copy', 'error');
    return;
  }
  
  navigator.clipboard.writeText(output).then(() => {
    showHint('Results copied to clipboard!', 'success');
  }).catch(() => {
    showHint('Failed to copy', 'error');
  });
}

// Reset all
function resetAll() {
  if (confirm('Reset all inputs and results?')) {
    // Clear inputs
    document.querySelectorAll('.card-input').forEach(input => {
      input.value = '';
    });
    
    // Clear results
    clearResults();
    
    // Reset tool selection
    selectTool('force');
    
    showHint('All inputs cleared', 'info');
  }
}

// Clear history
function clearHistory() {
  if (calculationHistory.length === 0) {
    showHint('History is already empty', 'info');
    return;
  }
  
  if (confirm('Clear all calculation history?')) {
    calculationHistory = [];
    localStorage.setItem('physicsHistory', JSON.stringify(calculationHistory));
    renderHistory();
    showHint('History cleared', 'success');
  }
}

// Add to history
function addToHistory(toolName, result, unit) {
  const historyItem = {
    id: Date.now(),
    tool: toolName,
    result: `${result} ${unit}`,
    timestamp: new Date().toISOString()
  };
  
  calculationHistory.unshift(historyItem);
  
  // Keep only last 20 items
  if (calculationHistory.length > 20) {
    calculationHistory = calculationHistory.slice(0, 20);
  }
  
  // Save to localStorage
  localStorage.setItem('physicsHistory', JSON.stringify(calculationHistory));
  
  // Update display
  renderHistory();
}

// Render history
function renderHistory() {
  const container = document.getElementById('history-list');
  const countEl = document.getElementById('history-count');
  
  countEl.textContent = calculationHistory.length;
  
  if (calculationHistory.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">üìù</div>
        <div>No calculations yet</div>
        <div class="empty-subtitle">Your calculations will appear here</div>
      </div>
    `;
    return;
  }
  
  container.innerHTML = '';
  
  calculationHistory.forEach(item => {
    const date = new Date(item.timestamp);
    const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    
    const div = document.createElement('div');
    div.className = 'history-item';
    div.innerHTML = `
      <div class="history-content">
        <div class="history-tool">${item.tool}</div>
        <div class="history-result">${item.result} ‚Ä¢ ${timeStr}</div>
      </div>
      <div class="history-actions">
        <button onclick="recallCalculation(${item.id})" class="card-btn secondary small">
          üîÑ
        </button>
      </div>
    `;
    container.appendChild(div);
  });
}

// Recall calculation (placeholder)
function recallCalculation(id) {
  const item = calculationHistory.find(i => i.id === id);
  if (item) {
    showHint(`Recalling: ${item.tool} = ${item.result}`, 'info');
    // In a real app, this would populate the inputs
  }
}

// Quick calculations
function quickCalc(type) {
  switch (type) {
    case 'earthGravity':
      document.getElementById('phys-mass').value = '10';
      document.getElementById('phys-acceleration').value = '9.81';
      selectTool('force');
      break;
      
    case 'carKinetic':
      // Mass of a car in kg, speed in m/s (60 km/h = 16.67 m/s)
      selectTool('kinetic');
      setTimeout(() => {
        document.getElementById('phys-mass').value = '1500';
        document.getElementById('phys-velocity').value = '16.67';
      }, 100);
      break;
      
    case 'waterfallPE':
      // 10 kg water falling 50 m
      selectTool('potential');
      setTimeout(() => {
        document.getElementById('phys-mass').value = '10';
        document.getElementById('phys-height').value = '50';
      }, 100);
      break;
      
    case 'humanPower':
      // Human climbing stairs (700 J work in 5 seconds)
      selectTool('power');
      setTimeout(() => {
        document.getElementById('phys-work').value = '700';
        document.getElementById('phys-time').value = '5';
      }, 100);
      break;
  }
  
  showHint('Quick calculation loaded. Click Calculate to compute.', 'info');
}

// Initialize
document.addEventListener('DOMContentLoaded', init);
</script>
