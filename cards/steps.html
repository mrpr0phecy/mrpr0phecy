<!-- 
===========================================
FILE: cards/steps-calories.html
DESCRIPTION: Convert steps walked to calories burned with activity equivalents
===========================================
-->

<div class="card glass glass-md" id="sc-card">
    
    <!-- ===== 1. HEADER ===== -->
    <div class="card-header">
        <h3 class="card-title" id="sc-title">
            <span style="display:inline-flex;align-items:center;gap:8px;">
                <span style="font-size:20px;">üö∂</span>
                <span>Steps to Calories Converter</span>
            </span>
        </h3>
        <div class="card-actions">
            <button class="btn btn-ghost btn-sm" onclick="scReset()" title="Reset to defaults">
                üîÑ Reset
            </button>
        </div>
    </div>
    
    <!-- ===== 2. CONTENT ===== -->
    <div class="card-content">
        
        <!-- Input Section -->
        <div class="form-section" style="margin-bottom:var(--space-major);">
            <label for="sc-steps" class="form-label">
                <span>Steps Walked</span>
                <span class="form-hint">Enter total steps taken</span>
            </label>
            <input 
                id="sc-steps" 
                type="number" 
                min="0" 
                step="100" 
                value="5000" 
                class="input glass glass-dark"
                oninput="scUpdate()"
            />
            
            <!-- Steps visualization -->
            <div class="steps-visualization" style="margin-top:var(--space-micro);">
                <div style="display:flex;justify-content:space-between;font-size:var(--text-micro);color:var(--text-secondary);margin-bottom:4px;">
                    <span>0 steps</span>
                    <span id="sc-current-steps">5,000 steps</span>
                    <span id="sc-goal-steps">10,000 steps</span>
                </div>
                <div style="height:6px;background:var(--bg-glass);border-radius:3px;overflow:hidden;">
                    <div id="sc-steps-progress" style="height:100%;background:linear-gradient(90deg, var(--accent), hsl(var(--accent-hue), 100%, 70%));width:50%;transition:width 0.5s ease;"></div>
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:var(--space-micro);">
                    <span style="font-size:var(--text-micro);color:var(--text-tertiary);" id="sc-distance">3.8 km (2.4 miles)</span>
                    <button onclick="scSetGoal()" style="font-size:var(--text-micro);padding:2px 8px;" class="btn btn-ghost btn-sm">
                        üéØ Set Goal
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Weight Input -->
        <div class="row" style="display:grid;grid-template-columns:1fr auto;gap:var(--space-minor);margin-bottom:var(--space-major);">
            <div>
                <label for="sc-weight" class="form-label">
                    <span>Weight</span>
                    <span class="form-hint">Your body weight</span>
                </label>
                <input 
                    id="sc-weight" 
                    type="number" 
                    min="1" 
                    step="0.1" 
                    value="70" 
                    class="input glass glass-dark"
                    oninput="scUpdate()"
                />
            </div>
            <div>
                <label for="sc-weight-unit" class="form-label" style="opacity:0;">
                    <span>Unit</span>
                </label>
                <select id="sc-weight-unit" class="input glass glass-dark" style="min-width:80px;" onchange="scUpdate()">
                    <option value="kg">kg</option>
                    <option value="lbs">lbs</option>
                </select>
            </div>
        </div>
        
        <!-- Walking Pace -->
        <div class="form-section" style="margin-bottom:var(--space-major);">
            <label for="sc-pace" class="form-label">
                <span>Walking Pace</span>
                <span class="form-hint">How fast are you walking?</span>
            </label>
            <select id="sc-pace" class="input glass glass-dark" onchange="scUpdate()">
                <option value="0.035">Leisurely (2-3 km/h)</option>
                <option value="0.04" selected>Normal (3-5 km/h)</option>
                <option value="0.045">Brisk (5-6 km/h)</option>
                <option value="0.05">Power Walking (6-7 km/h)</option>
            </select>
            
            <!-- Pace visualization -->
            <div class="pace-visualization" style="margin-top:var(--space-micro);">
                <div style="display:flex;justify-content:space-between;font-size:var(--text-micro);color:var(--text-secondary);">
                    <span>Leisurely</span>
                    <span id="sc-pace-label" style="color:var(--accent);">Normal</span>
                    <span>Power</span>
                </div>
                <div style="height:4px;background:var(--bg-glass);border-radius:2px;margin-top:2px;position:relative;">
                    <div id="sc-pace-indicator" style="width:50%;height:100%;background:var(--accent);border-radius:2px;transition:all 0.3s ease;"></div>
                </div>
            </div>
        </div>
        
        <!-- Results Grid -->
        <div class="results-grid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-minor);margin-bottom:var(--space-major);">
            <div class="result-card accent">
                <div class="result-label">Total Calories</div>
                <div class="result-value" id="sc-calories">175</div>
                <div class="result-unit">kcal</div>
            </div>
            <div class="result-card">
                <div class="result-label">Calories/Hour</div>
                <div class="result-value" id="sc-hourly">320</div>
                <div class="result-unit">kcal/h</div>
            </div>
        </div>
        
        <!-- Progress Visualization -->
        <div class="visualization-section" style="margin-bottom:var(--space-major);">
            <div class="section-header">
                <span style="font-size:var(--text-tiny);font-weight:var(--weight-semibold);color:var(--accent);">
                    üìä Progress to Daily Goal
                </span>
                <span style="font-size:var(--text-micro);color:var(--text-secondary);" id="sc-goal-text">
                    175 / 500 kcal
                </span>
            </div>
            
            <div class="progress-container" style="margin-top:var(--space-micro);">
                <div class="progress-bar" style="height:12px;background:var(--bg-glass);border-radius:6px;overflow:hidden;position:relative;">
                    <div id="sc-calories-progress" style="height:100%;background:linear-gradient(90deg, var(--accent), hsl(var(--accent-hue), 100%, 70%));width:35%;transition:width 0.5s ease;"></div>
                    <div style="position:absolute;right:0;top:0;bottom:0;width:1px;background:rgba(255,255,255,0.2);"></div>
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:4px;">
                    <span style="font-size:var(--text-micro);color:var(--text-tertiary);">0 kcal</span>
                    <span style="font-size:var(--text-micro);color:var(--text-tertiary);" id="sc-goal-display">500 kcal goal</span>
                </div>
            </div>
            
            <!-- Equivalent Activities -->
            <div class="equivalents" style="margin-top:var(--space-major);">
                <div style="font-size:var(--text-tiny);font-weight:var(--weight-semibold);color:var(--accent);margin-bottom:var(--space-minor);">
                    ‚ö° Equivalent Activities
                </div>
                <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:var(--space-micro);">
                    <div class="activity-card">
                        <div style="font-size:12px;margin-bottom:2px;">üèÉ Running</div>
                        <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-running">18 min</div>
                    </div>
                    <div class="activity-card">
                        <div style="font-size:12px;margin-bottom:2px;">üö¥ Cycling</div>
                        <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-cycling">22 min</div>
                    </div>
                    <div class="activity-card">
                        <div style="font-size:12px;margin-bottom:2px;">üèä Swimming</div>
                        <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-swimming">15 min</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Stats Summary -->
        <div class="stats-summary glass glass-dark" style="border-radius:var(--radius-md);padding:var(--space-minor);margin-bottom:var(--space-major);">
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:var(--space-minor);text-align:center;">
                <div>
                    <div style="font-size:var(--text-micro);color:var(--text-tertiary);">Time</div>
                    <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-time">1.0 h</div>
                </div>
                <div>
                    <div style="font-size:var(--text-micro);color:var(--text-tertiary);">Distance</div>
                    <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-total-distance">3.8 km</div>
                </div>
                <div>
                    <div style="font-size:var(--text-micro);color:var(--text-tertiary);">Pace</div>
                    <div style="font-family:var(--font-mono);font-size:var(--text-tiny);color:var(--text);" id="sc-pace-value">5.0 km/h</div>
                </div>
            </div>
        </div>
        
    </div>
    
    <!-- ===== 3. FOOTER ===== -->
    <div class="card-footer">
        <div class="card-meta">
            <span style="display:inline-flex;align-items:center;gap:4px;font-size:var(--text-micro);color:var(--text-tertiary);">
                ‚ö° Real-time calculation
            </span>
        </div>
        <div style="display:flex;gap:var(--space-micro);">
            <button onclick="scShare()" class="btn btn-ghost btn-sm">
                üì§ Share
            </button>
            <button onclick="scEmbed()" class="btn btn-ghost btn-sm">
                üîó Embed
            </button>
        </div>
    </div>
    
</div>

<!-- ===== 4. JAVASCRIPT ===== -->
<script>
// STEPS CALORIES FUNCTIONS (prefixed with sc-)
const scState = {
    steps: 5000,
    weight: 70,
    weightUnit: 'kg',
    pace: 0.04,
    dailyGoal: 500,
    goalSteps: 10000,
    
    // Constants
    stepLength: 0.76, // meters per step
    walkingSpeed: 5, // km/h for normal pace
    runningCalories: 10, // kcal per minute
    cyclingCalories: 8, // kcal per minute
    swimmingCalories: 12, // kcal per minute
    
    // Pace configurations
    paces: {
        0.035: { name: 'Leisurely', speed: 3 },
        0.04: { name: 'Normal', speed: 5 },
        0.045: { name: 'Brisk', speed: 5.5 },
        0.05: { name: 'Power', speed: 6.5 }
    }
};

// Initialize from localStorage
function scLoadSettings() {
    const savedGoal = localStorage.getItem('scDailyGoal');
    const savedStepsGoal = localStorage.getItem('scGoalSteps');
    
    if (savedGoal) scState.dailyGoal = parseInt(savedGoal);
    if (savedStepsGoal) scState.goalSteps = parseInt(savedStepsGoal);
}

// Calculate all metrics
function scUpdate() {
    // Get current values
    scState.steps = parseInt(document.getElementById('sc-steps').value) || 0;
    scState.weight = parseFloat(document.getElementById('sc-weight').value) || 0;
    scState.weightUnit = document.getElementById('sc-weight-unit').value;
    scState.pace = parseFloat(document.getElementById('sc-pace').value) || 0.04;
    
    // Convert weight to kg if needed
    let weightKg = scState.weight;
    if (scState.weightUnit === 'lbs') {
        weightKg = scState.weight / 2.20462;
    }
    
    // Calculate basic metrics
    const distanceKm = (scState.steps * scState.stepLength / 1000).toFixed(1);
    const distanceMiles = (distanceKm * 0.621371).toFixed(1);
    
    const paceInfo = scState.paces[scState.pace] || scState.paces[0.04];
    const timeHours = distanceKm / paceInfo.speed;
    const timeMinutes = timeHours * 60;
    
    // Calculate calories
    const calories = scState.steps * weightKg * scState.pace;
    const caloriesPerHour = timeHours > 0 ? calories / timeHours : 0;
    
    // Calculate equivalent activities
    const runningMinutes = (calories / scState.runningCalories).toFixed(0);
    const cyclingMinutes = (calories / scState.cyclingCalories).toFixed(0);
    const swimmingMinutes = (calories / scState.swimmingCalories).toFixed(0);
    
    // Calculate progress
    const stepsProgress = Math.min((scState.steps / scState.goalSteps) * 100, 100);
    const caloriesProgress = Math.min((calories / scState.dailyGoal) * 100, 100);
    
    // Update UI
    document.getElementById('sc-current-steps').textContent = scState.steps.toLocaleString() + ' steps';
    document.getElementById('sc-goal-steps').textContent = scState.goalSteps.toLocaleString() + ' steps';
    document.getElementById('sc-distance').textContent = `${distanceKm} km (${distanceMiles} miles)`;
    
    // Update pace indicator
    document.getElementById('sc-pace-label').textContent = paceInfo.name;
    const pacePercent = ((scState.pace - 0.035) / (0.05 - 0.035)) * 100;
    document.getElementById('sc-pace-indicator').style.width = `${Math.min(Math.max(pacePercent, 0), 100)}%`;
    
    // Update results
    document.getElementById('sc-calories').textContent = Math.round(calories);
    document.getElementById('sc-hourly').textContent = Math.round(caloriesPerHour);
    
    // Update progress bars
    document.getElementById('sc-steps-progress').style.width = `${stepsProgress}%`;
    document.getElementById('sc-calories-progress').style.width = `${caloriesProgress}%`;
    
    // Update goal text
    document.getElementById('sc-goal-text').textContent = 
        `${Math.round(calories)} / ${scState.dailyGoal} kcal`;
    document.getElementById('sc-goal-display').textContent = 
        `${scState.dailyGoal} kcal goal`;
    
    // Update equivalent activities
    document.getElementById('sc-running').textContent = `${runningMinutes} min`;
    document.getElementById('sc-cycling').textContent = `${cyclingMinutes} min`;
    document.getElementById('sc-swimming').textContent = `${swimmingMinutes} min`;
    
    // Update stats summary
    document.getElementById('sc-time').textContent = timeHours.toFixed(1) + ' h';
    document.getElementById('sc-total-distance').textContent = distanceKm + ' km';
    document.getElementById('sc-pace-value').textContent = paceInfo.speed + ' km/h';
}

// Reset to defaults
function scReset() {
    document.getElementById('sc-steps').value = 5000;
    document.getElementById('sc-weight').value = 70;
    document.getElementById('sc-weight-unit').value = 'kg';
    document.getElementById('sc-pace').value = 0.04;
    scUpdate();
    showNotification('Reset to defaults', 'success');
}

// Set daily goal
function scSetGoal() {
    const currentGoal = scState.dailyGoal;
    const newGoal = prompt(`Set daily calorie goal (current: ${currentGoal} kcal):`, currentGoal);
    
    if (newGoal !== null && !isNaN(newGoal) && newGoal > 0) {
        scState.dailyGoal = parseInt(newGoal);
        localStorage.setItem('scDailyGoal', scState.dailyGoal);
        scUpdate();
        showNotification(`Daily goal set to ${scState.dailyGoal} kcal`, 'success');
    }
    
    const stepsGoal = prompt(`Set daily steps goal (current: ${scState.goalSteps} steps):`, scState.goalSteps);
    if (stepsGoal !== null && !isNaN(stepsGoal) && stepsGoal > 0) {
        scState.goalSteps = parseInt(stepsGoal);
        localStorage.setItem('scGoalSteps', scState.goalSteps);
        scUpdate();
        showNotification(`Steps goal set to ${scState.goalSteps} steps`, 'success');
    }
}

// Share tool
function scShare() {
    const shareText = `üö∂ Steps to Calories:\n` +
                     `${scState.steps.toLocaleString()} steps = ${Math.round(scState.steps * (scState.weightUnit === 'kg' ? scState.weight : scState.weight / 2.20462) * scState.pace)} kcal\n` +
                     `Distance: ${(scState.steps * scState.stepLength / 1000).toFixed(1)} km\n\n` +
                     `From The Most Useful Site`;
    
    if (navigator.share) {
        navigator.share({
            title: 'Steps to Calories Converter',
            text: shareText,
            url: window.location.href
        });
    } else {
        navigator.clipboard.writeText(shareText);
        showNotification('Results copied to clipboard!', 'success');
    }
}

// Embed tool
function scEmbed() {
    const embedCode = `<iframe src="${window.location.origin}/cards/steps-calories.html" width="100%" height="550" style="border:none;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.3);" title="Steps to Calories Converter - The Most Useful Site"></iframe>`;
    
    navigator.clipboard.writeText(embedCode);
    showNotification('Embed code copied to clipboard!', 'success');
    
    // Track in analytics
    if (window.plausible) {
        window.plausible('Embed Generated', { props: { tool: 'steps-calories' } });
    }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    console.log('üö∂ Steps to Calories Converter loaded');
    
    // Load saved settings
    scLoadSettings();
    
    // Initial calculation
    scUpdate();
    
    // Auto-update on input with debounce
    let updateTimer;
    ['sc-steps', 'sc-weight', 'sc-pace'].forEach(id => {
        document.getElementById(id).addEventListener('input', () => {
            clearTimeout(updateTimer);
            updateTimer = setTimeout(scUpdate, 200);
        });
    });
    
    // Update on unit change
    document.getElementById('sc-weight-unit').addEventListener('change', scUpdate);
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            scReset();
        }
        if (e.key === 'g' && (e.ctrlKey || e.metaKey)) {
            e.preventDefault();
            scSetGoal();
        }
    });
});

// Make functions available globally
window.scUpdate = scUpdate;
window.scReset = scReset;
window.scSetGoal = scSetGoal;
window.scShare = scShare;
window.scEmbed = scEmbed;
</script>

<!-- ===== 5. CARD-SCOPED STYLES ===== -->
<style>
/* Card-specific styles */
#sc-card {
    --card-width: min(100%, 400px);
    --card-height: auto;
    min-height: 550px;
}

/* Form components */
.form-section {
    margin-bottom: var(--space-major);
}

.form-label {
    display: flex;
    flex-direction: column;
    gap: 2px;
    margin-bottom: var(--space-micro);
}

.form-label span:first-child {
    font-size: var(--text-tiny);
    font-weight: var(--weight-semibold);
    color: var(--text);
}

.form-hint {
    font-size: var(--text-micro);
    color: var(--text-tertiary);
}

/* Result card styling */
.result-card {
    background: linear-gradient(145deg, 
        rgba(255, 255, 255, 0.03), 
        rgba(255, 255, 255, 0.05));
    border: 1px solid var(--border-light);
    border-radius: var(--radius-md);
    padding: var(--space-minor);
    text-align: center;
    transition: var(--transition-base);
}

.result-card.accent {
    border-color: var(--accent);
    background: linear-gradient(145deg, 
        rgba(45, 212, 255, 0.1), 
        rgba(45, 212, 255, 0.05));
}

.result-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-sm);
}

.result-label {
    font-size: var(--text-micro);
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 4px;
}

.result-value {
    font-family: var(--font-mono);
    font-size: var(--text-xl);
    font-weight: var(--weight-bold);
    color: var(--accent);
    line-height: 1;
}

.result-card.accent .result-value {
    color: var(--text);
}

.result-unit {
    font-size: var(--text-micro);
    color: var(--text-secondary);
    margin-top: 2px;
}

/* Activity cards */
.activity-card {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-sm);
    padding: var(--space-micro);
    text-align: center;
    transition: var(--transition-base);
}

.activity-card:hover {
    border-color: var(--accent);
    transform: translateY(-2px);
}

/* Section header */
.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-minor);
}

/* Progress bar animations */
.progress-bar {
    position: relative;
}

.progress-bar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255, 255, 255, 0.1) 50%, 
        transparent 100%);
    background-size: 200% 100%;
    animation: shimmer 2s infinite linear;
    opacity: 0.5;
}

@keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

/* Responsive adjustments */
@media (max-width: 480px) {
    #sc-card {
        padding: var(--space-minor);
    }
    
    .results-grid {
        grid-template-columns: 1fr !important;
    }
    
    .equivalents > div {
        grid-template-columns: repeat(2, 1fr) !important;
    }
}

@media (max-width: 360px) {
    .equivalents > div {
        grid-template-columns: 1fr !important;
    }
    
    .stats-summary > div {
        grid-template-columns: 1fr !important;
        gap: var(--space-micro) !important;
    }
}

/* Print styles */
@media print {
    #sc-card {
        box-shadow: none !important;
        border: 1px solid #ccc !important;
        background: white !important;
        color: black !important;
    }
    
    .card-actions, button, .card-footer {
        display: none !important;
    }
    
    .progress-bar::after {
        display: none !important;
    }
}
</style>

<!-- ===== 6. METADATA FOR CARD LOADER ===== -->
<div style="display:none;" data-card-metadata>
    <!-- Metadata for card loader -->
    <div data-title="Steps to Calories Converter"></div>
    <div data-description="Convert steps walked to calories burned. Calculate energy expenditure based on steps, weight, and walking pace. See equivalent activities and track progress toward daily goals."></div>
    <div data-tags="health, fitness, exercise, walking, calories, converter, calculator, steps"></div>
    <div data-category="Health & Fitness"></div>
    <div data-icon="üö∂"></div>
    <div data-version="1.0.0"></div>
</div>
