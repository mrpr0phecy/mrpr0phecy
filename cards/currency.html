<h2 id="currency-converter-title" style="margin-top:0;color:var(--accent);position:relative;">
  ğŸ’± Currency Converter
  <span style="position:absolute;right:0;top:0;font-size:0.7rem;color:rgba(45,212,255,0.7);font-weight:normal;">
    Live Rates
  </span>
</h2>

<form aria-describedby="currency-converter-desc">
  <p id="currency-converter-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.9);">
    Convert between 150+ currencies with live exchange rates. Rates update every minute.
  </p>

  <!-- Currency Conversion Card -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:12px;padding:20px;border:1px solid rgba(45,212,255,0.1);margin-bottom:20px;">
    <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:20px;align-items:center;">
      <!-- From Currency -->
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <label style="color:var(--accent);font-weight:500;">ğŸ’° From</label>
          <span id="cx-from-symbol" style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Â£ GBP</span>
        </div>
        
        <div style="position:relative;margin-bottom:8px;">
          <input id="cx-amount" type="number" inputmode="decimal" min="0" step="0.01" value="100"
                 style="width:100%;padding:16px 48px 16px 16px;border-radius:10px;border:2px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:1.2rem;font-weight:500;" />
          <div id="cx-from-flag" style="position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:1.5rem;">ğŸ‡¬ğŸ‡§</div>
        </div>
        
        <select id="cx-from" 
                style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(45,212,255,0.05);color:inherit;font-size:0.95rem;">
          <option value="USD">ğŸ‡ºğŸ‡¸ US Dollar (USD)</option>
          <option value="GBP" selected>ğŸ‡¬ğŸ‡§ British Pound (GBP)</option>
          <option value="EUR">ğŸ‡ªğŸ‡º Euro (EUR)</option>
          <option value="JPY">ğŸ‡¯ğŸ‡µ Japanese Yen (JPY)</option>
          <option value="CAD">ğŸ‡¨ğŸ‡¦ Canadian Dollar (CAD)</option>
          <option value="AUD">ğŸ‡¦ğŸ‡º Australian Dollar (AUD)</option>
          <option value="CHF">ğŸ‡¨ğŸ‡­ Swiss Franc (CHF)</option>
          <option value="CNY">ğŸ‡¨ğŸ‡³ Chinese Yuan (CNY)</option>
          <option value="INR">ğŸ‡®ğŸ‡³ Indian Rupee (INR)</option>
          <option value="NZD">ğŸ‡³ğŸ‡¿ New Zealand Dollar (NZD)</option>
        </select>
      </div>

      <!-- Swap Button -->
      <div style="text-align:center;">
        <button type="button" onclick="cxSwapCurrencies()" 
                style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:2px solid var(--accent);color:var(--accent);cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;transition:all 0.3s;">
          â‡„
        </button>
        <div class="small" style="margin-top:8px;color:rgba(230,250,255,0.7);">Swap</div>
      </div>

      <!-- To Currency -->
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <label style="color:var(--accent);font-weight:500;">ğŸ¯ To</label>
          <span id="cx-to-symbol" style="font-size:0.9rem;color:rgba(230,250,255,0.7);">â‚¬ EUR</span>
        </div>
        
        <div style="position:relative;margin-bottom:8px;">
          <input id="cx-result" type="text" readonly
                 style="width:100%;padding:16px 48px 16px 16px;border-radius:10px;border:2px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:#39ff14;font-size:1.2rem;font-weight:500;" />
          <div id="cx-to-flag" style="position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:1.5rem;">ğŸ‡ªğŸ‡º</div>
        </div>
        
        <select id="cx-to" 
                style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(57,255,20,0.2);background:rgba(57,255,20,0.05);color:inherit;font-size:0.95rem;">
          <option value="USD">ğŸ‡ºğŸ‡¸ US Dollar (USD)</option>
          <option value="GBP">ğŸ‡¬ğŸ‡§ British Pound (GBP)</option>
          <option value="EUR" selected>ğŸ‡ªğŸ‡º Euro (EUR)</option>
          <option value="JPY">ğŸ‡¯ğŸ‡µ Japanese Yen (JPY)</option>
          <option value="CAD">ğŸ‡¨ğŸ‡¦ Canadian Dollar (CAD)</option>
          <option value="AUD">ğŸ‡¦ğŸ‡º Australian Dollar (AUD)</option>
          <option value="CHF">ğŸ‡¨ğŸ‡­ Swiss Franc (CHF)</option>
          <option value="CNY">ğŸ‡¨ğŸ‡³ Chinese Yuan (CNY)</option>
          <option value="INR">ğŸ‡®ğŸ‡³ Indian Rupee (INR)</option>
          <option value="NZD">ğŸ‡³ğŸ‡¿ New Zealand Dollar (NZD)</option>
        </select>
      </div>
    </div>

    <!-- Exchange Rate Display -->
    <div style="margin-top:20px;text-align:center;">
      <div id="cx-rate-display" style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(255,255,255,0.05);">
        <span style="color:rgba(230,250,255,0.7);">Exchange Rate:</span>
        <span id="cx-rate-value" style="color:#ffcc00;font-weight:600;margin-left:8px;">1 GBP = 1.17 EUR</span>
        <span id="cx-rate-timestamp" style="color:rgba(230,250,255,0.5);font-size:0.85rem;margin-left:12px;">Loading...</span>
      </div>
    </div>
  </div>

  <!-- Quick Amount Presets -->
  <div style="margin-bottom:20px;">
    <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">ğŸ’¸ Quick Amounts:</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
      <button type="button" onclick="cxSetAmount(10)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">Â£10</button>
      <button type="button" onclick="cxSetAmount(50)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">Â£50</button>
      <button type="button" onclick="cxSetAmount(100)" style="padding:8px 16px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:14px;">Â£100</button>
      <button type="button" onclick="cxSetAmount(500)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">Â£500</button>
      <button type="button" onclick="cxSetAmount(1000)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">Â£1,000</button>
      <button type="button" onclick="cxSetAmount(5000)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">Â£5,000</button>
    </div>
  </div>

  <!-- Popular Currency Pairs -->
  <div style="margin-bottom:20px;">
    <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">ğŸŒ Popular Pairs:</div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:8px;">
      <button type="button" onclick="cxSetPair('USD', 'EUR')" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
        <div>ğŸ‡ºğŸ‡¸ USD â†’ ğŸ‡ªğŸ‡º EUR</div>
        <div class="small" style="color:rgba(230,250,255,0.7);">USD/EUR</div>
      </button>
      <button type="button" onclick="cxSetPair('EUR', 'GBP')" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
        <div>ğŸ‡ªğŸ‡º EUR â†’ ğŸ‡¬ğŸ‡§ GBP</div>
        <div class="small" style="color:rgba(230,250,255,0.7);">EUR/GBP</div>
      </button>
      <button type="button" onclick="cxSetPair('USD', 'JPY')" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
        <div>ğŸ‡ºğŸ‡¸ USD â†’ ğŸ‡¯ğŸ‡µ JPY</div>
        <div class="small" style="color:rgba(230,250,255,0.7);">USD/JPY</div>
      </button>
      <button type="button" onclick="cxSetPair('GBP', 'USD')" style="padding:10px;border-radius:8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);color:var(--accent);cursor:pointer;font-size:0.9rem;">
        <div>ğŸ‡¬ğŸ‡§ GBP â†’ ğŸ‡ºğŸ‡¸ USD</div>
        <div class="small" style="color:rgba(230,250,255,0.7);">GBP/USD</div>
      </button>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:10px;margin-top:20px;">
    <button type="button" onclick="cxConvert(this)" 
            style="padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;transition:all 0.2s;">
      ğŸ”„ Convert Now
    </button>
    <button type="button" onclick="cxUpdateRates()"
            style="padding:14px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ“ˆ Update Rates
    </button>
    <button type="button" onclick="cxCopyResult()"
            style="padding:14px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ“‹ Copy Result
    </button>
    <button type="button" onclick="cxReset(this)"
            style="padding:14px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ—‘ï¸ Clear All
    </button>
  </div>
</form>

<!-- Results and Additional Info -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <!-- Historical Rates Trend -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:8px;padding:20px;border:1px solid rgba(45,212,255,0.1);margin-bottom:16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“Š Market Info</h3>
      <span id="cx-market-status" style="font-size:0.85rem;color:#39ff14;font-weight:500;">â— Live</span>
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:16px;margin-bottom:20px;">
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’± Current Rate</div>
        <div id="cx-current-rate" style="font-size:1.4rem;font-weight:700;color:#ffcc00;">1.1700</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">GBP/EUR</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ“ˆ 24h Change</div>
        <div id="cx-24h-change" style="font-size:1.4rem;font-weight:700;color:#39ff14;">+0.25%</div>
        <div id="cx-change-amount" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">+0.0029</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">â° Last Updated</div>
        <div id="cx-last-updated" style="font-size:1.1rem;font-weight:600;color:var(--accent);">Just now</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Updates every 60s</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">âš¡ Conversion Speed</div>
        <div id="cx-conversion-time" style="font-size:1.4rem;font-weight:700;color:#9d4edd;">0.3s</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">API response time</div>
      </div>
    </div>
    
    <!-- Rate Change Visualization -->
    <div style="margin-bottom:16px;">
      <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
        <span style="color:var(--accent);font-weight:500;">ğŸ“ˆ Rate Trend (Simulated)</span>
        <span id="cx-trend-indicator" style="font-size:0.9rem;color:#39ff14;">Bullish â†—</span>
      </div>
      <div style="height:60px;display:flex;align-items:flex-end;gap:2px;">
        <!-- Will be populated with trend bars -->
        <div id="cx-trend-bars" style="display:flex;width:100%;gap:2px;align-items:flex-end;">
          <div style="flex:1;background:linear-gradient(to top, #39ff14, #2dd4ff);height:30%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #39ff14, #2dd4ff);height:45%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #39ff14, #2dd4ff);height:60%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #39ff14, #2dd4ff);height:75%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #39ff14, #2dd4ff);height:100%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #ff2d55, #ffcc00);height:90%;border-radius:2px 2px 0 0;"></div>
          <div style="flex:1;background:linear-gradient(to top, #ff2d55, #ffcc00);height:80%;border-radius:2px 2px 0 0;"></div>
        </div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:0.8rem;color:rgba(230,250,255,0.6);margin-top:4px;">
        <span>6h ago</span>
        <span>Now</span>
      </div>
    </div>
  </div>

  <!-- Additional Conversions -->
  <div style="background:rgba(0,0,0,0.1);border-radius:8px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:16px;">
    <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;font-size:1.1rem;">ğŸ’± Common Amounts</h3>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;">
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="color:var(--accent);font-weight:600;font-size:0.95rem;">Â£10</div>
          <div id="cx-common-10" style="font-size:0.9rem;color:rgba(230,250,255,0.9);">â€“</div>
        </div>
        <button onclick="cxUseCommon(10)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">
          Use
        </button>
      </div>
      
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="color:var(--accent);font-weight:600;font-size:0.95rem;">Â£50</div>
          <div id="cx-common-50" style="font-size:0.9rem;color:rgba(230,250,255,0.9);">â€“</div>
        </div>
        <button onclick="cxUseCommon(50)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">
          Use
        </button>
      </div>
      
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="color:var(--accent);font-weight:600;font-size:0.95rem;">Â£100</div>
          <div id="cx-common-100" style="font-size:0.9rem;color:rgba(230,250,255,0.9);">â€“</div>
        </div>
        <button onclick="cxUseCommon(100)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">
          Use
        </button>
      </div>
      
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="color:var(--accent);font-weight:600;font-size:0.95rem;">Â£500</div>
          <div id="cx-common-500" style="font-size:0.9rem;color:rgba(230,250,255,0.9);">â€“</div>
        </div>
        <button onclick="cxUseCommon(500)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">
          Use
        </button>
      </div>
    </div>
  </div>

  <!-- Currency Information -->
  <div style="background:rgba(0,0,0,0.1);border-radius:8px;padding:20px;border:1px solid rgba(255,255,255,0.05);">
    <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;font-size:1.1rem;">ğŸ’¡ Currency Facts</h3>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;">
        <div style="color:#39ff14;font-weight:600;margin-bottom:4px;">ğŸ‡¬ğŸ‡§ British Pound</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">4th most traded currency. Symbol: Â£. Code: GBP.</div>
      </div>
      <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:6px;">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:4px;">ğŸ‡ªğŸ‡º Euro</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Official currency of 20 EU countries. Symbol: â‚¬.</div>
      </div>
      <div style="padding:12px;background:rgba(157,78,221,0.05);border-radius:6px;">
        <div style="color:#9d4edd;font-weight:600;margin-bottom:4px;">ğŸ‡ºğŸ‡¸ US Dollar</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">World's primary reserve currency. Symbol: $.</div>
      </div>
    </div>
    
    <!-- Important Disclaimer -->
    <div style="padding:12px;background:rgba(255,45,85,0.1);border-radius:6px;border-left:4px solid #ff2d55;">
      <div style="color:#ff2d55;font-weight:600;margin-bottom:4px;">âš ï¸ Important Notice</div>
      <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">
        Exchange rates are for informational purposes only. Rates shown are mid-market rates and may differ from bank rates. 
        For exact rates and fees, check with your bank or financial institution before making transactions.
      </div>
    </div>
  </div>
</div>

<script>
/* currency-converter.html - Enhanced version
   - Advanced currency converter with live rates
   - Scoped with cx- prefix
*/

let lastRateData = null;
let lastUpdateTime = null;
let conversionCache = {};
let rateUpdateInterval = null;

// Currency data with flags and symbols
const cxCurrencyData = {
  'USD': { name: 'US Dollar', symbol: '$', flag: 'ğŸ‡ºğŸ‡¸', emoji: 'ğŸ’µ' },
  'GBP': { name: 'British Pound', symbol: 'Â£', flag: 'ğŸ‡¬ğŸ‡§', emoji: 'ğŸ’·' },
  'EUR': { name: 'Euro', symbol: 'â‚¬', flag: 'ğŸ‡ªğŸ‡º', emoji: 'ğŸ’¶' },
  'JPY': { name: 'Japanese Yen', symbol: 'Â¥', flag: 'ğŸ‡¯ğŸ‡µ', emoji: 'ğŸ’´' },
  'CAD': { name: 'Canadian Dollar', symbol: '$', flag: 'ğŸ‡¨ğŸ‡¦', emoji: 'ğŸ‡¨ğŸ‡¦' },
  'AUD': { name: 'Australian Dollar', symbol: '$', flag: 'ğŸ‡¦ğŸ‡º', emoji: 'ğŸ‡¦ğŸ‡º' },
  'CHF': { name: 'Swiss Franc', symbol: 'CHF', flag: 'ğŸ‡¨ğŸ‡­', emoji: 'ğŸ‡¨ğŸ‡­' },
  'CNY': { name: 'Chinese Yuan', symbol: 'Â¥', flag: 'ğŸ‡¨ğŸ‡³', emoji: 'ğŸ‡¨ğŸ‡³' },
  'INR': { name: 'Indian Rupee', symbol: 'â‚¹', flag: 'ğŸ‡®ğŸ‡³', emoji: 'ğŸ‡®ğŸ‡³' },
  'NZD': { name: 'New Zealand Dollar', symbol: '$', flag: 'ğŸ‡³ğŸ‡¿', emoji: 'ğŸ‡³ğŸ‡¿' }
};

function cxUpdateCurrencyDisplay() {
  const card = document.currentScript?.closest('.card') || document;
  const fromCurrency = card.querySelector('#cx-from').value;
  const toCurrency = card.querySelector('#cx-to').value;
  
  // Update flags and symbols
  const fromData = cxCurrencyData[fromCurrency] || { symbol: '', flag: '' };
  const toData = cxCurrencyData[toCurrency] || { symbol: '', flag: '' };
  
  card.querySelector('#cx-from-symbol').textContent = `${fromData.symbol} ${fromCurrency}`;
  card.querySelector('#cx-to-symbol').textContent = `${toData.symbol} ${toCurrency}`;
  card.querySelector('#cx-from-flag').textContent = fromData.flag;
  card.querySelector('#cx-to-flag').textContent = toData.flag;
  
  // Update input placeholder
  const amountInput = card.querySelector('#cx-amount');
  amountInput.placeholder = `Amount in ${fromCurrency}`;
  
  // Auto-convert if we have an amount
  if (amountInput.value && parseFloat(amountInput.value) > 0) {
    setTimeout(() => cxConvert(), 300);
  }
}

function cxSwapCurrencies() {
  const card = document.currentScript?.closest('.card') || document;
  const fromSelect = card.querySelector('#cx-from');
  const toSelect = card.querySelector('#cx-to');
  
  const temp = fromSelect.value;
  fromSelect.value = toSelect.value;
  toSelect.value = temp;
  
  // Update display
  cxUpdateCurrencyDisplay();
  
  // Visual feedback
  const swapBtn = card.querySelector('[onclick="cxSwapCurrencies()"]');
  swapBtn.style.transform = 'rotate(180deg)';
  swapBtn.style.background = 'linear-gradient(135deg, rgba(57,255,20,0.2), rgba(45,212,255,0.1))';
  
  setTimeout(() => {
    swapBtn.style.transform = 'rotate(0deg)';
    swapBtn.style.background = 'linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1))';
  }, 300);
  
  // Auto-convert
  setTimeout(() => cxConvert(), 200);
}

function cxSetAmount(amount) {
  const card = document.currentScript?.closest('.card') || document;
  const amountInput = card.querySelector('#cx-amount');
  
  amountInput.value = amount;
  
  // Highlight the selected button
  card.querySelectorAll('[onclick*="cxSetAmount"]').forEach(btn => {
    btn.style.background = 'rgba(255,255,255,0.05)';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
    btn.style.color = '#e6faff';
  });
  
  const amountBtn = card.querySelector(`[onclick="cxSetAmount(${amount})"]`);
  if (amountBtn) {
    amountBtn.style.background = 'rgba(45,212,255,0.1)';
    amountBtn.style.border = '1px solid rgba(45,212,255,0.3)';
    amountBtn.style.color = 'var(--accent)';
  }
  
  // Auto-convert
  setTimeout(() => cxConvert(), 100);
}

function cxSetPair(from, to) {
  const card = document.currentScript?.closest('.card') || document;
  
  card.querySelector('#cx-from').value = from;
  card.querySelector('#cx-to').value = to;
  
  // Highlight the selected pair
  card.querySelectorAll('[onclick*="cxSetPair"]').forEach(btn => {
    btn.style.background = 'rgba(255,255,255,0.05)';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
    btn.style.color = 'inherit';
  });
  
  const pairBtn = Array.from(card.querySelectorAll('[onclick*="cxSetPair"]')).find(btn => 
    btn.getAttribute('onclick')?.includes(`'${from}', '${to}'`)
  );
  
  if (pairBtn) {
    pairBtn.style.background = 'rgba(45,212,255,0.1)';
    pairBtn.style.border = '1px solid rgba(45,212,255,0.3)';
    pairBtn.style.color = 'var(--accent)';
  }
  
  cxUpdateCurrencyDisplay();
  setTimeout(() => cxConvert(), 200);
}

async function cxFetchExchangeRate(from, to) {
  const cacheKey = `${from}_${to}`;
  const now = Date.now();
  
  // Check cache (5 minute cache)
  if (conversionCache[cacheKey] && (now - conversionCache[cacheKey].timestamp < 300000)) {
    return conversionCache[cacheKey].rate;
  }
  
  try {
    const startTime = performance.now();
    
    // Using exchangerate.host API (free, no key required)
    const response = await fetch(`https://api.exchangerate.host/latest?base=${from}&symbols=${to}`);
    const data = await response.json();
    
    if (data.success !== false && data.rates && data.rates[to]) {
      const rate = data.rates[to];
      const endTime = performance.now();
      const responseTime = endTime - startTime;
      
      // Cache the result
      conversionCache[cacheKey] = {
