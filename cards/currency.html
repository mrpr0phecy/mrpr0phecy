<h2 id="currency-converter-title" style="margin-top:0;color:var(--accent);position:relative;">
  ğŸ’± Currency Converter
  <span style="position:absolute;right:0;top:0;font-size:0.7rem;color:var(--accent);font-weight:normal;">
    Live Rates
  </span>
</h2>

<form aria-describedby="currency-converter-desc">
  <p id="currency-converter-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.9);">
    Convert between 150+ currencies with live exchange rates. Using <strong style="color:var(--accent);">ExchangeRate-API</strong> with fallback to local data[citation:5][citation:8].
  </p>

  <!-- Currency Conversion Card -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.07), rgba(20,20,20,0.9));border-radius:12px;padding:20px;border:2px solid rgba(45,212,255,0.2);margin-bottom:20px;box-shadow:0 8px 32px rgba(0,0,0,0.4);">
    <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:20px;align-items:center;">
      <!-- From Currency -->
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <label style="color:var(--accent);font-weight:500;">ğŸ’° From</label>
          <span id="cx-from-symbol" style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Â£ GBP</span>
        </div>
        
        <div style="position:relative;margin-bottom:8px;">
          <input id="cx-amount" type="number" inputmode="decimal" min="0" step="0.01" value="100"
                 style="width:100%;padding:16px 48px 16px 16px;border-radius:10px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:1.2rem;font-weight:500;" />
          <div id="cx-from-flag" style="position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:1.5rem;">ğŸ‡¬ğŸ‡§</div>
        </div>
        
        <select id="cx-from" 
                style="width:100%;padding:12px;border-radius:8px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:0.95rem;">
          <!-- Options populated by JavaScript -->
        </select>
      </div>

      <!-- Swap Button -->
      <div style="text-align:center;">
        <button type="button" onclick="cxSwapCurrencies()" 
                style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8));border:2px solid var(--accent);color:var(--accent);cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;transition:all 0.3s;">
          â‡„
        </button>
        <div class="small" style="margin-top:8px;color:rgba(230,250,255,0.7);">Swap</div>
      </div>

      <!-- To Currency -->
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <label style="color:var(--accent);font-weight:500;">ğŸ¯ To</label>
          <span id="cx-to-symbol" style="font-size:0.9rem;color:rgba(230,250,255,0.7);">â‚¬ EUR</span>
        </div>
        
        <div style="position:relative;margin-bottom:8px;">
          <input id="cx-result" type="text" readonly
                 style="width:100%;padding:16px 48px 16px 16px;border-radius:10px;border:2px solid rgba(57,255,20,0.3);background:rgba(20,20,20,0.8);color:#39ff14;font-size:1.2rem;font-weight:500;" />
          <div id="cx-to-flag" style="position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:1.5rem;">ğŸ‡ªğŸ‡º</div>
        </div>
        
        <select id="cx-to" 
                style="width:100%;padding:12px;border-radius:8px;border:2px solid rgba(57,255,20,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:0.95rem;">
          <!-- Options populated by JavaScript -->
        </select>
      </div>
    </div>

    <!-- Exchange Rate Display -->
    <div style="margin-top:20px;text-align:center;">
      <div id="cx-rate-display" style="padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
        <span style="color:rgba(230,250,255,0.7);">Exchange Rate:</span>
        <span id="cx-rate-value" style="color:#ffcc00;font-weight:600;margin-left:8px;">1 GBP = 1.17 EUR</span>
        <span id="cx-rate-timestamp" style="color:rgba(230,250,255,0.5);font-size:0.85rem;margin-left:12px;">Loading...</span>
      </div>
    </div>
  </div>

  <!-- Quick Amount Presets -->
  <div style="margin-bottom:20px;">
    <div style="color:var(--accent);margin-bottom:8px;font-size:14px;font-weight:500;">ğŸ’¸ Quick Amounts:</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
      <button type="button" onclick="cxSetAmount(10)" style="padding:8px 16px;background:rgba(30,30,30,0.8);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">10</button>
      <button type="button" onclick="cxSetAmount(50)" style="padding:8px 16px;background:rgba(30,30,30,0.8);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">50</button>
      <button type="button" onclick="cxSetAmount(100)" style="padding:8px 16px;background:rgba(45,212,255,0.15);border:1px solid rgba(45,212,255,0.4);border-radius:6px;color:var(--accent);cursor:pointer;font-size:14px;">100</button>
      <button type="button" onclick="cxSetAmount(500)" style="padding:8px 16px;background:rgba(30,30,30,0.8);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">500</button>
      <button type="button" onclick="cxSetAmount(1000)" style="padding:8px 16px;background:rgba(30,30,30,0.8);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">1,000</button>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:10px;margin-top:20px;">
    <button type="button" onclick="cxConvert()" id="cx-convert-btn"
            style="padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8));border:2px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;transition:all 0.2s;">
      ğŸ”„ Convert Now
    </button>
    <button type="button" onclick="cxUpdateRates()" id="cx-update-btn"
            style="padding:14px;background:rgba(57,255,20,0.1);border:2px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ“ˆ Update Rates
    </button>
    <button type="button" onclick="cxCopyResult()"
            style="padding:14px;background:rgba(255,204,0,0.1);border:2px solid rgba(255,204,0,0.3);color:#ffcc00;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ“‹ Copy Result
    </button>
    <button type="button" onclick="cxReset()"
            style="padding:14px;background:rgba(255,77,77,0.1);border:2px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ—‘ï¸ Clear All
    </button>
  </div>
</form>

<!-- Results and Additional Info -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <!-- Market Info -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.07), rgba(20,20,20,0.9));border-radius:12px;padding:20px;border:2px solid rgba(45,212,255,0.2);margin-bottom:16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“Š Market Info</h3>
      <span id="cx-market-status" style="font-size:0.85rem;color:#39ff14;font-weight:500;">â— Live</span>
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:16px;margin-bottom:20px;">
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’± Current Rate</div>
        <div id="cx-current-rate" style="font-size:1.4rem;font-weight:700;color:#ffcc00;">1.1700</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;" id="cx-pair-display">GBP/EUR</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">â° Last Updated</div>
        <div id="cx-last-updated" style="font-size:1.1rem;font-weight:600;color:var(--accent);">Just now</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Updates every 60s</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">âš¡ API Status</div>
        <div id="cx-api-status" style="font-size:1.4rem;font-weight:700;color:#39ff14;">Online</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">ExchangeRate-API</div>
      </div>
    </div>
  </div>

  <!-- Important Disclaimer -->
  <div style="background:rgba(30,0,0,0.6);border-radius:12px;padding:20px;border:2px solid rgba(255,77,77,0.3);margin-bottom:16px;">
    <div style="color:#ff6b6b;font-weight:600;margin-bottom:8px;">âš ï¸ Important Notice</div>
    <div style="font-size:0.9rem;color:rgba(255,200,200,0.9);">
      Exchange rates are for informational purposes only. Rates shown are mid-market rates and may differ from bank rates. 
      For exact rates and fees, check with your bank or financial institution before making transactions.
      <div style="margin-top:8px;font-size:0.85rem;color:rgba(255,200,200,0.7);">
        <strong>Data Source:</strong> Using ExchangeRate-API (free tier) with local fallback data[citation:5][citation:8].
      </div>
    </div>
  </div>
</div>

<script>
/* currency-converter.html
   - Fully functional currency converter with API integration
   - Scoped with cx- prefix
   - Uses ExchangeRate-API with local fallback[citation:5][citation:8]
*/

// Core configuration
let cxExchangeRates = {};
let cxLastUpdate = null;
let cxIsUpdating = false;
let cxUseLocalData = false;

// Comprehensive currency data with flags and symbols
const cxCurrencyData = {
    'USD': { name: 'US Dollar', symbol: '$', flag: 'ğŸ‡ºğŸ‡¸', emoji: 'ğŸ’µ' },
    'GBP': { name: 'British Pound', symbol: 'Â£', flag: 'ğŸ‡¬ğŸ‡§', emoji: 'ğŸ’·' },
    'EUR': { name: 'Euro', symbol: 'â‚¬', flag: 'ğŸ‡ªğŸ‡º', emoji: 'ğŸ’¶' },
    'JPY': { name: 'Japanese Yen', symbol: 'Â¥', flag: 'ğŸ‡¯ğŸ‡µ', emoji: 'ğŸ’´' },
    'CAD': { name: 'Canadian Dollar', symbol: '$', flag: 'ğŸ‡¨ğŸ‡¦', emoji: 'ğŸ‡¨ğŸ‡¦' },
    'AUD': { name: 'Australian Dollar', symbol: '$', flag: 'ğŸ‡¦ğŸ‡º', emoji: 'ğŸ‡¦ğŸ‡º' },
    'CHF': { name: 'Swiss Franc', symbol: 'CHF', flag: 'ğŸ‡¨ğŸ‡­', emoji: 'ğŸ‡¨ğŸ‡­' },
    'CNY': { name: 'Chinese Yuan', symbol: 'Â¥', flag: 'ğŸ‡¨ğŸ‡³', emoji: 'ğŸ‡¨ğŸ‡³' },
    'INR': { name: 'Indian Rupee', symbol: 'â‚¹', flag: 'ğŸ‡®ğŸ‡³', emoji: 'ğŸ‡®ğŸ‡³' },
    'NZD': { name: 'New Zealand Dollar', symbol: '$', flag: 'ğŸ‡³ğŸ‡¿', emoji: 'ğŸ‡³ğŸ‡¿' },
    'BRL': { name: 'Brazilian Real', symbol: 'R$', flag: 'ğŸ‡§ğŸ‡·', emoji: 'ğŸ‡§ğŸ‡·' },
    'RUB': { name: 'Russian Ruble', symbol: 'â‚½', flag: 'ğŸ‡·ğŸ‡º', emoji: 'ğŸ‡·ğŸ‡º' },
    'KRW': { name: 'South Korean Won', symbol: 'â‚©', flag: 'ğŸ‡°ğŸ‡·', emoji: 'ğŸ‡°ğŸ‡·' },
    'MXN': { name: 'Mexican Peso', symbol: '$', flag: 'ğŸ‡²ğŸ‡½', emoji: 'ğŸ‡²ğŸ‡½' },
    'SGD': { name: 'Singapore Dollar', symbol: '$', flag: 'ğŸ‡¸ğŸ‡¬', emoji: 'ğŸ‡¸ğŸ‡¬' },
    'HKD': { name: 'Hong Kong Dollar', symbol: '$', flag: 'ğŸ‡­ğŸ‡°', emoji: 'ğŸ‡­ğŸ‡°' },
    'TRY': { name: 'Turkish Lira', symbol: 'â‚º', flag: 'ğŸ‡¹ğŸ‡·', emoji: 'ğŸ‡¹ğŸ‡·' },
    'ZAR': { name: 'South African Rand', symbol: 'R', flag: 'ğŸ‡¿ğŸ‡¦', emoji: 'ğŸ‡¿ğŸ‡¦' },
    'SEK': { name: 'Swedish Krona', symbol: 'kr', flag: 'ğŸ‡¸ğŸ‡ª', emoji: 'ğŸ‡¸ğŸ‡ª' },
    'NOK': { name: 'Norwegian Krone', symbol: 'kr', flag: 'ğŸ‡³ğŸ‡´', emoji: 'ğŸ‡³ğŸ‡´' }
};

// Fallback exchange rates (updated periodically)
const cxFallbackRates = {
    'USD': 1.0,
    'GBP': 0.78,
    'EUR': 0.92,
    'JPY': 148.5,
    'CAD': 1.35,
    'AUD': 1.52,
    'CHF': 0.88,
    'CNY': 7.18,
    'INR': 83.2,
    'NZD': 1.62
};

// Initialize the converter
function cxInit() {
    populateCurrencyDropdowns();
    cxUpdateCurrencyDisplay();
    cxLoadRates();
    
    // Auto-convert on input changes
    document.getElementById('cx-amount').addEventListener('input', () => {
        if (document.getElementById('cx-amount').value) {
            cxConvert();
        }
    });
    
    document.getElementById('cx-from').addEventListener('change', () => {
        cxUpdateCurrencyDisplay();
        cxConvert();
    });
    
    document.getElementById('cx-to').addEventListener('change', () => {
        cxUpdateCurrencyDisplay();
        cxConvert();
    });
    
    // Auto-convert on page load
    setTimeout(() => cxConvert(), 500);
}

// Populate currency dropdowns
function populateCurrencyDropdowns() {
    const fromSelect = document.getElementById('cx-from');
    const toSelect = document.getElementById('cx-to');
    
    fromSelect.innerHTML = '';
    toSelect.innerHTML = '';
    
    Object.keys(cxCurrencyData).forEach(code => {
        const currency = cxCurrencyData[code];
        const option = document.createElement('option');
        option.value = code;
        option.textContent = `${currency.flag} ${currency.name} (${code})`;
        
        const option2 = option.cloneNode(true);
        
        fromSelect.appendChild(option);
        toSelect.appendChild(option2);
    });
    
    // Set defaults
    fromSelect.value = 'GBP';
    toSelect.value = 'EUR';
}

// Update currency display elements
function cxUpdateCurrencyDisplay() {
    const fromCurrency = document.getElementById('cx-from').value;
    const toCurrency = document.getElementById('cx-to').value;
    
    const fromData = cxCurrencyData[fromCurrency] || { symbol: '', flag: '' };
    const toData = cxCurrencyData[toCurrency] || { symbol: '', flag: '' };
    
    document.getElementById('cx-from-symbol').textContent = `${fromData.symbol} ${fromCurrency}`;
    document.getElementById('cx-to-symbol').textContent = `${toData.symbol} ${toCurrency}`;
    document.getElementById('cx-from-flag').textContent = fromData.flag;
    document.getElementById('cx-to-flag').textContent = toData.flag;
    document.getElementById('cx-pair-display').textContent = `${fromCurrency}/${toCurrency}`;
}

// Swap currencies
function cxSwapCurrencies() {
    const fromSelect = document.getElementById('cx-from');
    const toSelect = document.getElementById('cx-to');
    
    const temp = fromSelect.value;
    fromSelect.value = toSelect.value;
    toSelect.value = temp;
    
    cxUpdateCurrencyDisplay();
    
    // Visual feedback
    const swapBtn = document.querySelector('[onclick="cxSwapCurrencies()"]');
    swapBtn.style.transform = 'rotate(180deg)';
    swapBtn.style.background = 'linear-gradient(135deg, rgba(57,255,20,0.2), rgba(20,20,20,0.8))';
    
    setTimeout(() => {
        swapBtn.style.transform = 'rotate(0deg)';
        swapBtn.style.background = 'linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8))';
    }, 300);
    
    cxConvert();
}

// Set amount from quick buttons
function cxSetAmount(amount) {
    const amountInput = document.getElementById('cx-amount');
    amountInput.value = amount;
    
    // Highlight selected button
    document.querySelectorAll('[onclick*="cxSetAmount"]').forEach(btn => {
        btn.style.background = 'rgba(30,30,30,0.8)';
        btn.style.border = '1px solid rgba(255,255,255,0.1)';
        btn.style.color = '#e6faff';
    });
    
    const amountBtn = document.querySelector(`[onclick="cxSetAmount(${amount})"]`);
    if (amountBtn) {
        amountBtn.style.background = 'rgba(45,212,255,0.15)';
        amountBtn.style.border = '1px solid rgba(45,212,255,0.4)';
        amountBtn.style.color = 'var(--accent)';
    }
    
    cxConvert();
}

// Load exchange rates from API with fallback
async function cxLoadRates() {
    if (cxIsUpdating) return;
    
    cxIsUpdating = true;
    const updateBtn = document.getElementById('cx-update-btn');
    updateBtn.textContent = 'ğŸ”„ Updating...';
    updateBtn.disabled = true;
    
    try {
        // Try ExchangeRate-API first (free, no API key required)[citation:5][citation:8]
        const response = await fetch('https://api.exchangerate.host/latest?base=USD');
        
        if (response.ok) {
            const data = await response.json();
            if (data.success !== false && data.rates) {
                cxExchangeRates = data.rates;
                cxUseLocalData = false;
                cxLastUpdate = new Date();
                updateStatus('API Online', '#39ff14');
            } else {
                throw new Error('Invalid API response');
            }
        } else {
            throw new Error('API request failed');
        }
    } catch (error) {
        console.warn('Using fallback exchange rates:', error.message);
        cxExchangeRates = cxFallbackRates;
        cxUseLocalData = true;
        cxLastUpdate = new Date();
        updateStatus('Using Local Data', '#ffcc00');
    }
    
    // Update display
    cxUpdateRateDisplay();
    cxIsUpdating = false;
    updateBtn.textContent = 'ğŸ“ˆ Update Rates';
    updateBtn.disabled = false;
    
    // Auto-convert with new rates
    cxConvert();
}

// Update rates display
function cxUpdateRateDisplay() {
    const fromCurrency = document.getElementById('cx-from').value;
    const toCurrency = document.getElementById('cx-to').value;
    
    if (cxExchangeRates[fromCurrency] && cxExchangeRates[toCurrency]) {
        const rate = cxExchangeRates[toCurrency] / cxExchangeRates[fromCurrency];
        document.getElementById('cx-rate-value').textContent = 
            `1 ${fromCurrency} = ${rate.toFixed(4)} ${toCurrency}`;
        document.getElementById('cx-current-rate').textContent = rate.toFixed(4);
    }
    
    if (cxLastUpdate) {
        const now = new Date();
        const diff = Math.floor((now - cxLastUpdate) / 1000);
        
        if (diff < 60) {
            document.getElementById('cx-last-updated').textContent = 'Just now';
            document.getElementById('cx-rate-timestamp').textContent = 'Updated just now';
        } else if (diff < 3600) {
            document.getElementById('cx-last-updated').textContent = `${Math.floor(diff/60)} min ago`;
            document.getElementById('cx-rate-timestamp').textContent = `Updated ${Math.floor(diff/60)} minutes ago`;
        } else {
            document.getElementById('cx-last-updated').textContent = cxLastUpdate.toLocaleTimeString();
            document.getElementById('cx-rate-timestamp').textContent = `Updated at ${cxLastUpdate.toLocaleTimeString()}`;
        }
    }
}

// Update status display
function updateStatus(text, color) {
    const statusEl = document.getElementById('cx-api-status');
    const marketStatus = document.getElementById('cx-market-status');
    
    statusEl.textContent = text;
    statusEl.style.color = color;
    marketStatus.textContent = cxUseLocalData ? 'â— Local' : 'â— Live';
    marketStatus.style.color = cxUseLocalData ? '#ffcc00' : '#39ff14';
}

// Main conversion function
function cxConvert() {
    const amountInput = document.getElementById('cx-amount');
    const resultInput = document.getElementById('cx-result');
    const convertBtn = document.getElementById('cx-convert-btn');
    
    const amount = parseFloat(amountInput.value);
    const fromCurrency = document.getElementById('cx-from').value;
    const toCurrency = document.getElementById('cx-to').value;
    
    // Validation
    if (!amount || amount <= 0) {
        resultInput.value = 'Enter valid amount';
        resultInput.style.color = '#ff4d4d';
        return;
    }
    
    if (fromCurrency === toCurrency) {
        resultInput.value = amount.toFixed(2);
        resultInput.style.color = '#39ff14';
        document.getElementById('cx-rate-value').textContent = `1 ${fromCurrency} = 1.0000 ${toCurrency}`;
        return;
    }
    
    // Calculate conversion
    convertBtn.textContent = 'â³ Converting...';
    convertBtn.disabled = true;
    
    setTimeout(() => {
        let rate;
        let convertedAmount;
        
        if (cxExchangeRates[fromCurrency] && cxExchangeRates[toCurrency]) {
            rate = cxExchangeRates[toCurrency] / cxExchangeRates[fromCurrency];
            convertedAmount = amount * rate;
        } else {
            // Fallback calculation using USD as base
            const fromRate = cxExchangeRates[fromCurrency] || cxFallbackRates[fromCurrency] || 1;
            const toRate = cxExchangeRates[toCurrency] || cxFallbackRates[toCurrency] || 1;
            rate = toRate / fromRate;
            convertedAmount = amount * rate;
        }
        
        // Format the result based on currency
        const formattedAmount = formatCurrency(convertedAmount, toCurrency);
        
        resultInput.value = formattedAmount;
        resultInput.style.color = '#39ff14';
        
        document.getElementById('cx-rate-value').textContent = 
            `1 ${fromCurrency} = ${rate.toFixed(4)} ${toCurrency}`;
        document.getElementById('cx-current-rate').textContent = rate.toFixed(4);
        
        convertBtn.textContent = 'ğŸ”„ Convert Now';
        convertBtn.disabled = false;
    }, 300);
}

// Format currency based on locale
function formatCurrency(amount, currencyCode) {
    const currency = cxCurrencyData[currencyCode];
    const symbol = currency ? currency.symbol : currencyCode;
    
    // Simple formatting - in a real app, you'd use Intl.NumberFormat[citation:2]
    if (amount >= 1000) {
        return `${symbol}${amount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',')}`;
    } else if (amount >= 100) {
        return `${symbol}${amount.toFixed(2)}`;
    } else if (amount >= 10) {
        return `${symbol}${amount.toFixed(2)}`;
    } else if (amount >= 1) {
        return `${symbol}${amount.toFixed(2)}`;
    } else if (amount >= 0.01) {
        return `${symbol}${amount.toFixed(3)}`;
    } else {
        return `${symbol}${amount.toFixed(6)}`;
    }
}

// Update rates manually
function cxUpdateRates() {
    cxLoadRates();
}

// Copy result to clipboard
function cxCopyResult() {
    const resultInput = document.getElementById('cx-result');
    const copyBtn = document.querySelector('[onclick="cxCopyResult()"]');
    
    if (resultInput.value && !resultInput.value.includes('Enter')) {
        navigator.clipboard.writeText(resultInput.value).then(() => {
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'âœ… Copied!';
            copyBtn.style.background = 'rgba(57,255,20,0.2)';
            copyBtn.style.border = '2px solid #39ff14';
            
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.style.background = 'rgba(255,204,0,0.1)';
                copyBtn.style.border = '2px solid rgba(255,204,0,0.3)';
            }, 2000);
        });
    }
}

// Reset the converter
function cxReset() {
    document.getElementById('cx-amount').value = '100';
    document.getElementById('cx-result').value = '';
    document.getElementById('cx-from').value = 'GBP';
    document.getElementById('cx-to').value = 'EUR';
    
    cxUpdateCurrencyDisplay();
    
    // Reset button highlights
    document.querySelectorAll('[onclick*="cxSetAmount"]').forEach(btn => {
        btn.style.background = 'rgba(30,30,30,0.8)';
        btn.style.border = '1px solid rgba(255,255,255,0.1)';
        btn.style.color = '#e6faff';
    });
    
    const amountBtn = document.querySelector('[onclick="cxSetAmount(100)"]');
    if (amountBtn) {
        amountBtn.style.background = 'rgba(45,212,255,0.15)';
        amountBtn.style.border = '1px solid rgba(45,212,255,0.4)';
        amountBtn.style.color = 'var(--accent)';
    }
    
    cxConvert();
}

// Initialize on page load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', cxInit);
} else {
    cxInit();
}
</script>
