<h2 id="currency-title" style="margin-top:0;">Currency Converter</h2>

<form aria-describedby="currency-desc">
  <p id="currency-desc" class="small">Convert between major currencies with live exchange rates.</p>

  <div class="row">
    <div class="field">
      <label for="currency-amount">Amount</label>
      <div class="input"><input id="currency-amount" type="number" inputmode="decimal" min="0" step="0.01" value="100" /></div>
    </div>
    <div class="field">
      <label for="currency-from">From</label>
      <select id="currency-from">
        <option value="USD">USD</option>
        <option value="GBP" selected>GBP</option>
        <option value="EUR">EUR</option>
        <option value="JPY">JPY</option>
        <option value="CAD">CAD</option>
      </select>
    </div>
    <div class="field">
      <label for="currency-to">To</label>
      <select id="currency-to">
        <option value="USD">USD</option>
        <option value="GBP">GBP</option>
        <option value="EUR" selected>EUR</option>
        <option value="JPY">JPY</option>
        <option value="CAD">CAD</option>
      </select>
    </div>
  </div>

  <div class="actions">
    <button type="button" onclick="currencyConvert(this)">Convert</button>
    <button type="button" class="secondary" onclick="currencyReset(this)">Reset</button>
  </div>
</form>

<div class="results" aria-live="polite">
  <div class="result">
    <div class="label">Converted amount</div>
    <div class="value" id="currency-res">–</div>
  </div>
</div>

<details class="small" style="margin-top:12px;">
  <summary>How it works</summary>
  <p>
    Exchange rates are fetched live from a free API.  
    Conversion = Amount × (Rate<sub>from→to</sub>).
  </p>
</details>

<script>
async function currencyConvert(btn) {
  const card = btn.closest('.card');
  const amount = parseFloat(card.querySelector('#currency-amount').value) || 0;
  const from = card.querySelector('#currency-from').value;
  const to = card.querySelector('#currency-to').value;

  try {
    // Using exchangerate.host (free, no key required)
    const res = await fetch(`https://api.exchangerate.host/latest?base=${from}&symbols=${to}`);
    const data = await res.json();
    const rate = data.rates[to];
    const converted = amount * rate;

    const fmtMoney = n => new Intl.NumberFormat(undefined, { style: 'currency', currency: to }).format(n);
    card.querySelector('#currency-res').textContent = fmtMoney(converted);
  } catch (err) {
    card.querySelector('#currency-res').textContent = "Error fetching rates";
  }
}

function currencyReset(btn) {
  const card = btn.closest('.card');
  card.querySelector('form').reset();
  card.querySelector('#currency-res').textContent = '–';
}
</script>
