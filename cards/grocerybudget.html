<!-- cards/grocery-budget-tracker.html -->

<h2 id="grocery-budget-tracker-title">ğŸ›’ Grocery Budget Tracker</h2>

<form aria-describedby="grocery-budget-desc">
  <p id="grocery-budget-desc" class="small">Track your grocery spending, categorize items, and stay within your budget with smart insights.</p>

  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div>
      <label for="gb-budget" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Weekly Budget (Â£)</label>
      <div style="position:relative;">
        <span style="position:absolute;left:10px;top:50%;transform:translateY(-50%);color:rgba(230,250,255,0.7);">Â£</span>
        <input id="gb-budget" type="number" min="0" step="0.01" value="200" 
               style="width:100%;padding:10px 10px 10px 24px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
      </div>
    </div>
    
    <div>
      <label for="gb-period" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Budget Period</label>
      <select id="gb-period" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="weekly">Weekly</option>
        <option value="fortnightly">Fortnightly</option>
        <option value="monthly">Monthly</option>
        <option value="custom">Custom</option>
      </select>
    </div>
  </div>

  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div>
      <label for="gb-category" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Category</label>
      <select id="gb-category" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="produce">ğŸ¥¦ Produce</option>
        <option value="meat">ğŸ¥© Meat & Fish</option>
        <option value="dairy">ğŸ¥› Dairy & Eggs</option>
        <option value="bakery">ğŸ Bakery</option>
        <option value="pantry">ğŸ§‚ Pantry Staples</option>
        <option value="snacks">ğŸ« Snacks</option>
        <option value="beverages">ğŸ§ƒ Beverages</option>
        <option value="frozen">ğŸ§Š Frozen</option>
        <option value="household">ğŸ  Household</option>
        <option value="personal">ğŸ§´ Personal Care</option>
      </select>
    </div>
    
    <div>
      <label for="gb-item" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Item Name</label>
      <input id="gb-item" type="text" placeholder="e.g. Whole Wheat Bread" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gb-cost" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Cost (Â£)</label>
      <div style="position:relative;">
        <span style="position:absolute;left:10px;top:50%;transform:translateY(-50%);color:rgba(230,250,255,0.7);">Â£</span>
        <input id="gb-cost" type="number" min="0" step="0.01" value="1.50" 
               style="width:100%;padding:10px 10px 10px 24px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
      </div>
    </div>
    
    <div>
      <label for="gb-quantity" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Quantity</label>
      <div style="display:flex;gap:8px;">
        <input id="gb-quantity" type="number" min="1" step="1" value="1" 
               style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
        <select id="gb-unit" style="padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
          <option value="each">Each</option>
          <option value="kg">kg</option>
          <option value="g">g</option>
          <option value="l">L</option>
          <option value="ml">ml</option>
          <option value="pack">Pack</option>
          <option value="dozen">Dozen</option>
        </select>
      </div>
    </div>
  </div>

  <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap;">
    <button type="button" onclick="gbAddItem(this)" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      â• Add Item
    </button>
    <button type="button" onclick="gbResetForm(this)"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset Form
    </button>
    <button type="button" onclick="gbClearAll()"
            style="padding:12px 16px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:8px;color:#ff4d4d;cursor:pointer;">
      Clear All Items
    </button>
    <button type="button" onclick="gbExportData()"
            style="padding:12px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;">
      Export Data
    </button>
  </div>
</form>

<div aria-live="polite" style="margin-top:20px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:8px;">ğŸ›ï¸ Shopping List</h3>
  <div id="gb-items-list" style="max-height:300px;overflow-y:auto;padding-right:8px;">
    <!-- Items will appear here -->
    <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
      No items added yet. Add your first grocery item above!
    </div>
  </div>
</div>

<div style="margin-top:20px;padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
  <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;">ğŸ’° Budget Summary</h4>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div style="padding:12px;background:rgba(45,212,255,0.1);border-radius:8px;">
      <div style="color:var(--accent);font-size:13px;margin-bottom:4px;">Total Budget</div>
      <div style="display:flex;align-items:baseline;gap:4px;">
        <div style="font-size:28px;font-weight:600;color:var(--accent);" id="gb-total-budget">Â£200.00</div>
        <div style="color:rgba(230,250,255,0.7);font-size:14px;" id="gb-period-label">/week</div>
      </div>
    </div>
    
    <div style="padding:12px;background:rgba(255,107,157,0.1);border-radius:8px;">
      <div style="color:#ff6b9d;font-size:13px;margin-bottom:4px;">Total Spent</div>
      <div style="font-size:28px;font-weight:600;color:#ff6b9d;" id="gb-total-spent">Â£0.00</div>
    </div>
    
    <div style="padding:12px;background:rgba(57,255,20,0.1);border-radius:8px;">
      <div style="color:#39ff14;font-size:13px;margin-bottom:4px;">Remaining Budget</div>
      <div style="font-size:28px;font-weight:600;color:#39ff14;" id="gb-remaining-budget">Â£200.00</div>
    </div>
    
    <div style="padding:12px;background:rgba(255,204,0,0.1);border-radius:8px;">
      <div style="color:#ffcc00;font-size:13px;margin-bottom:4px;">Budget Used</div>
      <div style="font-size:28px;font-weight:600;color:#ffcc00;" id="gb-budget-used">0%</div>
    </div>
  </div>
  
  <!-- Progress Bar -->
  <div style="margin-top:12px;">
    <div style="display:flex;justify-content:space-between;margin-bottom:4px;font-size:12px;">
      <span style="color:var(--accent);">Budget Progress</span>
      <span style="color:rgba(230,250,255,0.7);" id="gb-progress-text">0% used</span>
    </div>
    <div style="height:10px;background:rgba(255,255,255,0.1);border-radius:5px;overflow:hidden;">
      <div id="gb-progress-bar" style="height:100%;width:0%;background:linear-gradient(90deg, #39ff14, #2dd4ff);border-radius:5px;transition:width 0.3s;"></div>
    </div>
  </div>
</div>

<div style="margin-top:20px;padding:16px;background:rgba(157,78,221,0.05);border-radius:8px;border:1px solid rgba(157,78,221,0.2);">
  <h4 style="color:#9d4edd;margin-top:0;margin-bottom:12px;">ğŸ“Š Spending Breakdown</h4>
  
  <div id="gb-categories-chart" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;">
    <!-- Category breakdown will appear here -->
    <div style="padding:20px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
      Add items to see category breakdown
    </div>
  </div>
</div>

<div id="gb-alert" style="position:fixed;top:20px;right:20px;padding:12px 16px;background:rgba(20,20,20,0.95);border-radius:8px;border:1px solid var(--accent);z-index:10000;display:none;box-shadow:0 4px 12px rgba(0,0,0,0.3);">
  <div style="display:flex;align-items:center;gap:8px;">
    <div style="color:var(--accent);font-size:18px;">âš ï¸</div>
    <div>
      <div style="color:var(--accent);font-weight:600;font-size:14px;">Budget Alert</div>
      <div id="gb-alert-message" style="color:rgba(230,250,255,0.9);font-size:13px;"></div>
    </div>
    <button onclick="document.getElementById('gb-alert').style.display='none'" 
            style="margin-left:12px;background:transparent;border:none;color:rgba(230,250,255,0.7);cursor:pointer;">âœ•</button>
  </div>
</div>

<script>
/* grocery-budget-tracker.html
   - Grocery budget tracking and management tool
   - Scoped with gb- prefix
*/

// Category configurations
const groceryCategories = {
  'produce': { emoji: 'ğŸ¥¦', color: '#39ff14', name: 'Produce' },
  'meat': { emoji: 'ğŸ¥©', color: '#ff6b9d', name: 'Meat & Fish' },
  'dairy': { emoji: 'ğŸ¥›', color: '#ffcc00', name: 'Dairy & Eggs' },
  'bakery': { emoji: 'ğŸ', color: '#ff9500', name: 'Bakery' },
  'pantry': { emoji: 'ğŸ§‚', color: '#2dd4ff', name: 'Pantry Staples' },
  'snacks': { emoji: 'ğŸ«', color: '#9d4edd', name: 'Snacks' },
  'beverages': { emoji: 'ğŸ§ƒ', color: '#00ff99', name: 'Beverages' },
  'frozen': { emoji: 'ğŸ§Š', color: '#8e44ad', name: 'Frozen' },
  'household': { emoji: 'ğŸ ', color: '#ff2d55', name: 'Household' },
  'personal': { emoji: 'ğŸ§´', color: '#1abc9c', name: 'Personal Care' }
};

let groceryItems = [];
const STORAGE_KEY = 'grocery-budget-items';

// Load saved items
function gbLoad() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      groceryItems = JSON.parse(saved);
      gbRender();
      gbUpdateBudget();
      gbUpdateCategories();
    }
  } catch (e) {
    console.error('Failed to load grocery items:', e);
  }
}

// Save items
function gbSave() {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(groceryItems));
  } catch (e) {
    console.error('Failed to save grocery items:', e);
  }
}

// Add a grocery item
function gbAddItem(btn) {
  const card = btn.closest('.card') || document;
  const budget = parseFloat(card.querySelector('#gb-budget').value) || 0;
  const category = card.querySelector('#gb-category').value;
  const item = card.querySelector('#gb-item').value.trim();
  const cost = parseFloat(card.querySelector('#gb-cost').value) || 0;
  const quantity = parseInt(card.querySelector('#gb-quantity').value) || 1;
  const unit = card.querySelector('#gb-unit').value;

  if (!item || cost <= 0) {
    gbShowAlert('Please enter item name and cost', 'error');
    return;
  }

  if (budget <= 0) {
    gbShowAlert('Please set a budget amount', 'error');
    return;
  }

  const itemId = Date.now();
  const totalCost = cost * quantity;
  
  groceryItems.push({
    id: itemId,
    category: category,
    name: item,
    unitCost: cost,
    quantity: quantity,
    unit: unit,
    totalCost: totalCost,
    date: new Date().toLocaleDateString(),
    time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
  });
  
  gbRender();
  gbSave();
  gbUpdateBudget();
  gbUpdateCategories();
  
  // Reset form (keep budget and category)
  card.querySelector('#gb-item').value = '';
  card.querySelector('#gb-cost').value = '1.50';
  card.querySelector('#gb-quantity').value = '1';
  card.querySelector('#gb-item').focus();
  
  gbShowToast(`Added ${quantity} ${unit} of ${item}`, 'success');
  
  // Check budget alerts
  gbCheckBudgetAlerts();
}

// Render grocery items
function gbRender() {
  const card = document.currentScript?.closest('.card') || document;
  const list = card.querySelector('#gb-items-list');
  
  if (groceryItems.length === 0) {
    list.innerHTML = `
      <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
        No items added yet. Add your first grocery item above!
      </div>
    `;
    return;
  }
  
  let html = '';
  groceryItems.forEach((item, index) => {
    const category = groceryCategories[item.category] || groceryCategories['pantry'];
    const totalFormatted = `Â£${item.totalCost.toFixed(2)}`;
    const unitCostFormatted = `Â£${item.unitCost.toFixed(2)}`;
    
    html += `
      <div class="grocery-item" data-id="${item.id}" 
           style="background:rgba(255,255,255,0.03);border-left:3px solid ${category.color};margin-bottom:12px;padding:12px;border-radius:8px;">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px;">
          <div style="flex:1;">
            <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
              <span style="font-size:18px;">${category.emoji}</span>
              <div style="font-weight:600;color:var(--accent);">${item.name}</div>
            </div>
            <div style="display:flex;gap:12px;margin-top:4px;font-size:13px;">
              <span style="color:rgba(230,250,255,0.8);">${item.quantity} ${item.unit}</span>
              <span style="color:#39ff14;">${unitCostFormatted} each</span>
              <span style="color:#ff6b9d;font-weight:600;">${totalFormatted} total</span>
            </div>
            <div style="margin-top:4px;font-size:12px;color:rgba(230,250,255,0.6);">
              Added: ${item.date} at ${item.time}
            </div>
          </div>
          <div>
            <button onclick="gbEditItem('${item.id}')" style="background:transparent;border:none;color:#ffcc00;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">âœï¸ Edit</button>
            <button onclick="gbRemoveItem('${item.id}')" style="background:transparent;border:none;color:#ff4d4d;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">ğŸ—‘ï¸</button>
          </div>
        </div>
      </div>
    `;
  });
  
  list.innerHTML = html;
}

// Update budget calculations
function gbUpdateBudget() {
  const card = document.currentScript?.closest('.card') || document;
  const budget = parseFloat(card.querySelector('#gb-budget').value) || 0;
  const period = card.querySelector('#gb-period').value;
  
  // Calculate total spent
  let totalSpent = 0;
  groceryItems.forEach(item => {
    totalSpent += item.totalCost;
  });
  
  const remainingBudget = Math.max(0, budget - totalSpent);
  const budgetUsed = budget > 0 ? (totalSpent / budget) * 100 : 0;
  
  // Update displays
  document.getElementById('gb-total-budget').textContent = `Â£${budget.toFixed(2)}`;
  document.getElementById('gb-period-label').textContent = `/${period}`;
  document.getElementById('gb-total-spent').textContent = `Â£${totalSpent.toFixed(2)}`;
  document.getElementById('gb-remaining-budget').textContent = `Â£${remainingBudget.toFixed(2)}`;
  document.getElementById('gb-budget-used').textContent = `${budgetUsed.toFixed(1)}%`;
  
  // Update progress bar
  const progressBar = document.getElementById('gb-progress-bar');
  const progressText = document.getElementById('gb-progress-text');
  
  progressBar.style.width = `${Math.min(100, budgetUsed)}%`;
  
  // Change color based on usage
  if (budgetUsed > 90) {
    progressBar.style.background = 'linear-gradient(90deg, #ff4d4d, #ff2d55)';
  } else if (budgetUsed > 75) {
    progressBar.style.background = 'linear-gradient(90deg, #ffcc00, #ff9500)';
  } else {
    progressBar.style.background = 'linear-gradient(90deg, #39ff14, #2dd4ff)';
  }
  
  progressText.textContent = `${budgetUsed.toFixed(1)}% used â€¢ Â£${remainingBudget.toFixed(2)} remaining`;
}

// Update category breakdown
function gbUpdateCategories() {
  const chart = document.getElementById('gb-categories-chart');
  
  if (groceryItems.length === 0) {
    chart.innerHTML = `
      <div style="padding:20px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
        Add items to see category breakdown
      </div>
    `;
    return;
  }
  
  // Calculate totals per category
  const categoryTotals = {};
  let overallTotal = 0;
  
  groceryItems.forEach(item => {
    if (!categoryTotals[item.category]) {
      categoryTotals[item.category] = 0;
    }
    categoryTotals[item.category] += item.totalCost;
    overallTotal += item.totalCost;
  });
  
  // Create chart items
  let html = '';
  Object.entries(categoryTotals).forEach(([categoryId, total]) => {
    const category = groceryCategories[categoryId] || groceryCategories['pantry'];
    const percentage = overallTotal > 0 ? (total / overallTotal) * 100 : 0;
    
    html += `
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
          <div style="display:flex;align-items:center;gap:6px;">
            <span style="font-size:16px;">${category.emoji}</span>
            <span style="color:${category.color};font-weight:600;font-size:14px;">${category.name}</span>
          </div>
          <div style="color:#ff6b9d;font-weight:600;">Â£${total.toFixed(2)}</div>
        </div>
        <div style="height:6px;background:rgba(255,255,255,0.1);border-radius:3px;overflow:hidden;">
          <div style="height:100%;width:${percentage}%;background:${category.color};border-radius:3px;"></div>
        </div>
        <div style="margin-top:4px;font-size:11px;color:rgba(230,250,255,0.6);">
          ${percentage.toFixed(1)}% of total spending
        </div>
      </div>
    `;
  });
  
  chart.innerHTML = html;
}

// Edit an item
function gbEditItem(itemId) {
  const item = groceryItems.find(i => i.id == itemId);
  if (!item) return;
  
  const card = document.currentScript?.closest('.card') || document;
  card.querySelector('#gb-category').value = item.category;
  card.querySelector('#gb-item').value = item.name;
  card.querySelector('#gb-cost').value = item.unitCost;
  card.querySelector('#gb-quantity').value = item.quantity;
  card.querySelector('#gb-unit').value = item.unit;
  
  // Change button to update
  const addBtn = card.querySelector('button[onclick="gbAddItem(this)"]');
  addBtn.textContent = 'ğŸ’¾ Update Item';
  addBtn.setAttribute('onclick', `gbUpdateItem('${itemId}')`);
  
  card.querySelector('#gb-item').focus();
}

// Update an item
function gbUpdateItem(itemId) {
  const card = document.currentScript?.closest('.card') || document;
  const category = card.querySelector('#gb-category').value;
  const itemName = card.querySelector('#gb-item').value.trim();
  const cost = parseFloat(card.querySelector('#gb-cost').value) || 0;
  const quantity = parseInt(card.querySelector('#gb-quantity').value) || 1;
  const unit = card.querySelector('#gb-unit').value;
  
  const itemIndex = groceryItems.findIndex(i => i.id == itemId);
  if (itemIndex === -1) return;
  
  const totalCost = cost * quantity;
  
  groceryItems[itemIndex] = {
    ...groceryItems[itemIndex],
    category: category,
    name: itemName,
    unitCost: cost,
    quantity: quantity,
    unit: unit,
    totalCost: totalCost
  };
  
  gbRender();
  gbSave();
  gbUpdateBudget();
  gbUpdateCategories();
  
  // Reset button and form
  const addBtn = card.querySelector('button[onclick^="gbUpdateItem"]');
  addBtn.textContent = 'â• Add Item';
  addBtn.setAttribute('onclick', 'gbAddItem(this)');
  
  card.querySelector('#gb-item').value = '';
  card.querySelector('#gb-cost').value = '1.50';
  card.querySelector('#gb-quantity').value = '1';
  
  gbShowToast('Item updated successfully', 'success');
}

// Remove an item
function gbRemoveItem(itemId) {
  if (!confirm('Remove this item from your shopping list?')) return;
  
  groceryItems = groceryItems.filter(i => i.id != itemId);
  gbRender();
  gbSave();
  gbUpdateBudget();
  gbUpdateCategories();
  
  gbShowToast('Item removed', 'success');
}

// Reset form
function gbResetForm(btn) {
  const card = btn.closest('.card') || document;
  card.querySelector('#gb-item').value = '';
  card.querySelector('#gb-cost').value = '1.50';
  card.querySelector('#gb-quantity').value = '1';
  
  // Make sure button is in add mode
  const addBtn = card.querySelector('button[onclick^="gbAddItem"], button[onclick^="gbUpdateItem"]');
  if (addBtn) {
    addBtn.textContent = 'â• Add Item';
    addBtn.setAttribute('onclick', 'gbAddItem(this)');
  }
  
  card.querySelector('#gb-item').focus();
}

// Clear all items
function gbClearAll() {
  if (groceryItems.length === 0) return;
  
  if (confirm('Are you sure you want to clear all grocery items?')) {
    groceryItems = [];
    gbRender();
    gbSave();
    gbUpdateBudget();
    gbUpdateCategories();
    
    gbShowToast('All items cleared', 'success');
  }
}

// Export data
function gbExportData() {
  if (groceryItems.length === 0) {
    gbShowAlert('No data to export', 'error');
    return;
  }
  
  let csv = 'Category,Item Name,Unit Cost,Quantity,Unit,Total Cost,Date,Time\n';
  groceryItems.forEach(item => {
    csv += `"${item.category}","${item.name}",${item.unitCost},${item.quantity},"${item.unit}",${item.totalCost},"${item.date}","${item.time}"\n`;
  });
  
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'grocery-budget.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  gbShowToast('Data exported as CSV', 'success');
}

// Check budget alerts
function gbCheckBudgetAlerts() {
  const card = document.currentScript?.closest('.card') || document;
  const budget = parseFloat(card.querySelector('#gb-budget').value) || 0;
  
  // Calculate total spent
  let totalSpent = 0;
  groceryItems.forEach(item => {
    totalSpent += item.totalCost;
  });
  
  const budgetUsed = budget > 0 ? (totalSpent / budget) * 100 : 0;
  
  // Show alerts at thresholds
  if (budgetUsed >= 100) {
    gbShowAlert('Budget exceeded! You are over budget.', 'critical');
  } else if (budgetUsed >= 90) {
    gbShowAlert('Warning: You have used 90% of your budget.', 'warning');
  } else if (budgetUsed >= 75) {
    gbShowAlert('Notice: You have used 75% of your budget.', 'info');
  }
}

// Show budget alert
function gbShowAlert(message, type = 'info') {
  const alertDiv = document.getElementById('gb-alert');
  const alertMessage = document.getElementById('gb-alert-message');
  
  alertMessage.textContent = message;
  
  // Set color based on alert type
  const colors = {
    'critical': '#ff4d4d',
    'warning': '#ffcc00',
    'info': '#2dd4ff',
    'error': '#ff6b9d',
    'success': '#39ff14'
  };
  
  alertDiv.style.borderColor = colors[type] || colors.info;
  alertDiv.style.display = 'block';
  
  // Auto-hide after 10 seconds
  setTimeout(() => {
    alertDiv.style.display = 'none';
  }, 10000);
}

// Show toast notification
function gbShowToast(message, type = 'info') {
  const colors = {
    'success': '#39ff14',
    'error': '#ff4d4d',
    'warning': '#ffcc00',
    'info': '#2dd4ff'
  };
  
  const toast = document.getElementById('gb-toast') || (() => {
    const div = document.createElement('div');
    div.id = 'gb-toast';
    div.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 16px;
      background: rgba(20,20,20,0.95);
      border-radius: 8px;
      border: 1px solid var(--accent);
      z-index: 10000;
      display: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    `;
    document.body.appendChild(div);
    return div;
  })();
  
  toast.innerHTML = `
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="color:${colors[type] || colors.info};font-size:18px;">âœ…</div>
      <div style="color:${colors[type] || colors.info};font-weight:600;font-size:14px;">${message}</div>
      <button onclick="this.parentElement.parentElement.style.display='none'" 
              style="margin-left:12px;background:transparent;border:none;color:rgba(230,250,255,0.7);cursor:pointer;">âœ•</button>
    </div>
  `;
  
  toast.style.display = 'block';
  
  setTimeout(() => {
    toast.style.display = 'none';
  }, 3000);
}

// Initialize on load
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(gbLoad, 100);
  });
} else {
  setTimeout(gbLoad, 100);
}
</script>

<style>
#grocery-budget-tracker-title {
  color: var(--accent);
  margin-top: 0;
  border-bottom: 1px solid rgba(45,212,255,0.2);
  padding-bottom: 10px;
  margin-bottom: 16px;
}

.grocery-item {
  transition: all 0.2s ease;
}

.grocery-item:hover {
  background: rgba(45,212,255,0.05) !important;
  transform: translateX(2px);
}

#gb-items-list::-webkit-scrollbar {
  width: 6px;
}

#gb-items-list::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#gb-items-list::-webkit-scrollbar-thumb {
  background: rgba(45,212,255,0.3);
  border-radius: 3px;
}

@media (max-width: 768px) {
  div[style*="grid-template-columns:repeat(auto-fit"] {
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }
  
  .actions {
    flex-direction: column !important;
  }
  
  .actions button {
    width: 100% !important;
    margin-bottom: 8px;
  }
  
  .grocery-item > div:first-child {
    flex-direction: column !important;
    gap: 8px;
  }
  
  .grocery-item > div:first-child > div:last-child {
    align-self: flex-end;
  }
}
</style>
