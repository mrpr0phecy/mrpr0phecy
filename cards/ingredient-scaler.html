<h2 id="ingredient-scaler" style="margin-top:0;">Ingredient Scaler</h2>

<!--
  Manifest metadata
  id: ingredient-scaler
  title: Ingredient Scaler
  path: cards/ingredient-scaler.html
  category: Food Tools
  version: 1.0
-->

<form aria-describedby="ingredient-scaler-desc">
  <p id="ingredient-scaler-desc" class="small">
    Scale recipe ingredients up or down based on desired servings.
  </p>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
    <div>
      <label for="is-original">Original Servings</label>
      <input id="is-original" type="number" value="4" min="1" style="width:100%;" />
    </div>
    <div>
      <label for="is-desired">Desired Servings</label>
      <input id="is-desired" type="number" value="8" min="1" style="width:100%;" />
    </div>
  </div>

  <label for="is-ingredients" style="margin-top:8px;">Ingredients (one per line, e.g. "200 g flour")</label>
  <textarea id="is-ingredients" rows="8" style="width:100%;"></textarea>

  <div style="margin-top:12px;display:flex;gap:8px;">
    <button type="button" onclick="scaleIngredients()">Scale</button>
    <button type="button" onclick="resetIngredients()" class="secondary">Reset</button>
  </div>
</form>

<div id="is-output" class="small" style="margin-top:12px;white-space:pre-wrap;background:#fafafa;padding:8px;border-radius:6px;"></div>

<script>
function scaleIngredients(){
  const orig = parseFloat(document.getElementById('is-original').value);
  const desired = parseFloat(document.getElementById('is-desired').value);
  const factor = desired / orig;
  const lines = document.getElementById('is-ingredients').value.split('\\n');
  const out = lines.map(line=>{
    const match = line.match(/([0-9]*\\.?[0-9]+)/);
    if(match){
      const num = parseFloat(match[1]);
      const scaled = (num * factor).toFixed(2);
      return line.replace(match[1], scaled);
    }
    return line;
  });
  document.getElementById('is-output').textContent = out.join('\\n');
}
function resetIngredients(){
  document.getElementById('is-ingredients').value = '';
  document.getElementById('is-output').textContent = '';
}
</script>
