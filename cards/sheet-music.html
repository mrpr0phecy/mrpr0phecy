<h2 id="sheet-music-title" style="margin-top:0;">ğŸ¼ Sheet Music Reference Generator</h2>

<form aria-describedby="sheet-music-desc">
  <p id="sheet-music-desc" class="small">
    Generate detailed sheet music references with proper notation guidance. 
    <span style="color:#ff6b6b;display:block;margin-top:4px;">
      âš ï¸ Educational only â€” always verify with a teacher or professional resource.
    </span>
  </p>

  <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div class="field">
      <label for="sheet-key" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">ğŸ¹</span> Key Signature
      </label>
      <select id="sheet-key" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="C" selected>C Major (0 sharps/flats)</option>
        <option value="G">G Major (1 sharp)</option>
        <option value="D">D Major (2 sharps)</option>
        <option value="F">F Major (1 flat)</option>
        <option value="Bb">Bb Major (2 flats)</option>
        <option value="Am">A Minor (Natural)</option>
        <option value="Em">E Minor (Natural)</option>
        <option value="Dm">D Minor (Natural)</option>
      </select>
    </div>

    <div class="field">
      <label for="sheet-type" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">ğŸ“</span> Notation Type
      </label>
      <select id="sheet-type" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="scale" selected>ğŸµ Scale (Two Octaves)</option>
        <option value="scale-3oct">ğŸµ Scale (Three Octaves)</option>
        <option value="arpeggio">ğŸµ Arpeggio</option>
        <option value="exercise">ğŸµ Technical Exercise</option>
        <option value="melody">ğŸµ Simple Melody</option>
        <option value="chord-progression">ğŸµ Chord Progression</option>
        <option value="sight-reading">ğŸµ Sight Reading Example</option>
      </select>
    </div>

    <div class="field">
      <label for="sheet-clef" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">ğŸ¼</span> Clef
      </label>
      <select id="sheet-clef" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="treble" selected>Treble Clef (G Clef)</option>
        <option value="bass">Bass Clef (F Clef)</option>
        <option value="alto">Alto Clef (C Clef)</option>
        <option value="both">Treble & Bass (Grand Staff)</option>
      </select>
    </div>
  </div>

  <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:20px;">
    <div class="field">
      <label for="sheet-tempo" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">ğŸ¶</span> Tempo Marking
      </label>
      <select id="sheet-tempo" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="largo" selected>Largo (40-60 BPM)</option>
        <option value="adagio">Adagio (66-76 BPM)</option>
        <option value="andante">Andante (76-108 BPM)</option>
        <option value="moderato">Moderato (108-120 BPM)</option>
        <option value="allegro">Allegro (120-168 BPM)</option>
        <option value="presto">Presto (168-200 BPM)</option>
      </select>
    </div>

    <div class="field">
      <label for="sheet-time" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">â±ï¸</span> Time Signature
      </label>
      <select id="sheet-time" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="4/4" selected>4/4 (Common Time)</option>
        <option value="3/4">3/4 (Waltz)</option>
        <option value="2/4">2/4 (March)</option>
        <option value="6/8">6/8 (Compound)</option>
        <option value="cut">Â¢ (Cut Time)</option>
      </select>
    </div>

    <div class="field">
      <label for="sheet-level" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
        <span style="font-size:18px;">ğŸ“Š</span> Difficulty Level
      </label>
      <select id="sheet-level" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="beginner" selected>Beginner</option>
        <option value="intermediate">Intermediate</option>
        <option value="advanced">Advanced</option>
      </select>
    </div>
  </div>

  <div style="background:rgba(255,107,107,0.05);border-radius:8px;padding:16px;margin-bottom:20px;border:1px solid rgba(255,107,107,0.1);">
    <label style="display:flex;align-items:center;gap:8px;margin-bottom:12px;color:#ff6b6b;font-weight:600;">
      <input type="checkbox" id="sheet-show-advanced" style="accent-color:#ff6b6b;">
      Show Advanced Options
    </label>
    
    <div id="advanced-options" style="display:none;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
      <div class="field">
        <label for="sheet-dynamics" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
          <span style="font-size:18px;">ğŸšï¸</span> Dynamics
        </label>
        <select id="sheet-dynamics" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="basic">Basic (p, mf, f)</option>
          <option value="full">Full Range (ppp to fff)</option>
          <option value="crescendo">With Crescendo/Diminuendo</option>
        </select>
      </div>
      
      <div class="field">
        <label for="sheet-articulation" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
          <span style="font-size:18px;">ğŸµ</span> Articulation
        </label>
        <select id="sheet-articulation" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="legato">Legato (Smooth)</option>
          <option value="staccato">Staccato (Short)</option>
          <option value="mixed">Mixed Articulation</option>
        </select>
      </div>
      
      <div class="field">
        <label for="sheet-show-facts" style="display:flex;align-items:center;gap:6px;margin-bottom:6px;">
          <span style="font-size:18px;">ğŸ“š</span> Educational Notes
        </label>
        <select id="sheet-show-facts" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="yes" selected>Show Educational Notes</option>
          <option value="no">Hide Educational Notes</option>
        </select>
      </div>
    </div>
  </div>

  <div class="actions" style="display:flex;gap:12px;margin-top:24px;">
    <button type="button" onclick="sheetGenerate(this)" 
            style="flex:1;padding:14px 20px;background:linear-gradient(135deg, rgba(255,107,107,0.2), rgba(255,107,107,0.1));border:1px solid rgba(255,107,107,0.4);border-radius:8px;color:#ff6b6b;cursor:pointer;font-weight:600;font-size:16px;">
      ğŸ¼ Generate Sheet Music Reference
    </button>
    <button type="button" class="secondary" onclick="sheetReset(this)"
            style="padding:14px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      ğŸ”„ Reset All
    </button>
    <button type="button" onclick="sheetCopy(this)"
            style="padding:14px 20px;background:rgba(74,144,226,0.1);border:1px solid rgba(74,144,226,0.3);border-radius:8px;color:#4a90e2;cursor:pointer;">
      ğŸ“‹ Copy to Clipboard
    </button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:24px;">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
    <h3 class="small" style="color:#ff6b6b;margin:0;display:flex;align-items:center;gap:8px;">
      <span style="font-size:20px;">ğŸ“„</span> Generated Sheet Music Reference
    </h3>
    <div id="sheet-hint" style="font-size:12px;color:rgba(230,250,255,0.7);"></div>
  </div>

  <div style="background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(255,255,255,0.1);padding:20px;margin-bottom:20px;">
    <div id="sheet-output" style="min-height:200px;white-space:pre-wrap;font-family:'Courier New', monospace;line-height:1.6;color:rgba(230,250,255,0.9);padding:16px;background:rgba(0,0,0,0.3);border-radius:6px;overflow-x:auto;">
      {/* Output will appear here */}
    </div>
    
    <div style="display:flex;gap:12px;margin-top:16px;">
      <button onclick="sheetDownload()" style="flex:1;padding:10px;background:rgba(255,107,107,0.1);border:1px solid rgba(255,107,107,0.3);border-radius:6px;color:#ff6b6b;cursor:pointer;">
        ğŸ’¾ Download as .txt
      </button>
      <button onclick="sheetPrint()" style="flex:1;padding:10px;background:rgba(74,144,226,0.1);border:1px solid rgba(74,144,226,0.3);border-radius:6px;color:#4a90e2;cursor:pointer;">
        ğŸ–¨ï¸ Print Reference
      </button>
    </div>
  </div>

  <div id="sheet-facts-container" style="margin-top:20px;display:none;">
    <div style="background:rgba(255,193,7,0.05);border-radius:8px;padding:20px;border:1px solid rgba(255,193,7,0.1);">
      <h4 style="color:#ffc107;margin:0 0 12px 0;font-size:16px;display:flex;align-items:center;gap:8px;">
        <span style="font-size:20px;">ğŸ“š</span> Music Theory Notes
      </h4>
      
      <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:16px;">
        <div style="background:rgba(0,0,0,0.3);border-radius:6px;padding:16px;">
          <h5 style="color:#ff6b6b;margin:0 0 8px 0;font-size:14px;">ğŸ¹ Key Signatures</h5>
          <ul style="list-style:none;padding:0;margin:0;font-size:13px;line-height:1.5;color:rgba(230,250,255,0.8);">
            <li>â€¢ Major keys follow circle of fifths pattern</li>
            <li>â€¢ Sharps: Fâ™¯, Câ™¯, Gâ™¯, Dâ™¯, Aâ™¯, Eâ™¯, Bâ™¯</li>
            <li>â€¢ Flats: Bâ™­, Eâ™­, Aâ™­, Dâ™­, Gâ™­, Câ™­, Fâ™­</li>
            <li>â€¢ Relative minor shares key signature</li>
          </ul>
        </div>
        
        <div style="background:rgba(0,0,0,0.3);border-radius:6px;padding:16px;">
          <h5 style="color:#4a90e2;margin:0 0 8px 0;font-size:14px;">ğŸ¼ Notation Symbols</h5>
          <ul style="list-style:none;padding:0;margin:0;font-size:13px;line-height:1.5;color:rgba(230,250,255,0.8);">
            <li>â€¢ ğ„ Treble clef: Notes above middle C</li>
            <li>â€¢ ğ„¢ Bass clef: Notes below middle C</li>
            <li>â€¢ â™© Quarter note = 1 beat in 4/4</li>
            <li>â€¢ ğ…—ğ…¥ Half note = 2 beats</li>
            <li>â€¢ ğ… Whole note = 4 beats</li>
          </ul>
        </div>
        
        <div style="background:rgba(0,0,0,0.3);border-radius:6px;padding:16px;">
          <h5 style="color:#ffc107;margin:0 0 8px 0;font-size:14px;">ğŸ¶ Practice Tips</h5>
          <ul style="list-style:none;padding:0;margin:0;font-size:13px;line-height:1.5;color:rgba(230,250,255,0.8);">
            <li>â€¢ Start slowly with metronome</li>
            <li>â€¢ Practice hands separately first</li>
            <li>â€¢ Focus on rhythm accuracy</li>
            <li>â€¢ Use proper fingering</li>
            <li>â€¢ Listen for even tone quality</li>
          </ul>
        </div>
      </div>
      
      <div style="margin-top:16px;padding:12px;background:rgba(255,107,107,0.1);border-radius:6px;border-left:4px solid #ff6b6b;">
        <div style="display:flex;align-items:center;gap:8px;color:#ff6b6b;font-size:14px;">
          <span style="font-size:18px;">âš ï¸</span>
          <strong>Important Reminder</strong>
        </div>
        <p style="margin:8px 0 0 0;font-size:12px;color:rgba(230,250,255,0.7);">
          This tool provides educational references only. Always verify sheet music accuracy with a qualified music teacher or professional resource. Practice with proper guidance to develop correct technique.
        </p>
      </div>
    </div>
  </div>
</div>

<script>
/* sheet-music.html - Enhanced Version
   - Professional sheet music reference generator
   - Scoped with sheet- prefix
   - No .card references
*/

// Music theory database
const sheetMusicDB = {
  keys: {
    'C': { name: 'C Major', sharps: 0, flats: 0, notes: ['C', 'D', 'E', 'F', 'G', 'A', 'B'] },
    'G': { name: 'G Major', sharps: 1, flats: 0, notes: ['G', 'A', 'B', 'C', 'D', 'E', 'Fâ™¯'] },
    'D': { name: 'D Major', sharps: 2, flats: 0, notes: ['D', 'E', 'Fâ™¯', 'G', 'A', 'B', 'Câ™¯'] },
    'F': { name: 'F Major', sharps: 0, flats: 1, notes: ['F', 'G', 'A', 'Bâ™­', 'C', 'D', 'E'] },
    'Bb': { name: 'Bb Major', sharps: 0, flats: 2, notes: ['Bâ™­', 'C', 'D', 'Eâ™­', 'F', 'G', 'A'] },
    'Am': { name: 'A Minor', sharps: 0, flats: 0, notes: ['A', 'B', 'C', 'D', 'E', 'F', 'G'] },
    'Em': { name: 'E Minor', sharps: 1, flats: 0, notes: ['E', 'Fâ™¯', 'G', 'A', 'B', 'C', 'D'] },
    'Dm': { name: 'D Minor', sharps: 0, flats: 1, notes: ['D', 'E', 'F', 'G', 'A', 'Bâ™­', 'C'] }
  },
  tempos: {
    'largo': { name: 'Largo', bpm: '40-60', desc: 'Very slow and broad' },
    'adagio': { name: 'Adagio', bpm: '66-76', desc: 'Slow and stately' },
    'andante': { name: 'Andante', bpm: '76-108', desc: 'Walking pace' },
    'moderato': { name: 'Moderato', bpm: '108-120', desc: 'Moderate speed' },
    'allegro': { name: 'Allegro', bpm: '120-168', desc: 'Fast, cheerful' },
    'presto': { name: 'Presto', bpm: '168-200', desc: 'Very fast' }
  },
  exercises: {
    'scale': 'Scale Exercise: Focus on even tone, consistent tempo, and smooth transitions between notes.',
    'scale-3oct': 'Three-Octave Scale: Develops range, finger independence, and position shifts.',
    'arpeggio': 'Arpeggio Exercise: Improves chord recognition, hand coordination, and fluid motion.',
    'exercise': 'Technical Exercise: Targets specific technique issues like finger strength or agility.',
    'melody': 'Simple Melody: Develops phrasing, expression, and musical interpretation.',
    'chord-progression': 'Chord Progression: Practices harmony, voice leading, and chord changes.',
    'sight-reading': 'Sight Reading: Improves note recognition, rhythm reading, and overall musicianship.'
  }
};

// Initialize advanced options toggle
document.addEventListener('DOMContentLoaded', function() {
  const toggle = document.querySelector('#sheet-show-advanced');
  const advanced = document.querySelector('#advanced-options');
  
  if (toggle && advanced) {
    toggle.addEventListener('change', function() {
      if (this.checked) {
        advanced.style.display = 'grid';
      } else {
        advanced.style.display = 'none';
      }
    });
  }
  
  // Set default date for any date inputs
  const dateInputs = document.querySelectorAll('input[type="date"]');
  const today = new Date().toISOString().split('T')[0];
  dateInputs.forEach(input => {
    if (!input.value) input.value = today;
  });
});

function sheetReset(btn){
  // Remove .card reference
  const form = btn.closest('form');
  form.reset();
  
  // Reset advanced options
  const advanced = document.querySelector('#advanced-options');
  if (advanced) advanced.style.display = 'none';
  
  // Clear output
  document.querySelector('#sheet-output').textContent = '';
  document.querySelector('#sheet-hint').textContent = '';
  document.querySelector('#sheet-facts-container').style.display = 'none';
  
  // Show confirmation
  const hint = document.querySelector('#sheet-hint');
  hint.textContent = 'âœ… All fields reset';
  hint.style.color = '#4a90e2';
  setTimeout(() => { hint.textContent = ''; }, 2000);
}

function sheetCopy(btn){
  const out = document.querySelector('#sheet-output').textContent;
  if(!out.trim()) {
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âŒ No content to copy';
    hint.style.color = '#ff6b6b';
    setTimeout(() => { hint.textContent = ''; }, 2000);
    return;
  }
  
  if(navigator.clipboard){
    navigator.clipboard.writeText(out).then(() => {
      const hint = document.querySelector('#sheet-hint');
      hint.textContent = 'âœ… Copied to clipboard';
      hint.style.color = '#4a90e2';
      setTimeout(() => { hint.textContent = ''; }, 2000);
    }).catch(err => {
      console.error('Copy failed:', err);
      sheetCopyFallback(out);
    });
  } else {
    sheetCopyFallback(out);
  }
}

function sheetCopyFallback(text) {
  const textArea = document.createElement('textarea');
  textArea.value = text;
  document.body.appendChild(textArea);
  textArea.select();
  try {
    document.execCommand('copy');
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âœ… Copied (fallback method)';
    hint.style.color = '#4a90e2';
    setTimeout(() => { hint.textContent = ''; }, 2000);
  } catch (err) {
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âŒ Press Ctrl+C to copy';
    hint.style.color = '#ff6b6b';
    setTimeout(() => { hint.textContent = ''; }, 3000);
  }
  document.body.removeChild(textArea);
}

function sheetGenerate(btn){
  // Get all values
  const keyValue = document.querySelector('#sheet-key').value;
  const typeValue = document.querySelector('#sheet-type').value;
  const clefValue = document.querySelector('#sheet-clef').value;
  const tempoValue = document.querySelector('#sheet-tempo').value;
  const timeValue = document.querySelector('#sheet-time').value;
  const levelValue = document.querySelector('#sheet-level').value;
  const showFacts = document.querySelector('#sheet-show-facts')?.value === 'yes' || false;
  
  // Get advanced options if visible
  let dynamicsValue = 'basic';
  let articulationValue = 'legato';
  if (document.querySelector('#sheet-show-advanced')?.checked) {
    dynamicsValue = document.querySelector('#sheet-dynamics')?.value || 'basic';
    articulationValue = document.querySelector('#sheet-articulation')?.value || 'legato';
  }
  
  // Validate
  if (!keyValue || !typeValue) {
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âŒ Please select key and notation type';
    hint.style.color = '#ff6b6b';
    return;
  }
  
  // Get data from database
  const keyInfo = sheetMusicDB.keys[keyValue] || sheetMusicDB.keys['C'];
  const tempoInfo = sheetMusicDB.tempos[tempoValue] || sheetMusicDB.tempos['andante'];
  const exerciseDesc = sheetMusicDB.exercises[typeValue] || sheetMusicDB.exercises['scale'];
  
  // Generate detailed reference
  let output = '';
  output += '='.repeat(60) + '\n';
  output += 'SHEET MUSIC REFERENCE\n';
  output += '='.repeat(60) + '\n\n';
  
  output += `ğŸ¹ KEY: ${keyInfo.name}\n`;
  output += `   â€¢ Accidentals: ${keyInfo.sharps > 0 ? keyInfo.sharps + ' sharp(s)' : keyInfo.flats > 0 ? keyInfo.flats + ' flat(s)' : 'None'}\n`;
  output += `   â€¢ Notes in scale: ${keyInfo.notes.join(' - ')}\n\n`;
  
  output += `ğŸ“ NOTATION TYPE: ${typeValue.toUpperCase()}\n`;
  output += `   â€¢ ${exerciseDesc}\n\n`;
  
  output += `ğŸ¼ CLEF: ${clefValue === 'treble' ? 'Treble Clef (ğ„)' : clefValue === 'bass' ? 'Bass Clef (ğ„¢)' : clefValue === 'alto' ? 'Alto Clef' : 'Grand Staff'}\n`;
  output += `   â€¢ Range: ${clefValue === 'treble' ? 'Middle C and above' : clefValue === 'bass' ? 'Middle C and below' : 'Both hands'}\n\n`;
  
  output += `ğŸ¶ TEMPO: ${tempoInfo.name} (${tempoInfo.bpm} BPM)\n`;
  output += `   â€¢ Character: ${tempoInfo.desc}\n\n`;
  
  output += `â±ï¸ TIME SIGNATURE: ${timeValue}\n`;
  output += `   â€¢ Beat pattern: ${timeValue === '4/4' ? 'Four quarter notes per measure' : 
                               timeValue === '3/4' ? 'Three quarter notes per measure' :
                               timeValue === '6/8' ? 'Six eighth notes per measure' :
                               timeValue === 'cut' ? 'Two half notes per measure' : 'Two quarter notes per measure'}\n\n`;
  
  output += `ğŸ“Š DIFFICULTY: ${levelValue.toUpperCase()}\n`;
  output += `   â€¢ Practice focus: ${levelValue === 'beginner' ? 'Accuracy and consistency' :
                                   levelValue === 'intermediate' ? 'Expression and dynamics' :
                                   'Musicality and technical mastery'}\n\n`;
  
  if (document.querySelector('#sheet-show-advanced')?.checked) {
    output += `ğŸšï¸ DYNAMICS: ${dynamicsValue.toUpperCase()}\n`;
    output += `   â€¢ Range: ${dynamicsValue === 'basic' ? 'p (soft) - mf (medium) - f (loud)' :
                                dynamicsValue === 'full' ? 'ppp (very soft) to fff (very loud)' :
                                'Gradual changes with crescendo/diminuendo'}\n\n`;
    
    output += `ğŸµ ARTICULATION: ${articulationValue.toUpperCase()}\n`;
    output += `   â€¢ Style: ${articulationValue === 'legato' ? 'Smooth and connected' :
                                   articulationValue === 'staccato' ? 'Short and detached' :
                                   'Varied articulation for expression'}\n\n`;
  }
  
  output += 'ğŸ“‹ PRACTICE INSTRUCTIONS:\n';
  output += '1. Start with slow, deliberate practice\n';
  output += '2. Use a metronome to maintain steady tempo\n';
  output += '3. Focus on proper hand position and posture\n';
  output += '4. Practice hands separately before combining\n';
  output += '5. Gradually increase tempo as comfort improves\n';
  output += '6. Listen carefully for even tone quality\n\n';
  
  output += 'âš ï¸ IMPORTANT NOTES:\n';
  output += 'â€¢ This is an educational reference only\n';
  output += 'â€¢ Always verify with a qualified music teacher\n';
  output += 'â€¢ Practice with proper technique to avoid injury\n';
  output += 'â€¢ Take regular breaks during practice sessions\n\n';
  
  output += '='.repeat(60) + '\n';
  output += `Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}\n`;
  output += '='.repeat(60);
  
  // Display output
  const outputElement = document.querySelector('#sheet-output');
  outputElement.textContent = output;
  
  // Show educational notes if selected
  document.querySelector('#sheet-facts-container').style.display = showFacts ? 'block' : 'none';
  
  // Show success message
  const hint = document.querySelector('#sheet-hint');
  hint.textContent = `âœ… Reference generated for ${keyInfo.name} ${typeValue}`;
  hint.style.color = '#4a90e2';
}

function sheetDownload() {
  const out = document.querySelector('#sheet-output').textContent;
  if(!out.trim()) {
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âŒ No content to download';
    hint.style.color = '#ff6b6b';
    setTimeout(() => { hint.textContent = ''; }, 2000);
    return;
  }
  
  const keyValue = document.querySelector('#sheet-key').value;
  const keyInfo = sheetMusicDB.keys[keyValue] || sheetMusicDB.keys['C'];
  const typeValue = document.querySelector('#sheet-type').value;
  
  const filename = `sheet-music-${keyInfo.name.replace(/\s+/g, '-')}-${typeValue}-${new Date().toISOString().slice(0,10)}.txt`;
  const blob = new Blob([out], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  const hint = document.querySelector('#sheet-hint');
  hint.textContent = `âœ… Downloaded as ${filename}`;
  hint.style.color = '#4a90e2';
  setTimeout(() => { hint.textContent = ''; }, 3000);
}

function sheetPrint() {
  const out = document.querySelector('#sheet-output').textContent;
  if(!out.trim()) {
    const hint = document.querySelector('#sheet-hint');
    hint.textContent = 'âŒ No content to print';
    hint.style.color = '#ff6b6b';
    setTimeout(() => { hint.textContent = ''; }, 2000);
    return;
  }
  
  const printWindow = window.open('', '_blank');
  const keyValue = document.querySelector('#sheet-key').value;
  const keyInfo = sheetMusicDB.keys[keyValue] || sheetMusicDB.keys['C'];
  const typeValue = document.querySelector('#sheet-type').value;
  
  printWindow.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Sheet Music Reference - ${keyInfo.name} ${typeValue}</title>
      <style>
        body { font-family: 'Courier New', monospace; margin: 20px; line-height: 1.6; }
        .header { text-align: center; margin-bottom: 30px; }
        .title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
        .subtitle { font-size: 14px; color: #666; margin-bottom: 20px; }
        .section { margin-bottom: 20px; }
        .section-title { font-weight: bold; border-bottom: 2px solid #000; padding-bottom: 5px; margin-bottom: 10px; }
        .note { background: #f5f5f5; padding: 15px; border-left: 4px solid #ff6b6b; margin: 20px 0; }
        .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
        @media print {
          body { margin: 0; }
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <div class="title">Sheet Music Reference</div>
        <div class="subtitle">${keyInfo.name} â€¢ ${typeValue.toUpperCase()}</div>
        <div class="subtitle">Generated: ${new Date().toLocaleDateString()}</div>
      </div>
      <pre>${out}</pre>
      <div class="footer">
        <p>âš ï¸ Educational reference only. Verify with qualified music teacher.</p>
      </div>
      <script>
        setTimeout(() => { window.print(); }, 500);
      <\/script>
    </body>
    </html>
  `);
  
  printWindow.document.close();
  
  const hint = document.querySelector('#sheet-hint');
  hint.textContent = 'âœ… Opening print preview...';
  hint.style.color = '#4a90e2';
  setTimeout(() => { hint.textContent = ''; }, 2000);
}
</script>

<style>
/* Enhanced styles */
#sheet-music-title {
  background: linear-gradient(45deg, #ff6b6b, #4a90e2);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-top: 0;
  margin-bottom: 8px;
  font-size: 28px;
}

/* Smooth transitions */
.field select, .field input, .field textarea {
  transition: all 0.3s ease;
}

.field select:focus, .field input:focus, .field textarea:focus {
  border-color: #4a90e2 !important;
  box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
  outline: none;
}

/* Button animations */
button {
  transition: all 0.3s ease;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

/* Responsive design */
@media (max-width: 768px) {
  .row {
    grid-template-columns: 1fr !important;
  }
  
  .actions {
    flex-direction: column;
  }
  
  .actions button {
    width: 100%;
    margin: 4px 0 !important;
  }
  
  #sheet-facts-container > div > div {
    grid-template-columns: 1fr !important;
  }
}

/* Print styles */
@media print {
  .no-print, button, form, .actions {
    display: none !important;
  }
  
  #sheet-output {
    background: white !important;
    color: black !important;
    border: 1px solid #000 !important;
  }
}

/* Loading animation */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.loading {
  animation: pulse 1.5s infinite;
}
</style>
