<h2 id="resistor-color-code-title">üé® Resistor Color Code</h2>

<form aria-describedby="resistor-color-code-desc">
    <p id="resistor-color-code-desc" class="small" style="margin-bottom:20px;color:var(--muted)">
        Decode resistor color bands into resistance values. 
        <span style="color:var(--accent)">‚ö†Ô∏è Educational only ‚Äî verify with multimeter.</span>
    </p>
    
    <!-- MODE SELECTOR -->
    <div style="margin-bottom:20px;">
        <label for="rcc-mode" style="display:block;margin-bottom:8px;color:var(--accent);font-size:14px;">
            Resistor Type
        </label>
        <select id="rcc-mode" onchange="rccUpdateBands()" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--glass);color:inherit;">
            <option value="4" selected>4-band (common)</option>
            <option value="5">5-band (precision)</option>
            <option value="6">6-band (with temperature coefficient)</option>
        </select>
    </div>
    
    <!-- BAND SELECTORS -->
    <div id="rcc-bands-container" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:12px;margin-bottom:20px;">
        <!-- Bands will be generated here -->
    </div>
    
    <!-- QUICK PRESETS -->
    <div style="margin-bottom:20px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:8px;font-size:14px;">Common Values:</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="rccSetPreset('1k')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">1K Œ©</button>
            <button type="button" onclick="rccSetPreset('10k')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">10K Œ©</button>
            <button type="button" onclick="rccSetPreset('100k')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">100K Œ©</button>
            <button type="button" onclick="rccSetPreset('220')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">220 Œ©</button>
            <button type="button" onclick="rccSetPreset('470')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">470 Œ©</button>
            <button type="button" onclick="rccSetPreset('4.7k')" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">4.7K Œ©</button>
        </div>
    </div>
    
    <!-- ACTION BUTTONS -->
    <div style="display:flex;gap:10px;">
        <button type="button" onclick="rccCalculate()" 
                style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.3), rgba(45,212,255,0.2));border:1px solid rgba(45,212,255,0.6);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
            üîç Decode
        </button>
        <button type="button" onclick="rccReset()"
                style="padding:14px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            üîÑ Reset
        </button>
        <button type="button" onclick="rccCopy()"
                style="padding:14px 20px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;">
            üìã Copy
        </button>
    </div>
</form>

<!-- RESULTS -->
<div id="rcc-results" style="margin-top:24px;display:none;">
    <h3 style="color:var(--accent);margin-bottom:16px;font-size:16px;">üìä Resistor Value</h3>
    
    <!-- VISUAL BANDS -->
    <div id="rcc-visual-bands" style="display:flex;gap:4px;margin-bottom:20px;justify-content:center;">
        <!-- Visual bands will appear here -->
    </div>
    
    <!-- QUICK RESULTS -->
    <div style="margin-bottom:20px;">
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;text-align:center;">
                <div style="font-size:24px;font-weight:bold;color:#39ff14;" id="rcc-nominal">0 Œ©</div>
                <div style="font-size:11px;color:var(--muted);">Nominal Value</div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;text-align:center;">
                <div style="font-size:20px;font-weight:bold;color:var(--accent);" id="rcc-tolerance">¬±0%</div>
                <div style="font-size:11px;color:var(--muted);">Tolerance</div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;text-align:center;">
                <div style="font-size:18px;font-weight:bold;color:#ffcc00;" id="rcc-range">0 Œ©</div>
                <div style="font-size:11px;color:var(--muted);">Min-Max Range</div>
            </div>
        </div>
    </div>
    
    <!-- DETAILED OUTPUT -->
    <div style="margin-bottom:20px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:12px;">üìù Analysis</div>
        <textarea id="rcc-output" rows="6" 
                  style="width:100%;padding:12px;border-radius:8px;border:1px solid var(--border);background:var(--glass);color:inherit;font-family:monospace;resize:vertical;"></textarea>
    </div>
    
    <!-- FACTS -->
    <div id="rcc-facts" style="margin-bottom:20px;">
        <div style="color:#39ff14;font-weight:500;margin-bottom:12px;">üìö Color Code Facts</div>
        <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;border-left:3px solid #39ff14;">
            <ul style="margin:0;padding-left:20px;color:var(--muted);">
                <li style="margin-bottom:6px;">IEC 60062 defines resistor color codes worldwide</li>
                <li style="margin-bottom:6px;">4-band codes are most common in consumer electronics</li>
                <li style="margin-bottom:6px;">5-band codes are used for precision resistors (¬±1% or better)</li>
                <li style="margin-bottom:6px;">6th band indicates temperature coefficient (ppm/¬∞C)</li>
                <li style="margin-bottom:6px;">Gold/Silver bands indicate ¬±5% or ¬±10% tolerance</li>
                <li>‚ö†Ô∏è Always verify with multimeter before use in circuits</li>
            </ul>
        </div>
    </div>
    
    <!-- STATUS -->
    <div style="text-align:center;">
        <div id="rcc-hint" style="font-size:13px;color:var(--muted);"></div>
    </div>
</div>

<script>
/* resistor-color-code.html
   - Resistor color band decoder
   - Scoped with rcc- prefix
*/

// Color definitions with proper values
const rccColorData = {
    black:   { digit: 0, multiplier: 1,     tolerance: null, tempCoeff: null,   hex: '#000000' },
    brown:   { digit: 1, multiplier: 10,    tolerance: 1,    tempCoeff: 100,    hex: '#8B4513' },
    red:     { digit: 2, multiplier: 100,   tolerance: 2,    tempCoeff: 50,     hex: '#FF0000' },
    orange:  { digit: 3, multiplier: 1000,  tolerance: null, tempCoeff: 15,     hex: '#FFA500' },
    yellow:  { digit: 4, multiplier: 10000, tolerance: null, tempCoeff: 25,     hex: '#FFFF00' },
    green:   { digit: 5, multiplier: 100000,tolerance: 0.5,  tempCoeff: null,   hex: '#008000' },
    blue:    { digit: 6, multiplier: 1000000,tolerance: 0.25,tempCoeff: 10,     hex: '#0000FF' },
    violet:  { digit: 7, multiplier: 10000000,tolerance: 0.1,tempCoeff: 5,      hex: '#800080' },
    gray:    { digit: 8, multiplier: 100000000,tolerance: 0.05,tempCoeff: null, hex: '#808080' },
    white:   { digit: 9, multiplier: 1000000000,tolerance: null,tempCoeff: null,hex: '#FFFFFF' },
    gold:    { digit: null,multiplier: 0.1, tolerance: 5,    tempCoeff: null,   hex: '#FFD700' },
    silver:  { digit: null,multiplier: 0.01,tolerance: 10,   tempCoeff: null,   hex: '#C0C0C0' }
};

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', rccInit);
} else {
    rccInit();
}

function rccInit() {
    console.log('Resistor Color Code initialized');
    rccUpdateBands();
    
    // Load last settings if available
    const saved = localStorage.getItem('rcc-settings');
    if (saved) {
        try {
            const settings = JSON.parse(saved);
            document.getElementById('rcc-mode').value = settings.mode || '4';
            rccUpdateBands();
        } catch (e) {
            console.error('Failed to load settings:', e);
        }
    }
}

// Update band inputs based on selected mode
function rccUpdateBands() {
    const mode = document.getElementById('rcc-mode').value;
    const container = document.getElementById('rcc-bands-container');
    
    let html = '';
    const bandCount = parseInt(mode);
    
    // Define band labels and types
    const bandConfigs = [
        { label: 'Band 1', type: 'digit' },
        { label: 'Band 2', type: 'digit' },
        { label: 'Band 3', type: bandCount === 4 ? 'multiplier' : 'digit' },
        { label: 'Band 4', type: bandCount === 4 ? 'tolerance' : 'multiplier' },
        { label: 'Band 5', type: 'tolerance' },
        { label: 'Band 6', type: 'tempCoeff' }
    ];
    
    // Generate band inputs
    for (let i = 0; i < bandCount; i++) {
        const config = bandConfigs[i];
        html += `
            <div>
                <label style="display:block;margin-bottom:6px;color:var(--accent);font-size:14px;">
                    ${config.label}
                </label>
                <select id="rcc-band-${i+1}" style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--glass);color:inherit;">
                    ${rccGetOptions(config.type)}
                </select>
            </div>
        `;
    }
    
    container.innerHTML = html;
    
    // Save mode selection
    localStorage.setItem('rcc-settings', JSON.stringify({ mode: mode }));
}

// Get options for band type
function rccGetOptions(type) {
    let options = '';
    
    switch(type) {
        case 'digit':
            options = `
                <option value="black">Black (0)</option>
                <option value="brown">Brown (1)</option>
                <option value="red">Red (2)</option>
                <option value="orange">Orange (3)</option>
                <option value="yellow">Yellow (4)</option>
                <option value="green">Green (5)</option>
                <option value="blue">Blue (6)</option>
                <option value="violet">Violet (7)</option>
                <option value="gray">Gray (8)</option>
                <option value="white">White (9)</option>
            `;
            break;
            
        case 'multiplier':
            options = `
                <option value="black">Black (√ó1)</option>
                <option value="brown">Brown (√ó10)</option>
                <option value="red">Red (√ó100)</option>
                <option value="orange">Orange (√ó1K)</option>
                <option value="yellow">Yellow (√ó10K)</option>
                <option value="green">Green (√ó100K)</option>
                <option value="blue">Blue (√ó1M)</option>
                <option value="violet">Violet (√ó10M)</option>
                <option value="gold">Gold (√ó0.1)</option>
                <option value="silver">Silver (√ó0.01)</option>
            `;
            break;
            
        case 'tolerance':
            options = `
                <option value="brown">Brown (¬±1%)</option>
                <option value="red">Red (¬±2%)</option>
                <option value="green">Green (¬±0.5%)</option>
                <option value="blue">Blue (¬±0.25%)</option>
                <option value="violet">Violet (¬±0.1%)</option>
                <option value="gray">Gray (¬±0.05%)</option>
                <option value="gold" selected>Gold (¬±5%)</option>
                <option value="silver">Silver (¬±10%)</option>
            `;
            break;
            
        case 'tempCoeff':
            options = `
                <option value="brown">Brown (100ppm/¬∞C)</option>
                <option value="red">Red (50ppm/¬∞C)</option>
                <option value="orange">Orange (15ppm/¬∞C)</option>
                <option value="yellow">Yellow (25ppm/¬∞C)</option>
                <option value="blue">Blue (10ppm/¬∞C)</option>
                <option value="violet">Violet (5ppm/¬∞C)</option>
            `;
            break;
    }
    
    return options;
}

// Set preset values
function rccSetPreset(value) {
    // Set to 4-band mode for presets
    document.getElementById('rcc-mode').value = '4';
    rccUpdateBands();
    
    let colors = [];
    
    switch(value) {
        case '1k':
            colors = ['brown', 'black', 'red', 'gold'];
            break;
        case '10k':
            colors = ['brown', 'black', 'orange', 'gold'];
            break;
        case '100k':
            colors = ['brown', 'black', 'yellow', 'gold'];
            break;
        case '220':
            colors = ['red', 'red', 'brown', 'gold'];
            break;
        case '470':
            colors = ['yellow', 'violet', 'brown', 'gold'];
            break;
        case '4.7k':
            colors = ['yellow', 'violet', 'red', 'gold'];
            break;
    }
    
    // Apply colors to bands
    colors.forEach((color, index) => {
        const select = document.getElementById(`rcc-band-${index + 1}`);
        if (select) select.value = color;
    });
    
    rccShowMessage(`Set to ${value} Œ©`, 'info');
}

// Main calculation function
function rccCalculate() {
    const mode = document.getElementById('rcc-mode').value;
    const bandCount = parseInt(mode);
    
    // Get selected colors
    const colors = [];
    for (let i = 1; i <= bandCount; i++) {
        const select = document.getElementById(`rcc-band-${i}`);
        if (select) {
            colors.push(select.value);
        }
    }
    
    if (colors.length !== bandCount) {
        rccShowMessage('Select all band colors', 'warning');
        return;
    }
    
    // Calculate resistance
    const result = rccCalculateResistance(colors, bandCount);
    
    // Display results
    rccDisplayResults(result, colors, bandCount);
    
    // Show results section
    document.getElementById('rcc-results').style.display = 'block';
    
    rccShowMessage('Resistor decoded!', 'success');
}

// Calculate resistance from colors
function rccCalculateResistance(colors, bandCount) {
    let digits = '';
    let multiplier = 1;
    let tolerance = 5; // Default
    let tempCoeff = null;
    
    if (bandCount === 4) {
        // 4-band: digit, digit, multiplier, tolerance
        digits = rccColorData[colors[0]].digit.toString() + 
                rccColorData[colors[1]].digit.toString();
        multiplier = rccColorData[colors[2]].multiplier;
        tolerance = rccColorData[colors[3]].tolerance || tolerance;
    } else if (bandCount === 5) {
        // 5-band: digit, digit, digit, multiplier, tolerance
        digits = rccColorData[colors[0]].digit.toString() + 
                rccColorData[colors[1]].digit.toString() + 
                rccColorData[colors[2]].digit.toString();
        multiplier = rccColorData[colors[3]].multiplier;
        tolerance = rccColorData[colors[4]].tolerance || tolerance;
    } else if (bandCount === 6) {
        // 6-band: digit, digit, digit, multiplier, tolerance, tempCoeff
        digits = rccColorData[colors[0]].digit.toString() + 
                rccColorData[colors[1]].digit.toString() + 
                rccColorData[colors[2]].digit.toString();
        multiplier = rccColorData[colors[3]].multiplier;
        tolerance = rccColorData[colors[4]].tolerance || tolerance;
        tempCoeff = rccColorData[colors[5]].tempCoeff;
    }
    
    const nominal = parseInt(digits) * multiplier;
    const min = nominal * (1 - tolerance/100);
    const max = nominal * (1 + tolerance/100);
    
    return {
        nominal: nominal,
        tolerance: tolerance,
        tempCoeff: tempCoeff,
        min: min,
        max: max,
        colors: colors
    };
}

// Display results
function rccDisplayResults(result, colors, bandCount) {
    // Update quick results
    document.getElementById('rcc-nominal').textContent = rccFormatResistance(result.nominal);
    document.getElementById('rcc-tolerance').textContent = `¬±${result.tolerance}%`;
    document.getElementById('rcc-range').textContent = 
        `${rccFormatResistance(result.min)} ‚Äì ${rccFormatResistance(result.max)}`;
    
    // Create visual bands
    const visualContainer = document.getElementById('rcc-visual-bands');
    let visualHTML = '';
    
    colors.forEach((color, index) => {
        const hex = rccColorData[color].hex;
        visualHTML += `
            <div style="position:relative;">
                <div style="width:20px;height:50px;background:${hex};border-radius:2px;border:1px solid rgba(255,255,255,0.1);"></div>
                <div style="position:absolute;bottom:-20px;left:0;right:0;text-align:center;font-size:10px;color:var(--muted);">
                    B${index + 1}
                </div>
            </div>
        `;
    });
    
    visualContainer.innerHTML = visualHTML;
    
    // Generate detailed output
    let output = 'RESISTOR COLOR CODE DECODER\n';
    output += '='.repeat(40) + '\n\n';
    output += `Type: ${bandCount}-band resistor\n\n`;
    
    output += 'Band Analysis:\n';
    colors.forEach((color, index) => {
        const data = rccColorData[color];
        output += `  Band ${index + 1}: ${color.toUpperCase()}`;
        
        if (index < (bandCount === 4 ? 2 : 3)) {
            output += ` ‚Üí Digit: ${data.digit}\n`;
        } else if (index === (bandCount === 4 ? 2 : 3)) {
            output += ` ‚Üí Multiplier: √ó${data.multiplier}\n`;
        } else if (index === (bandCount === 4 ? 3 : 4)) {
            output += ` ‚Üí Tolerance: ¬±${data.tolerance}%\n`;
        } else if (index === 5) {
            output += ` ‚Üí Temp Coefficient: ${data.tempCoeff}ppm/¬∞C\n`;
        }
    });
    
    output += '\n' + '='.repeat(40) + '\n\n';
    output += `Nominal Resistance: ${rccFormatResistance(result.nominal)}\n`;
    output += `Tolerance: ¬±${result.tolerance}%\n`;
    output += `Range: ${rccFormatResistance(result.min)} ‚Äì ${rccFormatResistance(result.max)}\n`;
    
    if (result.tempCoeff) {
        output += `Temperature Coefficient: ${result.tempCoeff}ppm/¬∞C\n`;
    }
    
    output += '\n' + '='.repeat(40) + '\n';
    output += '‚ö†Ô∏è Always verify with multimeter before use in circuits.';
    
    document.getElementById('rcc-output').value = output;
    document.getElementById('rcc-hint').textContent = 'Decoded successfully';
    
    // Show facts
    document.getElementById('rcc-facts').style.display = 'block';
}

// Format resistance for display
function rccFormatResistance(ohms) {
    if (ohms >= 1000000) {
        return (ohms / 1000000).toFixed(3).replace(/\.?0+$/, '') + ' MŒ©';
    } else if (ohms >= 1000) {
        return (ohms / 1000).toFixed(3).replace(/\.?0+$/, '') + ' KŒ©';
    } else if (ohms >= 1) {
        return ohms.toFixed(2).replace(/\.?0+$/, '') + ' Œ©';
    } else if (ohms >= 0.001) {
        return (ohms * 1000).toFixed(2) + ' mŒ©';
    } else {
        return ohms.toFixed(2) + ' Œ©';
    }
}

// Copy results
function rccCopy() {
    const output = document.getElementById('rcc-output').value;
    if (!output || output.trim() === '') {
        rccShowMessage('No results to copy', 'warning');
        return;
    }
    
    navigator.clipboard.writeText(output).then(() => {
        document.getElementById('rcc-hint').textContent = 'Copied to clipboard!';
        setTimeout(() => {
            document.getElementById('rcc-hint').textContent = '';
        }, 2000);
        rccShowMessage('Results copied!', 'success');
    }).catch(err => {
        console.error('Copy failed:', err);
        rccShowMessage('Copy failed', 'error');
    });
}

// Reset calculator
function rccReset() {
    if (confirm('Reset all inputs?')) {
        document.getElementById('rcc-mode').value = '4';
        rccUpdateBands();
        document.getElementById('rcc-results').style.display = 'none';
        document.getElementById('rcc-hint').textContent = '';
        rccShowMessage('Reset complete', 'info');
    }
}

// Show message
function rccShowMessage(msg, type) {
    const colors = { success: '#39ff14', warning: '#ffcc00', error: '#ff2d55', info: '#2dd4ff' };
    
    // Remove existing
    const existing = document.querySelector('.rcc-msg');
    if (existing) existing.remove();
    
    // Create new
    const div = document.createElement('div');
    div.className = 'rcc-msg';
    div.textContent = msg;
    div.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        background: rgba(0,0,0,0.9);
        border: 1px solid ${colors[type]};
        border-radius: 8px;
        color: ${colors[type]};
        z-index: 10000;
        font-weight: 500;
        animation: rccSlideIn 0.3s ease-out;
    `;
    
    document.body.appendChild(div);
    
    setTimeout(() => {
        div.style.animation = 'rccSlideOut 0.3s ease-out';
        setTimeout(() => div.remove(), 300);
    }, 3000);
}

// Add animation styles
if (!document.querySelector('#rcc-styles')) {
    const style = document.createElement('style');
    style.id = 'rcc-styles';
    style.textContent = `
        @keyframes rccSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes rccSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        #rcc-output {
            font-family: monospace;
            line-height: 1.4;
        }
        
        #rcc-output::-webkit-scrollbar {
            width: 8px;
        }
        
        #rcc-output::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 4px;
        }
        
        #rcc-output::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 4px;
        }
    `;
    document.head.appendChild(style);
}
</script>

<style>
#resistor-color-code-title {
    color: var(--accent);
    margin-top: 0;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    #rcc-bands-container {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 10px !important;
    }
    
    #rcc-visual-bands {
        gap: 2px !important;
    }
    
    #rcc-visual-bands > div > div:first-child {
        width: 16px !important;
        height: 40px !important;
    }
    
    #rcc-output {
        font-size: 12px !important;
    }
    
    select, button {
        font-size: 16px !important; /* Prevents iOS zoom */
        min-height: 44px; /* Better touch target */
    }
    
    button {
        padding: 12px !important;
    }
}
</style>
