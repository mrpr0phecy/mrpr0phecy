<h2 id="ohms-law-title" style="margin-top:0;">Ohm's Law Calculator (General Advice)</h2>

<form aria-describedby="ohms-law-desc">
  <p id="ohms-law-desc" class="small">
    Calculate electrical values using Ohm's Law. ⚠️ Educational only — always verify with a qualified electrician and local standards.
  </p>

  <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
    <div class="field">
      <label for="ol-voltage">Voltage (V)</label>
      <input id="ol-voltage" type="number" placeholder="e.g. 230" style="width:100%;" step="any" />
    </div>

    <div class="field">
      <label for="ol-current">Current (A)</label>
      <input id="ol-current" type="number" placeholder="e.g. 5" style="width:100%;" step="any" />
    </div>

    <div class="field">
      <label for="ol-resistance">Resistance (Ω)</label>
      <input id="ol-resistance" type="number" placeholder="e.g. 46" style="width:100%;" step="any" />
    </div>

    <div class="field">
      <label for="ol-power">Power (W)</label>
      <input id="ol-power" type="number" placeholder="e.g. 1150" style="width:100%;" step="any" />
    </div>

    <div class="field">
      <label for="ol-show-facts">Show Ohm's Law Facts</label>
      <select id="ol-show-facts" style="width:100%;">
        <option value="yes" selected>Yes</option>
        <option value="no">No</option>
      </select>
    </div>
  </div>

  <div class="actions" style="margin-top:12px;">
    <button type="button" onclick="olCalculate(this)">Calculate</button>
    <button type="button" class="secondary" onclick="olReset(this)">Reset</button>
    <button type="button" onclick="olCopy(this)">Copy Result</button>
  </div>
</form>

<div id="ol-result-area" style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:6px; border-left:4px solid #4b6cb7; display:none;">
  <h4 style="margin-top:0; color:#182848;">Calculation Result</h4>
  <div id="ol-calculation-result"></div>
  <div id="ol-calculation-steps" style="background:white; padding:12px; border-radius:4px; margin-top:10px; border:1px solid #e9ecef; font-size:0.9em;"></div>
</div>

<div id="ol-facts-area" style="margin-top:20px; padding:15px; background:#e8f4f8; border-radius:6px; border-left:4px solid #17a2b8;">
  <h4 style="margin-top:0; color:#0c5460;">Ohm's Law Facts</h4>
  <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
    <div style="background:white; padding:10px; border-radius:4px;">
      <strong>The Formula</strong>
      <p style="margin:5px 0; font-size:0.9em;">V = I × R<br>Where V=Voltage, I=Current, R=Resistance</p>
    </div>
    <div style="background:white; padding:10px; border-radius:4px;">
      <strong>Power Formula</strong>
      <p style="margin:5px 0; font-size:0.9em;">P = V × I<br>Also: P = I²R = V²/R</p>
    </div>
    <div style="background:white; padding:10px; border-radius:4px;">
      <strong>History</strong>
      <p style="margin:5px 0; font-size:0.9em;">Discovered by Georg Simon Ohm in 1827 through electrical circuit experiments.</p>
    </div>
    <div style="background:white; padding:10px; border-radius:4px;">
      <strong>Applications</strong>
      <p style="margin:5px 0; font-size:0.9em;">Used in circuit design, wire sizing, component selection, and electrical troubleshooting.</p>
    </div>
  </div>
</div>

<script>
// Store the calculated result for copying
let olCurrentResult = '';

function olCalculate(button) {
  // Get input values
  const voltage = document.getElementById('ol-voltage').value;
  const current = document.getElementById('ol-current').value;
  const resistance = document.getElementById('ol-resistance').value;
  const power = document.getElementById('ol-power').value;
  
  // Count how many fields are filled
  const filledFields = [voltage, current, resistance, power].filter(value => value !== '').length;
  
  // Validate input
  if (filledFields < 2) {
    alert('Please enter at least two values to calculate the others.');
    return;
  }
  
  // Convert to numbers
  const V = parseFloat(voltage) || 0;
  const I = parseFloat(current) || 0;
  const R = parseFloat(resistance) || 0;
  const P = parseFloat(power) || 0;
  
  let resultV = V;
  let resultI = I;
  let resultR = R;
  let resultP = P;
  
  let calculationSteps = '<strong>Calculation Steps:</strong><br><br>';
  
  // Calculate missing values based on what's provided
  if (V > 0 && I > 0) {
    // V and I provided: Calculate R and P
    resultR = V / I;
    resultP = V * I;
    calculationSteps += `Given: V = ${V}V, I = ${I}A<br>`;
    calculationSteps += `R = V / I = ${V} / ${I} = ${resultR.toFixed(2)}Ω<br>`;
    calculationSteps += `P = V × I = ${V} × ${I} = ${resultP.toFixed(2)}W`;
  } else if (V > 0 && R > 0) {
    // V and R provided: Calculate I and P
    resultI = V / R;
    resultP = V * resultI;
    calculationSteps += `Given: V = ${V}V, R = ${R}Ω<br>`;
    calculationSteps += `I = V / R = ${V} / ${R} = ${resultI.toFixed(2)}A<br>`;
    calculationSteps += `P = V × I = ${V} × ${resultI.toFixed(2)} = ${resultP.toFixed(2)}W`;
  } else if (I > 0 && R > 0) {
    // I and R provided: Calculate V and P
    resultV = I * R;
    resultP = resultV * I;
    calculationSteps += `Given: I = ${I}A, R = ${R}Ω<br>`;
    calculationSteps += `V = I × R = ${I} × ${R} = ${resultV.toFixed(2)}V<br>`;
    calculationSteps += `P = V × I = ${resultV.toFixed(2)} × ${I} = ${resultP.toFixed(2)}W`;
  } else if (V > 0 && P > 0) {
    // V and P provided: Calculate I and R
    resultI = P / V;
    resultR = V / resultI;
    calculationSteps += `Given: V = ${V}V, P = ${P}W<br>`;
    calculationSteps += `I = P / V = ${P} / ${V} = ${resultI.toFixed(2)}A<br>`;
    calculationSteps += `R = V / I = ${V} / ${resultI.toFixed(2)} = ${resultR.toFixed(2)}Ω`;
  } else if (I > 0 && P > 0) {
    // I and P provided: Calculate V and R
    resultV = P / I;
    resultR = resultV / I;
    calculationSteps += `Given: I = ${I}A, P = ${P}W<br>`;
    calculationSteps += `V = P / I = ${P} / ${I} = ${resultV.toFixed(2)}V<br>`;
    calculationSteps += `R = V / I = ${resultV.toFixed(2)} / ${I} = ${resultR.toFixed(2)}Ω`;
  } else if (R > 0 && P > 0) {
    // R and P provided: Calculate V and I
    resultV = Math.sqrt(P * R);
    resultI = resultV / R;
    calculationSteps += `Given: R = ${R}Ω, P = ${P}W<br>`;
    calculationSteps += `V = √(P × R) = √(${P} × ${R}) = ${resultV.toFixed(2)}V<br>`;
    calculationSteps += `I = V / R = ${resultV.toFixed(2)} / ${R} = ${resultI.toFixed(2)}A`;
  } else {
    alert('Please enter valid numeric values in at least two fields.');
    return;
  }
  
  // Update the form with calculated values (only for empty fields)
  if (!voltage) document.getElementById('ol-voltage').value = resultV.toFixed(2);
  if (!current) document.getElementById('ol-current').value = resultI.toFixed(2);
  if (!resistance) document.getElementById('ol-resistance').value = resultR.toFixed(2);
  if (!power) document.getElementById('ol-power').value = resultP.toFixed(2);
  
  // Display results
  const resultHTML = `
    <p><strong>Calculated Values:</strong></p>
    <p>Voltage: <strong>${resultV.toFixed(2)} V</strong></p>
    <p>Current: <strong>${resultI.toFixed(2)} A</strong></p>
    <p>Resistance: <strong>${resultR.toFixed(2)} Ω</strong></p>
    <p>Power: <strong>${resultP.toFixed(2)} W</strong></p>
  `;
  
  document.getElementById('ol-calculation-result').innerHTML = resultHTML;
  document.getElementById('ol-calculation-steps').innerHTML = calculationSteps;
  document.getElementById('ol-result-area').style.display = 'block';
  
  // Store result for copying
  olCurrentResult = `Ohm's Law Calculation Results:
Voltage: ${resultV.toFixed(2)} V
Current: ${resultI.toFixed(2)} A
Resistance: ${resultR.toFixed(2)} Ω
Power: ${resultP.toFixed(2)} W

Calculation Steps:
${calculationSteps.replace(/<br>/g, '\n').replace(/<[^>]*>/g, '')}`;
  
  // Scroll to results
  document.getElementById('ol-result-area').scrollIntoView({ behavior: 'smooth' });
}

function olReset(button) {
  // Clear all input fields
  document.getElementById('ol-voltage').value = '';
  document.getElementById('ol-current').value = '';
  document.getElementById('ol-resistance').value = '';
  document.getElementById('ol-power').value = '';
  
  // Hide result area
  document.getElementById('ol-result-area').style.display = 'none';
  
  // Reset facts display
  document.getElementById('ol-show-facts').value = 'yes';
  document.getElementById('ol-facts-area').style.display = 'block';
}

function olCopy(button) {
  if (!olCurrentResult) {
    alert('Please calculate a result first before copying.');
    return;
  }
  
  // Copy to clipboard
  navigator.clipboard.writeText(olCurrentResult).then(() => {
    // Show temporary feedback on the button
    const originalText = button.textContent;
    button.textContent = 'Copied!';
    button.style.backgroundColor = '#28a745';
    
    setTimeout(() => {
      button.textContent = originalText;
      button.style.backgroundColor = '';
    }, 2000);
  }).catch(err => {
    console.error('Failed to copy: ', err);
    alert('Failed to copy result to clipboard. You can manually copy the text from the result area.');
  });
}

// Toggle facts display based on dropdown selection
document.getElementById('ol-show-facts').addEventListener('change', function() {
  const factsArea = document.getElementById('ol-facts-area');
  factsArea.style.display = this.value === 'yes' ? 'block' : 'none';
});

// Allow Enter key to trigger calculation
document.querySelectorAll('#ol-voltage, #ol-current, #ol-resistance, #ol-power').forEach(input => {
  input.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      olCalculate();
    }
  });
});
</script>
