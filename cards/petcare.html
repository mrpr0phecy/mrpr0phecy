    <h2 class="card-title">
      <span class="title-icon">ğŸ¾</span>
      Pet Care Tracker
    </h2>
    <p class="card-subtitle">Log pet care tasks like feeding, walking, or grooming.</p>
  </div>
  
  <div class="card-content">
    <!-- Stats Dashboard -->
    <div class="stats-dashboard">
      <div class="stat-item">
        <div class="stat-label">
          <span class="stat-icon">ğŸ“…</span>
          Today
        </div>
        <div id="pct-today-count" class="stat-value">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">
          <span class="stat-icon">ğŸ½ï¸</span>
          Feedings
        </div>
        <div id="pct-feedings-count" class="stat-value">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">
          <span class="stat-icon">ğŸ•</span>
          Walks
        </div>
        <div id="pct-walks-count" class="stat-value">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">
          <span class="stat-icon">ğŸ’Š</span>
          Medications
        </div>
        <div id="pct-meds-count" class="stat-value">0</div>
      </div>
    </div>
    
    <!-- Pet Selector -->
    <div class="pet-selector">
      <div class="section-title">Your Pets</div>
      <div class="pets-grid" id="pets-grid">
        <div class="pet-item active" data-pet="General">
          <div class="pet-avatar">ğŸ¾</div>
          <div class="pet-name">General</div>
        </div>
        <!-- Will be populated with user pets -->
      </div>
      <button type="button" class="add-pet-btn" onclick="showAddPetModal()">
        <span class="btn-icon">â•</span>
        Add Pet
      </button>
    </div>
    
    <!-- Add Task Form -->
    <div class="input-section">
      <h3 class="section-title">
        <span class="section-icon">ğŸ“</span>
        Log New Task
      </h3>
      
      <div class="input-grid">
        <div class="input-group">
          <label for="pct-pet" class="input-label">Pet Name</label>
          <div class="input-with-icon">
            <span class="input-icon">ğŸ¾</span>
            <input type="text" id="pct-pet" class="card-input" placeholder="e.g. Bella" list="pet-suggestions">
          </div>
          <datalist id="pet-suggestions"></datalist>
        </div>
        
        <div class="input-group">
          <label for="pct-task" class="input-label">Task Type</label>
          <select id="pct-task" class="card-select">
            <option value="">Select task...</option>
            <option value="feeding">ğŸ½ï¸ Feeding</option>
            <option value="walking">ğŸ• Walking</option>
            <option value="grooming">ğŸ› Grooming</option>
            <option value="medication">ğŸ’Š Medication</option>
            <option value="playtime">ğŸ¾ Playtime</option>
            <option value="training">ğŸ“ Training</option>
            <option value="vet-visit">ğŸ¥ Vet Visit</option>
            <option value="other">ğŸ“ Other</option>
          </select>
        </div>
        
        <div class="input-group">
          <label for="pct-date" class="input-label">Date & Time</label>
          <div class="datetime-input">
            <input type="date" id="pct-date" class="card-input">
            <input type="time" id="pct-time" class="card-input" value="12:00">
          </div>
        </div>
      </div>
      
      <div class="input-group">
        <label for="pct-notes" class="input-label">Notes (Optional)</label>
        <textarea id="pct-notes" class="card-textarea" rows="2" placeholder="Special instructions, amounts, details..."></textarea>
      </div>
      
      <!-- Quick Log Presets -->
      <div class="quick-presets">
        <div class="presets-label">Quick Log Common Tasks:</div>
        <div class="presets-grid">
          <button type="button" class="preset-btn" onclick="quickLog('Morning feeding', 'feeding')">
            ğŸ½ï¸ Morning Feed
          </button>
          <button type="button" class="preset-btn" onclick="quickLog('Evening walk', 'walking')">
            ğŸŒ… Evening Walk
          </button>
          <button type="button" class="preset-btn" onclick="quickLog('Medication dose', 'medication')">
            ğŸ’Š Give Meds
          </button>
          <button type="button" class="preset-btn" onclick="quickLog('Brush coat', 'grooming')">
            ğŸ› Brush Coat
          </button>
        </div>
      </div>
      
      <button type="button" class="card-btn primary" onclick="petcareAdd()">
        <span class="btn-icon">ğŸ“‹</span>
        Log Pet Care Task
      </button>
    </div>
    
    <!-- Task List -->
    <div class="task-section">
      <div class="section-header">
        <h3 class="section-title">
          <span class="section-icon">ğŸ“Š</span>
          Care History
        </h3>
        
        <div class="filter-controls">
          <select id="pct-filter" onchange="filterTasks()" class="card-select small">
            <option value="all">All Tasks</option>
            <option value="today">Today</option>
            <option value="this-week">This Week</option>
            <option value="feeding">Feedings</option>
            <option value="walking">Walks</option>
            <option value="medication">Medications</option>
          </select>
          <button type="button" class="card-btn secondary small" onclick="clearOldTasks()">
            Clear Old
          </button>
        </div>
      </div>
      
      <div id="pct-list" class="task-list">
        <div class="empty-state">
          <div class="empty-icon">ğŸ¶</div>
          <div>No pet care tasks logged yet</div>
          <div class="empty-subtitle">Log your first task above!</div>
        </div>
      </div>
      
      <div class="task-stats">
        <div class="stat-item">
          <span class="stat-label">Total logged:</span>
          <span id="pct-total-count" class="stat-value">0</span> tasks
        </div>
        <div class="stat-item">
          <span class="stat-label">Last 7 days:</span>
          <span id="pct-week-count" class="stat-value">0</span> tasks
        </div>
        <div class="stat-item">
          <span class="stat-label">Most active:</span>
          <span id="pct-active-pet" class="stat-value">-</span>
        </div>
      </div>
    </div>
    
    <!-- Pet Health Summary -->
    <div class="health-section">
      <h3 class="section-title">
        <span class="section-icon">â¤ï¸</span>
        Pet Health Summary
      </h3>
      
      <div class="health-grid">
        <div class="health-card">
          <div class="health-icon">ğŸ½ï¸</div>
          <div class="health-content">
            <div class="health-label">Feeding Schedule</div>
            <div class="health-value" id="feeding-status">Not logged today</div>
          </div>
        </div>
        <div class="health-card">
          <div class="health-icon">ğŸ•</div>
          <div class="health-content">
            <div class="health-label">Exercise</div>
            <div class="health-value" id="exercise-status">No walks today</div>
          </div>
        </div>
        <div class="health-card">
          <div class="health-icon">ğŸ’Š</div>
          <div class="health-content">
            <div class="health-label">Medications</div>
            <div class="health-value" id="meds-status">Up to date</div>
          </div>
        </div>
        <div class="health-card">
          <div class="health-icon">ğŸ“…</div>
          <div class="health-content">
            <div class="health-label">Next Vet Visit</div>
            <div class="health-value" id="vet-status">Not scheduled</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Action Buttons -->
    <div class="action-buttons">
      <button type="button" class="card-btn" onclick="exportLog()">
        <span class="btn-icon">ğŸ“¥</span>
        Export Log
      </button>
      <button type="button" class="card-btn" onclick="setReminders()">
        <span class="btn-icon">â°</span>
        Set Reminders
      </button>
      <button type="button" class="card-btn" onclick="resetAll()">
        <span class="btn-icon">ğŸ”„</span>
        Reset All
      </button>
    </div>
  </div>
</div>

<!-- Add Pet Modal -->
<div id="add-pet-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">Add New Pet</h3>
      <button class="modal-close" onclick="closeAddPetModal()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="input-group">
        <label class="input-label">Pet Name</label>
        <input type="text" id="new-pet-name" class="card-input" placeholder="e.g. Luna">
      </div>
      <div class="input-group">
        <label class="input-label">Pet Type</label>
        <select id="new-pet-type" class="card-select">
          <option value="dog">ğŸ• Dog</option>
          <option value="cat">ğŸˆ Cat</option>
          <option value="bird">ğŸ¦ Bird</option>
          <option value="fish">ğŸ  Fish</option>
          <option value="rabbit">ğŸ‡ Rabbit</option>
          <option value="hamster">ğŸ¹ Hamster</option>
          <option value="other">ğŸ¾ Other</option>
        </select>
      </div>
      <div class="input-group">
        <label class="input-label">Birth Date (Optional)</label>
        <input type="date" id="new-pet-birthdate" class="card-input">
      </div>
    </div>
    <div class="modal-footer">
      <button class="card-btn secondary" onclick="closeAddPetModal()">Cancel</button>
      <button class="card-btn primary" onclick="saveNewPet()">Save Pet</button>
    </div>
  </div>
</div>

<style>
.card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
  padding: 24px;
  max-width: 900px;
  margin: 0 auto;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  border: 1px solid #e0f2fe;
}

.card-header {
  text-align: center;
  margin-bottom: 24px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f0f9ff;
}

.card-title {
  margin: 0;
  color: #1e3a8a;
  font-size: 28px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.title-icon {
  font-size: 32px;
}

.card-subtitle {
  font-size: 16px;
  color: #64748b;
  margin-top: 8px;
}

.card-content {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

/* Stats Dashboard */
.stats-dashboard {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  background: linear-gradient(135deg, #f0f9ff, #fef7ff);
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #dbeafe;
}

@media (max-width: 768px) {
  .stats-dashboard {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .stats-dashboard {
    grid-template-columns: 1fr;
  }
}

.stat-item {
  text-align: center;
  padding: 16px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  border: 1px solid #e2e8f0;
}

.stat-label {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  font-size: 13px;
  color: #64748b;
  margin-bottom: 8px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-icon {
  font-size: 16px;
}

.stat-value {
  font-size: 28px;
  font-weight: 700;
  color: #1e3a8a;
}

/* Pet Selector */
.pet-selector {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.section-title {
  margin: 0 0 16px 0;
  color: #1e3a8a;
  font-size: 18px;
  font-weight: 600;
}

.pets-grid {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
  flex-wrap: wrap;
}

.pet-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 12px;
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 80px;
}

.pet-item:hover {
  transform: translateY(-2px);
  border-color: #93c5fd;
}

.pet-item.active {
  background: #dbeafe;
  border-color: #3b82f6;
}

.pet-avatar {
  font-size: 32px;
  margin-bottom: 8px;
}

.pet-name {
  font-size: 13px;
  font-weight: 500;
  color: #374151;
}

.add-pet-btn {
  padding: 10px 16px;
  background: #f1f5f9;
  border: 1px dashed #cbd5e0;
  border-radius: 8px;
  color: #64748b;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  justify-content: center;
}

.add-pet-btn:hover {
  background: #e2e8f0;
  border-color: #94a3b8;
}

/* Input Sections */
.input-section,
.task-section,
.health-section {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 1px solid #e2e8f0;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.section-icon {
  font-size: 20px;
  margin-right: 8px;
}

/* Input Grid */
.input-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  margin-bottom: 20px;
}

@media (max-width: 768px) {
  .input-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .input-grid {
    grid-template-columns: 1fr;
  }
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.input-label {
  font-size: 14px;
  font-weight: 500;
  color: #4b5563;
}

.card-input,
.card-select,
.card-textarea {
  padding: 12px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
  color: #374151;
  background: white;
  transition: all 0.2s;
  font-family: inherit;
}

.card-input:focus,
.card-select:focus,
.card-textarea:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.card-textarea {
  resize: vertical;
  min-height: 80px;
}

.input-with-icon {
  position: relative;
}

.input-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 16px;
}

.input-with-icon .card-input {
  padding-left: 40px;
}

.datetime-input {
  display: flex;
  gap: 8px;
}

.datetime-input .card-input {
  flex: 1;
}

/* Quick Presets */
.quick-presets {
  margin: 20px 0;
}

.presets-label {
  font-size: 13px;
  color: #6b7280;
  margin-bottom: 8px;
}

.presets-grid {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.preset-btn {
  padding: 8px 12px;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  color: #4b5563;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.preset-btn:hover {
  background: #f3f4f6;
  border-color: #d1d5db;
  transform: translateY(-1px);
}

/* Buttons */
.card-btn {
  padding: 12px 20px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.card-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.card-btn.primary {
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  color: white;
  width: 100%;
  margin-top: 16px;
}

.card-btn.primary:hover {
  background: linear-gradient(135deg, #1d4ed8, #1e40af);
}

.card-btn.secondary {
  background: #f3f4f6;
  color: #4b5563;
  border: 1px solid #e5e7eb;
}

.card-btn.secondary:hover {
  background: #e5e7eb;
}

.card-btn.small {
  padding: 6px 12px;
  font-size: 13px;
}

/* Task List */
.task-list {
  min-height: 200px;
  max-height: 400px;
  overflow-y: auto;
  margin-bottom: 16px;
  padding-right: 8px;
}

.task-list::-webkit-scrollbar {
  width: 6px;
}

.task-list::-webkit-scrollbar-track {
  background: #f1f5f9;
  border-radius: 3px;
}

.task-list::-webkit-scrollbar-thumb {
  background: #cbd5e0;
  border-radius: 3px;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #9ca3af;
}

.empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.empty-subtitle {
  font-size: 13px;
  margin-top: 8px;
  color: #d1d5db;
}

/* Task Items */
.task-item {
  background: white;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
  border: 1px solid #e5e7eb;
  transition: all 0.2s;
}

.task-item:hover {
  transform: translateX(4px);
  border-color: #93c5fd;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.task-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
}

.task-content {
  flex: 1;
  margin-right: 12px;
}

.task-title {
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 4px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.task-meta {
  display: flex;
  gap: 12px;
  font-size: 12px;
  color: #6b7280;
}

.meta-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.task-notes {
  margin-top: 8px;
  padding: 8px;
  background: #f9fafb;
  border-radius: 6px;
  font-size: 13px;
  color: #4b5563;
  border-left: 3px solid #e5e7eb;
}

.task-type-badge {
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 500;
}

.type-feeding { background: #dcfce7; color: #166534; }
.type-walking { background: #dbeafe; color: #1e40af; }
.type-grooming { background: #fef3c7; color: #92400e; }
.type-medication { background: #fee2e2; color: #991b1b; }
.type-playtime { background: #f0f9ff; color: #0c4a6e; }
.type-training { background: #f5f3ff; color: #5b21b6; }
.type-vet-visit { background: #ffedd5; color: #9a3412; }
.type-other { background: #f3f4f6; color: #374151; }

/* Task Stats */
.task-stats {
  display: flex;
  justify-content: space-between;
  padding-top: 16px;
  border-top: 1px solid #e5e7eb;
  font-size: 13px;
  color: #6b7280;
}

/* Health Section */
.health-section {
  background: #f0f9ff;
  border: 1px solid #dbeafe;
}

.health-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .health-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 480px) {
  .health-grid {
    grid-template-columns: 1fr;
  }
}

.health-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: white;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
}

.health-icon {
  font-size: 24px;
  flex-shrink: 0;
}

.health-content {
  flex: 1;
}

.health-label {
  font-size: 12px;
  color: #6b7280;
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.health-value {
  font-size: 14px;
  font-weight: 600;
  color: #1f2937;
}

/* Action Buttons */
.action-buttons {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .action-buttons {
    grid-template-columns: 1fr;
  }
}

.btn-icon {
  font-size: 16px;
}

/* Filter Controls */
.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

/* Modal */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: white;
  border-radius: 12px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  border-bottom: 1px solid #e5e7eb;
}

.modal-title {
  margin: 0;
  color: #1f2937;
  font-size: 18px;
  font-weight: 600;
}

.modal-close {
  background: none;
  border: none;
  font-size: 24px;
  color: #6b7280;
  cursor: pointer;
  padding: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-close:hover {
  color: #374151;
}

.modal-body {
  padding: 20px;
}

.modal-footer {
  padding: 20px;
  border-top: 1px solid #e5e7eb;
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

/* Animations */
@keyframes taskComplete {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

.task-item.completed {
  background: #f0fdf4;
  border-color: #bbf7d0;
}

/* Responsive */
@media (max-width: 768px) {
  .section-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }
  
  .filter-controls {
    width: 100%;
    justify-content: space-between;
  }
}

/* Pet type colors */
.pet-dog .pet-avatar { color: #dc2626; }
.pet-cat .pet-avatar { color: #7c3aed; }
.pet-bird .pet-avatar { color: #059669; }
.pet-fish .pet-avatar { color: #0369a1; }
.pet-rabbit .pet-avatar { color: #ea580c; }
.pet-hamster .pet-avatar { color: #ca8a04; }
.pet-other .pet-avatar { color: #6b7280; }
</style>

<script>
/* Pet Care Tracker - Card Version */

// Task database
let petcareLog = [];
let currentFilter = 'all';
let userPets = [];

// Task type icons
const taskIcons = {
  feeding: 'ğŸ½ï¸',
  walking: 'ğŸ•',
  grooming: 'ğŸ›',
  medication: 'ğŸ’Š',
  playtime: 'ğŸ¾',
  training: 'ğŸ“',
  'vet-visit': 'ğŸ¥',
  other: 'ğŸ“'
};

// Task type colors
const taskTypeColors = {
  feeding: 'type-feeding',
  walking: 'type-walking',
  grooming: 'type-grooming',
  medication: 'type-medication',
  playtime: 'type-playtime',
  training: 'type-training',
  'vet-visit': 'type-vet-visit',
  other: 'type-other'
};

// Pet type icons
const petTypeIcons = {
  dog: 'ğŸ•',
  cat: 'ğŸˆ',
  bird: 'ğŸ¦',
  fish: 'ğŸ ',
  rabbit: 'ğŸ‡',
  hamster: 'ğŸ¹',
  other: 'ğŸ¾'
};

// Initialize
function init() {
  // Load saved data
  const savedLog = localStorage.getItem('petcareLog');
  const savedPets = localStorage.getItem('userPets');
  
  if (savedLog) {
    try {
      petcareLog = JSON.parse(savedLog);
    } catch (e) {
      console.log("Failed to load log:", e);
      petcareLog = [];
    }
  }
  
  if (savedPets) {
    try {
      userPets = JSON.parse(savedPets);
    } catch (e) {
      console.log("Failed to load pets:", e);
      userPets = [];
    }
  }
  
  // Set today's date
  const today = new Date().toISOString().split('T')[0];
  document.getElementById('pct-date').value = today;
  document.getElementById('pct-time').value = new Date().toTimeString().slice(0, 5);
  
  // Set up pet suggestions
  updatePetSuggestions();
  
  // Render pet selector
  renderPetSelector();
  
  // Render tasks
  renderTaskList();
  
  // Update stats
  updateStats();
  
  // Set up event listeners
  document.getElementById('pct-pet').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      petcareAdd();
    }
  });
}

// Render pet selector
function renderPetSelector() {
  const container = document.getElementById('pets-grid');
  container.innerHTML = '';
  
  // Add General pet
  const generalPet = document.createElement('div');
  generalPet.className = 'pet-item active';
  generalPet.dataset.pet = 'General';
  generalPet.innerHTML = `
    <div class="pet-avatar">ğŸ¾</div>
    <div class="pet-name">General</div>
  `;
  generalPet.onclick = () => selectPet('General');
  container.appendChild(generalPet);
  
  // Add user pets
  userPets.forEach(pet => {
    const petElement = document.createElement('div');
    petElement.className = `pet-item pet-${pet.type}`;
    petElement.dataset.pet = pet.name;
    petElement.innerHTML = `
      <div class="pet-avatar">${petTypeIcons[pet.type] || 'ğŸ¾'}</div>
      <div class="pet-name">${pet.name}</div>
    `;
    petElement.onclick = () => selectPet(pet.name);
    container.appendChild(petElement);
  });
}

// Select pet
function selectPet(petName) {
  // Update active class
  document.querySelectorAll('.pet-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelector(`[data-pet="${petName}"]`).classList.add('active');
  
  // Set pet name in input
  document.getElementById('pct-pet').value = petName;
}

// Update pet suggestions
function updatePetSuggestions() {
  const datalist = document.getElementById('pet-suggestions');
  datalist.innerHTML = '';
  
  // Add unique pet names from log
  const petNames = [...new Set(petcareLog.map(log => log.pet))];
  petNames.forEach(name => {
    const option = document.createElement('option');
    option.value = name;
    datalist.appendChild(option);
  });
  
  // Add user pets
  userPets.forEach(pet => {
    if (!petNames.includes(pet.name)) {
      const option = document.createElement('option');
      option.value = pet.name;
      datalist.appendChild(option);
    }
  });
}

// Quick log
function quickLog(taskText, taskType) {
  const taskSelect = document.getElementById('pct-task');
  const petInput = document.getElementById('pct-pet');
  
  if (!petInput.value.trim()) {
    alert('Please enter a pet name first');
    petInput.focus();
    return;
  }
  
  // Find task type option
  for (let option of taskSelect.options) {
    if (option.value === taskType) {
      taskSelect.value = taskType;
      break;
    }
  }
  
  // Focus on notes for additional info
  const notes = document.getElementById('pct-notes');
  notes.value = taskText;
  notes.focus();
}

// Add new task
function petcareAdd() {
  const petInput = document.getElementById('pct-pet');
  const taskSelect = document.getElementById('pct-task');
  const dateInput = document.getElementById('pct-date');
  const timeInput = document.getElementById('pct-time');
  const notesInput = document.getElementById('pct-notes');
  
  const pet = petInput.value.trim();
  const taskType = taskSelect.value;
  const date = dateInput.value;
  const time = timeInput.value;
  const notes = notesInput.value.trim();
  
  if (!pet) {
    petInput.style.borderColor = '#ef4444';
    setTimeout(() => petInput.style.borderColor = '', 1000);
    return;
  }
  
  if (!taskType) {
    taskSelect.style.borderColor = '#ef4444';
    setTimeout(() => taskSelect.style.borderColor = '', 1000);
    return;
  }
  
  const newTask = {
    id: Date.now().toString(),
    pet: pet,
    taskType: taskType,
    taskText: taskSelect.options[taskSelect.selectedIndex].text.replace(/^[^a-zA-Z]*/, ''), // Remove emoji
    date: date,
    time: time,
    notes: notes,
    completed: false,
    loggedAt: new Date().toISOString()
  };
  
  petcareLog.unshift(newTask);
  saveData();
  renderTaskList();
  updateStats();
  updatePetSuggestions();
  
  // Clear form
  notesInput.value = '';
  notesInput.focus();
  
  // Visual feedback
  const btn = document.querySelector('[onclick="petcareAdd()"]');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<span class="btn-icon">âœ…</span> Task Logged!';
  btn.style.background = '#10b981';
  
  setTimeout(() => {
    btn.innerHTML = originalText;
    btn.style.background = '';
  }, 1500);
}

// Render task list
function renderTaskList() {
  const container = document.getElementById('pct-list');
  
  if (petcareLog.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">ğŸ¶</div>
        <div>No pet care tasks logged yet</div>
        <div class="empty-subtitle">Log your first task above!</div>
      </div>
    `;
    return;
  }
  
  // Filter tasks
  let filteredTasks = [...petcareLog];
  const today = new Date().toISOString().split('T')[0];
  const oneWeekAgo = new Date();
  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
  
  switch (currentFilter) {
    case 'today':
      filteredTasks = filteredTasks.filter(task => task.date === today);
      break;
    case 'this-week':
      filteredTasks = filteredTasks.filter(task => new Date(task.date) >= oneWeekAgo);
      break;
    case 'feeding':
      filteredTasks = filteredTasks.filter(task => task.taskType === 'feeding');
      break;
    case 'walking':
      filteredTasks = filteredTasks.filter(task => task.taskType === 'walking');
      break;
    case 'medication':
      filteredTasks = filteredTasks.filter(task => task.taskType === 'medication');
      break;
  }
  
  // Render tasks
  container.innerHTML = '';
  
  filteredTasks.forEach(task => {
    const taskElement = document.createElement('div');
    taskElement.className = `task-item ${task.completed ? 'completed' : ''}`;
    
    taskElement.innerHTML = `
      <div class="task-header">
        <div class="task-content">
          <div class="task-title">
            ${taskIcons[task.taskType] || 'ğŸ“'} ${task.taskText}
            <span class="task-type-badge ${taskTypeColors[task.taskType]}">
              ${task.taskType}
            </span>
          </div>
          <div class="task-meta">
            <div class="meta-item">
              <span>ğŸ¾</span> ${task.pet}
            </div>
            <div class="meta-item">
              <span>ğŸ“…</span> ${task.date} ${task.time}
            </div>
            ${getDaysAgo(task.date) === 0 ? 
              '<div class="meta-item" style="color:#10b981;">Today</div>' : 
              getDaysAgo(task.date) === 1 ? 
              '<div class="meta-item" style="color:#f59e0b;">Yesterday</div>' : 
              `<div class="meta-item">${getDaysAgo(task.date)} days ago</div>`
            }
          </div>
          ${task.notes ? `<div class="task-notes">${task.notes}</div>` : ''}
        </div>
        <div class="task-actions">
          <button onclick="toggleComplete('${task.id}')" class="card-btn secondary small">
            ${task.completed ? 'âœ…' : 'â¬œ'}
          </button>
          <button onclick="deleteTask('${task.id}')" class="card-btn secondary small">
            ğŸ—‘ï¸
          </button>
        </div>
      </div>
    `;
    
    container.appendChild(taskElement);
  });
}

// Helper: Get days ago
function getDaysAgo(dateString) {
  const date = new Date(dateString);
  const today = new Date();
  const diffTime = Math.abs(today - date);
  return Math.floor(diffTime / (1000 * 60 * 60 * 24));
}

// Toggle task completion
function toggleComplete(taskId) {
  const task = petcareLog.find(t => t.id === taskId);
  if (task) {
    task.completed = !task.completed;
    saveData();
    renderTaskList();
    updateStats();
  }
}

// Delete task
function deleteTask(taskId) {
  if (confirm('Delete this task?')) {
    petcareLog = petcareLog.filter(t => t.id !== taskId);
    saveData();
    renderTaskList();
    updateStats();
  }
}

// Filter tasks
function filterTasks() {
  currentFilter = document.getElementById('pct-filter').value;
  renderTaskList();
}

// Clear old tasks
function clearOldTasks() {
  const thirtyDaysAgo = new Date();
  thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
  
  const oldTasks = petcareLog.filter(task => {
    const taskDate = new Date(task.date);
    return taskDate < thirtyDaysAgo;
  });
  
  if (oldTasks.length === 0) {
    alert('No tasks older than 30 days found.');
    return;
  }
  
  if (confirm(`Clear ${oldTasks.length} tasks older than 30 days?`)) {
    petcareLog = petcareLog.filter(task => {
      const taskDate = new Date(task.date);
      return taskDate >= thirtyDaysAgo;
    });
    saveData();
    renderTaskList();
    updateStats();
  }
}

// Update statistics
function updateStats() {
  const today = new Date().toISOString().split('T')[0];
  const oneWeekAgo = new Date();
  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
  
  // Count tasks
  const totalTasks = petcareLog.length;
  const todayTasks = petcareLog.filter(t => t.date === today).length;
  const weekTasks = petcareLog.filter(t => new Date(t.date) >= oneWeekAgo).length;
  
  // Count by type
  const feedingTasks = petcareLog.filter(t => t.taskType === 'feeding').length;
  const walkTasks = petcareLog.filter(t => t.taskType === 'walking').length;
  const medTasks = petcareLog.filter(t => t.taskType === 'medication').length;
  
  // Most active pet
  const petCounts = {};
  petcareLog.forEach(task => {
    petCounts[task.pet] = (petCounts[task.pet] || 0) + 1;
  });
  
  let mostActivePet = '-';
  let maxCount = 0;
  Object.entries(petCounts).forEach(([pet, count]) => {
    if (count > maxCount) {
      maxCount = count;
      mostActivePet = pet;
    }
  });
  
  // Update counts
  document.getElementById('pct-today-count').textContent = todayTasks;
  document.getElementById('pct-feedings-count').textContent = feedingTasks;
  document.getElementById('pct-walks-count').textContent = walkTasks;
  document.getElementById('pct-meds-count').textContent = medTasks;
  document.getElementById('pct-total-count').textContent = totalTasks;
  document.getElementById('pct-week-count').textContent = weekTasks;
  document.getElementById('pct-active-pet').textContent = mostActivePet;
  
  // Update health status
  updateHealthStatus();
}

// Update health status
function updateHealthStatus() {
  const today = new Date().toISOString().split('T')[0];
  
  // Feeding status
  const todayFeeding = petcareLog.some(t => t.date === today && t.taskType === 'feeding');
  document.getElementById('feeding-status').textContent = todayFeeding ? 'Fed today âœ“' : 'Not fed today';
  document.getElementById('feeding-status').style.color = todayFeeding ? '#10b981' : '#ef4444';
  
  // Exercise status
  const todayWalks = petcareLog.filter(t => t.date === today && t.taskType === 'walking').length;
  document.getElementById('exercise-status').textContent = todayWalks > 0 ? 
    `${todayWalks} walk${todayWalks > 1 ? 's' : ''} today âœ“` : 'No walks today';
  document.getElementById('exercise-status').style.color = todayWalks > 0 ? '#10b981' : '#f59e0b';
  
  // Medication status
  const todayMeds = petcareLog.filter(t => t.date === today && t.taskType === 'medication').length;
  document.getElementById('meds-status').textContent = todayMeds > 0 ? 
    `${todayMeds} dose${todayMeds > 1 ? 's' : ''} today âœ“` : 'Up to date';
  document.getElementById('meds-status').style.color = todayMeds > 0 ? '#10b981' : '#3b82f6';
  
  // Vet status (check for vet visits in next 30 days)
  const thirtyDaysFromNow = new Date();
  thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);
  
  const upcomingVisits = petcareLog.filter(t => 
    t.taskType === 'vet-visit' && 
    new Date(t.date) > new Date() && 
    new Date(t.date) <= thirtyDaysFromNow
  ).sort((a, b) => new Date(a.date) - new Date(b.date));
  
  if (upcomingVisits.length > 0) {
    const nextVisit = upcomingVisits[0];
    const daysUntil = getDaysAgo(nextVisit.date);
    document.getElementById('vet-status').textContent = `In ${daysUntil} days`;
    document.getElementById('vet-status').style.color = daysUntil <= 7 ? '#ef4444' : 
                                                       daysUntil <= 14 ? '#f59e0b' : '#10b981';
  } else {
    document.getElementById('vet-status').textContent = 'Not scheduled';
    document.getElementById('vet-status').style.color = '#6b7280';
  }
}

// Save data
function saveData() {
  localStorage.setItem('petcareLog', JSON.stringify(petcareLog));
  localStorage.setItem('userPets', JSON.stringify(userPets));
}

// Export log
function exportLog() {
  const exportData = {
    exportedAt: new Date().toISOString(),
    totalTasks: petcareLog.length,
    pets: userPets,
    tasks: petcareLog
  };
  
  const dataStr = JSON.stringify(exportData, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
  
  const link = document.createElement('a');
  link.setAttribute('href', dataUri);
  link.setAttribute('download', `petcare-log-${new Date().toISOString().split('T')[0]}.json`);
  link.click();
}

// Set reminders
function setReminders() {
  alert('Reminder feature would integrate with your device calendar or notification system.\n\nFor now, consider setting recurring calendar events for regular pet care tasks.');
}

// Reset all
function resetAll() {
  if (confirm('Reset all pet care data? This cannot be undone.')) {
    petcareLog = [];
    userPets = [];
    saveData();
    init();
    alert('All data has been reset.');
  }
}

// Add pet modal functions
function showAddPetModal() {
  document.getElementById('add-pet-modal').style.display = 'flex';
  document.getElementById('new-pet-name').value = '';
  document.getElementById('new-pet-type').value = 'dog';
  document.getElementById('new-pet-birthdate').value = '';
  document.getElementById('new-pet-name').focus();
}

function closeAddPetModal() {
  document.getElementById('add-pet-modal').style.display = 'none';
}

function saveNewPet() {
  const name = document.getElementById('new-pet-name').value.trim();
  const type = document.getElementById('new-pet-type').value;
  const birthdate = document.getElementById('new-pet-birthdate').value;
  
  if (!name) {
    alert('Please enter a pet name');
    return;
  }
  
  // Check for duplicate names
  if (userPets.some(pet => pet.name.toLowerCase() === name.toLowerCase())) {
    alert(`A pet named "${name}" already exists!`);
    return;
  }
  
  const newPet = {
    id: Date.now().toString(),
    name: name,
    type: type,
    birthdate: birthdate || null,
    addedAt: new Date().toISOString()
  };
  
  userPets.push(newPet);
  saveData();
  renderPetSelector();
  updatePetSuggestions();
  selectPet(name);
  closeAddPetModal();
  
  alert(`Pet "${name}" added successfully! ğŸ‰`);
}

// Initialize
document.addEventListener('DOMContentLoaded', init);
</script>
