<div class="card" id="study-planner-card">
  <h2 id="studyplanner-title" style="margin-top:0;">Study Planner</h2>

  <form aria-describedby="studyplanner-desc">
    <p id="studyplanner-desc" class="small">
      Plan your study sessions by subject, duration, and date. Set goals, track progress, and optimize your schedule.
    </p>

    <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
      <div class="field">
        <label for="studyplanner-subject">Subject</label>
        <input id="studyplanner-subject" type="text" placeholder="e.g., Physics, Math, History" style="width:100%;" />
        <div class="small" style="margin-top:4px;color:#aaa;">
          <span id="subject-count">0</span> unique subjects
        </div>
      </div>

      <div class="field">
        <label for="studyplanner-duration">Duration</label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input id="studyplanner-duration" type="number" min="0.25" max="8" step="0.25" value="1.5" style="width:100%;" />
          <div style="white-space:nowrap;">hours</div>
        </div>
        <div class="small" style="margin-top:4px;color:#aaa;">
          Recommended: 25-50 min sessions with breaks
        </div>
      </div>

      <div class="field">
        <label for="studyplanner-date">Date</label>
        <input id="studyplanner-date" type="date" style="width:100%;" />
        <div class="small" style="margin-top:4px;color:#aaa;">
          <span id="session-count">0</span> sessions planned
        </div>
      </div>
    </div>

    <div class="row" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-top:12px;">
      <div class="field">
        <label for="studyplanner-priority">Priority</label>
        <select id="studyplanner-priority" style="width:100%;">
          <option value="low">Low</option>
          <option value="medium" selected>Medium</option>
          <option value="high">High</option>
          <option value="urgent">Urgent</option>
        </select>
      </div>

      <div class="field">
        <label for="studyplanner-type">Session Type</label>
        <select id="studyplanner-type" style="width:100%;">
          <option value="review" selected>Review</option>
          <option value="practice">Practice Problems</option>
          <option value="reading">Reading</option>
          <option value="memorization">Memorization</option>
          <option value="project">Project Work</option>
          <option value="exam-prep">Exam Prep</option>
        </select>
      </div>

      <div class="field">
        <label for="studyplanner-goal">Daily Goal (hours)</label>
        <input id="studyplanner-goal" type="number" min="0.5" max="12" step="0.5" value="3" style="width:100%;" />
      </div>
    </div>

    <div class="actions" style="margin-top:12px;display:flex;gap:8px;">
      <button type="button" onclick="studyplannerAdd(this)" class="primary">Add Session</button>
      <button type="button" onclick="studyplannerAddBatch(this)" class="secondary">Add Recurring</button>
      <button type="button" onclick="studyplannerReset(this)" class="secondary">Reset All</button>
      <button type="button" onclick="studyplannerExport(this)" class="secondary">Export</button>
    </div>
  </form>

  <div class="results" aria-live="polite" style="margin-top:12px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
      <h3 class="small">Study Schedule</h3>
      <div style="display:flex;gap:8px;">
        <select id="studyplanner-filter" style="font-size:0.85rem;padding:4px 8px;" onchange="filterSessions()">
          <option value="all">All Sessions</option>
          <option value="today">Today</option>
          <option value="week">This Week</option>
          <option value="subject">By Subject</option>
          <option value="priority">By Priority</option>
        </select>
        <button type="button" onclick="sortSessions()" class="small" style="padding:4px 8px;">Sort by Date</button>
      </div>
    </div>

    <div id="studyplanner-list" style="max-height:300px;overflow-y:auto;border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:8px;">
      <p style="text-align:center;color:#aaa;padding:20px;">No study sessions added yet.</p>
    </div>

    <div style="margin-top:12px;">
      <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:12px;">
        <div class="metric-box" style="background:rgba(33, 150, 243, 0.1);border-radius:8px;padding:12px;text-align:center;">
          <div class="small" style="margin-bottom:4px;color:#2196f3;">Total Hours</div>
          <div class="value" style="font-size:1.5rem;font-weight:600;" id="studyplanner-total">0</div>
        </div>
        <div class="metric-box" style="background:rgba(76, 175, 80, 0.1);border-radius:8px;padding:12px;text-align:center;">
          <div class="small" style="margin-bottom:4px;color:#4caf50;">Goal Progress</div>
          <div class="value" style="font-size:1.5rem;font-weight:600;" id="studyplanner-progress">0%</div>
        </div>
        <div class="metric-box" style="background:rgba(255, 152, 0, 0.1);border-radius:8px;padding:12px;text-align:center;">
          <div class="small" style="margin-bottom:4px;color:#ff9800;">Upcoming</div>
          <div class="value" style="font-size:1.5rem;font-weight:600;" id="studyplanner-upcoming">0</div>
        </div>
        <div class="metric-box" style="background:rgba(158, 158, 158, 0.1);border-radius:8px;padding:12px;text-align:center;">
          <div class="small" style="margin-bottom:4px;color:#9e9e9e;">Subjects</div>
          <div class="value" style="font-size:1.5rem;font-weight:600;" id="studyplanner-subjects">0</div>
        </div>
      </div>
    </div>

    <div style="margin-top:12px;">
      <div class="progress-container" style="margin-bottom:4px;">
        <div class="progress-label" style="display:flex;justify-content:space-between;font-size:0.85rem;margin-bottom:4px;">
          <span>Daily Goal Progress</span>
          <span id="goal-progress-text">0/3 hours</span>
        </div>
        <div class="progress-bar" style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;">
          <div id="goal-progress-bar" style="height:100%;background:linear-gradient(90deg, #2196f3, #4caf50);width:0%;transition:width 0.5s ease;"></div>
        </div>
      </div>
    </div>

    <div id="studyplanner-hint" class="small" style="margin-top:8px;opacity:0.9;"></div>
  </div>

  <details class="small" style="margin-top:12px;border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:8px;">
    <summary style="cursor:pointer;font-weight:500;padding:4px;">Study Tips & Best Practices</summary>
    <div style="margin-top:8px;padding:4px;border-top:1px solid rgba(255,255,255,0.08);">
      <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
        <div>
          <strong>Time Management:</strong>
          <ul style="margin:4px 0;padding-left:20px;">
            <li>Use Pomodoro Technique (25 min work, 5 min break)</li>
            <li>Schedule hardest subjects during peak focus times</li>
            <li>Include regular breaks every 50-90 minutes</li>
          </ul>
        </div>
        <div>
          <strong>Effective Studying:</strong>
          <ul style="margin:4px 0;padding-left:20px;">
            <li>Active recall over passive reading</li>
            <li>Spaced repetition for memorization</li>
            <li>Interleave different subjects</li>
          </ul>
        </div>
      </div>
      <p style="margin-top:8px;color:#4caf50;"><strong>Recommended:</strong> Aim for consistency over cramming. 2-3 hours daily is more effective than 10 hours once a week.</p>
    </div>
  </details>

  <style>
    .card {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid #333;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      margin-bottom: 20px;
    }
    
    .card h2 {
      color: #2196f3;
      font-size: 1.5rem;
      margin-bottom: 8px;
    }
    
    .card .small {
      font-size: 0.875rem;
      color: #aaa;
      margin-bottom: 16px;
      line-height: 1.5;
    }
    
    .field {
      margin-bottom: 16px;
    }
    
    .field label {
      display: block;
      margin-bottom: 6px;
      color: #ddd;
      font-weight: 500;
    }
    
    .field input,
    .field select {
      padding: 10px 12px;
      border: 1px solid #444;
      border-radius: 8px;
      background: #252525;
      color: #fff;
      font-size: 0.95rem;
    }
    
    .field input:focus,
    .field select:focus {
      outline: none;
      border-color: #2196f3;
      box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
    }
    
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
      opacity: 1;
      height: 24px;
      cursor: pointer;
    }
    
    .actions button {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.95rem;
    }
    
    .actions button.primary {
      background: #2196f3;
      color: white;
    }
    
    .actions button.primary:hover {
      background: #1976d2;
    }
    
    .actions button.secondary {
      background: #555;
      color: white;
    }
    
    .actions button.secondary:hover {
      background: #666;
    }
    
    .results h3 {
      color: #2196f3;
      margin-bottom: 8px;
      font-size: 1rem;
    }
    
    .metric-box {
      transition: transform 0.2s ease;
    }
    
    .metric-box:hover {
      transform: translateY(-2px);
    }
    
    .session-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      margin-bottom: 6px;
      border-left: 4px solid #2196f3;
    }
    
    .session-item.high { border-left-color: #f44336; }
    .session-item.medium { border-left-color: #ff9800; }
    .session-item.low { border-left-color: #4caf50; }
    .session-item.urgent { border-left-color: #9c27b0; }
    
    .session-item:hover {
      background: rgba(255,255,255,0.05);
    }
    
    .session-info {
      flex: 1;
    }
    
    .session-actions {
      display: flex;
      gap: 6px;
    }
    
    .session-actions button {
      padding: 4px 8px;
      font-size: 0.8rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: rgba(255,255,255,0.1);
      color: white;
    }
    
    .session-actions button:hover {
      background: rgba(255,255,255,0.2);
    }
    
    .priority-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-left: 8px;
    }
    
    .priority-high { background: rgba(244, 67, 54, 0.2); color: #f44336; }
    .priority-medium { background: rgba(255, 152, 0, 0.2); color: #ff9800; }
    .priority-low { background: rgba(76, 175, 80, 0.2); color: #4caf50; }
    .priority-urgent { background: rgba(156, 39, 176, 0.2); color: #9c27b0; }
    
    .type-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      background: rgba(33, 150, 243, 0.2);
      color: #2196f3;
      margin-left: 8px;
    }
    
    details summary::-webkit-details-marker {
      display: none;
    }
    
    details summary:after {
      content: '▼';
      float: right;
      font-size: 0.75em;
      transition: transform 0.2s ease;
    }
    
    details[open] summary:after {
      transform: rotate(180deg);
    }
    
    .empty-state {
      text-align: center;
      padding: 20px;
      color: #666;
    }
  </style>
</div>

<script>
// Study Planner Application
let studySessions = JSON.parse(localStorage.getItem('studySessions')) || [];
let dailyGoal = parseFloat(localStorage.getItem('studyDailyGoal')) || 3;

// Priority colors
const PRIORITY_COLORS = {
  'low': '#4caf50',
  'medium': '#ff9800',
  'high': '#f44336',
  'urgent': '#9c27b0'
};

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  const card = document.getElementById('study-planner-card');
  
  // Set default date to today
  const today = new Date().toISOString().split('T')[0];
  card.querySelector('#studyplanner-date').value = today;
  
  // Set daily goal
  card.querySelector('#studyplanner-goal').value = dailyGoal;
  
  // Load saved sessions
  renderStudyPlanner();
  updateStats();
  
  // Update date count
  updateDateCount();
  
  // Set up input events
  card.querySelector('#studyplanner-date').addEventListener('change', updateDateCount);
  card.querySelector('#studyplanner-goal').addEventListener('input', function() {
    dailyGoal = parseFloat(this.value) || 3;
    localStorage.setItem('studyDailyGoal', dailyGoal);
    updateStats();
  });
});

function updateDateCount() {
  const card = document.getElementById('study-planner-card');
  const date = card.querySelector('#studyplanner-date').value;
  const sessionsOnDate = studySessions.filter(s => s.date === date).length;
  card.querySelector('#session-count').textContent = sessionsOnDate;
}

function studyplannerAdd(btn) {
  const card = document.getElementById('study-planner-card');
  const subject = card.querySelector('#studyplanner-subject').value.trim();
  const duration = parseFloat(card.querySelector('#studyplanner-duration').value) || 0;
  const date = card.querySelector('#studyplanner-date').value;
  const priority = card.querySelector('#studyplanner-priority').value;
  const type = card.querySelector('#studyplanner-type').value;
  
  // Validate inputs
  if (!subject) {
    showHint('Please enter a subject name.', 'error');
    return;
  }
  
  if (duration <= 0 || duration > 8) {
    showHint('Please enter a valid duration (0.25-8 hours).', 'error');
    return;
  }
  
  if (!date) {
    showHint('Please select a date.', 'error');
    return;
  }
  
  // Create session object
  const session = {
    id: Date.now(),
    subject,
    duration,
    date,
    priority,
    type,
    completed: false,
    createdAt: new Date().toISOString()
  };
  
  // Add to sessions
  studySessions.push(session);
  
  // Save to localStorage
  localStorage.setItem('studySessions', JSON.stringify(studySessions));
  
  // Update UI
  renderStudyPlanner();
  updateStats();
  updateDateCount();
  
  // Clear form
  card.querySelector('#studyplanner-subject').value = '';
  card.querySelector('#studyplanner-duration').value = '1.5';
  
  // Show success message
  showHint(`Added ${duration}h of ${subject} for ${formatDate(date)}`, 'success');
}

function studyplannerAddBatch(btn) {
  const card = document.getElementById('study-planner-card');
  const subject = card.querySelector('#studyplanner-subject').value.trim();
  const duration = parseFloat(c.querySelector('#studyplanner-duration').value) || 0;
  const priority = card.querySelector('#studyplanner-priority').value;
  const type = card.querySelector('#studyplanner-type').value;
  
  if (!subject || duration <= 0) {
    showHint('Please enter subject and duration first.', 'error');
    return;
  }
  
  // Prompt for batch settings
  const days = prompt('How many days to schedule?', '7');
  const sessionsPerDay = prompt('How many sessions per day?', '1');
  
  if (!days || !sessionsPerDay) return;
  
  const startDate = new Date(card.querySelector('#studyplanner-date').value);
  const sessionsAdded = [];
  
  for (let i = 0; i < parseInt(days); i++) {
    const currentDate = new Date(startDate);
    currentDate.setDate(startDate.getDate() + i);
    const dateStr = currentDate.toISOString().split('T')[0];
    
    for (let j = 0; j < parseInt(sessionsPerDay); j++) {
      const session = {
        id: Date.now() + i * 100 + j,
        subject,
        duration,
        date: dateStr,
        priority,
        type,
        completed: false,
        createdAt: new Date().toISOString()
      };
      
      studySessions.push(session);
      sessionsAdded.push(session);
    }
  }
  
  // Save and update
  localStorage.setItem('studySessions', JSON.stringify(studySessions));
  renderStudyPlanner();
  updateStats();
  updateDateCount();
  
  showHint(`Added ${sessionsAdded.length} sessions over ${days} days`, 'success');
}

function renderStudyPlanner() {
  const listContainer = document.getElementById('studyplanner-list');
  
  if (studySessions.length === 0) {
    listContainer.innerHTML = '<p class="empty-state">No study sessions added yet.</p>';
    return;
  }
  
  // Sort by date (oldest first)
  const sortedSessions = [...studySessions].sort((a, b) => new Date(a.date) - new Date(b.date));
  
  let html = '';
  
  sortedSessions.forEach(session => {
    const isPast = new Date(session.date) < new Date().setHours(0,0,0,0);
    const isToday = session.date === new Date().toISOString().split('T')[0];
    
    html += `
      <div class="session-item ${session.priority} ${isPast && !session.completed ? 'past' : ''}" data-id="${session.id}">
        <div class="session-info">
          <div style="display:flex;align-items:center;margin-bottom:4px;">
            <strong>${session.subject}</strong>
            <span class="priority-badge priority-${session.priority}">${session.priority.toUpperCase()}</span>
            <span class="type-badge">${session.type}</span>
          </div>
          <div class="small" style="color:#aaa;">
            ${formatDate(session.date)} ${isToday ? ' (Today)' : ''} ${isPast ? ' (Past)' : ''}
            • ${session.duration.toFixed(1)} hours
            ${session.completed ? '• ✅ Completed' : ''}
          </div>
        </div>
        <div class="session-actions">
          <button onclick="toggleSessionComplete(${session.id})" title="${session.completed ? 'Mark as incomplete' : 'Mark as complete'}">
            ${session.completed ? '↩' : '✓'}
          </button>
          <button onclick="editSession(${session.id})" title="Edit">✎</button>
          <button onclick="deleteSession(${session.id})" title="Delete">✕</button>
        </div>
      </div>
    `;
  });
  
  listContainer.innerHTML = html;
  
  // Update subject count
  const uniqueSubjects = [...new Set(studySessions.map(s => s.subject))];
  document.getElementById('subject-count').textContent = uniqueSubjects.length;
}

function updateStats() {
  const totalHours = studySessions.reduce((sum, session) => sum + session.duration, 0);
  const completedHours = studySessions
    .filter(s => s.completed)
    .reduce((sum, session) => sum + session.duration, 0);
  
  // Calculate upcoming sessions (next 7 days)
  const today = new Date();
  const nextWeek = new Date();
  nextWeek.setDate(today.getDate() + 7);
  
  const upcomingSessions = studySessions.filter(s => {
    const sessionDate = new Date(s.date);
    return sessionDate >= today && sessionDate <= nextWeek && !s.completed;
  });
  
  // Update metrics
  document.getElementById('studyplanner-total').textContent = totalHours.toFixed(1);
  document.getElementById('studyplanner-subjects').textContent = 
    [...new Set(studySessions.map(s => s.subject))].length;
  document.getElementById('studyplanner-upcoming').textContent = upcomingSessions.length;
  
  // Calculate progress percentage
  const progressPercent = Math.min((completedHours / dailyGoal) * 100, 100);
  document.getElementById('studyplanner-progress').textContent = Math.round(progressPercent) + '%';
  
  // Update progress bar
  const progressBar = document.getElementById('goal-progress-bar');
  progressBar.style.width = `${progressPercent}%`;
  document.getElementById('goal-progress-text').textContent = 
    `${completedHours.toFixed(1)}/${dailyGoal} hours`;
    
  // Color code progress bar
  if (progressPercent >= 100) {
    progressBar.style.background = 'linear-gradient(90deg, #4caf50, #2e7d32)';
  } else if (progressPercent >= 75) {
    progressBar.style.background = 'linear-gradient(90deg, #ff9800, #f57c00)';
  } else {
    progressBar.style.background = 'linear-gradient(90deg, #2196f3, #1976d2)';
  }
}

function toggleSessionComplete(sessionId) {
  const session = studySessions.find(s => s.id === sessionId);
  if (session) {
    session.completed = !session.completed;
    localStorage.setItem('studySessions', JSON.stringify(studySessions));
    renderStudyPlanner();
    updateStats();
    
    showHint(
      session.completed 
        ? `Marked ${session.subject} as completed` 
        : `Marked ${session.subject} as incomplete`,
      'info'
    );
  }
}

function editSession(sessionId) {
  const session = studySessions.find(s => s.id === sessionId);
  if (!session) return;
  
  const card = document.getElementById('study-planner-card');
  card.querySelector('#studyplanner-subject').value = session.subject;
  card.querySelector('#studyplanner-duration').value = session.duration;
  card.querySelector('#studyplanner-date').value = session.date;
  card.querySelector('#studyplanner-priority').value = session.priority;
  card.querySelector('#studyplanner-type').value = session.type;
  
  // Remove the session being edited
  deleteSession(sessionId);
  
  showHint(`Editing session: ${session.subject}`, 'info');
}

function deleteSession(sessionId) {
  studySessions = studySessions.filter(s => s.id !== sessionId);
  localStorage.setItem('studySessions', JSON.stringify(studySessions));
  renderStudyPlanner();
  updateStats();
  updateDateCount();
}

function filterSessions() {
  const filter = document.getElementById('studyplanner-filter').value;
  const today = new Date().toISOString().split('T')[0];
  const oneWeekLater = new Date();
  oneWeekLater.setDate(oneWeekLater.getDate() + 7);
  const weekEnd = oneWeekLater.toISOString().split('T')[0];
  
  let filteredSessions = [...studySessions];
  
  switch(filter) {
    case 'today':
      filteredSessions = studySessions.filter(s => s.date === today);
      break;
    case 'week':
      filteredSessions = studySessions.filter(s => s.date >= today && s.date <= weekEnd);
      break;
    case 'subject':
      // Group by subject
      const subjects = [...new Set(studySessions.map(s => s.subject))];
      const subject = prompt('Enter subject to filter by:', subjects[0]);
      if (subject) {
        filteredSessions = studySessions.filter(s => s.subject.toLowerCase().includes(subject.toLowerCase()));
      }
      break;
    case 'priority':
      const priority = prompt('Enter priority to filter by (low/medium/high/urgent):', 'high');
      if (priority) {
        filteredSessions = studySessions.filter(s => s.priority === priority);
      }
      break;
  }
  
  // Temporary display of filtered sessions
  const listContainer = document.getElementById('studyplanner-list');
  
  if (filteredSessions.length === 0) {
    listContainer.innerHTML = '<p class="empty-state">No sessions match the filter.</p>';
    return;
  }
  
  let html = '';
  filteredSessions.forEach(session => {
    html += `
      <div class="session-item ${session.priority}">
        <div class="session-info">
          <div style="display:flex;align-items:center;margin-bottom:4px;">
            <strong>${session.subject}</strong>
            <span class="priority-badge priority-${session.priority}">${session.priority.toUpperCase()}</span>
          </div>
          <div class="small" style="color:#aaa;">
            ${formatDate(session.date)} • ${session.duration.toFixed(1)} hours
          </div>
        </div>
      </div>
    `;
  });
  
  listContainer.innerHTML = html;
  
  // Reset filter after 5 seconds
  setTimeout(() => {
    document.getElementById('studyplanner-filter').value = 'all';
    renderStudyPlanner();
  }, 5000);
}

function sortSessions() {
  // Toggle between date ascending and descending
  const currentSort = document.getElementById('studyplanner-list').dataset.sort || 'asc';
  const newSort = currentSort === 'asc' ? 'desc' : 'asc';
  
  studySessions.sort((a, b) => {
    const dateA = new Date(a.date);
    const dateB = new Date(b.date);
    return newSort === 'asc' ? dateA - dateB : dateB - dateA;
  });
  
  localStorage.setItem('studySessions', JSON.stringify(studySessions));
  renderStudyPlanner();
  
  showHint(`Sorted sessions by date (${newSort === 'asc' ? 'oldest first' : 'newest first'})`, 'info');
}

function studyplannerReset(btn) {
  if (confirm('Are you sure you want to delete all study sessions? This cannot be undone.')) {
    studySessions = [];
    localStorage.removeItem('studySessions');
    renderStudyPlanner();
    updateStats();
    updateDateCount();
    showHint('All study sessions have been deleted.', 'info');
  }
}

function studyplannerExport(btn) {
  if (studySessions.length === 0) {
    showHint('No sessions to export.', 'error');
    return;
  }
  
  // Create CSV content
  let csv = 'Subject,Date,Duration (h),Priority,Type,Completed\n';
  
  studySessions.forEach(session => {
    csv += `"${session.subject}","${session.date}",${session.duration},${session.priority},${session.type},${session.completed ? 'Yes' : 'No'}\n`;
  });
  
  // Create download link
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `study-plan-${new Date().toISOString().split('T')[0]}.csv`;
  a.click();
  window.URL.revokeObjectURL(url);
  
  showHint('Study plan exported as CSV', 'success');
}

function formatDate(dateStr) {
  const date = new Date(dateStr);
  const today = new Date();
  const tomorrow = new Date(today);
  tomorrow.setDate(tomorrow.getDate() + 1);
  
  if (dateStr === today.toISOString().split('T')[0]) {
    return 'Today';
  } else if (dateStr === tomorrow.toISOString().split('T')[0]) {
    return 'Tomorrow';
  } else {
    return date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
  }
}

function showHint(message, type = 'info') {
  const hint = document.getElementById('studyplanner-hint');
  const colors = {
    'success': '#4caf50',
    'error': '#f44336',
    'info': '#2196f3',
    'warning': '#ff9800'
  };
  
  hint.innerHTML = `<span style="color:${colors[type]}">${type === 'success' ? '✓' : type === 'error' ? '✕' : 'ⓘ'}</span> ${message}`;
  
  // Clear after 3 seconds
  setTimeout(() => {
    if (hint.innerHTML.includes(message)) {
      hint.innerHTML = '';
    }
  }, 3000);
}
</script>
