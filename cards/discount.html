<h2 id="discount-calculator-title" style="margin-top:0;color:var(--accent);position:relative;">
Â  ğŸ›ï¸ Discount Calculator
Â  <span style="position:absolute;right:0;top:0;font-size:0.7rem;color:rgba(45,212,255,0.7);font-weight:normal;">
Â  Â  Smart Shopping Tool
Â  </span>
</h2>

<form aria-describedby="discount-calculator-desc">
Â  <p id="discount-calculator-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.9);">
Â  Â  Calculate final prices after discounts, taxes, and compare savings. Perfect for shopping decisions!
Â  </p>

Â  Â  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:12px;padding:20px;border:1px solid rgba(45,212,255,0.1);margin-bottom:20px;">
Â  Â  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:20px;">
Â  Â  Â  Â  Â  Â  <div class="field" style="position:relative;">
Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
Â  Â  Â  Â  Â  <label for="dc-price" style="color:var(--accent);font-weight:500;">ğŸ’° Original Price (Â£)</label>
Â  Â  Â  Â  Â  <span id="dc-price-display" style="font-size:0.9rem;color:#ffcc00;">Â£100.00</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="display:flex;align-items:center;gap:8px;">
Â  Â  Â  Â  Â  <input id="dc-price" type="number" min="0" step="0.01" value="100.00"
Â  Â  Â  Â  Â  Â  Â  Â  Â style="flex:1;padding:14px;border-radius:8px;border:1px solid rgba(255,204,0,0.3);background:rgba(255,204,0,0.05);color:inherit;font-size:1.1rem;" />
Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:4px;">
Â  Â  Â  Â  Â  Â  <button type="button" onclick="dcAdjustValue('price', 10)" style="padding:6px 12px;border-radius:6px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;cursor:pointer;font-size:0.8rem;">+10</button>
Â  Â  Â  Â  Â  Â  <button type="button" onclick="dcAdjustValue('price', -10)" style="padding:6px 12px;border-radius:6px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;cursor:pointer;font-size:0.8rem;">-10</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="small" style="margin-top:6px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
Â  Â  Â  Â  Â  <span>Â£0.00</span>
Â  Â  Â  Â  Â  <span>Max Price</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="field" style="position:relative;">
Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
Â  Â  Â  Â  Â  <label for="dc-discount" style="color:var(--accent);font-weight:500;">ğŸ·ï¸ Discount %</label>
Â  Â  Â  Â  Â  <span id="dc-discount-display" style="font-size:0.9rem;color:#39ff14;">20%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <input id="dc-discount" type="range" min="0" max="100" step="1" value="20"
Â  Â  Â  Â  Â  Â  Â  Â style="width:100%;margin-bottom:8px;accent-color:#39ff14;" />
Â  Â  Â  Â  <input id="dc-discount-input" type="number" min="0" max="100" step="1" value="20"
Â  Â  Â  Â  Â  Â  Â  Â style="width:100%;padding:14px;border-radius:8px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:inherit;font-size:1.1rem;text-align:center;" />
Â  Â  Â  Â  <div class="small" style="margin-top:6px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
Â  Â  Â  Â  Â  <span>0%</span>
Â  Â  Â  Â  Â  <span>100%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="field" style="position:relative;">
Â  Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
Â  Â  Â  Â  Â  <label for="dc-tax" style="color:var(--accent);font-weight:500;">ğŸ“Š Tax % (on discounted price)</label>
Â  Â  Â  Â  Â  <span id="dc-tax-display" style="font-size:0.9rem;color:#ff2d55;">0%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <input id="dc-tax" type="range" min="0" max="30" step="0.5" value="0"
Â  Â  Â  Â  Â  Â  Â  Â style="width:100%;margin-bottom:8px;accent-color:#ff2d55;" />
Â  Â  Â  Â  <input id="dc-tax-input" type="number" min="0" max="50" step="0.1" value="0"
Â  Â  Â  Â  Â  Â  Â  Â style="width:100%;padding:14px;border-radius:8px;border:1px solid rgba(255,45,85,0.3);background:rgba(255,45,85,0.05);color:inherit;font-size:1.1rem;text-align:center;" />
Â  Â  Â  Â  <div class="small" style="margin-top:6px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
Â  Â  Â  Â  Â  <span>0%</span>
Â  Â  Â  Â  Â  <span>30%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  Â  Â  <div>
Â  Â  Â  <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">âš¡ Common Discounts:</div>
Â  Â  Â  <div style="display:flex;gap:8px;flex-wrap:wrap;">
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(10)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">10% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(15)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">15% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(20)" style="padding:8px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:14px;">20% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(25)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">25% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(30)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">30% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(50)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">50% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(75)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">75% Off</button>
Â  Â  Â  Â  <button type="button" onclick="dcSetDiscount(100)" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:14px;">100% Off</button>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  Â  <div style="margin-bottom:20px;">
Â  Â  <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">ğŸ’¸ Common Price Points:</div>
Â  Â  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:8px;">
Â  Â  Â  <button type="button" onclick="dcSetPrice(9.99)" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
Â  Â  Â  Â  <div>Â£9.99</div>
Â  Â  Â  Â  <div class="small" style="color:rgba(230,250,255,0.7);">Common price</div>
Â  Â  Â  </button>
Â  Â  Â  <button type="button" onclick="dcSetPrice(19.99)" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
Â  Â  Â  Â  <div>Â£19.99</div>
Â  Â  Â  Â  <div class="small" style="color:rgba(230,250,255,0.7);">Mid-range</div>
Â  Â  Â  </button>
Â  Â  Â  <button type="button" onclick="dcSetPrice(49.99)" style="padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;font-size:0.9rem;">
Â  Â  Â  Â  <div>Â£49.99</div>
Â  Â  Â  Â  <div class="small" style="color:rgba(230,250,255,0.7);">Premium item</div>
Â  Â  Â  </button>
Â  Â  Â  <button type="button" onclick="dcSetPrice(99.99)" style="padding:10px;border-radius:8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);color:var(--accent);cursor:pointer;font-size:0.9rem;">
Â  Â  Â  Â  <div>Â£99.99</div>
Â  Â  Â  Â  <div class="small" style="color:rgba(230,250,255,0.7);">Default</div>
Â  Â  Â  </button>
Â  Â  </div>
Â  </div>

Â  Â  <div style="margin-bottom:20px;">
Â  Â  <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">ğŸ›ï¸ Common Tax Rates:</div>
Â  Â  <div style="display:flex;gap:8px;flex-wrap:wrap;">
Â  Â  Â  <button type="button" onclick="dcSetTax(0)" style="padding:6px 12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:12px;">0% (Tax-free)</button>
Â  Â  Â  <button type="button" onclick="dcSetTax(5)" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">5% (Reduced)</button>
Â  Â  Â  <button type="button" onclick="dcSetTax(10)" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">10% (Standard)</button>
Â  Â  Â  <button type="button" onclick="dcSetTax(20)" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">20% (VAT UK)</button>
Â  Â  Â  <button type="button" onclick="dcSetTax(25)" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">25% (High VAT)</button>
Â  Â  </div>
Â  </div>

Â  Â  <div class="actions" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:10px;margin-top:20px;">
Â  Â  <button type="button" onclick="dcCalculate(this)"Â 
Â  Â  Â  Â  Â  Â  style="padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;transition:all 0.2s;">
Â  Â  Â  ğŸ§® Calculate Now
Â  Â  </button>
Â  Â  <button type="button" onclick="dcCompareDiscounts(this)"
Â  Â  Â  Â  Â  Â  style="padding:14px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;transition:all 0.2s;">
Â  Â  Â  ğŸ“Š Compare Deals
Â  Â  </button>
Â  Â  <button type="button" onclick="dcCopyResults(this)"
Â  Â  Â  Â  Â  Â  style="padding:14px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;border-radius:8px;cursor:pointer;transition:all 0.2s;">
Â  Â  Â  ğŸ“‹ Copy Results
Â  Â  </button>
Â  Â  <button type="button" onclick="dcReset(this)"
Â  Â  Â  Â  Â  Â  style="padding:14px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;transition:all 0.2s;">
Â  Â  Â  ğŸ”„ Reset All
Â  Â  </button>
Â  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:20px;">
Â  Â  <div id="dc-results-section" style="display:none;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:8px;padding:24px;border:1px solid rgba(45,212,255,0.1);margin-bottom:20px;">
Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
Â  Â  Â  <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“Š Price Breakdown</h3>
Â  Â  Â  <button onclick="dcSaveDeal()" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.9rem;">
Â  Â  Â  Â  ğŸ’¾ Save Deal
Â  Â  Â  </button>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div style="margin-bottom:24px;">
Â  Â  Â  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Original Price</div>
Â  Â  Â  Â  Â  <div id="dc-original-price" style="font-size:1.5rem;font-weight:700;color:#ffcc00;">Â£100.00</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="font-size:1.5rem;color:var(--accent);">â†’</div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Final Price</div>
Â  Â  Â  Â  Â  <div id="dc-final-price" style="font-size:2.2rem;font-weight:800;color:#39ff14;">Â£80.00</div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div style="height:8px;background:linear-gradient(90deg, #ff4d4d, #ffcc00, #39ff14);border-radius:4px;margin-bottom:8px;position:relative;">
Â  Â  Â  Â  <div id="dc-savings-marker" style="position:absolute;top:-6px;width:2px;height:20px;background:white;border-radius:1px;box-shadow:0 0 6px rgba(255,255,255,0.8);left:80%;transition:left 0.5s ease;"></div>
Â  Â  Â  </div>
Â  Â  Â  <div style="display:flex;justify-content:space-between;font-size:0.8rem;color:rgba(230,250,255,0.6);">
Â  Â  Â  Â  <span>Original (0%)</span>
Â  Â  Â  Â  <span>Discounted</span>
Â  Â  Â  Â  <span>Final (100%)</span>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));gap:16px;margin-bottom:24px;">
Â  Â  Â  <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’¸ Discount Amount</div>
Â  Â  Â  Â  <div id="dc-discount-amount" style="font-size:1.8rem;font-weight:700;color:#39ff14;">Â£20.00</div>
Â  Â  Â  Â  <div id="dc-save-percent" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">20% off</div>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ·ï¸ Discounted Price</div>
Â  Â  Â  Â  <div id="dc-discounted-price" style="font-size:1.8rem;font-weight:700;color:#ffcc00;">Â£80.00</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Before tax</div>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ“Š Tax Amount</div>
Â  Â  Â  Â  <div id="dc-tax-amount" style="font-size:1.8rem;font-weight:700;color:#ff2d55;">Â£0.00</div>
Â  Â  Â  Â  <div id="dc-tax-rate" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">0% tax rate</div>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’° Total Saved</div>
Â  Â  Â  Â  <div id="dc-total-savings" style="font-size:1.4rem;font-weight:700;color:#9d4edd;">Â£20.00</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Savings including tax effect</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div>
Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:12px;">ğŸ’¡ Shopping Insights</div>
Â  Â  Â  <div id="dc-insights" style="padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border-left:4px solid var(--accent);">
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);line-height:1.5;">
Â  Â  Â  Â  Â  Enter your price details and click **Calculate Now** to see shopping insights and savings tips.
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  Â  <div id="dc-comparison-section" style="display:none;background:rgba(0,0,0,0.1);border-radius:8px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
Â  Â  <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;font-size:1.1rem;">ğŸ“Š Compare Different Discounts</h3>
Â  Â  <div style="overflow-x:auto;">
Â  Â  Â  <table style="width:100%;border-collapse:collapse;font-size:0.9rem;">
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr style="border-bottom:1px solid rgba(255,255,255,0.1);">
Â  Â  Â  Â  Â  Â  <th style="text-align:left;padding:8px;color:var(--accent);">Deal (Price: Â£<span id="dc-comparison-base-price">100.00</span>)</th>
Â  Â  Â  Â  Â  Â  <th style="text-align:right;padding:8px;color:var(--accent);">Discounted Price</th>
Â  Â  Â  Â  Â  Â  <th style="text-align:right;padding:8px;color:var(--accent);">Tax Amount</th>
Â  Â  Â  Â  Â  Â  <th style="text-align:right;padding:8px;color:var(--accent);">Final Price</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody id="dc-comparison-body">
Â  Â  Â  Â  Â  <tr><td colspan="4" style="text-align:center;padding:12px;color:rgba(230,250,255,0.7);">Click 'Compare Deals' to generate comparison data.</td></tr>
Â  Â  Â  Â  </tbody>
Â  Â  Â  </table>
Â  Â  </div>
Â  </div>

Â  Â  <div style="background:rgba(0,0,0,0.1);border-radius:8px;padding:24px;border:1px solid rgba(255,255,255,0.05);">
Â  Â  <h3 style="color:var(--accent);margin-top:0;margin-bottom:20px;font-size:1.1rem;">ğŸ’¡ Smart Shopping Tips</h3>
Â  Â Â 
Â  Â  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:20px;">
Â  Â  Â  <div style="padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;">
Â  Â  Â  Â  <div style="color:#39ff14;font-weight:600;margin-bottom:8px;">ğŸ¯ Calculate Real Discounts</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Always calculate the final price including tax to know the real cost.</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="padding:16px;background:rgba(57,255,20,0.05);border-radius:8px;">
Â  Â  Â  Â  <div style="color:#ffcc00;font-weight:600;margin-bottom:8px;">ğŸ•’ Wait for Better Deals</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Many items go on deeper discount during clearance sales.</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="padding:16px;background:rgba(255,204,0,0.05);border-radius:8px;">
Â  Â  Â  Â  <div style="color:#9d4edd;font-weight:600;margin-bottom:8px;">ğŸ“¦ Bulk Buying</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Check for unit price savings when buying multiple items.</div>
Â  Â  Â  </div>
Â  Â  Â  <div style="padding:16px;background:rgba(157,78,221,0.05);border-radius:8px;">
Â  Â  Â  Â  <div style="color:#2dd4ff;font-weight:600;margin-bottom:8px;">âš¡ Stack Discounts</div>
Â  Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Combine coupons, sales, and cashback for maximum savings.</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  Â  Â  <div style="padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border-left:4px solid var(--accent);">
Â  Â  Â  <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">ğŸ“ Quick Calculation Rules (Mental Math)</div>
Â  Â  Â  <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);line-height:1.5;">
Â  Â  Â  Â  â€¢ <strong>10% off:</strong> Move decimal one place left (Â£100 â†’ Â£90)<br>
Â  Â  Â  Â  â€¢ <strong>20% off:</strong> Find 10% (move decimal) and double it (Â£100 â†’ Â£80)<br>
Â  Â  Â  Â  â€¢ <strong>25% off:</strong> Divide the price by 4 (Â£100 â†’ Â£75)<br>
Â  Â  Â  Â  â€¢ <strong>50% off:</strong> Halve the price (Â£100 â†’ Â£50)<br>
Â  Â  Â  Â  â€¢ <strong>75% off:</strong> Quarter the price (Â£100 â†’ Â£25)
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</div>

<script>
/* discount-calculator.html - Completed Logic
Â  Â - Advanced discount calculator with visual comparisons
Â  Â - Scoped with dc- prefix
*/

let dealHistory = [];

// Helper function to format currency
function dcFormatCurrency(value) {
Â  return 'Â£' + (value || 0).toFixed(2);
}

// Helper function to handle DOM selection scoped to the current card
function dcGetCard() {
Â  return document.currentScript?.closest('.card') || document;
}

// Function to calculate all values and return them as an object
function dcCalculateValues(price, discountPercentage, taxPercentage) {
Â  const discount = discountPercentage / 100;
Â  const tax = taxPercentage / 100;

Â  const discountAmount = price * discount;
Â  const discountedPrice = price - discountAmount;
Â  const taxAmount = discountedPrice * tax;
Â  const finalPrice = discountedPrice + taxAmount;
Â  const totalSavings = price - finalPrice;

Â  return {
Â  Â  price,
Â  Â  discountPercentage,
Â  Â  taxPercentage,
Â  Â  discountAmount,
Â  Â  discountedPrice,
Â  Â  taxAmount,
Â  Â  finalPrice,
Â  Â  totalSavings
Â  };
}

// Function to update the main results display
function dcUpdateResultsDisplay(results) {
Â  const card = dcGetCard();
Â  const { price, discountPercentage, taxPercentage, discountAmount, discountedPrice, taxAmount, finalPrice, totalSavings } = results;

Â  // 1. Update main display
Â  dcAnimateValue('dc-original-price', dcFormatCurrency(price));
Â  dcAnimateValue('dc-final-price', dcFormatCurrency(finalPrice), 100, '#39ff14');
Â  dcAnimateValue('dc-discount-amount', dcFormatCurrency(discountAmount));
Â  dcAnimateValue('dc-discounted-price', dcFormatCurrency(discountedPrice));
Â  dcAnimateValue('dc-tax-amount', dcFormatCurrency(taxAmount), 100, '#ff2d55');
Â  dcAnimateValue('dc-total-savings', dcFormatCurrency(totalSavings), 100, '#9d4edd');

Â  card.querySelector('#dc-save-percent').textContent = discountPercentage.toFixed(0) + '% off';
Â  card.querySelector('#dc-tax-rate').textContent = taxPercentage.toFixed(1) + '% tax rate';

Â  // 2. Update Savings Visual Bar
Â  const savingsMarker = card.querySelector('#dc-savings-marker');
Â  if (price > 0) {
Â  Â  const markerPosition = (finalPrice / price) * 100;
Â  Â  savingsMarker.style.left = markerPosition.toFixed(2) + '%';
Â  Â  savingsMarker.style.background = totalSavings > 0 ? 'white' : 'red';
Â  } else {
Â  Â  savingsMarker.style.left = '100%';
Â  Â  savingsMarker.style.background = 'white';
Â  }

Â  // 3. Update Insights
Â  const insightDiv = card.querySelector('#dc-insights').querySelector('div');
Â  if (totalSavings > 0 && taxPercentage === 0) {
Â  Â  insightDiv.innerHTML = `ğŸ‰ You are saving a fantastic **${dcFormatCurrency(totalSavings)}**! The discounted price is the final price.`;
Â  Â  insightDiv.style.borderLeftColor = '#39ff14';
Â  } else if (totalSavings > 0 && taxPercentage > 0) {
Â  Â  insightDiv.innerHTML = `ğŸ’¸ Your total savings are **${dcFormatCurrency(totalSavings)}**, but remember the tax of ${taxPercentage.toFixed(1)}% adds ${dcFormatCurrency(taxAmount)} to the final cost.`;
Â  Â  insightDiv.style.borderLeftColor = '#ffcc00';
Â  } else if (price === 0) {
Â  Â  insightDiv.innerHTML = `Enter a price greater than Â£0 to calculate savings.`;
Â  Â  insightDiv.style.borderLeftColor = 'var(--accent)';
Â  } else {
Â  Â  insightDiv.innerHTML = `âš ï¸ No discount applied, or tax exceeds savings. Final price is ${dcFormatCurrency(finalPrice)}.`;
Â  Â  insightDiv.style.borderLeftColor = '#ff4d4d';
Â  }
}

// Main calculation and display function (triggered by button)
function dcCalculate(btn = null) {
Â  const card = dcGetCard();
Â  const price = parseFloat(card.querySelector('#dc-price').value) || 0;
Â  const discount = parseFloat(card.querySelector('#dc-discount-input').value) || 0;
Â  const tax = parseFloat(card.querySelector('#dc-tax-input').value) || 0;

Â  // Input validation
Â  if (price <= 0) {
Â  Â  alert("Please enter a valid Original Price greater than zero.");
Â  Â  return;
Â  }

Â  // Visual feedback (start)
Â  if (btn) {
Â  Â  btn.innerHTML = 'â³ Calculating...';
Â  Â  btn.disabled = true;
Â  }

Â  setTimeout(() => {
Â  Â  const results = dcCalculateValues(price, discount, tax);
Â  Â  dcUpdateResultsDisplay(results);

Â  Â  card.querySelector('#dc-results-section').style.display = 'block';
Â  Â  card.querySelector('#dc-comparison-section').style.display = 'none'; // Hide comparison when main calc runs

Â  Â  // Visual feedback (end)
Â  Â  if (btn) {
Â  Â  Â  btn.innerHTML = 'ğŸ§® Calculate Now';
Â  Â  Â  btn.disabled = false;
Â  Â  }
Â  }, 200);
}

// Auto-calculation logic (triggered by input changes)
function dcAutoCalculate() {
Â  const card = dcGetCard();
Â  const price = parseFloat(card.querySelector('#dc-price').value) || 0;
Â  const discount = parseFloat(card.querySelector('#dc-discount-input').value) || 0;
Â  const tax = parseFloat(card.querySelector('#dc-tax-input').value) || 0;
Â Â 
Â  if (price > 0 && card.querySelector('#dc-results-section').style.display === 'block') {
Â  Â  const results = dcCalculateValues(price, discount, tax);
Â  Â  dcUpdateResultsDisplay(results);
Â  }
}

// Function to handle value changes from presets or adjust buttons
function dcAdjustValue(type, amount) {
Â  const card = dcGetCard();
Â Â 
Â  if (type === 'price') {
Â  Â  const input = card.querySelector('#dc-price');
Â  Â  const current = parseFloat(input.value) || 0;
Â  Â  const newValue = Math.max(0, Math.min(999999, current + amount)); // Cap max price
Â  Â  input.value = newValue.toFixed(2);
Â  Â  card.querySelector('#dc-price-display').textContent = dcFormatCurrency(newValue);
Â  }
Â  dcAutoCalculate();
}

function dcSetPrice(price) {
Â  const card = dcGetCard();
Â  card.querySelector('#dc-price').value = price.toFixed(2);
Â  card.querySelector('#dc-price-display').textContent = dcFormatCurrency(price);
Â  dcHighlightPreset('dcSetPrice', price);
Â  dcAutoCalculate();
}

function dcSetDiscount(discount) {
Â  const card = dcGetCard();
Â  card.querySelector('#dc-discount').value = discount;
Â  card.querySelector('#dc-discount-input').value = discount;
Â  card.querySelector('#dc-discount-display').textContent = discount + '%';
Â  dcHighlightPreset('dcSetDiscount', discount);
Â  dcAutoCalculate();
}

function dcSetTax(tax) {
Â  const card = dcGetCard();
Â  card.querySelector('#dc-tax').value = tax;
Â  card.querySelector('#dc-tax-input').value = tax;
Â  card.querySelector('#dc-tax-display').textContent = tax + '%';
Â  dcHighlightPreset('dcSetTax', tax);
Â  dcAutoCalculate();
}

// Function to handle preset button highlighting
function dcHighlightPreset(funcName, value) {
Â  const card = dcGetCard();
Â  card.querySelectorAll(`[onclick*="${funcName}"]`).forEach(btn => {
Â  Â  btn.style.background = 'rgba(255,255,255,0.05)';
Â  Â  btn.style.border = '1px solid rgba(255,255,255,0.1)';
Â  Â  btn.style.color = funcName === 'dcSetTax' ? '#e6faff' : (funcName === 'dcSetPrice' ? 'inherit' : '#e6faff');
Â  });

Â  const activeBtn = Array.from(card.querySelectorAll(`[onclick*="${funcName}"]`)).find(btn =>
Â  Â  btn.getAttribute('onclick')?.includes(`(${value})`)
Â  );

Â  if (activeBtn) {
Â  Â  if (funcName === 'dcSetPrice' && value === 99.99) {
Â  Â  Â  activeBtn.style.background = 'rgba(45,212,255,0.1)';
Â  Â  Â  activeBtn.style.border = '1px solid rgba(45,212,255,0.3)';
Â  Â  Â  activeBtn.style.color = 'var(--accent)';
Â  Â  } else if (funcName === 'dcSetDiscount' && value === 20) {
Â  Â  Â  activeBtn.style.background = 'rgba(57,255,20,0.1)';
Â  Â  Â  activeBtn.style.border = '1px solid rgba(57,255,20,0.3)';
Â  Â  Â  activeBtn.style.color = '#39ff14';
Â  Â  } else if (funcName === 'dcSetTax' && value === 0) {
Â  Â  Â  activeBtn.style.background = 'rgba(57,255,20,0.1)';
Â  Â  Â  activeBtn.style.border = '1px solid rgba(57,255,20,0.3)';
Â  Â  Â  activeBtn.style.color = '#39ff14';
Â  Â  } else if (funcName === 'dcSetTax') {
Â  Â  Â  activeBtn.style.background = 'rgba(255,45,85,0.1)';
Â  Â  Â  activeBtn.style.border = '1px solid rgba(255,45,85,0.3)';
Â  Â  Â  activeBtn.style.color = '#ff2d55';
Â  Â  } else {
Â  Â  Â  activeBtn.style.background = 'rgba(45,212,255,0.1)';
Â  Â  Â  activeBtn.style.border = '1px solid rgba(45,212,255,0.3)';
Â  Â  Â  activeBtn.style.color = 'var(--accent)';
Â  Â  }
Â  }
}


// Function to compare multiple common discounts
function dcCompareDiscounts(btn) {
Â  const card = dcGetCard();
Â  const price = parseFloat(card.querySelector('#dc-price').value) || 0;
Â  const currentTax = parseFloat(card.querySelector('#dc-tax-input').value) || 0;
Â  const comparisonBody = card.querySelector('#dc-comparison-body');
Â  const comparisonBasePrice = card.querySelector('#dc-comparison-base-price');

Â  if (price <= 0) {
Â  Â  alert("Please enter a valid Original Price greater than zero to compare deals.");
Â  Â  return;
Â  }

Â  // Visual feedback
Â  btn.innerHTML = 'â³ Generating...';
Â  btn.disabled = true;

Â  const comparisonDiscounts = [10, 15, 20, 25, 30, 50];
Â  let html = '';
Â  let highestSavings = -1;

Â  comparisonDiscounts.forEach(d => {
Â  Â  const results = dcCalculateValues(price, d, currentTax);
Â  Â  if (results.totalSavings > highestSavings) {
Â  Â  Â  highestSavings = results.totalSavings;
Â  Â  }
Â  Â  results.discount = d;
Â  Â  dealHistory.push(results); // Optionally log to history
Â  });

Â  // Sort history by final price (best deal first)
Â  dealHistory.sort((a, b) => a.finalPrice - b.finalPrice);

Â  dealHistory.forEach(r => {
Â  Â  const isBest = r.finalPrice === dealHistory[0].finalPrice && r.finalPrice < price;
Â  Â  const rowStyle = isBest ? 'background:rgba(57,255,20,0.1);font-weight:600;color:#39ff14;' : '';
Â  Â  const label = `${r.discount}% Off (Tax: ${r.taxPercentage.toFixed(1)}%)`;
Â  Â  html += `
Â  Â  Â  <tr style="border-bottom:1px solid rgba(255,255,255,0.05);${rowStyle}">
Â  Â  Â  Â  <td style="text-align:left;padding:8px;">${label} ${isBest ? 'â­ BEST DEAL' : ''}</td>
Â  Â  Â  Â  <td style="text-align:right;padding:8px;color:#ffcc00;">${dcFormatCurrency(r.discountedPrice)}</td>
Â  Â  Â  Â  <td style="text-align:right;padding:8px;color:#ff2d55;">${dcFormatCurrency(r.taxAmount)}</td>
Â  Â  Â  Â  <td style="text-align:right;padding:8px;font-size:1.1rem;color:${isBest ? '#39ff14' : 'inherit'};">${dcFormatCurrency(r.finalPrice)}</td>
Â  Â  Â  </tr>
Â  Â  `;
Â  });

Â  comparisonBody.innerHTML = html;
Â  comparisonBasePrice.textContent = price.toFixed(2);
Â  card.querySelector('#dc-comparison-section').style.display = 'block';
Â  card.querySelector('#dc-results-section').style.display = 'none'; // Hide main calc when comparison runs

Â  // Visual feedback end
Â  setTimeout(() => {
Â  Â  btn.innerHTML = 'ğŸ“Š Compare Deals';
Â  Â  btn.disabled = false;
Â  }, 200);
}

// Function to save current deal (using local storage)
function dcSaveDeal() {
Â  const card = dcGetCard();
Â  const price = parseFloat(card.querySelector('#dc-price').value) || 0;
Â  const discount = parseFloat(card.querySelector('#dc-discount-input').value) || 0;
Â  const tax = parseFloat(card.querySelector('#dc-tax-input').value) || 0;

Â  if (price <= 0) {
Â  Â  alert("Enter a price to save a deal.");
Â  Â  return;
Â  }

Â  const currentDeal = dcCalculateValues(price, discount, tax);
Â  
Â  // Simple check to prevent duplicate saves immediately
Â  if (dealHistory.length > 0 && JSON.stringify(dealHistory[dealHistory.length - 1]) === JSON.stringify(currentDeal)) {
Â  Â  alert("This exact deal has already been saved!");
Â  Â  return;
Â  }
Â  
Â  dealHistory.push(currentDeal);
Â  localStorage.setItem('dc-deal-history', JSON.stringify(dealHistory));
Â  alert(`Deal Saved: ${dcFormatCurrency(currentDeal.finalPrice)} (Discount: ${discount}%, Tax: ${tax}%)`);
}

// Function to copy results to clipboard
function dcCopyResults(btn) {
Â  const card = dcGetCard();
Â  const price = parseFloat(card.querySelector('#dc-price').value) || 0;
Â Â 
Â  if (price <= 0 || card.querySelector('#dc-results-section').style.display !== 'block') {
Â  Â  alert("Please calculate the final price first.");
Â  Â  return;
Â  }

Â  const finalPrice = card.querySelector('#dc-final-price').textContent;
Â  const originalPrice = card.querySelector('#dc-original-price').textContent;
Â  const totalSavings = card.querySelector('#dc-total-savings').textContent;
Â  const discountPercent = card.querySelector('#dc-save-percent').textContent;
Â  const taxRate = card.querySelector('#dc-tax-rate').textContent;
Â Â 
Â  const copyText = `
ğŸ›ï¸ Discount Calculation Results
---------------------------------
Original Price: ${originalPrice}
Discount (${discountPercent}): ${totalSavings}
Tax (${taxRate}): ${card.querySelector('#dc-tax-amount').textContent}
---------------------------------
ğŸ’° Final Price: ${finalPrice}
---------------------------------
`;
Â Â 
Â  navigator.clipboard?.writeText(copyText.trim()).then(() => {
Â  Â  btn.innerHTML = 'ğŸ“‹ Copied!';
Â  Â  setTimeout(() => { btn.innerHTML = 'ğŸ“‹ Copy Results'; }, 1500);
Â  }).catch(() => alert("Copy failed."));
}

// Function to reset all inputs and results
function dcReset(btn) {
Â  const card = dcGetCard();
Â  card.querySelector('#dc-price').value = 100.00;
Â  card.querySelector('#dc-discount').value = 20;
Â  card.querySelector('#dc-discount-input').value = 20;
Â  card.querySelector('#dc-tax').value = 0;
Â  card.querySelector('#dc-tax-input').value = 0;

Â  // Reset displays
Â  card.querySelector('#dc-price-display').textContent = 'Â£100.00';
Â  card.querySelector('#dc-discount-display').textContent = '20%';
Â  card.querySelector('#dc-tax-display').textContent = '0%';
Â  card.querySelector('#dc-results-section').style.display = 'none';
Â  card.querySelector('#dc-comparison-section').style.display = 'none';
Â  card.querySelector('#dc-comparison-body').innerHTML = '<tr><td colspan="4" style="text-align:center;padding:12px;color:rgba(230,250,255,0.7);">Click \'Compare Deals\' to generate comparison data.</td></tr>';

Â  // Reset history (optional)
Â  dealHistory = [];
Â  localStorage.removeItem('dc-deal-history');
Â  
Â  // Reset highlights
Â  dcHighlightPreset('dcSetPrice', 99.99);
Â  dcHighlightPreset('dcSetDiscount', 20);
Â  dcHighlightPreset('dcSetTax', 0);
Â  
Â  alert("Calculator reset to default values (Â£100, 20% off, 0% tax).");
}

// Simple animation helper
function dcAnimateValue(id, newValue, duration = 300, color = 'inherit') {
Â  const element = dcGetCard().querySelector(`#${id}`);
Â  if (!element) return;
Â  element.style.transition = `color ${duration}ms ease-out`;
Â  element.style.color = 'var(--accent)'; // Flash accent color
Â  setTimeout(() => {
Â  Â  element.textContent = newValue;
Â  Â  element.style.color = color; // Settle to final color
Â  }, duration / 2);
}

// Initialize synchronization and initial calculation
document.addEventListener('DOMContentLoaded', function() {
Â  dcInitializeInputs();
Â  dcHighlightPreset('dcSetPrice', 99.99);
Â  dcHighlightPreset('dcSetDiscount', 20);
Â  dcHighlightPreset('dcSetTax', 0);
Â  
Â  // Load history from localStorage
Â  const savedHistory = localStorage.getItem('dc-deal-history');
Â  if (savedHistory) {
Â  Â  try {
Â  Â  Â  dealHistory = JSON.parse(savedHistory);
Â  Â  } catch (e) {
Â  Â  Â  console.error("Could not load deal history:", e);
Â  Â  Â  dealHistory = [];
Â  Â  }
Â  }
});

function dcInitializeInputs() {
Â  const card = dcGetCard();
Â Â 
Â  // Price sync
Â  const priceInput = card.querySelector('#dc-price');
Â  const priceDisplay = card.querySelector('#dc-price-display');
Â  priceInput.addEventListener('input', function() {
Â  Â  const value = parseFloat(this.value) || 0;
Â  Â  priceDisplay.textContent = dcFormatCurrency(value);
Â  Â  dcAutoCalculate();
Â  });
Â Â 
Â  // Discount sync
Â  const discountSlider = card.querySelector('#dc-discount');
Â  const discountInput = card.querySelector('#dc-discount-input');
Â  const discountDisplay = card.querySelector('#dc-discount-display');
Â Â 
Â  discountSlider.addEventListener('input', function() {
Â  Â  const value = parseInt(this.value);
Â  Â  discountInput.value = value;
Â  Â  discountDisplay.textContent = value + '%';
Â  Â  dcHighlightPreset('dcSetDiscount', value);
Â  Â  dcAutoCalculate();
Â  });
Â  discountInput.addEventListener('input', function() {
Â  Â  const value = Math.min(100, Math.max(0, parseInt(this.value) || 0));
Â  Â  discountSlider.value = value;
Â  Â  discountDisplay.textContent = value + '%';
Â  Â  dcHighlightPreset('dcSetDiscount', value);
Â  Â  dcAutoCalculate();
Â  });
Â Â 
Â  // Tax sync
Â  const taxSlider = card.querySelector('#dc-tax');
Â  const taxInput = card.querySelector('#dc-tax-input');
Â  const taxDisplay = card.querySelector('#dc-tax-display');
Â Â 
Â  taxSlider.addEventListener('input', function() {
Â  Â  const value = parseFloat(this.value).toFixed(1);
Â  Â  taxInput.value = value;
Â  Â  taxDisplay.textContent = value + '%';
Â  Â  dcHighlightPreset('dcSetTax', parseFloat(value));
Â  Â  dcAutoCalculate();
Â  });
Â  taxInput.addEventListener('input', function() {
Â  Â  const value = Math.min(50, Math.max(0, parseFloat(this.value) || 0)).toFixed(1);
Â  Â  taxSlider.value = value;
Â  Â  taxDisplay.textContent = value + '%';
Â  Â  dcHighlightPreset('dcSetTax', parseFloat(value));
Â  Â  dcAutoCalculate();
Â  });
}

</script>

<style>
/* Card-specific styles only */
#discount-calculator-title {
Â  Â  color: var(--accent);
}

/* Custom range slider styling for better visual */
input[type=range]::-webkit-slider-thumb {
Â  Â  -webkit-appearance: none;
Â  Â  height: 18px;
Â  Â  width: 18px;
Â  Â  border-radius: 50%;
Â  Â  cursor: pointer;
Â  Â  margin-top: -6px; /* Adjust alignment */
}

#dc-discount::-webkit-slider-thumb {
Â  Â  background: #39ff14;
Â  Â  border: 2px solid rgba(0, 0, 0, 0.4);
}

#dc-tax::-webkit-slider-thumb {
Â  Â  background: #ff2d55;
Â  Â  border: 2px solid rgba(0, 0, 0, 0.4);
}

/* Ensure default buttons also adopt the glass style if they weren't explicitly styled */
.actions button:hover {
Â  Â  transform: translateY(-2px);
Â  Â  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
</style>
