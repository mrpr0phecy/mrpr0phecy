<!-- cards/christmas-naughty-list-quiz.html -->
<h2 id="christmas-naughty-list-title" style="margin-top:0;color:var(--accent);">ğŸ… Am I on Santa's Christmas Naughty List?</h2>

<form aria-describedby="christmas-naughty-list-desc">
  <p id="christmas-naughty-list-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.8);">
    Take this scientific* holiday quiz to discover if you're getting coal or presents this Christmas!
    <span style="color:var(--accent);font-weight:500;">*Not actually scientific</span>
  </p>

  <div id="quiz-container" style="margin-bottom:20px;">
    <!-- Question 1 -->
    <div class="quiz-question active" data-question="1">
      <h4 style="color:var(--accent);margin-bottom:12px;">1. How many Christmas cookies have you stolen from the kitchen this month?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(1, 0, this)">
          <span style="color:#39ff14;">ğŸ„</span> None, I'm saving them for Santa
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(1, 1, this)">
          <span style="color:#ffa500;">ğŸª</span> Just a few... for quality control
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(1, 2, this)">
          <span style="color:#ff2d55;">ğŸ‘¹</span> ALL OF THEM. The cookie jar is my domain now
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(1, 3, this)">
          <span style="color:#ff0000;">ğŸ”¥</span> I've moved on to stealing from neighbors
        </button>
      </div>
    </div>

    <!-- Question 2 -->
    <div class="quiz-question" data-question="2" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">2. How early did you start playing Christmas music?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(2, 0, this)">
          <span style="color:#39ff14;">ğŸ¶</span> December 1st, like a civilized person
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(2, 1, this)">
          <span style="color:#ffa500;">ğŸ“»</span> November... just a little...
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(2, 2, this)">
          <span style="color:#ff2d55;">ğŸ§</span> October. Halloween? Never heard of her.
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(2, 3, this)">
          <span style="color:#ff0000;">ğŸ”Š</span> July 5th. I play it year-round in my bunker
        </button>
      </div>
    </div>

    <!-- Question 3 -->
    <div class="quiz-question" data-question="3" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">3. Have you peeked at your presents?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(3, 0, this)">
          <span style="color:#39ff14;">ğŸ‘¼</span> Never! I respect the magic
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(3, 1, this)">
          <span style="color:#ffa500;">ğŸ‘€</span> Maybe just shook them a little...
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(3, 2, this)">
          <span style="color:#ff2d55;">ğŸ</span> I know what they are, where they are, and the tracking number
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(3, 3, this)">
          <span style="color:#ff0000;">ğŸ•µï¸</span> I've already "tested" them to make sure they work
        </button>
      </div>
    </div>

    <!-- Question 4 -->
    <div class="quiz-question" data-question="4" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">4. How's your Christmas spirit level?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(4, 0, this)">
          <span style="color:#39ff14;">ğŸŒŸ</span> So high I'm basically a human Christmas tree
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(4, 1, this)">
          <span style="color:#ffa500;">âœ¨</span> Normal holiday cheer
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(4, 2, this)">
          <span style="color:#ff2d55;">ğŸ˜</span> I'm here for the food and time off
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(4, 3, this)">
          <span style="color:#ff0000;">ğŸŒ§ï¸</span> My spirit animal is the Grinch before his heart grew
        </button>
      </div>
    </div>

    <!-- Question 5 -->
    <div class="quiz-question" data-question="5" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">5. Did you finish your Christmas shopping?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(5, 0, this)">
          <span style="color:#39ff14;">âœ…</span> Done in July! All wrapped and labeled
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(5, 1, this)">
          <span style="color:#ffa500;">ğŸ“</span> Mostly done, just a few things left
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(5, 2, this)">
          <span style="color:#ff2d55;">ğŸ¤”</span> I have a list... somewhere...
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(5, 3, this)">
          <span style="color:#ff0000;">ğŸƒ</span> December 24th, 11:59 PM is my strategy
        </button>
      </div>
    </div>

    <!-- Question 6 -->
    <div class="quiz-question" data-question="6" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">6. How many times have you watched "Die Hard"?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(6, 0, this)">
          <span style="color:#39ff14;">ğŸ¬</span> Zero - it's not a Christmas movie!
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(6, 1, this)">
          <span style="color:#ffa500;">ğŸ¿</span> Once - for the debate research
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(6, 2, this)">
          <span style="color:#ff2d55;">ğŸ¥</span> Annual tradition with eggnog
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(6, 3, this)">
          <span style="color:#ff0000;">ğŸ”</span> Loop it from Thanksgiving to New Year's
        </button>
      </div>
    </div>

    <!-- Question 7 -->
    <div class="quiz-question" data-question="7" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">7. Have you ever "regifted"?</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(7, 0, this)">
          <span style="color:#39ff14;">ğŸ</span> Never! Each gift is chosen with love
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(7, 1, this)">
          <span style="color:#ffa500;">ğŸ”„</span> Only if I know they'll love it more
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(7, 2, this)">
          <span style="color:#ff2d55;">ğŸ¯</span> It's called "thoughtful redistribution"
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(7, 3, this)">
          <span style="color:#ff0000;">â™»ï¸</span> I'm the CEO of Regift Incorporated
        </button>
      </div>
    </div>

    <!-- Question 8 -->
    <div class="quiz-question" data-question="8" style="display:none;">
      <h4 style="color:var(--accent);margin-bottom:12px;">8. Your reaction when someone says "Happy Holidays":</h4>
      <div class="quiz-options" style="display:grid;gap:8px;">
        <button type="button" class="quiz-option" data-points="0" onclick="xmasSelectAnswer(8, 0, this)">
          <span style="color:#39ff14;">ğŸ˜Š</span> "Happy Holidays to you too!"
        </button>
        <button type="button" class="quiz-option" data-points="1" onclick="xmasSelectAnswer(8, 1, this)">
          <span style="color:#ffa500;">ğŸ™‚</span> "Thanks! Merry Christmas!"
        </button>
        <button type="button" class="quiz-option" data-points="2" onclick="xmasSelectAnswer(8, 2, this)">
          <span style="color:#ff2d55;">ğŸ˜ </span> "IT'S MERRY CHRISTMAS!"
        </button>
        <button type="button" class="quiz-option" data-points="3" onclick="xmasSelectAnswer(8, 3, this)">
          <span style="color:#ff0000;">ğŸ¤¬</span> I've started a 3-hour lecture on tradition
        </button>
      </div>
    </div>
  </div>

  <!-- Quiz Navigation -->
  <div id="quiz-nav" style="display:flex;justify-content:space-between;margin-top:20px;">
    <button type="button" onclick="xmasPrevQuestion()" id="prev-btn" 
            style="padding:10px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;display:none;">
      â† Previous
    </button>
    
    <div style="text-align:center;flex:1;">
      <div id="quiz-progress" class="small" style="color:var(--accent);margin-bottom:4px;">Question 1 of 8</div>
      <div style="height:6px;background:rgba(255,255,255,0.1);border-radius:3px;overflow:hidden;">
        <div id="quiz-progress-bar" style="height:100%;background:linear-gradient(90deg, #2dd4ff, #39ff14);width:12.5%;transition:width 0.3s;"></div>
      </div>
    </div>
    
    <button type="button" onclick="xmasNextQuestion()" id="next-btn"
            style="padding:10px 16px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;">
      Next Question â†’
    </button>
  </div>
</form>

<!-- Results Section -->
<div id="quiz-results" style="margin-top:20px;display:none;">
  <div style="text-align:center;margin-bottom:24px;">
    <div id="result-emoji" style="font-size:64px;margin-bottom:8px;">ğŸ…</div>
    <h3 id="result-title" style="color:var(--accent);margin-bottom:8px;">Santa's Verdict</h3>
    <div id="result-subtitle" class="small" style="color:rgba(230,250,255,0.8);margin-bottom:16px;">Based on our highly scientific analysis</div>
  </div>

  <div id="result-content" style="background:rgba(0,0,0,0.2);border-radius:10px;padding:20px;border:1px solid rgba(45,212,255,0.2);margin-bottom:20px;">
    <!-- Dynamic content will go here -->
  </div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px;">
    <div style="text-align:center;padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;">
      <div style="font-size:32px;font-weight:600;color:var(--accent);" id="score-display">0</div>
      <div class="small" style="color:rgba(230,250,255,0.7);">Naughty Score</div>
    </div>
    <div style="text-align:center;padding:16px;background:rgba(57,255,20,0.05);border-radius:8px;">
      <div style="font-size:32px;font-weight:600;color:#39ff14;" id="coal-meter">0%</div>
      <div class="small" style="color:rgba(230,250,255,0.7);">Coal Probability</div>
    </div>
  </div>

  <div id="result-gifts" style="margin-bottom:20px;display:none;">
    <h4 class="small" style="color:#39ff14;margin-bottom:12px;">ğŸ Your Christmas Presents:</h4>
    <div id="gift-list" style="display:grid;gap:8px;"></div>
  </div>

  <div id="result-coal" style="margin-bottom:20px;display:none;">
    <h4 class="small" style="color:#ff2d55;margin-bottom:12px;">ğŸ”¥ Your Coal Collection:</h4>
    <div id="coal-list" style="display:grid;gap:8px;"></div>
  </div>

  <div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:16px;margin-bottom:20px;">
    <h4 class="small" style="color:var(--accent);margin-bottom:8px;">ğŸ“ Santa's Notes:</h4>
    <div id="santa-notes" style="font-style:italic;color:rgba(230,250,255,0.8);"></div>
  </div>

  <div class="actions" style="display:flex;gap:10px;">
    <button type="button" onclick="xmasShareResult()" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);font-weight:600;cursor:pointer;">
      ğŸ“± Share My Result
    </button>
    <button type="button" onclick="xmasRetakeQuiz()"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      ğŸ”„ Retake Quiz
    </button>
  </div>
</div>

<script>
/* christmas-naughty-list-quiz.html
   - Funny "Am I on the Naughty List?" Christmas quiz
   - Scoped with xmas- prefix
*/

let xmasQuizState = {
  currentQuestion: 1,
  totalQuestions: 8,
  answers: {},
  totalScore: 0
};

// Quiz results database
const xmasResults = {
  'saint': {
    title: 'ğŸ„ Christmas Angel! ğŸ„',
    subtitle: 'You are literally made of holiday cheer',
    emoji: 'ğŸ‘¼',
    minScore: 0,
    maxScore: 4,
    description: 'Santa has you on the "Nice List Hall of Fame." You probably help elves in your spare time and your blood is 50% hot chocolate.',
    gifts: [
      'ğŸ A lifetime supply of Christmas cookies',
      'ğŸ„ Your own personal elf assistant',
      'ğŸŒŸ A golden ticket to Santa\'s workshop',
      'â„ï¸ Magical snow that never melts'
    ],
    coal: [],
    notes: '"This one sparkles with pure holiday spirit. Double presents this year!" - Santa'
  },
  'nice': {
    title: 'âœ¨ Definitely Nice List! âœ¨',
    subtitle: 'Santa\'s checking you twice (in a good way)',
    emoji: 'ğŸ˜Š',
    minScore: 5,
    maxScore: 8,
    description: 'You\'re on the Nice List with some extra sprinkles! You might have nibbled a cookie or two, but your heart is full of cheer.',
    gifts: [
      'ğŸ All the presents you asked for',
      'ğŸª Premium Christmas cookie basket',
      'ğŸ§¦ Perfectly fitting Christmas socks',
      'ğŸ¬ Every Christmas movie ever made'
    ],
    coal: [],
    notes: '"Solid Nice List material. Keep up the good cheer!" - Santa'
  },
  'borderline': {
    title: 'âš ï¸ Nice List... Probably? âš ï¸',
    subtitle: 'Santa\'s elves are having a debate',
    emoji: 'ğŸ¤”',
    minScore: 9,
    maxScore: 12,
    description: 'You\'re right on the edge! One minute you\'re singing carols, the next you\'re arguing about Die Hard being a Christmas movie.',
    gifts: [
      'ğŸ Most of your Christmas list',
      'â˜• A nice warm beverage',
      'ğŸ“š A book of Christmas puns',
      'ğŸ¶ A mixed holiday music CD'
    ],
    coal: [
      'ğŸ”¥ One small lump of "warning coal"'
    ],
    notes: '"We\'re watching you... but also here\'s some gifts. Don\'t make us regret this." - The Elves'
  },
  'naughty': {
    title: 'ğŸ˜¬ Naughty List Applicant ğŸ˜¬',
    subtitle: 'Better start writing that apology letter',
    emoji: 'ğŸ…',
    minScore: 13,
    maxScore: 16,
    description: 'Santa saw you eat all those cookies. The reindeer are talking. You might want to leave extra milk and cookies this year.',
    gifts: [
      'ğŸ Socks (they\'re warm at least)',
      'ğŸ§¼ Christmas-themed soap',
      'ğŸ“– "How to Be Nice" guidebook',
      'ğŸª One (1) cookie'
    ],
    coal: [
      'ğŸ”¥ Medium bag of premium coal',
      'ğŸ–Šï¸ A pen for writing apologies'
    ],
    notes: '"I see you. I know what you did. Try harder next year." - Santa (probably frowning)'
  },
  'grinch': {
    title: 'ğŸ”¥ COAL FOR CHRISTMAS! ğŸ”¥',
    subtitle: 'The Grinch is taking notes from YOU',
    emoji: 'ğŸ‘¹',
    minScore: 17,
    maxScore: 24,
    description: 'Your Christmas spirit is so low, you make the Grinch look like Mrs. Claus. Santa might skip your house entirely.',
    gifts: [
      'ğŸ A bill for last year\'s presents',
      'ğŸ“¦ An empty box (it\'s the thought that counts)'
    ],
    coal: [
      'ğŸ”¥ An entire truckload of coal',
      'ğŸ”¥ Industrial-sized coal furnace',
      'ğŸ”¥ Coal-powered generator',
      'ğŸ”¥ "How to Use Coal" manual'
    ],
    notes: '"I\'m considering putting YOU on the roof as a warning to others." - Santa (definitely frowning)'
  }
};

// Gift database for random generation
const xmasGiftIdeas = [
  'ğŸ„ Personal Christmas tree that never sheds needles',
  'ğŸ§¦ Socks that automatically warm up',
  'ğŸª Cookie jar that refills magically',
  'ğŸ… A day with Santa (he\'ll judge you in person)',
  'â„ï¸ Snow machine for year-round winter',
  'ğŸ Mystery gift that changes daily',
  'ğŸŒŸ Star from the top of the Rockefeller tree',
  'ğŸ¶ Christmas carol sung by actual angels',
  'ğŸ¦Œ Pet reindeer (requires permit)',
  'ğŸ  Miniature North Pole village',
  'â˜• Hot chocolate that never gets cold',
  'ğŸ”¥ Fireplace that burns Christmas spirit'
];

// Select answer and move to next question
function xmasSelectAnswer(questionNum, points, button) {
  const card = document.currentScript?.closest('.card') || document;
  
  // Remove selected state from all buttons in this question
  const questionDiv = button.closest('.quiz-question');
  const allButtons = questionDiv.querySelectorAll('.quiz-option');
  allButtons.forEach(btn => {
    btn.style.background = '';
    btn.style.borderColor = '';
    btn.style.color = '';
  });
  
  // Highlight selected button
  button.style.background = 'rgba(45,212,255,0.1)';
  button.style.borderColor = 'rgba(45,212,255,0.4)';
  button.style.color = 'var(--accent)';
  
  // Store answer
  xmasQuizState.answers[questionNum] = points;
  
  // Enable next button
  const nextBtn = card.querySelector('#next-btn');
  nextBtn.disabled = false;
  nextBtn.style.opacity = '1';
}

// Move to next question
function xmasNextQuestion() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Check if current question is answered
  if (typeof xmasQuizState.answers[xmasQuizState.currentQuestion] === 'undefined') {
    // Show hint
    const hint = document.createElement('div');
    hint.textContent = 'Please select an answer first!';
    hint.style.cssText = 'position:fixed;top:20px;right:20px;background:#ff2d55;color:white;padding:10px;border-radius:8px;z-index:10000;';
    document.body.appendChild(hint);
    setTimeout(() => hint.remove(), 2000);
    return;
  }
  
  // Hide current question
  const currentQ = card.querySelector(`.quiz-question[data-question="${xmasQuizState.currentQuestion}"]`);
  currentQ.style.display = 'none';
  
  // Move to next question
  xmasQuizState.currentQuestion++;
  
  // Show next question or show results
  if (xmasQuizState.currentQuestion <= xmasQuizState.totalQuestions) {
    const nextQ = card.querySelector(`.quiz-question[data-question="${xmasQuizState.currentQuestion}"]`);
    nextQ.style.display = 'block';
    
    // Update progress
    xmasUpdateProgress();
    
    // Show/hide buttons
    const prevBtn = card.querySelector('#prev-btn');
    prevBtn.style.display = 'block';
    
    // Reset next button
    const nextBtn = card.querySelector('#next-btn');
    nextBtn.disabled = true;
    nextBtn.style.opacity = '0.5';
    
    // Change text on last question
    if (xmasQuizState.currentQuestion === xmasQuizState.totalQuestions) {
      nextBtn.textContent = 'ğŸ… See Santa\'s Verdict!';
    }
  } else {
    // Calculate final score and show results
    xmasCalculateResults();
  }
}

// Move to previous question
function xmasPrevQuestion() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Hide current question
  const currentQ = card.querySelector(`.quiz-question[data-question="${xmasQuizState.currentQuestion}"]`);
  currentQ.style.display = 'none';
  
  // Move to previous question
  xmasQuizState.currentQuestion--;
  
  // Show previous question
  const prevQ = card.querySelector(`.quiz-question[data-question="${xmasQuizState.currentQuestion}"]`);
  prevQ.style.display = 'block';
  
  // Update progress
  xmasUpdateProgress();
  
  // Show/hide buttons
  const prevBtn = card.querySelector('#prev-btn');
  if (xmasQuizState.currentQuestion === 1) {
    prevBtn.style.display = 'none';
  }
  
  // Enable next button (since we already answered this one)
  const nextBtn = card.querySelector('#next-btn');
  nextBtn.disabled = false;
  nextBtn.style.opacity = '1';
  
  // Reset button text if it was changed
  if (xmasQuizState.currentQuestion < xmasQuizState.totalQuestions) {
    nextBtn.textContent = 'Next Question â†’';
  }
}

// Update progress bar
function xmasUpdateProgress() {
  const card = document.currentScript?.closest('.card') || document;
  const progressBar = card.querySelector('#quiz-progress-bar');
  const progressText = card.querySelector('#quiz-progress');
  
  const percent = (xmasQuizState.currentQuestion / xmasQuizState.totalQuestions) * 100;
  progressBar.style.width = `${percent}%`;
  progressText.textContent = `Question ${xmasQuizState.currentQuestion} of ${xmasQuizState.totalQuestions}`;
}

// Calculate final results
function xmasCalculateResults() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Calculate total score
  let totalScore = 0;
  for (let i = 1; i <= xmasQuizState.totalQuestions; i++) {
    totalScore += xmasQuizState.answers[i] || 0;
  }
  
  xmasQuizState.totalScore = totalScore;
  
  // Find result category
  let resultCategory = 'grinch'; // Default
  for (const [category, data] of Object.entries(xmasResults)) {
    if (totalScore >= data.minScore && totalScore <= data.maxScore) {
      resultCategory = category;
      break;
    }
  }
  
  const result = xmasResults[resultCategory];
  
  // Hide quiz, show results
  const quizForm = card.querySelector('form');
  const resultsDiv = card.querySelector('#quiz-results');
  
  quizForm.style.display = 'none';
  resultsDiv.style.display = 'block';
  
  // Scroll to results
  resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
  
  // Update result display
  card.querySelector('#result-emoji').textContent = result.emoji;
  card.querySelector('#result-title').textContent = result.title;
  card.querySelector('#result-subtitle').textContent = result.subtitle;
  card.querySelector('#score-display').textContent = totalScore;
  card.querySelector('#santa-notes').textContent = result.notes;
  
  // Calculate coal probability
  const maxPossibleScore = xmasQuizState.totalQuestions * 3; // 3 points max per question
  const coalProbability = Math.round((totalScore / maxPossibleScore) * 100);
  card.querySelector('#coal-meter').textContent = `${coalProbability}%`;
  
  // Update result content
  const resultContent = card.querySelector('#result-content');
  resultContent.innerHTML = `
    <div style="font-size:15px;line-height:1.6;color:rgba(230,250,255,0.9);margin-bottom:16px;">
      ${result.description}
    </div>
    <div style="display:flex;align-items:center;gap:8px;padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
      <span style="color:var(--accent);font-size:20px;">ğŸ“Š</span>
      <div>
        <div style="color:var(--accent);font-weight:500;">Your Naughty Score: ${totalScore}/${maxPossibleScore}</div>
        <div class="small" style="color:rgba(230,250,255,0.7);">Higher score = more coal in your stocking</div>
      </div>
    </div>
  `;
  
  // Show gifts
  const giftsDiv = card.querySelector('#result-gifts');
  const giftList = card.querySelector('#gift-list');
  
  if (result.gifts && result.gifts.length > 0) {
    giftList.innerHTML = '';
    result.gifts.forEach(gift => {
      giftList.innerHTML += `
        <div style="display:flex;align-items:center;gap:8px;padding:10px;background:rgba(57,255,20,0.05);border-radius:6px;border:1px solid rgba(57,255,20,0.2);">
          <span style="color:#39ff14;">âœ“</span>
          <span>${gift}</span>
        </div>
      `;
    });
    giftsDiv.style.display = 'block';
  }
  
  // Show coal
  const coalDiv = card.querySelector('#result-coal');
  const coalList = card.querySelector('#coal-list');
  
  if (result.coal && result.coal.length > 0) {
    coalList.innerHTML = '';
    result.coal.forEach(coal => {
      coalList.innerHTML += `
        <div style="display:flex;align-items:center;gap:8px;padding:10px;background:rgba(255,45,85,0.05);border-radius:6px;border:1px solid rgba(255,45,85,0.2);">
          <span style="color:#ff2d55;">âœ—</span>
          <span>${coal}</span>
        </div>
      `;
    });
    coalDiv.style.display = 'block';
  }
  
  // Add random bonus gift for fun
  if (resultCategory !== 'grinch') {
    const randomGift = xmasGiftIdeas[Math.floor(Math.random() * xmasGiftIdeas.length)];
    giftList.innerHTML += `
      <div style="display:flex;align-items:center;gap:8px;padding:10px;background:rgba(255,165,0,0.05);border-radius:6px;border:1px solid rgba(255,165,0,0.3);">
        <span style="color:#ffa500;">ğŸ</span>
        <span><strong>Bonus Gift:</strong> ${randomGift}</span>
      </div>
    `;
  }
  
  // Add funny tip based on score
  const tips = [
    "ğŸ’¡ Tip: Leave carrots for the reindeer, they're working hard!",
    "ğŸ… Pro tip: Santa appreciates homemade cookies more than store-bought",
    "ğŸŒŸ Remember: Christmas spirit is measured in hugs, not gifts",
    "ğŸª Insider info: The milk-to-cookie ratio is crucial",
    "ğŸ„ Expert advice: More tinsel = more Christmas"
  ];
  
  const randomTip = tips[Math.floor(Math.random() * tips.length)];
  resultContent.innerHTML += `
    <div style="margin-top:12px;padding:10px;background:rgba(255,255,255,0.03);border-radius:6px;border-left:3px solid var(--accent);">
      <div style="color:var(--accent);font-weight:500;">${randomTip}</div>
    </div>
  `;
}

// Share result
function xmasShareResult() {
  const card = document.currentScript?.closest('.card') || document;
  const resultTitle = card.querySelector('#result-title').textContent;
  const score = xmasQuizState.totalScore;
  const maxScore = xmasQuizState.totalQuestions * 3;
  
  const shareText = `ğŸ… My Christmas Naughty List Score: ${score}/${maxScore}\n"${resultTitle}"\n\nTake the quiz at The Most Useful Site in the World!`;
  
  if (navigator.share) {
    navigator.share({
      title: 'My Christmas Naughty List Result',
      text: shareText,
      url: window.location.href
    }).catch(console.error);
  } else {
    navigator.clipboard.writeText(shareText).then(() => {
      const hint = document.createElement('div');
      hint.textContent = 'Result copied to clipboard! Share it anywhere!';
      hint.style.cssText = 'position:fixed;top:20px;right:20px;background:#39ff14;color:black;padding:10px;border-radius:8px;z-index:10000;';
      document.body.appendChild(hint);
      setTimeout(() => hint.remove(), 3000);
    });
  }
}

// Retake quiz
function xmasRetakeQuiz() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Reset state
  xmasQuizState = {
    currentQuestion: 1,
    totalQuestions: 8,
    answers: {},
    totalScore: 0
  };
  
  // Hide results, show quiz
  const quizForm = card.querySelector('form');
  const resultsDiv = card.querySelector('#quiz-results');
  const firstQuestion = card.querySelector('.quiz-question[data-question="1"]');
  const allQuestions = card.querySelectorAll('.quiz-question');
  
  quizForm.style.display = 'block';
  resultsDiv.style.display = 'none';
  
  // Reset all questions
  allQuestions.forEach((q, index) => {
    q.style.display = index === 0 ? 'block' : 'none';
    
    // Reset button styles
    const buttons = q.querySelectorAll('.quiz-option');
    buttons.forEach(btn => {
      btn.style.background = '';
      btn.style.borderColor = '';
      btn.style.color = '';
    });
  });
  
  // Reset navigation
  const prevBtn = card.querySelector('#prev-btn');
  const nextBtn = card.querySelector('#next-btn');
  prevBtn.style.display = 'none';
  nextBtn.textContent = 'Next Question â†’';
  nextBtn.disabled = true;
  nextBtn.style.opacity = '0.5';
  
  // Reset progress
  xmasUpdateProgress();
  
  // Scroll to top
  quizForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Initialize quiz
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Christmas Naughty List Quiz loaded!');
  });
}
</script>

<style>
#christmas-naughty-list-title {
  color: var(--accent);
  margin-top: 0;
  text-align: center;
  font-size: 1.4rem;
}

.quiz-option {
  width: 100%;
  padding: 14px;
  text-align: left;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: inherit;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 10px;
}

.quiz-option:hover {
  background: rgba(45,212,255,0.1);
  border-color: rgba(45,212,255,0.3);
  transform: translateY(-2px);
}

.quiz-option:active {
  transform: translateY(0);
}

@media (max-width: 768px) {
  .quiz-option {
    padding: 12px;
    font-size: 13px;
  }
  
  #quiz-nav {
    flex-direction: column;
    gap: 12px;
  }
  
  #quiz-nav button {
    width: 100%;
  }
  
  #prev-btn, #next-btn {
    order: 2;
  }
  
  #quiz-progress {
    order: 1;
  }
}
</style>
