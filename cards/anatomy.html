<h2 id="anatomy-title">Anatomy Tools & Facts</h2>

<div style="color: rgba(230,250,255,0.8); margin: 10px 0 20px 0; font-size: 15px;">
  Calculate health metrics and discover fascinating facts about the human body.
</div>

<!-- ü©∫ TOOL SELECTOR -->
<div style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px; margin-bottom: 25px;">
  <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 15px;">Choose a Health Calculator:</div>
  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin-bottom: 20px;">
    <button id="bmi-btn" class="anat-tool-btn active" data-tool="bmi" 
            style="background: rgba(45,212,255,0.2); border: 2px solid #2dd4ff; padding: 15px; border-radius: 8px; cursor: pointer; text-align: center;">
      <div style="font-weight: 600; color: #2dd4ff;">BMI</div>
      <div style="font-size: 13px; color: rgba(230,250,255,0.8); margin-top: 4px;">Body Mass Index</div>
    </button>
    
    <button id="bmr-btn" class="anat-tool-btn" data-tool="bmr"
            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; cursor: pointer; text-align: center;">
      <div style="font-weight: 600; color: #e6faff;">BMR</div>
      <div style="font-size: 13px; color: rgba(230,250,255,0.8); margin-top: 4px;">Basal Metabolic Rate</div>
    </button>
    
    <button id="blood-btn" class="anat-tool-btn" data-tool="blood"
            style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; cursor: pointer; text-align: center;">
      <div style="font-weight: 600; color: #e6faff;">Blood Volume</div>
      <div style="font-size: 13px; color: rgba(230,250,255,0.8); margin-top: 4px;">Estimated Blood</div>
    </button>
  </div>
  
  <!-- üìù INPUT FIELDS -->
  <div id="bmi-inputs" class="anat-inputs" style="display: block;">
    <div style="color: #e6faff; margin-bottom: 12px; font-size: 15px;">Enter your details:</div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Weight (kg)</label>
        <input type="number" id="anat-weight" placeholder="e.g., 70" 
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
      </div>
      
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Height (m)</label>
        <input type="number" id="anat-height" placeholder="e.g., 1.75" step="0.01"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
      </div>
    </div>
    
    <div style="margin-top: 10px; color: rgba(230,250,255,0.6); font-size: 13px;">
      Example: 70 kg, 1.75 m (5'9")
    </div>
  </div>
  
  <div id="bmr-inputs" class="anat-inputs" style="display: none;">
    <div style="color: #e6faff; margin-bottom: 12px; font-size: 15px;">Enter your details:</div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Weight (kg)</label>
        <input type="number" id="bmr-weight" placeholder="e.g., 70"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
      </div>
      
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Height (cm)</label>
        <input type="number" id="bmr-height" placeholder="e.g., 175"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
      </div>
      
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Age (years)</label>
        <input type="number" id="bmr-age" placeholder="e.g., 30"
               style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
      </div>
      
      <div>
        <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Sex</label>
        <select id="bmr-sex" 
                style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
      </div>
    </div>
  </div>
  
  <div id="blood-inputs" class="anat-inputs" style="display: none;">
    <div style="color: #e6faff; margin-bottom: 12px; font-size: 15px;">Enter your details:</div>
    
    <div>
      <label style="display: block; margin-bottom: 6px; color: rgba(230,250,255,0.8); font-size: 14px;">Weight (kg)</label>
      <input type="number" id="blood-weight" placeholder="e.g., 70"
             style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #e6faff;">
    </div>
    
    <div style="margin-top: 10px; color: rgba(230,250,255,0.6); font-size: 13px;">
      Based on average 70-75 ml of blood per kg body weight
    </div>
  </div>
  
  <!-- üîò FACTS TOGGLE -->
  <div style="margin-top: 20px; display: flex; align-items: center; gap: 10px;">
    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: rgba(230,250,255,0.8);">
      <input type="checkbox" id="anat-facts-toggle" checked style="cursor: pointer;">
      <span>Show Amazing Body Facts</span>
    </label>
  </div>
</div>

<!-- üöÄ CALCULATE BUTTON -->
<div style="text-align: center; margin: 25px 0;">
  <button id="anat-calculate-btn" 
          style="background: #2dd4ff; color: #000; border: none; padding: 14px 32px; border-radius: 10px; cursor: pointer; font-size: 16px; font-weight: 600; box-shadow: 0 4px 15px rgba(45,212,255,0.3);">
    CALCULATE
  </button>
  
  <button id="anat-reset-btn" 
          style="background: rgba(255,255,255,0.08); color: #e6faff; border: 1px solid rgba(255,255,255,0.2); padding: 14px 24px; border-radius: 10px; cursor: pointer; font-size: 16px; margin-left: 12px;">
    Reset
  </button>
</div>

<!-- üìä RESULTS DISPLAY -->
<div id="anat-results" style="display: none;">
  <div style="background: rgba(20,20,20,0.7); border-radius: 10px; padding: 25px; border: 1px solid rgba(57,255,20,0.2); margin-bottom: 25px;">
    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
      <div style="color: #39ff14; font-size: 18px; font-weight: 600;">‚úÖ Results</div>
      <button id="anat-copy-btn" 
              style="background: rgba(57,255,20,0.1); color: #39ff14; border: 1px solid rgba(57,255,20,0.3); padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">
        Copy Result
      </button>
    </div>
    
    <div id="anat-result-display" style="font-size: 20px; color: #39ff14; text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
      <!-- Results appear here -->
    </div>
    
    <div id="anat-interpretation" style="color: #e6faff; font-size: 15px; line-height: 1.6; padding: 15px; background: rgba(30,30,30,0.5); border-radius: 8px;">
      <!-- Interpretation appears here -->
    </div>
  </div>
</div>

<!-- üß† BODY FACTS -->
<div id="anat-facts" style="margin-top: 20px; display: block;">
  <div style="background: rgba(30,30,30,0.5); border-radius: 10px; padding: 20px; border: 1px solid rgba(45,212,255,0.2);">
    <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 15px; font-size: 16px;">
      üî¨ Amazing Human Body Facts
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #2dd4ff;">
        <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 5px;">206 Bones</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Babies are born with ~300 bones that fuse together</div>
      </div>
      
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #ff2d55;">
        <div style="color: #ff2d55; font-weight: 600; margin-bottom: 5px;">100,000 Beats/Day</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Heart pumps ~7,500 liters of blood daily</div>
      </div>
      
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #00ff99;">
        <div style="color: #00ff99; font-weight: 600; margin-bottom: 5px;">6 Meter Intestine</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Small intestine length if stretched out</div>
      </div>
      
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #9d4edd;">
        <div style="color: #9d4edd; font-weight: 600; margin-bottom: 5px;">Largest Organ</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Skin covers ~2 m¬≤ in adults</div>
      </div>
      
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #ffcc00;">
        <div style="color: #ffcc00; font-weight: 600; margin-bottom: 5px;">20% Oxygen</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Brain uses 20% of body's oxygen & energy</div>
      </div>
      
      <div style="background: rgba(255,255,255,0.03); padding: 12px; border-radius: 8px; border-left: 3px solid #2dd4ff;">
        <div style="color: #2dd4ff; font-weight: 600; margin-bottom: 5px;">500 Functions</div>
        <div style="color: rgba(230,250,255,0.8); font-size: 14px;">Liver performs over 500 vital functions</div>
      </div>
    </div>
  </div>
</div>

<!-- üö® ERROR MESSAGE -->
<div id="anat-error" style="margin-top: 20px; padding: 15px; background: rgba(255,77,77,0.1); border-radius: 8px; border: 1px solid rgba(255,77,77,0.3); display: none;">
  <div style="color: #ff4d4d; font-weight: 600; margin-bottom: 5px;">‚ö†Ô∏è Please check your inputs</div>
  <div id="anat-error-text" style="color: rgba(255,77,77,0.9);"></div>
</div>

<script>
// ============================================
// ANATOMY TOOLS - SUPER USER FRIENDLY
// ============================================

// Wait for DOM to be ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initAnatomyTools);
} else {
    setTimeout(initAnatomyTools, 100);
}

function initAnatomyTools() {
    console.log("Anatomy Tools: Initializing...");
    
    // Tool buttons
    const toolBtns = document.querySelectorAll('.anat-tool-btn');
    toolBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            // Update active button
            toolBtns.forEach(b => {
                b.style.background = 'rgba(255,255,255,0.05)';
                b.style.border = '1px solid rgba(255,255,255,0.1)';
                b.style.color = '#e6faff';
                b.querySelector('div:first-child').style.color = '#e6faff';
                b.classList.remove('active');
            });
            
            this.style.background = 'rgba(45,212,255,0.2)';
            this.style.border = '2px solid #2dd4ff';
            this.style.color = '#2dd4ff';
            this.querySelector('div:first-child').style.color = '#2dd4ff';
            this.classList.add('active');
            
            // Show corresponding inputs
            const tool = this.dataset.tool;
            document.querySelectorAll('.anat-inputs').forEach(input => {
                input.style.display = 'none';
            });
            
            if (tool === 'bmi') {
                document.getElementById('bmi-inputs').style.display = 'block';
                // Auto-focus weight input
                setTimeout(() => {
                    document.getElementById('anat-weight').focus();
                }, 50);
            } else if (tool === 'bmr') {
                document.getElementById('bmr-inputs').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('bmr-weight').focus();
                }, 50);
            } else if (tool === 'blood') {
                document.getElementById('blood-inputs').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('blood-weight').focus();
                }, 50);
            }
            
            // Clear results
            clearAnatomyResults();
        });
    });
    
    // Calculate button
    document.getElementById('anat-calculate-btn').addEventListener('click', calculateAnatomy);
    
    // Reset button
    document.getElementById('anat-reset-btn').addEventListener('click', resetAnatomy);
    
    // Copy button
    document.getElementById('anat-copy-btn').addEventListener('click', copyAnatomyResult);
    
    // Facts toggle
    document.getElementById('anat-facts-toggle').addEventListener('change', function() {
        document.getElementById('anat-facts').style.display = this.checked ? 'block' : 'none';
    });
    
    // Enter key support for all inputs
    const allInputs = document.querySelectorAll('input[type="number"], input[type="text"]');
    allInputs.forEach(input => {
        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateAnatomy();
            }
        });
    });
    
    // Set default values for easy testing
    setDefaultValues();
    
    console.log("‚úÖ Anatomy Tools ready!");
}

function setDefaultValues() {
    // Set some default values for quick testing
    document.getElementById('anat-weight').value = '70';
    document.getElementById('anat-height').value = '1.75';
    document.getElementById('bmr-weight').value = '70';
    document.getElementById('bmr-height').value = '175';
    document.getElementById('bmr-age').value = '30';
    document.getElementById('blood-weight').value = '70';
}

function calculateAnatomy() {
    console.log("Calculating anatomy metrics...");
    
    // Hide previous results/errors
    document.getElementById('anat-results').style.display = 'none';
    document.getElementById('anat-error').style.display = 'none';
    
    // Get active tool
    const activeTool = document.querySelector('.anat-tool-btn.active').dataset.tool;
    let result = '';
    let interpretation = '';
    
    try {
        if (activeTool === 'bmi') {
            const weight = parseFloat(document.getElementById('anat-weight').value);
            const height = parseFloat(document.getElementById('anat-height').value);
            
            if (!weight || !height || weight <= 0 || height <= 0) {
                showAnatomyError('Please enter valid weight (kg) and height (m)');
                return;
            }
            
            const bmi = weight / (height * height);
            result = `BMI: ${bmi.toFixed(1)}`;
            
            // Interpretation
            if (bmi < 18.5) {
                interpretation = 'Underweight - Consider consulting a healthcare provider';
            } else if (bmi < 25) {
                interpretation = 'Normal weight - Healthy range';
            } else if (bmi < 30) {
                interpretation = 'Overweight - Consider lifestyle adjustments';
            } else {
                interpretation = 'Obese - Consult healthcare provider for guidance';
            }
            
            interpretation += `\n\nFormula: Weight (${weight} kg) √∑ Height¬≤ (${height} m √ó ${height} m) = ${bmi.toFixed(1)}`;
            
        } else if (activeTool === 'bmr') {
            const weight = parseFloat(document.getElementById('bmr-weight').value);
            const height = parseFloat(document.getElementById('bmr-height').value);
            const age = parseFloat(document.getElementById('bmr-age').value);
            const sex = document.getElementById('bmr-sex').value;
            
            if (!weight || !height || !age || weight <= 0 || height <= 0 || age <= 0) {
                showAnatomyError('Please enter valid weight, height, and age');
                return;
            }
            
            let bmr;
            if (sex === 'male') {
                // Mifflin-St Jeor Equation for males
                bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
            } else {
                // Mifflin-St Jeor Equation for females
                bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
            }
            
            result = `BMR: ${bmr.toFixed(0)} calories/day`;
            interpretation = `Your body burns approximately ${bmr.toFixed(0)} calories daily at rest.\n\n`;
            interpretation += `Activity Level Estimates:\n`;
            interpretation += `‚Ä¢ Sedentary: ${(bmr * 1.2).toFixed(0)} cal/day\n`;
            interpretation += `‚Ä¢ Light exercise: ${(bmr * 1.375).toFixed(0)} cal/day\n`;
            interpretation += `‚Ä¢ Moderate exercise: ${(bmr * 1.55).toFixed(0)} cal/day\n`;
            interpretation += `‚Ä¢ Very active: ${(bmr * 1.725).toFixed(0)} cal/day\n`;
            interpretation += `‚Ä¢ Extra active: ${(bmr * 1.9).toFixed(0)} cal/day`;
            
        } else if (activeTool === 'blood') {
            const weight = parseFloat(document.getElementById('blood-weight').value);
            
            if (!weight || weight <= 0) {
                showAnatomyError('Please enter valid weight (kg)');
                return;
            }
            
            // Average blood volume: 70-75 ml/kg for adults
            const bloodVolumeMl = weight * 72.5; // Using average
            const bloodVolumeLiters = bloodVolumeMl / 1000;
            
            result = `Estimated Blood Volume: ${bloodVolumeLiters.toFixed(1)} liters`;
            interpretation = `An average adult has approximately 70-75 ml of blood per kg of body weight.\n\n`;
            interpretation += `Calculation: ${weight} kg √ó 72.5 ml/kg = ${bloodVolumeMl.toFixed(0)} ml\n`;
            interpretation += `Converted: ${bloodVolumeMl.toFixed(0)} ml √∑ 1000 = ${bloodVolumeLiters.toFixed(1)} L\n\n`;
            interpretation += `‚Ä¢ That's about ${(bloodVolumeLiters * 0.264).toFixed(1)} gallons\n`;
            interpretation += `‚Ä¢ Or ${Math.round(bloodVolumeMl / 470)} standard blood donations`;
        }
        
        // Display results
        document.getElementById('anat-result-display').textContent = result;
        document.getElementById('anat-interpretation').innerHTML = interpretation.replace(/\n/g, '<br>');
        document.getElementById('anat-results').style.display = 'block';
        
        // Scroll to results
        setTimeout(() => {
            document.getElementById('anat-results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
        
    } catch (error) {
        console.error('Calculation error:', error);
        showAnatomyError('Unable to calculate. Please check your inputs.');
    }
}

function resetAnatomy() {
    // Reset all inputs to defaults
    setDefaultValues();
    
    // Reset to BMI tool
    document.querySelectorAll('.anat-tool-btn').forEach(btn => {
        btn.style.background = 'rgba(255,255,255,0.05)';
        btn.style.border = '1px solid rgba(255,255,255,0.1)';
        btn.style.color = '#e6faff';
        btn.querySelector('div:first-child').style.color = '#e6faff';
        btn.classList.remove('active');
    });
    
    const bmiBtn = document.getElementById('bmi-btn');
    bmiBtn.style.background = 'rgba(45,212,255,0.2)';
    bmiBtn.style.border = '2px solid #2dd4ff';
    bmiBtn.style.color = '#2dd4ff';
    bmiBtn.querySelector('div:first-child').style.color = '#2dd4ff';
    bmiBtn.classList.add('active');
    
    // Show BMI inputs
    document.querySelectorAll('.anat-inputs').forEach(input => {
        input.style.display = 'none';
    });
    document.getElementById('bmi-inputs').style.display = 'block';
    
    // Clear results and errors
    clearAnatomyResults();
    
    // Focus on weight input
    setTimeout(() => {
        document.getElementById('anat-weight').focus();
        document.getElementById('anat-weight').select();
    }, 50);
    
    console.log("Anatomy tools reset");
}

function clearAnatomyResults() {
    document.getElementById('anat-results').style.display = 'none';
    document.getElementById('anat-error').style.display = 'none';
}

function copyAnatomyResult() {
    const result = document.getElementById('anat-result-display').textContent;
    const interpretation = document.getElementById('anat-interpretation').textContent;
    const text = `${result}\n\n${interpretation}`;
    
    navigator.clipboard.writeText(text).then(() => {
        // Visual feedback
        const copyBtn = document.getElementById('anat-copy-btn');
        const originalText = copyBtn.textContent;
        copyBtn.textContent = '‚úÖ Copied!';
        copyBtn.style.background = 'rgba(57,255,20,0.2)';
        
        setTimeout(() => {
            copyBtn.textContent = originalText;
            copyBtn.style.background = '';
        }, 2000);
    }).catch(err => {
        console.error('Copy failed:', err);
        alert('Failed to copy. Please select and copy manually.');
    });
}

function showAnatomyError(message) {
    document.getElementById('anat-error-text').textContent = message;
    document.getElementById('anat-error').style.display = 'block';
    
    // Scroll to error
    setTimeout(() => {
        document.getElementById('anat-error').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 100);
}

// Auto-initialize on load
setTimeout(initAnatomyTools, 100);
</script>