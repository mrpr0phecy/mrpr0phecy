<!-- cards/exponents-calculator.html -->
<h2 id="exponents-calculator-title">‚ö° Exponents & Roots Calculator</h2>

<form aria-describedby="exponents-description">
    <p id="exponents-description" class="small" style="color:rgba(230,250,255,0.9);margin-bottom:20px;">
        Calculate powers, roots, and exponential functions with detailed steps and visualizations. 
        <span style="color:var(--accent);font-weight:500;">Perfect for students learning algebra and calculus.</span>
    </p>
    
    <!-- Input Panel -->
    <div style="margin-bottom:24px;">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px;">
            <!-- Base Input -->
            <div>
                <label for="exp-base" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                    <span style="font-size:1.2rem;">a</span> Base Value
                </label>
                <div style="position:relative;">
                    <input id="exp-base" type="number" step="any" placeholder="Enter base (a)" 
                           style="width:100%;padding:14px;padding-left:48px;border-radius:10px;border:2px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:1.1rem;font-weight:500;" />
                    <div style="position:absolute;left:16px;top:50%;transform:translateY(-50%);color:var(--accent);font-weight:600;font-size:1.2rem;">a</div>
                </div>
                <div style="margin-top:8px;display:flex;gap:8px;">
                    <button type="button" onclick="expQuickValue('base', 2)" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.8rem;">2</button>
                    <button type="button" onclick="expQuickValue('base', 10)" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.8rem;">10</button>
                    <button type="button" onclick="expQuickValue('base', Math.E)" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.8rem;">e</button>
                    <button type="button" onclick="expQuickValue('base', Math.PI)" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.8rem;">œÄ</button>
                </div>
            </div>
            
            <!-- Exponent Input -->
            <div>
                <label for="exp-exponent" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                    <span style="font-size:1.2rem;">b</span> Exponent/Root Value
                </label>
                <div style="position:relative;">
                    <input id="exp-exponent" type="number" step="any" placeholder="Enter exponent (b)" 
                           style="width:100%;padding:14px;padding-left:48px;border-radius:10px;border:2px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:inherit;font-size:1.1rem;font-weight:500;" />
                    <div style="position:absolute;left:16px;top:50%;transform:translateY(-50%);color:#39ff14;font-weight:600;font-size:1.2rem;">b</div>
                </div>
                <div style="margin-top:8px;display:flex;gap:8px;">
                    <button type="button" onclick="expQuickValue('exponent', 2)" style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:6px;color:#39ff14;cursor:pointer;font-size:0.8rem;">2</button>
                    <button type="button" onclick="expQuickValue('exponent', 3)" style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:6px;color:#39ff14;cursor:pointer;font-size:0.8rem;">3</button>
                    <button type="button" onclick="expQuickValue('exponent', 0.5)" style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:6px;color:#39ff14;cursor:pointer;font-size:0.8rem;">¬Ω</button>
                    <button type="button" onclick="expQuickValue('exponent', -1)" style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:6px;color:#39ff14;cursor:pointer;font-size:0.8rem;">-1</button>
                </div>
            </div>
        </div>
        
        <!-- Operation Selection -->
        <div style="margin-bottom:20px;">
            <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">üìê Select Operation:</div>
            <div style="display:flex;gap:12px;flex-wrap:wrap;">
                <button type="button" onclick="expSetOperation('power')" id="exp-op-power"
                        style="padding:12px 20px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:2px solid var(--accent);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;">
                    ‚ö° Power (a<sup>b</sup>)
                </button>
                <button type="button" onclick="expSetOperation('root')" id="exp-op-root"
                        style="padding:12px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:rgba(230,250,255,0.8);cursor:pointer;display:flex;align-items:center;gap:8px;">
                    ‚àö Root (<sup>b</sup>‚àöa)
                </button>
                <button type="button" onclick="expSetOperation('log')" id="exp-op-log"
                        style="padding:12px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:rgba(230,250,255,0.8);cursor:pointer;display:flex;align-items:center;gap:8px;">
                    üìä Logarithm (log<sub>b</sub>a)
                </button>
                <button type="button" onclick="expSetOperation('exponential')" id="exp-op-exponential"
                        style="padding:12px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:rgba(230,250,255,0.8);cursor:pointer;display:flex;align-items:center;gap:8px;">
                    üìà Exponential (e<sup>x</sup>)
                </button>
            </div>
        </div>
        
        <!-- Options -->
        <div style="display:flex;gap:24px;margin-bottom:20px;">
            <label style="display:flex;align-items:center;gap:10px;color:rgba(230,250,255,0.9);cursor:pointer;">
                <input type="checkbox" id="exp-show-steps" checked style="width:18px;height:18px;accent-color:var(--accent);">
                <span style="font-weight:500;">Show Detailed Steps</span>
            </label>
            <label style="display:flex;align-items:center;gap:10px;color:rgba(230,250,255,0.9);cursor:pointer;">
                <input type="checkbox" id="exp-show-formula" checked style="width:18px;height:18px;accent-color:var(--accent);">
                <span style="font-weight:500;">Show Formula</span>
            </label>
            <label style="display:flex;align-items:center;gap:10px;color:rgba(230,250,255,0.9);cursor:pointer;">
                <input type="checkbox" id="exp-show-graph" style="width:18px;height:18px;accent-color:var(--accent);">
                <span style="font-weight:500;">Show Visualization</span>
            </label>
        </div>
    </div>
    
    <!-- Action Buttons -->
    <div class="actions" style="display:flex;gap:12px;">
        <button type="button" onclick="expCalculate()" 
                style="flex:1;padding:16px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:2px solid rgba(45,212,255,0.4);border-radius:12px;color:var(--accent);cursor:pointer;font-weight:600;font-size:1.1rem;display:flex;align-items:center;justify-content:center;gap:10px;">
            ‚ö° Calculate
            <span style="font-size:0.9rem;opacity:0.8;">(Enter key works too)</span>
        </button>
        <button type="button" onclick="expReset()"
                style="padding:16px 24px;background:rgba(255,77,77,0.1);border:2px solid rgba(255,77,77,0.3);border-radius:12px;color:#ff4d4d;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;">
            üóëÔ∏è Reset
        </button>
        <button type="button" onclick="expExample()"
                style="padding:16px 24px;background:rgba(255,204,0,0.1);border:2px solid rgba(255,204,0,0.3);border-radius:12px;color:#ffcc00;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;">
            üìö Example
        </button>
    </div>
</form>

<!-- Results Display -->
<div class="results" aria-live="polite" style="margin-top:24px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 class="small" style="color:var(--accent);margin:0;font-size:1.1rem;">üìä Calculation Results</h3>
        <div style="display:flex;gap:8px;">
            <button onclick="expCopyToClipboard()" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:rgba(230,250,255,0.8);cursor:pointer;display:flex;align-items:center;gap:6px;">
                üìã Copy
            </button>
            <button onclick="expSaveResult()" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:rgba(230,250,255,0.8);cursor:pointer;display:flex;align-items:center;gap:6px;">
                üíæ Save
            </button>
        </div>
    </div>
    
    <!-- Main Result -->
    <div id="exp-main-result" style="
        padding:24px;
        background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));
        border:2px solid rgba(45,212,255,0.15);
        border-radius:12px;
        margin-bottom:20px;
        text-align:center;
        font-size:1.3rem;
        font-weight:600;
        color:#fff;
        min-height:80px;
        display:flex;
        align-items:center;
        justify-content:center;
    ">
        <div style="color:rgba(230,250,255,0.5);">Results will appear here</div>
    </div>
    
    <!-- Formula Display -->
    <div id="exp-formula-container" style="display:none;margin-bottom:20px;">
        <h4 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üìù Formula:</h4>
        <div id="exp-formula" style="
            padding:16px;
            background:rgba(0,0,0,0.2);
            border-radius:10px;
            border:1px solid rgba(45,212,255,0.2);
            font-family:'Courier New',monospace;
            font-size:1.2rem;
            text-align:center;
            color:#fff;
        "></div>
    </div>
    
    <!-- Step-by-Step Solution -->
    <div id="exp-steps-container" style="display:none;margin-bottom:20px;">
        <h4 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üìà Step-by-Step Solution:</h4>
        <div id="exp-steps" style="
            padding:20px;
            background:rgba(0,0,0,0.2);
            border-radius:10px;
            border:1px solid rgba(255,255,255,0.05);
            counter-reset: step-counter;
        "></div>
    </div>
    
    <!-- Visualization -->
    <div id="exp-visualization-container" style="display:none;">
        <h4 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üìä Visualization:</h4>
        <div id="exp-visualization" style="
            padding:20px;
            background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));
            border:2px solid rgba(45,212,255,0.15);
            border-radius:12px;
            min-height:200px;
            display:flex;
            align-items:center;
            justify-content:center;
            overflow:hidden;
        ">
            <canvas id="exp-chart-canvas"></canvas>
        </div>
    </div>
    
    <!-- Additional Info -->
    <div id="exp-additional-info" style="display:none;margin-top:20px;">
        <h4 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">‚ÑπÔ∏è Additional Information:</h4>
        <div id="exp-info-content" style="
            padding:16px;
            background:rgba(0,0,0,0.2);
            border-radius:10px;
            border:1px solid rgba(255,255,255,0.05);
            font-size:0.95rem;
            line-height:1.6;
            color:rgba(230,250,255,0.8);
        "></div>
    </div>
</div>

<script>
/* exponents-calculator.html
   - Advanced exponents and roots calculator with visualization
   - Prefix: exp
*/

let expCurrentOperation = 'power';
let expHistory = [];

function expSetOperation(operation) {
    expCurrentOperation = operation;
    
    // Update button styles
    const buttons = ['power', 'root', 'log', 'exponential'];
    buttons.forEach(op => {
        const btn = document.getElementById(`exp-op-${op}`);
        if (op === operation) {
            btn.style.background = 'linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1))';
            btn.style.border = '2px solid var(--accent)';
            btn.style.color = 'var(--accent)';
        } else {
            btn.style.background = 'rgba(255,255,255,0.05)';
            btn.style.border = '1px solid rgba(255,255,255,0.1)';
            btn.style.color = 'rgba(230,250,255,0.8)';
        }
    });
    
    // Auto-calculate if values are present
    const base = document.getElementById('exp-base').value;
    const exponent = document.getElementById('exp-exponent').value;
    if (base && exponent) {
        setTimeout(expCalculate, 100);
    }
}

function expQuickValue(type, value) {
    if (type === 'base') {
        document.getElementById('exp-base').value = value;
    } else {
        document.getElementById('exp-exponent').value = value;
    }
    
    // Auto-calculate if both values are present
    const base = document.getElementById('exp-base').value;
    const exponent = document.getElementById('exp-exponent').value;
    if (base && exponent) {
        setTimeout(expCalculate, 100);
    }
}

function expCalculate() {
    const baseInput = document.getElementById('exp-base');
    const exponentInput = document.getElementById('exp-exponent');
    const showSteps = document.getElementById('exp-show-steps').checked;
    const showFormula = document.getElementById('exp-show-formula').checked;
    const showGraph = document.getElementById('exp-show-graph').checked;
    
    const base = parseFloat(baseInput.value);
    const exponent = parseFloat(exponentInput.value);
    
    // Validation
    if (isNaN(base) || isNaN(exponent)) {
        expShowError("Please enter valid numbers for both base and exponent.");
        return;
    }
    
    if (expCurrentOperation === 'log' && base <= 0) {
        expShowError("For logarithms, base must be positive.");
        return;
    }
    
    if (expCurrentOperation === 'log' && exponent <= 0) {
        expShowError("For logarithms, the argument must be positive.");
        return;
    }
    
    // Calculate based on operation
    let result;
    let formula = '';
    let steps = [];
    let additionalInfo = '';
    
    switch(expCurrentOperation) {
        case 'power':
            result = Math.pow(base, exponent);
            formula = `${base}<sup>${exponent}</sup> = ${result}`;
            
            steps = [
                `We want to calculate ${base}<sup>${exponent}</sup>`,
                `This means: ${base} √ó ${base} (repeated ${exponent} times)`,
                `Using exponent rules: a<sup>b</sup> = e<sup>b¬∑ln(a)</sup>`,
                `Calculation: e<sup>${exponent}¬∑ln(${base})</sup>`,
                `Final result: ${result}`
            ];
            
            additionalInfo = `Powers represent repeated multiplication. Negative exponents give reciprocals (a‚Åª‚Åø = 1/a‚Åø).`;
            break;
            
        case 'root':
            result = Math.pow(base, 1/exponent);
            formula = `<sup>${exponent}</sup>‚àö${base} = ${result}`;
            
            steps = [
                `We want to calculate the ${exponent}th root of ${base}`,
                `This is equivalent to: ${base}<sup>1/${exponent}</sup>`,
                `Using exponent rules: <sup>b</sup>‚àöa = a<sup>1/b</sup>`,
                `Calculation: ${base}<sup>1/${exponent}</sup> = ${result}`,
                `Verification: ${result}<sup>${exponent}</sup> = ${Math.pow(result, exponent)} ‚âà ${base}`
            ];
            
            additionalInfo = `Roots are the inverse operation of powers. The ${exponent}th root finds what number, when raised to the ${exponent}th power, gives ${base}.`;
            break;
            
        case 'log':
            result = Math.log(exponent) / Math.log(base);
            formula = `log<sub>${base}</sub>(${exponent}) = ${result}`;
            
            steps = [
                `We want to calculate log<sub>${base}</sub>(${exponent})`,
                `Using change of base formula: log<sub>b</sub>(a) = ln(a) / ln(b)`,
                `Calculation: ln(${exponent}) / ln(${base})`,
                `ln(${exponent}) ‚âà ${Math.log(exponent).toFixed(6)}`,
                `ln(${base}) ‚âà ${Math.log(base).toFixed(6)}`,
                `Division: ${Math.log(exponent).toFixed(6)} / ${Math.log(base).toFixed(6)} = ${result}`
            ];
            
            additionalInfo = `Logarithms answer the question: "To what power must we raise ${base} to get ${exponent}?"`;
            break;
            
        case 'exponential':
            result = Math.exp(base);
            formula = `e<sup>${base}</sup> = ${result}`;
            
            steps = [
                `We want to calculate e<sup>${base}</sup>`,
                `e ‚âà 2.718281828459045`,
                `Using exponential function: e<sup>x</sup> = lim<sub>n‚Üí‚àû</sub>(1 + x/n)<sup>n</sup>`,
                `Calculation: e<sup>${base}</sup> = ${result}`,
                `For large x, e<sup>x</sup> grows very rapidly`
            ];
            
            additionalInfo = `The exponential function e<sup>x</sup> is its own derivative. It's fundamental in calculus and growth models.`;
            break;
    }
    
    // Display main result
    const mainResult = document.getElementById('exp-main-result');
    mainResult.innerHTML = `
        <div style="display:flex;align-items:baseline;gap:10px;flex-wrap:wrap;justify-content:center;">
            <div style="font-size:1.8rem;color:var(--accent);">${formula.split('=')[0]}</div>
            <div style="font-size:2rem;color:#39ff14;font-weight:700;">= ${result.toLocaleString(undefined, {maximumFractionDigits: 10})}</div>
        </div>
    `;
    
    // Display formula if enabled
    const formulaContainer = document.getElementById('exp-formula-container');
    const formulaDiv = document.getElementById('exp-formula');
    if (showFormula) {
        formulaContainer.style.display = 'block';
        formulaDiv.innerHTML = formula;
    } else {
        formulaContainer.style.display = 'none';
    }
    
    // Display steps if enabled
    const stepsContainer = document.getElementById('exp-steps-container');
    const stepsDiv = document.getElementById('exp-steps');
    if (showSteps) {
        stepsContainer.style.display = 'block';
        stepsDiv.innerHTML = steps.map((step, index) => `
            <div style="margin-bottom:12px;padding-left:24px;position:relative;">
                <div style="position:absolute;left:0;top:2px;width:18px;height:18px;background:var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#000;font-size:0.8rem;font-weight:600;">
                    ${index + 1}
                </div>
                <div>${step}</div>
            </div>
        `).join('');
    } else {
        stepsContainer.style.display = 'none';
    }
    
    // Display additional info
    const infoContainer = document.getElementById('exp-additional-info');
    const infoDiv = document.getElementById('exp-info-content');
    infoContainer.style.display = 'block';
    infoDiv.innerHTML = additionalInfo;
    
    // Display visualization if enabled
    const vizContainer = document.getElementById('exp-visualization-container');
    if (showGraph) {
        vizContainer.style.display = 'block';
        expCreateVisualization(base, exponent, result);
    } else {
        vizContainer.style.display = 'none';
    }
    
    // Add to history
    expAddToHistory(base, exponent, expCurrentOperation, result);
    
    // Animation
    mainResult.style.animation = 'expPulse 0.5s ease';
    setTimeout(() => {
        mainResult.style.animation = '';
    }, 500);
}

function expCreateVisualization(base, exponent, result) {
    const canvas = document.getElementById('exp-chart-canvas');
    const container = document.getElementById('exp-visualization');
    
    // Set canvas size
    canvas.width = container.clientWidth - 40;
    canvas.height = 200;
    
    const ctx = canvas.getContext('2d');
    
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw based on operation
    switch(expCurrentOperation) {
        case 'power':
            expDrawPowerVisualization(ctx, canvas, base, exponent, result);
            break;
        case 'root':
            expDrawRootVisualization(ctx, canvas, base, exponent, result);
            break;
        case 'log':
            expDrawLogVisualization(ctx, canvas, base, exponent, result);
            break;
        case 'exponential':
            expDrawExponentialVisualization(ctx, canvas, base, result);
            break;
    }
}

function expDrawPowerVisualization(ctx, canvas, base, exponent, result) {
    const padding = 30;
    const chartWidth = canvas.width - 2 * padding;
    const chartHeight = canvas.height - 2 * padding;
    
    // Draw grid
    ctx.strokeStyle = 'rgba(255,255,255,0.1)';
    ctx.lineWidth = 1;
    
    // Draw bars for visualization
    const barWidth = chartWidth / 3;
    const maxValue = Math.max(base, result, 10);
    const scale = chartHeight / maxValue;
    
    // Base bar
    const baseHeight = base * scale;
    ctx.fillStyle = 'rgba(45,212,255,0.6)';
    ctx.fillRect(padding, canvas.height - padding - baseHeight, barWidth, baseHeight);
    
    // Operation symbol
    ctx.fillStyle = 'rgba(255,255,255,0.8)';
    ctx.font = 'bold 24px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('^' + exponent, padding + barWidth + barWidth/2, canvas.height/2);
    
    // Result bar
    const resultHeight = result * scale;
    ctx.fillStyle = 'rgba(57,255,20,0.6)';
    ctx.fillRect(padding + 2 * barWidth, canvas.height - padding - resultHeight, barWidth, resultHeight);
    
    // Labels
    ctx.fillStyle = '#fff';
    ctx.font = '12px Arial';
    ctx.textAlign = 'center';
    
    // Base label
    ctx.fillText('Base: ' + base, padding + barWidth/2, canvas.height - padding + 20);
    ctx.fillText(`${base}`, padding + barWidth/2, canvas.height - padding - baseHeight - 10);
    
    // Result label
    ctx.fillText('Result: ' + result.toFixed(2), padding + 2.5 * barWidth, canvas.height - padding + 20);
    ctx.fillText(`${result.toFixed(2)}`, padding + 2.5 * barWidth, canvas.height - padding - resultHeight - 10);
}

function expDrawRootVisualization(ctx, canvas, base, exponent, result) {
    const padding = 30;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = Math.min(canvas.width, canvas.height) / 3;
    
    // Draw circle representing the root operation
    ctx.strokeStyle = 'rgba(45,212,255,0.6)';
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
    ctx.stroke();
    
    // Draw root symbol
    ctx.fillStyle = 'rgba(255,255,255,0.8)';
    ctx.font = 'bold 48px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText('‚àö', centerX, centerY);
    
    // Draw small exponent
    ctx.font = 'bold 24px Arial';
    ctx.fillText(exponent, centerX - 20, centerY - 40);
    
    // Draw input and output
    ctx.font = '16px Arial';
    ctx.fillText('Input: ' + base, centerX, centerY + radius + 30);
    ctx.fillStyle = 'rgba(57,255,20,0.8)';
    ctx.fillText('Output: ' + result.toFixed(4), centerX, centerY - radius - 20);
}

function expShowError(message) {
    const mainResult = document.getElementById('exp-main-result');
    mainResult.innerHTML = `
        <div style="color:#ff2d55;font-weight:600;text-align:center;">
            <div style="font-size:2rem;margin-bottom:10px;">‚ö†Ô∏è</div>
            ${message}
        </div>
    `;
    
    // Hide other containers
    document.getElementById('exp-formula-container').style.display = 'none';
    document.getElementById('exp-steps-container').style.display = 'none';
    document.getElementById('exp-visualization-container').style.display = 'none';
    document.getElementById('exp-additional-info').style.display = 'none';
}

function expAddToHistory(base, exponent, operation, result) {
    const entry = {
        timestamp: new Date().toLocaleTimeString(),
        operation: operation,
        expression: `${base} ${getOperationSymbol(operation)} ${exponent}`,
        result: result.toFixed(6),
        id: Date.now()
    };
    
    expHistory.unshift(entry);
    if (expHistory.length > 5) {
        expHistory.pop();
    }
}

function getOperationSymbol(operation) {
    switch(operation) {
        case 'power': return '^';
        case 'root': return '‚àö';
        case 'log': return 'log';
        case 'exponential': return 'e^';
        default: return '?';
    }
}

function expCopyToClipboard() {
    const mainResult = document.getElementById('exp-main-result').textContent;
    if (!mainResult || mainResult.includes('Results will appear here')) return;
    
    let text = mainResult + '\n\n';
    
    if (document.getElementById('exp-formula-container').style.display !== 'none') {
        text += 'Formula: ' + document.getElementById('exp-formula').textContent + '\n\n';
    }
    
    if (document.getElementById('exp-steps-container').style.display !== 'none') {
        text += 'Steps:\n' + document.getElementById('exp-steps').textContent + '\n\n';
    }
    
    if (document.getElementById('exp-additional-info').style.display !== 'none') {
        text += 'Additional Info: ' + document.getElementById('exp-info-content').textContent;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        // Show success message
        const button = document.querySelector('[onclick="expCopyToClipboard()"]');
        const original = button.innerHTML;
        button.innerHTML = '‚úÖ Copied!';
        button.style.color = '#39ff14';
        
        setTimeout(() => {
            button.innerHTML = original;
            button.style.color = '';
        }, 2000);
    });
}

function expSaveResult() {
    const mainResult = document.getElementById('exp-main-result').textContent;
    if (!mainResult || mainResult.includes('Results will appear here')) return;
    
    const data = {
        timestamp: new Date().toISOString(),
        calculation: mainResult,
        base: document.getElementById('exp-base').value,
        exponent: document.getElementById('exp-exponent').value,
        operation: expCurrentOperation
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
    
    const link = document.createElement('a');
    link.download = `exponent-calculation-${Date.now()}.json`;
    link.href = dataUri;
    link.click();
}

function expReset() {
    document.getElementById('exp-base').value = '';
    document.getElementById('exp-exponent').value = '';
    document.getElementById('exp-show-steps').checked = true;
    document.getElementById('exp-show-formula').checked = true;
    document.getElementById('exp-show-graph').checked = false;
    
    const mainResult = document.getElementById('exp-main-result');
    mainResult.innerHTML = `<div style="color:rgba(230,250,255,0.5);">Results will appear here</div>`;
    
    document.getElementById('exp-formula-container').style.display = 'none';
    document.getElementById('exp-steps-container').style.display = 'none';
    document.getElementById('exp-visualization-container').style.display = 'none';
    document.getElementById('exp-additional-info').style.display = 'none';
}

function expExample() {
    // Set example values
    document.getElementById('exp-base').value = 2;
    document.getElementById('exp-exponent').value = 3;
    expSetOperation('power');
    
    // Auto-calculate
    setTimeout(expCalculate, 300);
}

// Add keyboard shortcut (Enter to calculate)
document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.target.matches('textarea, input[type="text"]')) {
        e.preventDefault();
        expCalculate();
    }
});

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        // Set default values
        expSetOperation('power');
        
        // Auto-calculate example
        setTimeout(expExample, 500);
        
        console.log('Exponents Calculator ready');
    });
}
</script>

<style>
@keyframes expPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
}

#exponents-calculator-title {
    color: var(--accent);
    margin-top: 0;
    text-align: center;
    position: relative;
    padding-bottom: 12px;
}

#exponents-calculator-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 25%;
    width: 50%;
    height: 3px;
    background: linear-gradient(90deg, 
        transparent, 
        #2dd4ff, 
        #39ff14, 
        #ffcc00, 
        transparent
    );
    border-radius: 
