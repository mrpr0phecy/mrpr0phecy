<h2 id="garden-task-checklist" style="margin-top:0;color:var(--accent);text-align:center;position:relative;">
  ğŸŒ± <span style="color:#39ff14">Smart Garden</span> Task Planner
  <div style="font-size:14px;color:rgba(230,250,255,0.7);font-weight:400;margin-top:4px;">
    Plan, Track & Grow Your Perfect Garden!
  </div>
</h2>

<!-- Quick Stats Dashboard -->
<div style="background:linear-gradient(135deg, rgba(57,255,20,0.08), rgba(45,212,255,0.05));border-radius:12px;padding:16px;margin-bottom:20px;border:1px solid rgba(57,255,20,0.2);box-shadow:0 4px 20px rgba(0,0,0,0.2);">
  <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;text-align:center;">
    <div style="padding:8px;background:rgba(255,255,255,0.03);border-radius:8px;">
      <div style="font-size:11px;color:rgba(230,250,255,0.7);margin-bottom:4px;">ğŸ“… Today</div>
      <div id="gtc-today-count" style="font-size:24px;font-weight:700;color:#39ff14;">0</div>
    </div>
    <div style="padding:8px;background:rgba(255,255,255,0.03);border-radius:8px;">
      <div style="font-size:11px;color:rgba(230,250,255,0.7);margin-bottom:4px;">âœ… Completed</div>
      <div id="gtc-completed-count" style="font-size:24px;font-weight:700;color:#2dd4ff;">0</div>
    </div>
    <div style="padding:8px;background:rgba(255,255,255,0.03);border-radius:8px;">
      <div style="font-size:11px;color:rgba(230,250,255,0.7);margin-bottom:4px;">â° Urgent</div>
      <div id="gtc-urgent-count" style="font-size:24px;font-weight:700;color:#ffcc00;">0</div>
    </div>
  </div>
</div>

<form aria-describedby="gtc-desc" style="margin-top:16px;">
  <p id="gtc-desc" class="small" style="text-align:center;color:rgba(230,250,255,0.9);line-height:1.5;">
    Manage your gardening journey with <span style="color:#39ff14;font-weight:600">smart scheduling</span>, 
    seasonal tips, and progress tracking.
  </p>

  <!-- QUICK ADD SECTION -->
  <div style="background:rgba(45,212,255,0.05);border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(45,212,255,0.15);">
    <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:18px">â•</span> Add New Task
    </h4>
    
    <div style="display:grid;gap:12px;">
      <!-- Task Input -->
      <div>
        <label for="gtc-task" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Task Description
        </label>
        <input id="gtc-task" type="text" placeholder="e.g., Prune roses, Fertilize tomatoes, Harvest basil..." 
               style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-size:14px;" />
      </div>
      
      <!-- Task Category & Priority -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label for="gtc-category" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Category
          </label>
          <select id="gtc-category" 
                  style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
            <option value="pruning">âœ‚ï¸ Pruning</option>
            <option value="watering" selected>ğŸ’§ Watering</option>
            <option value="fertilizing">ğŸŒ± Fertilizing</option>
            <option value="planting">ğŸª´ Planting</option>
            <option value="harvesting">ğŸ¥• Harvesting</option>
            <option value="weeding">ğŸŒ¿ Weeding</option>
            <option value="pest-control">ğŸ› Pest Control</option>
            <option value="maintenance">ğŸ”§ Maintenance</option>
          </select>
        </div>
        
        <div>
          <label for="gtc-priority" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Priority
          </label>
          <select id="gtc-priority" 
                  style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
            <option value="low">ğŸŸ¢ Low (Within 2 weeks)</option>
            <option value="medium" selected>ğŸŸ¡ Medium (This week)</option>
            <option value="high">ğŸ”´ High (Today/Tomorrow)</option>
            <option value="urgent">âš ï¸ Urgent (Today!)</option>
          </select>
        </div>
      </div>
      
      <!-- Due Date & Plant Type -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label for="gtc-due-date" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Due Date
          </label>
          <input id="gtc-due-date" type="date" 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;" />
        </div>
        
        <div>
          <label for="gtc-plant" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Plant/Area
          </label>
          <input id="gtc-plant" type="text" placeholder="Tomatoes, Roses, Lawn, etc." 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;" />
        </div>
      </div>
      
      <!-- Notes -->
      <div>
        <label for="gtc-notes" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Notes (Optional)
        </label>
        <textarea id="gtc-notes" rows="2" placeholder="Special instructions, reminders, or details..."
                  style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;resize:vertical;"></textarea>
      </div>
      
      <!-- Quick Add Presets -->
      <div>
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:6px;">Quick Add Common Tasks:</div>
        <div style="display:flex;gap:6px;flex-wrap:wrap;">
          <button type="button" onclick="gtcQuickAdd('Water vegetable garden', 'watering', 'medium')" 
                  style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:11px;white-space:nowrap;">
            ğŸ’§ Water veggies
          </button>
          <button type="button" onclick="gtcQuickAdd('Prune roses', 'pruning', 'medium')" 
                  style="padding:6px 10px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);border-radius:6px;color:#ffa500;cursor:pointer;font-size:11px;white-space:nowrap;">
            âœ‚ï¸ Prune roses
          </button>
          <button type="button" onclick="gtcQuickAdd('Fertilize tomatoes', 'fertilizing', 'high')" 
                  style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:11px;white-space:nowrap;">
            ğŸŒ± Fertilize
          </button>
          <button type="button" onclick="gtcQuickAdd('Harvest herbs', 'harvesting', 'low')" 
                  style="padding:6px 10px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:6px;color:#ff4d4d;cursor:pointer;font-size:11px;white-space:nowrap;">
            ğŸ¥• Harvest
          </button>
        </div>
      </div>
    </div>
    
    <!-- Add Task Button -->
    <div style="margin-top:16px;text-align:center;">
      <button type="button" onclick="gtcAddTask()" 
              style="padding:14px 24px;background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(45,212,255,0.1));border:1px solid rgba(57,255,20,0.4);border-radius:10px;color:#39ff14;cursor:pointer;font-weight:600;font-size:16px;width:100%;display:flex;align-items:center;justify-content:center;gap:8px;">
        <span>ğŸŒ±</span> Add Gardening Task
      </button>
    </div>
  </div>
</form>

<!-- TASK MANAGEMENT -->
<div style="background:rgba(45,212,255,0.05);border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(45,212,255,0.15);">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
    <h4 style="color:var(--accent);margin:0;display:flex;align-items:center;gap:8px;">
      <span style="font-size:18px">ğŸ“‹</span> Your Garden Tasks
    </h4>
    
    <!-- Filter Controls -->
    <div style="display:flex;gap:8px;">
      <select id="gtc-filter" onchange="gtcFilterTasks()"
              style="padding:6px 10px;border-radius:6px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:12px;cursor:pointer;">
        <option value="all">All Tasks</option>
        <option value="today">Today</option>
        <option value="pending">Pending</option>
        <option value="completed">Completed</option>
        <option value="urgent">Urgent</option>
      </select>
      <button type="button" onclick="gtcClearCompleted()" 
              style="padding:6px 10px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:6px;color:#ff4d4d;cursor:pointer;font-size:12px;">
        Clear Completed
      </button>
    </div>
  </div>
  
  <!-- Task List Container -->
  <div id="gtc-output" style="min-height:100px;max-height:400px;overflow-y:auto;padding-right:4px;">
    <!-- Tasks will be added here -->
    <div style="text-align:center;padding:32px;color:rgba(230,250,255,0.5);">
      <div style="font-size:48px;margin-bottom:12px;">ğŸŒ¿</div>
      <div>No gardening tasks yet</div>
      <div style="font-size:12px;margin-top:6px;">Add your first task above!</div>
    </div>
  </div>
  
  <!-- Task Stats -->
  <div style="margin-top:16px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.1);">
    <div style="display:flex;justify-content:space-between;font-size:12px;color:rgba(230,250,255,0.7);">
      <span>Total: <span id="gtc-total-count" style="color:inherit;font-weight:600;">0</span> tasks</span>
      <span>Due today: <span id="gtc-due-today" style="color:#ffcc00;font-weight:600;">0</span></span>
      <span>Completion: <span id="gtc-completion" style="color:#39ff14;font-weight:600;">0%</span></span>
    </div>
  </div>
</div>

<!-- GARDENING TIPS & SEASONAL GUIDE -->
<div style="background:linear-gradient(135deg, rgba(57,255,20,0.08), rgba(45,212,255,0.05));border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(57,255,20,0.2);">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
    <h4 style="color:var(--accent);margin:0;display:flex;align-items:center;gap:8px;">
      <span style="font-size:18px">ğŸŒ¤ï¸</span> Seasonal Gardening Tips
    </h4>
    <button type="button" onclick="gtcNewTip()" 
            style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;font-size:11px;">
      New Tip
    </button>
  </div>
  
  <div id="gtc-gardening-tip" style="font-size:13px;color:rgba(230,250,255,0.9);line-height:1.5;padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border-left:4px solid var(--accent);">
    <div style="display:flex;align-items:flex-start;gap:8px;">
      <span style="color:#39ff14;flex-shrink:0;font-size:16px;">ğŸ’¡</span>
      <span>Early morning is the best time to water plants - less evaporation and reduced fungal diseases.</span>
    </div>
  </div>
  
  <!-- Seasonal Checklist -->
  <div style="margin-top:16px;">
    <div style="font-size:13px;color:rgba(230,250,255,0.8);margin-bottom:8px;">This season consider:</div>
    <div id="gtc-seasonal-checklist" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:12px;">
      <!-- Will be populated by JS -->
    </div>
  </div>
</div>

<!-- ACTION BUTTONS -->
<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:20px;">
  <button type="button" onclick="gtcExportTasks()" 
          style="padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.1), rgba(45,212,255,0.05));border:1px solid rgba(45,212,255,0.3);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;">
    ğŸ“¥ Export Tasks
  </button>
  <button type="button" onclick="gtcShareGarden()"
          style="padding:12px;background:linear-gradient(135deg, rgba(57,255,20,0.1), rgba(57,255,20,0.05));border:1px solid rgba(57,255,20,0.3);border-radius:10px;color:#39ff14;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;">
    ğŸ“¤ Share Progress
  </button>
</div>

<!-- PROGRESS VISUALIZATION -->
<div style="margin-top:20px;background:rgba(20,20,20,0.6);border-radius:12px;padding:16px;border:1px solid rgba(255,255,255,0.1);">
  <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;text-align:center;font-size:16px;">
    ğŸ“Š Garden Progress Overview
  </h4>
  
  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:16px;">
    <div style="text-align:center;padding:8px;background:rgba(45,212,255,0.08);border-radius:6px;">
      <div style="font-size:10px;color:rgba(230,250,255,0.7);margin-bottom:2px;">Pruning</div>
      <div id="gtc-cat-pruning" style="font-size:18px;font-weight:600;color:var(--accent);">0</div>
    </div>
    <div style="text-align:center;padding:8px;background:rgba(57,255,20,0.08);border-radius:6px;">
      <div style="font-size:10px;color:rgba(230,250,255,0.7);margin-bottom:2px;">Watering</div>
      <div id="gtc-cat-watering" style="font-size:18px;font-weight:600;color:#39ff14;">0</div>
    </div>
    <div style="text-align:center;padding:8px;background:rgba(255,165,0,0.08);border-radius:6px;">
      <div style="font-size:10px;color:rgba(230,250,255,0.7);margin-bottom:2px;">Fertilizing</div>
      <div id="gtc-cat-fertilizing" style="font-size:18px;font-weight:600;color:#ffa500;">0</div>
    </div>
    <div style="text-align:center;padding:8px;background:rgba(255,77,77,0.08);border-radius:6px;">
      <div style="font-size:10px;color:rgba(230,250,255,0.7);margin-bottom:2px;">Harvesting</div>
      <div id="gtc-cat-harvesting" style="font-size:18px;font-weight:600;color:#ff4d4d;">0</div>
    </div>
  </div>
  
  <!-- Monthly Stats -->
  <div style="font-size:12px;color:rgba(230,250,255,0.7);text-align:center;">
    <span>This month: </span>
    <span style="color:var(--accent);font-weight:600;" id="gtc-month-tasks">0</span> tasks â€¢ 
    <span style="color:#39ff14;font-weight:600;" id="gtc-month-completed">0</span> completed
  </div>
</div>

<script>
/* garden-task-checklist.html - VIRAL EDITION
   - Comprehensive garden task manager
   - Seasonal gardening tips
   - Progress tracking and statistics
   - Shareable garden progress
   - Smart filtering and organization
*/

// Task database
let gtcTasks = [];
let gtcCurrentFilter = 'all';

// Gardening tips database
const gtcGardeningTips = [
  "Water plants deeply but less frequently to encourage strong root growth.",
  "Companion planting: Grow basil with tomatoes to improve flavor and repel pests.",
  "Mulch your garden beds to retain moisture and suppress weeds.",
  "Rotate crops each year to prevent soil nutrient depletion and reduce pests.",
  "Test soil pH every 2-3 years; most vegetables prefer 6.0-7.0 pH.",
  "Use rainwater when possible - it's free of chlorine and better for plants.",
  "Prune fruit trees in late winter while they're dormant for best results.",
  "Attract pollinators by planting native flowers near your vegetable garden.",
  "Keep a garden journal to track what works and plan for next season.",
  "Use organic compost to improve soil structure and nutrient content.",
  "Stagger plantings of vegetables like lettuce and carrots for continuous harvest.",
  "Control slugs with beer traps or crushed eggshells around plants.",
  "Start seeds indoors 6-8 weeks before last frost date for early harvest.",
  "Use vertical space with trellises for cucumbers, beans, and peas.",
  "Harvest herbs in the morning when oil concentrations are highest."
];

// Seasonal tasks by month (0 = January)
const gtcSeasonalTasks = [
  ["Plan garden layout", "Order seeds", "Start indoor seeds", "Clean tools"],
  ["Prune fruit trees", "Start cool-season crops", "Prepare soil", "Test soil"],
  ["Plant peas & spinach", "Transplant seedlings", "Divide perennials", "Weed"],
  ["Plant tomatoes", "Direct sow beans", "Fertilize spring bulbs", "Mulch"],
  ["Stake tall plants", "Plant warm crops", "Thin seedlings", "Water regularly"],
  ["Harvest berries", "Monitor pests", "Weed consistently", "Deadhead flowers"],
  ["Harvest vegetables", "Water deeply", "Prune herbs", "Check for diseases"],
  ["Plant fall crops", "Harvest garlic", "Save seeds", "Fertilize"],
  ["Harvest pumpkins", "Plant cover crops", "Clean beds", "Divide irises"],
  ["Harvest root crops", "Plant garlic", "Rake leaves for compost", "Winterize"],
  ["Protect tender plants", "Clean tools", "Test soil pH", "Order catalogs"],
  ["Review garden notes", "Plan next year", "Maintain compost", "Prune grapes"]
];

// Initialize
function gtcInit() {
  console.log("Garden Task Checklist initialized");
  
  // Load saved tasks from localStorage
  const savedTasks = localStorage.getItem('gtcTasks');
  const savedDate = localStorage.getItem('gtcStatsDate');
  const today = new Date().toDateString();
  
  if (savedTasks) {
    try {
      gtcTasks = JSON.parse(savedTasks);
      
      // Clear old completed tasks (older than 30 days)
      const thirtyDaysAgo = new Date();
      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
      
      gtcTasks = gtcTasks.filter(task => {
        if (task.completed) {
          const completedDate = new Date(task.completedAt);
          return completedDate > thirtyDaysAgo;
        }
        return true;
      });
    } catch (e) {
      console.log("Failed to load tasks:", e);
      gtcTasks = [];
    }
  }
  
  // Reset monthly stats if new month
  if (savedDate !== today) {
    const todayMonth = new Date().getMonth();
    const savedMonth = savedDate ? new Date(savedDate).getMonth() : -1;
    
    if (todayMonth !== savedMonth) {
      localStorage.setItem('gtcMonthTasks', '0');
      localStorage.setItem('gtcMonthCompleted', '0');
    }
    localStorage.setItem('gtcStatsDate', today);
  }
  
  // Set today's date as default due date
  const todayInput = new Date().toISOString().split('T')[0];
  document.getElementById('gtc-due-date').value = todayInput;
  document.getElementById('gtc-due-date').min = todayInput;
  
  // Load seasonal tips
  gtcLoadSeasonalTips();
  
  // Render tasks
  gtcRenderTasks();
  
  // Update stats
  gtcUpdateStats();
  
  // Set up event listeners
  document.getElementById('gtc-task').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      gtcAddTask();
    }
  });
}

// Load seasonal gardening tips
function gtcLoadSeasonalTips() {
  const currentMonth = new Date().getMonth();
  const seasonalTasks = gtcSeasonalTasks[currentMonth];
  
  const container = document.getElementById('gtc-seasonal-checklist');
  container.innerHTML = '';
  
  seasonalTasks.forEach(task => {
    const div = document.createElement('div');
    div.style.padding = '6px 8px';
    div.style.background = 'rgba(255,255,255,0.03)';
    div.style.borderRadius = '6px';
    div.style.border = '1px solid rgba(57,255,20,0.2)';
    div.style.color = 'rgba(230,250,255,0.8)';
    div.textContent = 'âœ“ ' + task;
    container.appendChild(div);
  });
}

// Quick add common tasks
function gtcQuickAdd(task, category, priority) {
  document.getElementById('gtc-task').value = task;
  document.getElementById('gtc-category').value = category;
  document.getElementById('gtc-priority').value = priority;
  
  // Focus on task input
  document.getElementById('gtc-task').focus();
}

// Add new task
function gtcAddTask() {
  const taskInput = document.getElementById('gtc-task');
  const taskText = taskInput.value.trim();
  
  if (!taskText) {
    taskInput.style.borderColor = '#ff2d55';
    setTimeout(() => {
      taskInput.style.borderColor = 'rgba(45,212,255,0.3)';
    }, 1000);
    return;
  }
  
  const newTask = {
    id: Date.now() + Math.random().toString(36).substr(2, 9),
    text: taskText,
    category: document.getElementById('gtc-category').value,
    priority: document.getElementById('gtc-priority').value,
    dueDate: document.getElementById('gtc-due-date').value,
    plant: document.getElementById('gtc-plant').value.trim(),
    notes: document.getElementById('gtc-notes').value.trim(),
    completed: false,
    createdAt: new Date().toISOString(),
    completedAt: null
  };
  
  gtcTasks.unshift(newTask); // Add to beginning
  gtcSaveTasks();
  gtcRenderTasks();
  gtcUpdateStats();
  
  // Clear form
  taskInput.value = '';
  document.getElementById('gtc-plant').value = '';
  document.getElementById('gtc-notes').value = '';
  taskInput.focus();
  
  // Visual feedback
  const addButton = document.querySelector('[onclick="gtcAddTask()"]');
  const originalText = addButton.innerHTML;
  addButton.innerHTML = 'âœ… Task Added!';
  addButton.style.background = 'linear-gradient(135deg, rgba(57,255,20,0.3), rgba(57,255,20,0.2))';
  
  setTimeout(() => {
    addButton.innerHTML = originalText;
    addButton.style.background = '';
  }, 1500);
  
  // Update monthly task count
  const monthTasks = parseInt(localStorage.getItem('gtcMonthTasks') || '0') + 1;
  localStorage.setItem('gtcMonthTasks', monthTasks.toString());
  document.getElementById('gtc-month-tasks').textContent = monthTasks;
}

// Render tasks
function gtcRenderTasks() {
  const container = document.getElementById('gtc-output');
  
  if (gtcTasks.length === 0) {
    container.innerHTML = `
      <div style="text-align:center;padding:32px;color:rgba(230,250,255,0.5);">
        <div style="font-size:48px;margin-bottom:12px;">ğŸŒ¿</div>
        <div>No gardening tasks yet</div>
        <div style="font-size:12px;margin-top:6px;">Add your first task above!</div>
      </div>
    `;
    return;
  }
  
  // Filter tasks
  let filteredTasks = [...gtcTasks];
  const today = new Date().toISOString().split('T')[0];
  
  switch (gtcCurrentFilter) {
    case 'today':
      filteredTasks = filteredTasks.filter(task => task.dueDate === today);
      break;
    case 'pending':
      filteredTasks = filteredTasks.filter(task => !task.completed);
      break;
    case 'completed':
      filteredTasks = filteredTasks.filter(task => task.completed);
      break;
    case 'urgent':
      filteredTasks = filteredTasks.filter(task => 
        !task.completed && (task.priority === 'urgent' || task.priority === 'high')
      );
      break;
  }
  
  // Render tasks
  container.innerHTML = '';
  
  filteredTasks.forEach(task => {
    const taskElement = document.createElement('div');
    taskElement.className = 'gtc-task-item';
    taskElement.dataset.id = task.id;
    
    // Priority colors
    const priorityColors = {
      low: '#39ff14',
      medium: '#ffcc00',
      high: '#ff2d55',
      urgent: '#ff0000'
    };
    
    // Category icons
    const categoryIcons = {
      pruning: 'âœ‚ï¸',
      watering: 'ğŸ’§',
      fertilizing: 'ğŸŒ±',
      planting: 'ğŸª´',
      harvesting: 'ğŸ¥•',
      weeding: 'ğŸŒ¿',
      'pest-control': 'ğŸ›',
      maintenance: 'ğŸ”§'
    };
    
    const isToday = task.dueDate === today;
    const isOverdue = !task.completed && task.dueDate && task.dueDate < today;
    
    taskElement.innerHTML = `
      <div style="display:flex;align-items:flex-start;gap:12px;padding:12px;background:${task.completed ? 'rgba(57,255,20,0.05)' : 'rgba(255,255,255,0.03)'};border-radius:8px;border:1px solid ${task.completed ? 'rgba(57,255,20,0.3)' : 'rgba(255,255,255,0.1)'};margin-bottom:8px;${isOverdue ? 'border-left:4px solid #ff0000;' : isToday ? 'border-left:4px solid #ffcc00;' : ''}">
        <div style="flex-shrink:0;">
          <input type="checkbox" ${task.completed ? 'checked' : ''} 
                 onchange="gtcToggleTask('${task.id}')" 
                 style="cursor:pointer;width:18px;height:18px;" />
        </div>
        <div style="flex:1;min-width:0;">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:8px;margin-bottom:4px;">
            <div style="font-weight:500;color:${task.completed ? 'rgba(230,250,255,0.5)' : 'rgba(230,250,255,0.9)'};text-decoration:${task.completed ? 'line-through' : 'none'};word-break:break-word;">
              ${categoryIcons[task.category] || 'ğŸŒ±'} ${task.text}
            </div>
            <div style="display:flex;gap:4px;flex-shrink:0;">
              <span style="font-size:11px;padding:2px 6px;background:${priorityColors[task.priority]}20;color:${priorityColors[task.priority]};border-radius:4px;border:1px solid ${priorityColors[task.priority]}40;">
                ${task.priority}
              </span>
              <button onclick="gtcDeleteTask('${task.id}')" style="background:transparent;border:none;color:rgba(255,77,77,0.7);cursor:pointer;padding:2px;font-size:12px;" title="Delete task">
                ğŸ—‘ï¸
              </button>
            </div>
          </div>
          
          <div style="display:flex;flex-wrap:wrap;gap:8px;font-size:11px;color:rgba(230,250,255,0.6);">
            ${task.plant ? `<span>ğŸŒ¿ ${task.plant}</span>` : ''}
            ${task.dueDate ? `<span style="color:${isOverdue ? '#ff0000' : isToday ? '#ffcc00' : 'inherit'};">ğŸ“… ${task.dueDate}</span>` : ''}
            ${task.notes ? `<span title="${task.notes}">ğŸ“ Note</span>` : ''}
            <span>${new Date(task.createdAt).toLocaleDateString()}</span>
          </div>
        </div>
      </div>
    `;
    
    container.appendChild(taskElement);
  });
}

// Toggle task completion
function gtcToggleTask(taskId) {
  const task = gtcTasks.find(t => t.id === taskId);
  if (task) {
    task.completed = !task.completed;
    task.completedAt = task.completed ? new Date().toISOString() : null;
    
    // Update monthly completed count
    if (task.completed) {
      const monthCompleted = parseInt(localStorage.getItem('gtcMonthCompleted') || '0') + 1;
      localStorage.setItem('gtcMonthCompleted', monthCompleted.toString());
    }
    
    gtcSaveTasks();
    gtcRenderTasks();
    gtcUpdateStats();
  }
}

// Delete task
function gtcDeleteTask(taskId) {
  if (confirm('Delete this task?')) {
    gtcTasks = gtcTasks.filter(t => t.id !== taskId);
    gtcSaveTasks();
    gtcRenderTasks();
    gtcUpdateStats();
  }
}

// Filter tasks
function gtcFilterTasks() {
  gtcCurrentFilter = document.getElementById('gtc-filter').value;
  gtcRenderTasks();
}

// Clear completed tasks
function gtcClearCompleted() {
  if (confirm('Clear all completed tasks?')) {
    gtcTasks = gtcTasks.filter(task => !task.completed);
    gtcSaveTasks();
    gtcRenderTasks();
    gtcUpdateStats();
  }
}

// Update statistics
function gtcUpdateStats() {
  const today = new Date().toISOString().split('T')[0];
  
  // Count tasks
  const totalTasks = gtcTasks.length;
  const completedTasks = gtcTasks.filter(t => t.completed).length;
  const todayTasks = gtcTasks.filter(t => t.dueDate === today && !t.completed).length;
  const urgentTasks = gtcTasks.filter(t => 
    !t.completed && (t.priority === 'urgent' || (t.dueDate && t.dueDate <= today))
  ).length;
  
  // Update counts
  document.getElementById('gtc-today-count').textContent = todayTasks;
  document.getElementById('gtc-completed-count').textContent = completedTasks;
  document.getElementById('gtc-urgent-count').textContent = urgentTasks;
  document.getElementById('gtc-total-count').textContent = totalTasks;
  document.getElementById('gtc-due-today').textContent = todayTasks;
  
  // Completion percentage
  const completionPercent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
  document.getElementById('gtc-completion').textContent = completionPercent + '%';
  
  // Category counts
  const categories = ['pruning', 'watering', 'fertilizing', 'harvesting'];
  categories.forEach(cat => {
    const count = gtcTasks.filter(t => t.category === cat).length;
    document.getElementById(`gtc-cat-${cat}`).textContent = count;
  });
  
  // Monthly stats
  const monthTasks = localStorage.getItem('gtcMonthTasks') || '0';
  const monthCompleted = localStorage.getItem('gtcMonthCompleted') || '0';
  document.getElementById('gtc-month-tasks').textContent = monthTasks;
  document.getElementById('gtc-month-completed').textContent = monthCompleted;
}

// Save tasks to localStorage
function gtcSaveTasks() {
  localStorage.setItem('gtcTasks', JSON.stringify(gtcTasks));
}

// Export tasks
function gtcExportTasks() {
  const exportData = {
    exportedAt: new Date().toISOString(),
    totalTasks: gtcTasks.length,
    completedTasks: gtcTasks.filter(t => t.completed).length,
    tasks: gtcTasks
  };
  
  const dataStr = JSON.stringify(exportData, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
  
  const exportFileDefaultName = `garden-tasks-${new Date().toISOString().split('T')[0]}.json`;
  
  const linkElement = document.createElement('a');
  linkElement.setAttribute('href', dataUri);
  linkElement.setAttribute('download', exportFileDefaultName);
  linkElement.click();
  
  // Visual feedback
  const exportBtn = document.querySelector('[onclick="gtcExportTasks()"]');
  const originalText = exportBtn.textContent;
  exportBtn.textContent = 'âœ… Exported!';
  
  setTimeout(() => {
    exportBtn.textContent = originalText;
  }, 1500);
}

// Share garden progress
function gtcShareGarden() {
  const totalTasks = gtcTasks.length;
  const completedTasks = gtcTasks.filter(t => t.completed).length;
  const completionPercent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
  
  const shareText = `ğŸŒ± My garden progress: ${completedTasks}/${totalTasks} tasks completed (${completionPercent}%)! Track your gardening tasks at The Most Useful Site in the World!`;
  
  // Try Web Share API first
  if (navigator.share) {
    navigator.share({
      title: 'My Garden Progress',
      text: shareText,
      url: window.location.href
    }).catch(err => {
      console.log('Share cancelled:', err);
      // Fallback to clipboard
      navigator.clipboard.writeText(shareText).then(() => {
        alert('Garden progress copied to clipboard! ğŸ“‹');
      });
    });
  } else {
    // Fallback to clipboard
    navigator.clipboard.writeText(shareText).then(() => {
      alert('Garden progress copied to clipboard! ğŸ“‹ Share your gardening journey!');
    });
  }
}

// Show new gardening tip
function gtcNewTip() {
  const tipElement = document.getElementById('gtc-gardening-tip');
  
  // Get random tip that's not the current one
  let newTip;
  const currentTip = tipElement.querySelector('span:nth-child(2)').textContent;
  do {
    newTip = gtcGardeningTips[Math.floor(Math.random() * gtcGardeningTips.length)];
  } while (newTip === currentTip && gtcGardeningTips.length > 1);
  
  tipElement.querySelector('span:nth-child(2)').textContent = newTip;
  
  // Visual feedback
  tipElement.style.opacity = '0.5';
  setTimeout(() => {
    tipElement.style.opacity = '1';
    tipElement.style.transition = 'opacity 0.3s';
  }, 10);
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', gtcInit);
} else {
  gtcInit();
}
</script>

<style>
@keyframes taskComplete {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

.gtc-task-item {
  transition: all 0.3s ease;
}

.gtc-task-item:hover {
  transform: translateX(4px);
  background: rgba(255,255,255,0.05);
}

input[type="checkbox"]:checked {
  accent-color: #39ff14;
}

/* Custom scrollbar for task list */
#gtc-output::-webkit-scrollbar {
  width: 6px;
}

#gtc-output::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#gtc-output::-webkit-scrollbar-thumb {
  background: rgba(57,255,20,0.3);
  border-radius: 3px;
}

#gtc-output::-webkit-scrollbar-thumb:hover {
  background: rgba(57,255,20,0.5);
}

@media (max-width: 768px) {
  .row {
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }
  
  #gtc-seasonal-checklist {
    grid-template-columns: 1fr !important;
  }
  
  .action-buttons {
    flex-direction: column;
  }
  
  .action-buttons button {
    width: 100%;
    margin: 4px 0 !important;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}
</style>
