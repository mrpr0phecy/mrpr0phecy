<h2 id="moving-planner-title" style="margin-top:0;">ğŸšš Ultimate Moving Planner</h2>

<!-- Manifest metadata -->
<!--
  id: moving-planner
  title: Ultimate Moving Planner
  path: cards/moving-planner.html
  category: Life & Productivity
  version: 2.0
  viral_tags: [moving, checklist, productivity, organization, home, lifehack]
  accessibility: [keyboard_nav, screen_reader, high_contrast]
  languages: [en, es, fr, de, zh, ja, pt, ru]
  features: [checklist, inventory, budget, timeline, sharing, export]
-->

<form aria-describedby="moving-desc" style="margin-bottom:16px;">
  <div id="moving-desc" style="margin-bottom:20px;">
    <p style="margin:0 0 12px 0;color:var(--muted);font-size:14px;line-height:1.5;">
      <span style="color:var(--accent);font-weight:600;">Complete moving organization tool</span>: Create checklists, track inventory, manage budget, schedule tasks, and coordinate with family/friends. Make your move stress-free!
    </p>
    
    <!-- Progress Summary -->
    <div style="display:flex;gap:16px;flex-wrap:wrap;margin-bottom:12px;">
      <div style="flex:1;min-width:200px;">
        <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
          <span style="color:var(--muted);font-size:13px;">Overall Progress</span>
          <span id="moving-overall-progress" style="color:var(--accent);font-weight:600;">0%</span>
        </div>
        <div style="height:8px;background:var(--glass);border-radius:4px;overflow:hidden;">
          <div id="moving-progress-bar" style="height:100%;background:linear-gradient(90deg, var(--accent), #39ff14);width:0%;transition:width 0.5s;"></div>
        </div>
      </div>
      
      <div style="display:flex;gap:12px;">
        <div style="text-align:center;">
          <div style="color:var(--muted);font-size:11px;">Tasks</div>
          <div id="moving-stats-tasks" style="color:var(--accent);font-size:18px;font-weight:600;">0</div>
        </div>
        <div style="text-align:center;">
          <div style="color:var(--muted);font-size:11px;">Done</div>
          <div id="moving-stats-done" style="color:#39ff14;font-size:18px;font-weight:600;">0</div>
        </div>
        <div style="text-align:center;">
          <div style="color:var(--muted);font-size:11px;">Budget</div>
          <div id="moving-stats-budget" style="color:#ffcc00;font-size:18px;font-weight:600;">$0</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Add Section -->
  <div style="background:rgba(255,255,255,0.03);padding:16px;border-radius:8px;border:1px solid var(--border);margin-bottom:20px;">
    <h3 style="color:var(--accent);font-size:15px;margin:0 0 12px 0;display:flex;align-items:center;gap:6px;">
      âœ¨ Quick Add Task
      <button type="button" onclick="mpShowTemplates()" style="margin-left:auto;padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--accent);cursor:pointer;">
        Templates
      </button>
    </h3>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:12px;">
      <div>
        <label for="mp-task" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Task Name *</label>
        <input id="mp-task" type="text" placeholder="e.g., Pack fragile items" 
               style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);"
               aria-required="true" />
      </div>
      
      <div>
        <label for="mp-category" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Category</label>
        <select id="mp-category" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);">
          <option value="packing">ğŸ“¦ Packing</option>
          <option value="logistics">ğŸšš Logistics</option>
          <option value="administrative">ğŸ“„ Paperwork</option>
          <option value="cleaning">ğŸ§¹ Cleaning</option>
          <option value="setup">ğŸ  Setup</option>
          <option value="shopping">ğŸ›’ Shopping</option>
        </select>
      </div>
      
      <div>
        <label for="mp-priority" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Priority</label>
        <select id="mp-priority" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);">
          <option value="high" style="color:#ff2d55;">ğŸ”¥ High</option>
          <option value="medium" style="color:#ff9500;" selected>âš ï¸ Medium</option>
          <option value="low" style="color:#39ff14;">âœ… Low</option>
        </select>
      </div>
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
      <div>
        <label for="mp-assigned" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Assigned To</label>
        <input id="mp-assigned" type="text" placeholder="Family member or friend" 
               style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);"
               list="mp-people-list" />
        <datalist id="mp-people-list"></datalist>
      </div>
      
      <div>
        <label for="mp-date" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Due Date</label>
        <input id="mp-date" type="date" 
               style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
      </div>
      
      <div>
        <label for="mp-cost" style="display:block;font-size:12px;color:var(--accent);margin-bottom:6px;">Estimated Cost</label>
        <div style="display:flex;align-items:center;">
          <span style="padding:0 8px;color:var(--muted);">$</span>
          <input id="mp-cost" type="number" min="0" step="0.01" placeholder="0.00" 
                 style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
        </div>
      </div>
    </div>
    
    <div class="actions" style="display:flex;gap:10px;flex-wrap:wrap;">
      <button type="button" onclick="mpAddTask()" 
              style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid var(--accent);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;min-width:140px;">
        âœ… Add Task
      </button>
      <button type="button" onclick="mpAddMultiple()"
              style="padding:12px 16px;background:var(--glass);border:1px solid var(--border);border-radius:8px;color:var(--text);cursor:pointer;">
        â• Add Multiple
      </button>
      <button type="button" onclick="mpResetForm()"
              style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid var(--border);border-radius:8px;color:var(--text);cursor:pointer;">
        ğŸ§¹ Clear Form
      </button>
    </div>
    
    <!-- Quick Task Templates -->
    <div id="mp-quick-tasks" style="display:none;margin-top:16px;padding-top:16px;border-top:1px solid var(--border);">
      <div style="color:var(--muted);font-size:13px;margin-bottom:8px;">Common Moving Tasks:</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;">
        <button onclick="mpQuickTask('Book moving truck', 'logistics', 'high')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Book Truck</button>
        <button onclick="mpQuickTask('Pack fragile items', 'packing', 'high')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Pack Fragile</button>
        <button onclick="mpQuickTask('Change address', 'administrative', 'medium')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Change Address</button>
        <button onclick="mpQuickTask('Clean old apartment', 'cleaning', 'low')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Clean Old</button>
        <button onclick="mpQuickTask('Setup internet', 'setup', 'medium')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Setup Internet</button>
      </div>
    </div>
  </div>
</form>

<!-- Main Content Tabs -->
<div style="display:flex;flex-direction:column;gap:20px;margin-bottom:20px;">
  
  <!-- Task List with Filters -->
  <div style="border:2px solid var(--border);border-radius:12px;padding:16px;background:var(--panel);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px;">
      <div style="display:flex;align-items:center;gap:8px;">
        <h3 style="color:var(--accent);font-size:15px;margin:0;">ğŸ“‹ Task List</h3>
        <div style="display:flex;gap:4px;">
          <button onclick="mpFilter('all')" id="mp-filter-all" style="padding:4px 8px;font-size:11px;background:var(--accent);border:1px solid var(--accent);border-radius:4px;color:#000;cursor:pointer;">All</button>
          <button onclick="mpFilter('pending')" id="mp-filter-pending" style="padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--text);cursor:pointer;">Pending</button>
          <button onclick="mpFilter('completed')" id="mp-filter-completed" style="padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--text);cursor:pointer;">Completed</button>
        </div>
      </div>
      
      <div style="display:flex;gap:8px;">
        <button onclick="mpExportTasks()" style="padding:6px 12px;font-size:12px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--accent);cursor:pointer;display:flex;align-items:center;gap:4px;">
          ğŸ“¥ Export
        </button>
        <button onclick="mpSharePlan()" style="padding:6px 12px;font-size:12px;background:linear-gradient(135deg, #1da1f2, #0d8bd9);color:white;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;gap:4px;">
          ğŸ“¤ Share
        </button>
      </div>
    </div>
    
    <!-- Task List Container -->
    <div id="mp-task-list" style="max-height:400px;overflow-y:auto;padding-right:8px;">
      <div style="text-align:center;padding:40px 20px;color:var(--muted);font-style:italic;">
        No tasks yet. Add your first moving task above!
      </div>
    </div>
    
    <!-- Bulk Actions -->
    <div id="mp-bulk-actions" style="display:none;margin-top:16px;padding-top:16px;border-top:1px solid var(--border);">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
        <span style="color:var(--muted);font-size:13px;">Bulk Actions:</span>
        <button onclick="mpBulkComplete()" style="padding:6px 12px;font-size:12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;">âœ“ Mark Selected Complete</button>
        <button onclick="mpBulkDelete()" style="padding:6px 12px;font-size:12px;background:rgba(255,45,85,0.1);border:1px solid rgba(255,45,85,0.3);border-radius:6px;color:#ff2d55;cursor:pointer;">ğŸ—‘ï¸ Delete Selected</button>
        <button onclick="mpClearBulk()" style="padding:6px 12px;font-size:12px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;">Clear Selection</button>
      </div>
    </div>
  </div>
  
  <!-- Dashboard Widgets -->
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:16px;">
    
    <!-- Budget Tracker -->
    <div style="border:2px solid var(--border);border-radius:12px;padding:16px;background:var(--panel);">
      <h3 style="color:#ffcc00;font-size:15px;margin:0 0 12px 0;display:flex;align-items:center;gap:6px;">
        ğŸ’° Budget Tracker
        <span id="mp-budget-total" style="margin-left:auto;font-weight:600;">$0</span>
      </h3>
      
      <div style="margin-bottom:12px;">
        <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
          <span style="color:var(--muted);font-size:12px;">Estimated Total</span>
          <span id="mp-budget-estimated" style="color:#ffcc00;font-weight:600;">$0</span>
        </div>
        <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
          <span style="color:var(--muted);font-size:12px;">Actual Spent</span>
          <span id="mp-budget-spent" style="color:#39ff14;font-weight:600;">$0</span>
        </div>
        <div style="display:flex;justify-content:space-between;">
          <span style="color:var(--muted);font-size:12px;">Remaining</span>
          <span id="mp-budget-remaining" style="color:var(--accent);font-weight:600;">$0</span>
        </div>
      </div>
      
      <div style="height:8px;background:var(--glass);border-radius:4px;overflow:hidden;margin-bottom:12px;">
        <div id="mp-budget-progress" style="height:100%;background:linear-gradient(90deg, #ffcc00, #39ff14);width:0%;"></div>
      </div>
      
      <button onclick="mpAddExpense()" style="width:100%;padding:8px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;font-size:12px;">
        + Add Expense
      </button>
    </div>
    
    <!-- Timeline View -->
    <div style="border:2px solid var(--border);border-radius:12px;padding:16px;background:var(--panel);">
      <h3 style="color:var(--accent);font-size:15px;margin:0 0 12px 0;display:flex;align-items:center;gap:6px;">
        ğŸ“… Timeline
        <button onclick="mpViewCalendar()" style="margin-left:auto;padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--accent);cursor:pointer;">
          View All
        </button>
      </h3>
      
      <div id="mp-timeline" style="max-height:150px;overflow-y:auto;font-size:13px;">
        <div style="color:var(--muted);font-style:italic;text-align:center;padding:20px;">
          No upcoming tasks
        </div>
      </div>
    </div>
    
    <!-- Inventory Summary -->
    <div style="border:2px solid var(--border);border-radius:12px;padding:16px;background:var(--panel);">
      <h3 style="color:#9d4edd;font-size:15px;margin:0 0 12px 0;display:flex;align-items:center;gap:6px;">
        ğŸ“¦ Inventory
        <button onclick="mpOpenInventory()" style="margin-left:auto;padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:#9d4edd;cursor:pointer;">
          Manage
        </button>
      </h3>
      
      <div id="mp-inventory-summary" style="font-size:13px;">
        <div style="display:flex;justify-content:space-between;margin-bottom:6px;">
          <span style="color:var(--muted);">Boxes Packed</span>
          <span id="mp-boxes-packed" style="color:#9d4edd;font-weight:600;">0</span>
        </div>
        <div style="display:flex;justify-content:space-between;margin-bottom:6px;">
          <span style="color:var(--muted);">Fragile Items</span>
          <span id="mp-fragile-items" style="color:#ff2d55;font-weight:600;">0</span>
        </div>
        <div style="display:flex;justify-content:space-between;">
          <span style="color:var(--muted);">To Pack</span>
          <span id="mp-to-pack" style="color:var(--accent);font-weight:600;">0</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Advanced Features Section -->
<details style="margin-bottom:20px;">
  <summary style="padding:14px;background:var(--glass);border:2px solid var(--border);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:500;list-style:none;display:flex;align-items:center;gap:8px;">
    âš™ï¸ Advanced Features & Settings
  </summary>
  
  <div style="padding:20px;background:var(--panel);border:2px solid var(--border);border-radius:0 0 8px 8px;margin-top:-2px;">
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:20px;margin-bottom:20px;">
      
      <!-- Team Management -->
      <div>
        <h4 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸ‘¥ Team & Assignments</h4>
        <div id="mp-team-list" style="margin-bottom:12px;max-height:200px;overflow-y:auto;padding-right:8px;">
          <div style="color:var(--muted);font-style:italic;text-align:center;padding:20px;">
            No team members added
          </div>
        </div>
        <div style="display:flex;gap:8px;">
          <input id="mp-new-member" type="text" placeholder="Add team member" 
                 style="flex:1;padding:8px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
          <button onclick="mpAddTeamMember()" style="padding:8px 12px;background:var(--accent);border:none;border-radius:6px;color:#000;cursor:pointer;font-weight:600;">
            Add
          </button>
        </div>
      </div>
      
      <!-- Moving Details -->
      <div>
        <h4 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸ¡ Moving Details</h4>
        <div style="display:grid;gap:10px;">
          <div>
            <label style="display:block;font-size:12px;color:var(--muted);margin-bottom:4px;">Move Date</label>
            <input id="mp-move-date" type="date" style="width:100%;padding:8px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
          </div>
          <div>
            <label style="display:block;font-size:12px;color:var(--muted);margin-bottom:4px;">Moving From</label>
            <input id="mp-moving-from" type="text" placeholder="Current address" 
                   style="width:100%;padding:8px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
          </div>
          <div>
            <label style="display:block;font-size:12px;color:var(--muted);margin-bottom:4px;">Moving To</label>
            <input id="mp-moving-to" type="text" placeholder="New address" 
                   style="width:100%;padding:8px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);" />
          </div>
        </div>
      </div>
    </div>
    
    <!-- Export & Backup -->
    <div>
      <h4 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸ’¾ Export & Backup</h4>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <button onclick="mpExportPDF()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:6px;">
          ğŸ“„ Export PDF
        </button>
        <button onclick="mpExportCSV()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:6px;">
          ğŸ“Š Export CSV
        </button>
        <button onclick="mpBackupData()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:6px;">
          ğŸ’¾ Backup Data
        </button>
        <button onclick="mpImportData()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:6px;">
          ğŸ“¥ Import Data
        </button>
        <button onclick="mpPrintPlan()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;display:flex;align-items:center;gap:6px;">
          ğŸ–¨ï¸ Print Plan
        </button>
      </div>
    </div>
  </div>
</details>

<!-- Tips & Resources -->
<div style="padding:16px;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
  <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;">
    <h3 style="color:var(--accent);font-size:14px;margin:0;">ğŸ’¡ Moving Tips & Resources</h3>
    <button onclick="mpToggleTips()" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:12px;">
      Hide
    </button>
  </div>
  
  <div id="mp-tips-content" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:12px;">
    <div style="padding:12px;background:var(--glass);border-radius:6px;">
      <div style="color:var(--accent);font-weight:600;margin-bottom:6px;">Start Early</div>
      <div style="color:var(--muted);font-size:12px;">Begin packing non-essential items 4-6 weeks before moving day.</div>
    </div>
    <div style="padding:12px;background:var(--glass);border-radius:6px;">
      <div style="color:var(--accent);font-weight:600;margin-bottom:6px;">Label Boxes</div>
      <div style="color:var(--muted);font-size:12px;">Label each box with room and contents for easy unpacking.</div>
    </div>
    <div style="padding:12px;background:var(--glass);border-radius:6px;">
      <div style="color:var(--accent);font-weight:600;margin-bottom:6px;">Essentials Box</div>
      <div style="color:var(--muted);font-size:12px;">Pack a box with essentials for the first 24 hours at your new home.</div>
    </div>
    <div style="padding:12px;background:var(--glass);border-radius:6px;">
      <div style="color:var(--accent);font-weight:600;margin-bottom:6px;">Update Address</div>
      <div style="color:var(--muted);font-size:12px;">Remember to update your address with banks, subscriptions, and government agencies.</div>
    </div>
  </div>
</div>

<script>
/* Ultimate Moving Planner
   Features:
   - Complete moving organization
   - Budget tracking
   - Team collaboration
   - Inventory management
   - Multiple export formats
   - Social sharing
   - Mobile friendly
   - Data persistence
*/

// ========== GLOBAL STATE ==========
const mp = {
  // Core data
  tasks: [],
  team: [],
  inventory: {
    boxes: 0,
    fragile: 0,
    rooms: {}
  },
  budget: {
    estimated: 0,
    spent: 0,
    expenses: []
  },
  settings: {
    moveDate: '',
    fromAddress: '',
    toAddress: '',
    currency: 'USD'
  },
  
  // UI state
  currentFilter: 'all',
  selectedTasks: new Set(),
  
  // Templates
  templates: {
    'Book moving truck': { category: 'logistics', priority: 'high', cost: 500 },
    'Pack fragile items': { category: 'packing', priority: 'high', cost: 50 },
    'Change address': { category: 'administrative', priority: 'medium', cost: 0 },
    'Clean old apartment': { category: 'cleaning', priority: 'low', cost: 100 },
    'Setup internet': { category: 'setup', priority: 'medium', cost: 100 },
    'Transfer utilities': { category: 'administrative', priority: 'medium', cost: 0 },
    'Pack kitchen': { category: 'packing', priority: 'medium', cost: 30 },
    'Donate unwanted items': { category: 'packing', priority: 'low', cost: 0 },
    'Measure new spaces': { category: 'setup', priority: 'low', cost: 0 },
    'Forward mail': { category: 'administrative', priority: 'medium', cost: 0 }
  },
  
  // Categories
  categories: {
    packing: { name: 'ğŸ“¦ Packing', color: '#9d4edd' },
    logistics: { name: 'ğŸšš Logistics', color: '#ff9500' },
    administrative: { name: 'ğŸ“„ Paperwork', color: '#0077cc' },
    cleaning: { name: 'ğŸ§¹ Cleaning', color: '#39ff14' },
    setup: { name: 'ğŸ  Setup', color: '#2dd4ff' },
    shopping: { name: 'ğŸ›’ Shopping', color: '#ff2d55' }
  },
  
  // Priority levels
  priorities: {
    high: { name: 'ğŸ”¥ High', color: '#ff2d55' },
    medium: { name: 'âš ï¸ Medium', color: '#ff9500' },
    low: { name: 'âœ… Low', color: '#39ff14' }
  }
};

// ========== INITIALIZATION ==========
document.addEventListener('DOMContentLoaded', function() {
  // Load saved data
  mpLoadData();
  
  // Initialize date inputs
  const today = new Date();
  const moveDate = new Date(today);
  moveDate.setDate(today.getDate() + 30);
  
  document.getElementById('mp-date').value = formatDate(today);
  document.getElementById('mp-move-date').value = formatDate(moveDate);
  
  // Update display
  mpUpdateUI();
  
  // Set up event listeners
  setupEventListeners();
  
  // Announce to screen reader
  announceToScreenReader('Ultimate Moving Planner loaded. Add your first task to get started.');
});

function setupEventListeners() {
  // Add task on Enter key in task field
  document.getElementById('mp-task').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault();
      mpAddTask();
    }
  });
  
  // Save data on input changes
  document.getElementById('mp-move-date').addEventListener('change', mpSaveData);
  document.getElementById('mp-moving-from').addEventListener('input', mpSaveData);
  document.getElementById('mp-moving-to').addEventListener('input', mpSaveData);
}

// ========== CORE TASK MANAGEMENT ==========
function mpAddTask() {
  const taskInput = document.getElementById('mp-task');
  const task = taskInput.value.trim();
  
  if (!task) {
    showNotification('Please enter a task name', 'warning');
    taskInput.focus();
    return;
  }
  
  const newTask = {
    id: Date.now() + Math.random().toString(36).substr(2, 9),
    task: task,
    category: document.getElementById('mp-category').value,
    priority: document.getElementById('mp-priority').value,
    assigned: document.getElementById('mp-assigned').value.trim(),
    date: document.getElementById('mp-date').value,
    cost: parseFloat(document.getElementById('mp-cost').value) || 0,
    completed: false,
    createdAt: new Date().toISOString(),
    notes: ''
  };
  
  mp.tasks.push(newTask);
  
  // Add assigned person to team list if not empty
  if (newTask.assigned && !mp.team.includes(newTask.assigned)) {
    mp.team.push(newTask.assigned);
    updateTeamList();
  }
  
  // Update budget
  mp.budget.estimated += newTask.cost;
  
  // Clear form
  mpResetForm();
  
  // Update UI
  mpUpdateUI();
  
  // Save data
  mpSaveData();
  
  // Announce
  announceToScreenReader(`Task added: ${task}`);
  showNotification('Task added successfully!', 'success');
}

function mpAddMultiple() {
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
  `;
  
  modal.innerHTML = `
    <div style="background: var(--panel); padding: 24px; border-radius: 12px; max-width: 500px; width: 100%; max-height: 80vh; overflow-y: auto;">
      <h3 style="color: var(--accent); margin: 0 0 16px 0;">Add Multiple Tasks</h3>
      <p style="color: var(--muted); font-size: 13px; margin-bottom: 16px;">
        Enter one task per line. You can use format: "Task | Category | Priority | Assigned To | Due Date | Cost"
      </p>
      <textarea id="mp-bulk-input" 
                placeholder="Pack kitchen boxes | packing | medium | Jamie | 2024-12-20 | 30
Book moving truck | logistics | high | Alex | 2024-12-15 | 500
Change address | administrative | medium | | 2024-12-10 | 0"
                style="width: 100%; height: 200px; padding: 12px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text); font-family: monospace; font-size: 13px; margin-bottom: 16px;"></textarea>
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                style="padding: 10px 20px; background: var(--glass); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer;">
          Cancel
        </button>
        <button onclick="mpProcessBulkTasks()" 
                style="padding: 10px 20px; background: var(--accent); border: none; border-radius: 6px; color: #000; cursor: pointer; font-weight: 600;">
          Add Tasks
        </button>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
  modal.querySelector('textarea').focus();
}

function mpProcessBulkTasks() {
  const input = document.getElementById('mp-bulk-input').value.trim();
  const lines = input.split('\n');
  let added = 0;
  let skipped = 0;
  
  lines.forEach(line => {
    const trimmed = line.trim();
    if (!trimmed) return;
    
    const parts = trimmed.split('|').map(p => p.trim());
    
    const task = {
      id: Date.now() + Math.random().toString(36).substr(2, 9),
      task: parts[0] || 'Untitled Task',
      category: parts[1] || 'packing',
      priority: parts[2] || 'medium',
      assigned: parts[3] || '',
      date: parts[4] || '',
      cost: parseFloat(parts[5]) || 0,
      completed: false,
      createdAt: new Date().toISOString(),
      notes: ''
    };
    
    // Validate category
    if (!mp.categories[task.category]) {
      task.category = 'packing';
    }
    
    // Validate priority
    if (!mp.priorities[task.priority]) {
      task.priority = 'medium';
    }
    
    mp.tasks.push(task);
    
    // Add to team
    if (task.assigned && !mp.team.includes(task.assigned)) {
      mp.team.push(task.assigned);
    }
    
    // Update budget
    mp.budget.estimated += task.cost;
    
    added++;
  });
  
  // Close modal
  document.querySelector('[style*="position: fixed"]').remove();
  
  // Update UI
  updateTeamList();
  mpUpdateUI();
  mpSaveData();
  
  showNotification(`Added ${added} tasks successfully!`, 'success');
  announceToScreenReader(`Added ${added} new tasks`);
}

function mpToggleTask(taskId) {
  const task = mp.tasks.find(t => t.id === taskId);
  if (task) {
    task.completed = !task.completed;
    
    // Update budget if task has cost
    if (task.completed && task.cost > 0) {
      mp.budget.spent += task.cost;
    } else if (!task.completed && task.cost > 0) {
      mp.budget.spent -= task.cost;
    }
    
    mpUpdateUI();
    mpSaveData();
    
    const status = task.completed ? 'completed' : 'pending';
    announceToScreenReader(`Task marked as ${status}: ${task.task}`);
  }
}

function mpDeleteTask(taskId) {
  const task = mp.tasks.find(t => t.id === taskId);
  if (task) {
    // Remove from budget
    mp.budget.estimated -= task.cost;
    if (task.completed) {
      mp.budget.spent -= task.cost;
    }
    
    // Remove from tasks
    const index = mp.tasks.findIndex(t => t.id === taskId);
    if (index > -1) {
      mp.tasks.splice(index, 1);
    }
    
    // Remove from selected
    mp.selectedTasks.delete(taskId);
    
    mpUpdateUI();
    mpSaveData();
    
    announceToScreenReader(`Task deleted: ${task.task}`);
    showNotification('Task deleted', 'info');
  }
}

function mpEditTask(taskId) {
  const task = mp.tasks.find(t => t.id === taskId);
  if (!task) return;
  
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
  `;
  
  modal.innerHTML = `
    <div style="background: var(--panel); padding: 24px; border-radius: 12px; max-width: 500px; width: 100%; max-height: 80vh; overflow-y: auto;">
      <h3 style="color: var(--accent); margin: 0 0 16px 0;">Edit Task</h3>
      
      <div style="display: grid; gap: 12px; margin-bottom: 20px;">
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Task Name</label>
          <input id="mp-edit-task" type="text" value="${escapeHtml(task.task)}" 
                 style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
          <div>
            <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Category</label>
            <select id="mp-edit-category" style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);">
              ${Object.entries(mp.categories).map(([key, cat]) => 
                `<option value="${key}" ${task.category === key ? 'selected' : ''}>${cat.name}</option>`
              ).join('')}
            </select>
          </div>
          
          <div>
            <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Priority</label>
            <select id="mp-edit-priority" style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);">
              ${Object.entries(mp.priorities).map(([key, pri]) => 
                `<option value="${key}" ${task.priority === key ? 'selected' : ''}>${pri.name}</option>`
              ).join('')}
            </select>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
          <div>
            <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Assigned To</label>
            <input id="mp-edit-assigned" type="text" value="${escapeHtml(task.assigned)}" 
                   style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" 
                   list="mp-edit-people-list" />
            <datalist id="mp-edit-people-list">
              ${mp.team.map(person => `<option value="${escapeHtml(person)}">`).join('')}
            </datalist>
          </div>
          
          <div>
            <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Due Date</label>
            <input id="mp-edit-date" type="date" value="${task.date}" 
                   style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
          </div>
        </div>
        
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Cost ($)</label>
          <input id="mp-edit-cost" type="number" min="0" step="0.01" value="${task.cost}" 
                 style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
        </div>
        
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Notes</label>
          <textarea id="mp-edit-notes" 
                    style="width: 100%; height: 100px; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text); resize: vertical;">${escapeHtml(task.notes)}</textarea>
        </div>
      </div>
      
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                style="padding: 10px 20px; background: var(--glass); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer;">
          Cancel
        </button>
        <button onclick="mpSaveTaskEdit('${taskId}')" 
                style="padding: 10px 20px; background: var(--accent); border: none; border-radius: 6px; color: #000; cursor: pointer; font-weight: 600;">
          Save Changes
        </button>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function mpSaveTaskEdit(taskId) {
  const task = mp.tasks.find(t => t.id === taskId);
  if (!task) return;
  
  // Get old values for budget adjustment
  const oldCost = task.cost;
  const oldCompleted = task.completed;
  
  // Update task
  task.task = document.getElementById('mp-edit-task').value.trim();
  task.category = document.getElementById('mp-edit-category').value;
  task.priority = document.getElementById('mp-edit-priority').value;
  task.assigned = document.getElementById('mp-edit-assigned').value.trim();
  task.date = document.getElementById('mp-edit-date').value;
  task.cost = parseFloat(document.getElementById('mp-edit-cost').value) || 0;
  task.notes = document.getElementById('mp-edit-notes').value.trim();
  
  // Update budget
  mp.budget.estimated = mp.budget.estimated - oldCost + task.cost;
  
  if (oldCompleted) {
    mp.budget.spent = mp.budget.spent - oldCost + task.cost;
  }
  
  // Update team if new person
  if (task.assigned && !mp.team.includes(task.assigned)) {
    mp.team.push(task.assigned);
    updateTeamList();
  }
  
  // Close modal
  document.querySelector('[style*="position: fixed"]').remove();
  
  // Update UI and save
  mpUpdateUI();
  mpSaveData();
  
  showNotification('Task updated successfully!', 'success');
  announceToScreenReader('Task updated');
}

// ========== UI UPDATES ==========
function mpUpdateUI() {
  updateTaskList();
  updateStats();
  updateBudgetDisplay();
  updateTimeline();
  updateInventorySummary();
  updateProgressBar();
}

function updateTaskList() {
  const container = document.getElementById('mp-task-list');
  const filter = mp.currentFilter;
  
  // Filter tasks
  let tasksToShow;
  switch (filter) {
    case 'pending':
      tasksToShow = mp.tasks.filter(t => !t.completed);
      break;
    case 'completed':
      tasksToShow = mp.tasks.filter(t => t.completed);
      break;
    default:
      tasksToShow = [...mp.tasks];
  }
  
  // Sort tasks: incomplete first, then by priority, then by date
  tasksToShow.sort((a, b) => {
    if (a.completed !== b.completed) return a.completed ? 1 : -1;
    
    const priorityOrder = { high: 0, medium: 1, low: 2 };
    if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
      return priorityOrder[a.priority] - priorityOrder[b.priority];
    }
    
    if (a.date && b.date) return new Date(a.date) - new Date(b.date);
    if (a.date) return -1;
    if (b.date) return 1;
    
    return new Date(b.createdAt) - new Date(a.createdAt);
  });
  
  if (tasksToShow.length === 0) {
    container.innerHTML = `
      <div style="text-align:center;padding:40px 20px;color:var(--muted);font-style:italic;">
        No tasks ${filter === 'all' ? 'yet' : filter}. ${filter === 'all' ? 'Add your first moving task above!' : 'Try another filter.'}
      </div>
    `;
    return;
  }
  
  let html = '';
  
  tasksToShow.forEach(task => {
    const category = mp.categories[task.category] || mp.categories.packing;
    const priority = mp.priorities[task.priority] || mp.priorities.medium;
    const isSelected = mp.selectedTasks.has(task.id);
    
    html += `
      <div class="task-item" 
           style="display:flex;align-items:center;padding:12px;background:${isSelected ? 'rgba(45,212,255,0.1)' : 'transparent'};border-radius:8px;border:1px solid ${isSelected ? 'var(--accent)' : 'var(--border)'};margin-bottom:8px;transition:all 0.2s;cursor:pointer;"
           onclick="mpToggleSelect('${task.id}', event)">
        
        <!-- Checkbox -->
        <div style="margin-right:12px;flex-shrink:0;">
          <input type="checkbox" id="task-${task.id}" ${isSelected ? 'checked' : ''} 
                 style="width:18px;height:18px;cursor:pointer;"
                 onchange="mpToggleSelect('${task.id}')" />
        </div>
        
        <!-- Status -->
        <div style="margin-right:12px;flex-shrink:0;">
          <button onclick="mpToggleTask('${task.id}');event.stopPropagation();" 
                  style="width:24px;height:24px;border-radius:12px;border:2px solid ${task.completed ? '#39ff14' : priority.color};background:${task.completed ? '#39ff14' : 'transparent'};color:${task.completed ? '#000' : priority.color};cursor:pointer;font-weight:bold;font-size:12px;display:flex;align-items:center;justify-content:center;">
            ${task.completed ? 'âœ“' : ''}
          </button>
        </div>
        
        <!-- Task Details -->
        <div style="flex:1;min-width:0;">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;flex-wrap:wrap;">
            <div style="font-weight:${task.completed ? 'normal' : '600'};color:${task.completed ? 'var(--muted)' : 'var(--text)'};text-decoration:${task.completed ? 'line-through' : 'none'};">
              ${escapeHtml(task.task)}
            </div>
            <span style="padding:2px 6px;background:${category.color}20;color:${category.color};border-radius:4px;font-size:11px;">
              ${category.name}
            </span>
            <span style="padding:2px 6px;background:${priority.color}20;color:${priority.color};border-radius:4px;font-size:11px;">
              ${priority.name}
            </span>
          </div>
          
          <div style="display:flex;align-items:center;gap:12px;font-size:12px;color:var(--muted);flex-wrap:wrap;">
            ${task.assigned ? `<span>ğŸ‘¤ ${escapeHtml(task.assigned)}</span>` : ''}
            ${task.date ? `<span>ğŸ“… ${formatDateDisplay(task.date)}</span>` : ''}
            ${task.cost > 0 ? `<span>ğŸ’° $${task.cost.toFixed(2)}</span>` : ''}
          </div>
          
          ${task.notes ? `<div style="margin-top:6px;font-size:12px;color:var(--muted);font-style:italic;">${escapeHtml(task.notes)}</div>` : ''}
        </div>
        
        <!-- Actions -->
        <div style="display:flex;gap:4px;flex-shrink:0;margin-left:8px;">
          <button onclick="mpEditTask('${task.id}');event.stopPropagation();" 
                  style="padding:6px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--accent);cursor:pointer;font-size:12px;">
            âœï¸
          </button>
          <button onclick="mpDeleteTask('${task.id}');event.stopPropagation();" 
                  style="padding:6px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:#ff2d55;cursor:pointer;font-size:12px;">
            ğŸ—‘ï¸
          </button>
        </div>
        
      </div>
    `;
  });
  
  container.innerHTML = html;
  
  // Show/hide bulk actions
  const bulkActions = document.getElementById('mp-bulk-actions');
  if (mp.selectedTasks.size > 0) {
    bulkActions.style.display = 'block';
  } else {
    bulkActions.style.display = 'none';
  }
}

function updateStats() {
  const totalTasks = mp.tasks.length;
  const completedTasks = mp.tasks.filter(t => t.completed).length;
  const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
  
  // Update progress bar
  document.getElementById('mp-overall-progress').textContent = `${progress}%`;
  
  // Update stats numbers
  document.getElementById('moving-stats-tasks').textContent = totalTasks;
  document.getElementById('moving-stats-done').textContent = completedTasks;
  document.getElementById('moving-stats-budget').textContent = `$${mp.budget.spent.toFixed(2)}`;
}

function updateProgressBar() {
  const totalTasks = mp.tasks.length;
  const completedTasks = mp.tasks.filter(t => t.completed).length;
  const progress = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
  
  document.getElementById('moving-progress-bar').style.width = `${progress}%`;
}

function updateBudgetDisplay() {
  const estimated = mp.budget.estimated;
  const spent = mp.budget.spent;
  const remaining = Math.max(0, estimated - spent);
  const progress = estimated > 0 ? (spent / estimated) * 100 : 0;
  
  document.getElementById('mp-budget-total').textContent = `$${estimated.toFixed(2)}`;
  document.getElementById('mp-budget-estimated').textContent = `$${estimated.toFixed(2)}`;
  document.getElementById('mp-budget-spent').textContent = `$${spent.toFixed(2)}`;
  document.getElementById('mp-budget-remaining').textContent = `$${remaining.toFixed(2)}`;
  document.getElementById('mp-budget-progress').style.width = `${Math.min(100, progress)}%`;
}

function updateTimeline() {
  const container = document.getElementById('mp-timeline');
  const today = new Date();
  const upcomingTasks = mp.tasks
    .filter(t => t.date && !t.completed)
    .filter(t => {
      const taskDate = new Date(t.date);
      return taskDate >= today;
    })
    .sort((a, b) => new Date(a.date) - new Date(b.date))
    .slice(0, 5);
  
  if (upcomingTasks.length === 0) {
    container.innerHTML = '<div style="color:var(--muted);font-style:italic;text-align:center;padding:20px;">No upcoming tasks</div>';
    return;
  }
  
  let html = '';
  upcomingTasks.forEach(task => {
    const daysDiff = Math.ceil((new Date(task.date) - today) / (1000 * 60 * 60 * 24));
    let dayText = daysDiff === 0 ? 'Today' : daysDiff === 1 ? 'Tomorrow' : `in ${daysDiff} days`;
    
    html += `
      <div style="display:flex;align-items:center;padding:8px;border-bottom:1px solid var(--border);">
        <div style="flex:1;min-width:0;">
          <div style="color:var(--text);font-size:13px;margin-bottom:2px;">${escapeHtml(task.task)}</div>
          <div style="color:var(--muted);font-size:11px;">${formatDateDisplay(task.date)} (${dayText})</div>
        </div>
        <button onclick="mpToggleTask('${task.id}')" 
                style="padding:4px 8px;font-size:11px;background:var(--glass);border:1px solid var(--border);border-radius:4px;color:var(--accent);cursor:pointer;">
          âœ“
        </button>
      </div>
    `;
  });
  
  container.innerHTML = html;
}

function updateInventorySummary() {
  // Calculate inventory stats
  const packingTasks = mp.tasks.filter(t => t.category === 'packing' && !t.completed);
  const fragileTasks = mp.tasks.filter(t => 
    t.category === 'packing' && 
    t.task.toLowerCase().includes('fragile') && 
    !t.completed
  );
  
  document.getElementById('mp-boxes-packed').textContent = mp.inventory.boxes;
  document.getElementById('mp-fragile-items').textContent = fragileTasks.length;
  document.getElementById('mp-to-pack').textContent = packingTasks.length;
}

function updateTeamList() {
  const container = document.getElementById('mp-team-list');
  const datalist = document.getElementById('mp-people-list');
  
  if (mp.team.length === 0) {
    container.innerHTML = '<div style="color:var(--muted);font-style:italic;text-align:center;padding:20px;">No team members added</div>';
    datalist.innerHTML = '';
    return;
  }
  
  let html = '';
  mp.team.forEach(person => {
    const tasksAssigned = mp.tasks.filter(t => t.assigned === person);
    const completed = tasksAssigned.filter(t => t.completed).length;
    const total = tasksAssigned.length;
    
    html += `
      <div style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid var(--border);">
        <div style="color:var(--text);font-size:13px;">ğŸ‘¤ ${escapeHtml(person)}</div>
        <div style="display:flex;align-items:center;gap:8px;">
          <span style="color:var(--muted);font-size:12px;">${completed}/${total}</span>
          <button onclick="mpRemoveTeamMember('${escapeHtml(person)}')" 
                  style="padding:2px 6px;font-size:11px;background:rgba(255,45,85,0.1);border:1px solid rgba(255,45,85,0.3);border-radius:4px;color:#ff2d55;cursor:pointer;">
            Remove
          </button>
        </div>
      </div>
    `;
  });
  
  container.innerHTML = html;
  
  // Update datalist
  datalist.innerHTML = mp.team.map(person => `<option value="${escapeHtml(person)}">`).join('');
}

// ========== FILTERS & SELECTION ==========
function mpFilter(filter) {
  mp.currentFilter = filter;
  
  // Update filter buttons
  document.getElementById('mp-filter-all').style.background = filter === 'all' ? 'var(--accent)' : 'var(--glass)';
  document.getElementById('mp-filter-all').style.color = filter === 'all' ? '#000' : 'var(--text)';
  document.getElementById('mp-filter-pending').style.background = filter === 'pending' ? 'var(--accent)' : 'var(--glass)';
  document.getElementById('mp-filter-pending').style.color = filter === 'pending' ? '#000' : 'var(--text)';
  document.getElementById('mp-filter-completed').style.background = filter === 'completed' ? 'var(--accent)' : 'var(--glass)';
  document.getElementById('mp-filter-completed').style.color = filter === 'completed' ? '#000' : 'var(--text)';
  
  updateTaskList();
}

function mpToggleSelect(taskId, event) {
  if (event) {
    event.stopPropagation();
  }
  
  if (mp.selectedTasks.has(taskId)) {
    mp.selectedTasks.delete(taskId);
  } else {
    mp.selectedTasks.add(taskId);
  }
  
  updateTaskList();
}

function mpBulkComplete() {
  mp.selectedTasks.forEach(taskId => {
    const task = mp.tasks.find(t => t.id === taskId);
    if (task && !task.completed) {
      task.completed = true;
      if (task.cost > 0) {
        mp.budget.spent += task.cost;
      }
    }
  });
  
  mp.selectedTasks.clear();
  mpUpdateUI();
  mpSaveData();
  
  showNotification('Selected tasks marked as complete!', 'success');
}

function mpBulkDelete() {
  if (!confirm(`Delete ${mp.selectedTasks.size} selected tasks? This cannot be undone.`)) {
    return;
  }
  
  const tasksToDelete = Array.from(mp.selectedTasks);
  
  tasksToDelete.forEach(taskId => {
    const task = mp.tasks.find(t => t.id === taskId);
    if (task) {
      // Remove from budget
      mp.budget.estimated -= task.cost;
      if (task.completed) {
        mp.budget.spent -= task.cost;
      }
      
      // Remove from tasks
      const index = mp.tasks.findIndex(t => t.id === taskId);
      if (index > -1) {
        mp.tasks.splice(index, 1);
      }
    }
  });
  
  mp.selectedTasks.clear();
  mpUpdateUI();
  mpSaveData();
  
  showNotification(`${tasksToDelete.length} tasks deleted`, 'info');
}

function mpClearBulk() {
  mp.selectedTasks.clear();
  updateTaskList();
}

// ========== TEAM MANAGEMENT ==========
function mpAddTeamMember() {
  const input = document.getElementById('mp-new-member');
  const name = input.value.trim();
  
  if (!name) {
    showNotification('Please enter a name', 'warning');
    return;
  }
  
  if (mp.team.includes(name)) {
    showNotification('Team member already exists', 'info');
    return;
  }
  
  mp.team.push(name);
  input.value = '';
  
  updateTeamList();
  mpSaveData();
  
  showNotification(`Added ${name} to team`, 'success');
}

function mpRemoveTeamMember(name) {
  if (confirm(`Remove ${name} from team?`)) {
    const index = mp.team.indexOf(name);
    if (index > -1) {
      mp.team.splice(index, 1);
    }
    
    // Clear assignments from tasks
    mp.tasks.forEach(task => {
      if (task.assigned === name) {
        task.assigned = '';
      }
    });
    
    updateTeamList();
    mpUpdateUI();
    mpSaveData();
    
    showNotification(`Removed ${name} from team`, 'info');
  }
}

// ========== TEMPLATES & QUICK ACTIONS ==========
function mpShowTemplates() {
  const quickTasks = document.getElementById('mp-quick-tasks');
  const btn = document.querySelector('button[onclick="mpShowTemplates()"]');
  
  if (quickTasks.style.display === 'none') {
    quickTasks.style.display = 'block';
    btn.textContent = 'Hide Templates';
  } else {
    quickTasks.style.display = 'none';
    btn.textContent = 'Templates';
  }
}

function mpQuickTask(taskName, category, priority) {
  document.getElementById('mp-task').value = taskName;
  document.getElementById('mp-category').value = category;
  document.getElementById('mp-priority').value = priority;
  
  const template = mp.templates[taskName];
  if (template && template.cost > 0) {
    document.getElementById('mp-cost').value = template.cost;
  }
  
  document.getElementById('mp-task').focus();
  showNotification(`Template loaded: ${taskName}`, 'info');
}

// ========== EXPORT & SHARING ==========
function mpExportTasks() {
  const tasks = mp.tasks.map(t => ({
    Task: t.task,
    Category: t.category,
    Priority: t.priority,
    Assigned: t.assigned,
    'Due Date': t.date,
    Cost: t.cost,
    Completed: t.completed,
    Notes: t.notes
  }));
  
  const csv = arrayToCSV(tasks);
  downloadCSV(csv, 'moving-tasks.csv');
  
  showNotification('Tasks exported as CSV', 'success');
}

function mpExportPDF() {
  showNotification('PDF export would be generated here', 'info');
  // In a real implementation, you would use jsPDF or similar library
}

function mpExportCSV() {
  const data = {
    tasks: mp.tasks,
    team: mp.team,
    budget: mp.budget,
    settings: mp.settings,
    inventory: mp.inventory
  };
  
  const csv = JSON.stringify(data, null, 2);
  downloadCSV(csv, 'moving-plan-full.json');
  
  showNotification('Full plan exported as JSON', 'success');
}

function mpBackupData() {
  const data = {
    tasks: mp.tasks,
    team: mp.team,
    budget: mp.budget,
    settings: mp.settings,
    inventory: mp.inventory,
    timestamp: new Date().toISOString()
  };
  
  const backup = JSON.stringify(data, null, 2);
  const blob = new Blob([backup], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement('a');
  a.href = url;
  a.download = `moving-plan-backup-${new Date().toISOString().split('T')[0]}.json`;
  a.click();
  
  URL.revokeObjectURL(url);
  
  showNotification('Backup created successfully!', 'success');
}

function mpImportData() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = '.json';
  
  input.onchange = function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    
    reader.onload = function(event) {
      try {
        const data = JSON.parse(event.target.result);
        
        // Validate data structure
        if (!data.tasks || !Array.isArray(data.tasks)) {
          throw new Error('Invalid backup file format');
        }
        
        // Load data
        mp.tasks = data.tasks || [];
        mp.team = data.team || [];
        mp.budget = data.budget || { estimated: 0, spent: 0, expenses: [] };
        mp.settings = data.settings || {};
        mp.inventory = data.inventory || { boxes: 0, fragile: 0, rooms: {} };
        
        // Update UI
        mpUpdateUI();
        updateTeamList();
        mpSaveData();
        
        showNotification('Data imported successfully!', 'success');
        announceToScreenReader('Moving plan imported successfully');
        
      } catch (error) {
        showNotification('Failed to import: ' + error.message, 'error');
      }
    };
    
    reader.readAsText(file);
  };
  
  input.click();
}

function mpPrintPlan() {
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head>
        <title>Moving Plan</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          h1 { color: #2dd4ff; }
          .task { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
          .completed { text-decoration: line-through; opacity: 0.6; }
          .priority-high { color: #ff2d55; }
          .priority-medium { color: #ff9500; }
          .priority-low { color: #39ff14; }
          .stats { display: flex; gap: 20px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <h1>Moving Plan</h1>
        <div class="stats">
          <div>Total Tasks: ${mp.tasks.length}</div>
          <div>Completed: ${mp.tasks.filter(t => t.completed).length}</div>
          <div>Budget: $${mp.budget.spent.toFixed(2)} / $${mp.budget.estimated.toFixed(2)}</div>
        </div>
        ${mp.tasks.map(task => `
          <div class="task ${task.completed ? 'completed' : ''}">
            <div><strong>${task.task}</strong></div>
            <div>Category: ${mp.categories[task.category]?.name || task.category}</div>
            <div class="priority-${task.priority}">Priority: ${mp.priorities[task.priority]?.name || task.priority}</div>
            ${task.assigned ? `<div>Assigned to: ${task.assigned}</div>` : ''}
            ${task.date ? `<div>Due: ${task.date}</div>` : ''}
            ${task.cost > 0 ? `<div>Cost: $${task.cost.toFixed(2)}</div>` : ''}
            ${task.notes ? `<div>Notes: ${task.notes}</div>` : ''}
          </div>
        `).join('')}
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

function mpSharePlan() {
  const moveDate = document.getElementById('mp-move-date').value;
  const fromAddress = document.getElementById('mp-moving-from').value;
  const toAddress = document.getElementById('mp-moving-to').value;
  
  let shareText = `ğŸ“¦ My Moving Plan\n\n`;
  
  if (moveDate) shareText += `Move Date: ${formatDateDisplay(moveDate)}\n`;
  if (fromAddress) shareText += `From: ${fromAddress}\n`;
  if (toAddress) shareText += `To: ${toAddress}\n\n`;
  
  shareText += `Tasks: ${mp.tasks.length} total, ${mp.tasks.filter(t => t.completed).length} completed\n`;
  shareText += `Budget: $${mp.budget.spent.toFixed(2)} / $${mp.budget.estimated.toFixed(2)}\n\n`;
  
  shareText += `Created with The Most Useful Site in the World`;
  
  // Try Web Share API
  if (navigator.share) {
    navigator.share({
      title: 'My Moving Plan',
      text: shareText,
      url: window.location.href
    }).catch(console.error);
  } else {
    // Fallback to clipboard
    navigator.clipboard.writeText(shareText)
      .then(() => {
        showNotification('Moving plan copied to clipboard!', 'success');
      })
      .catch(() => {
        // Show share dialog
        const shareDiv = document.createElement('div');
        shareDiv.innerHTML = `
          <div style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:var(--panel);padding:20px;border-radius:12px;border:2px solid var(--accent);z-index:10000;max-width:500px;">
            <h3 style="color:var(--accent);margin:0 0 10px 0;">Share Moving Plan</h3>
            <textarea style="width:100%;height:200px;padding:10px;border-radius:6px;border:1px solid var(--border);background:var(--glass);color:var(--text);margin-bottom:15px;font-family:monospace;font-size:12px;">${shareText}</textarea>
            <div style="display:flex;gap:10px;justify-content:flex-end;">
              <button onclick="this.parentElement.parentElement.parentElement.remove()" style="padding:8px 16px;background:var(--glass);border:1px solid var(--border);border-radius:6px;color:var(--text);cursor:pointer;">Close</button>
            </div>
          </div>
        `;
        document.body.appendChild(shareDiv);
      });
  }
}

// ========== BUDGET & INVENTORY ==========
function mpAddExpense() {
  const amount = prompt('Enter expense amount:', '0');
  if (amount === null) return;
  
  const cost = parseFloat(amount);
  if (isNaN(cost) || cost < 0) {
    showNotification('Invalid amount', 'error');
    return;
  }
  
  const description = prompt('Enter expense description:', 'Additional moving expense');
  if (description === null) return;
  
  mp.budget.spent += cost;
  mp.budget.expenses.push({
    amount: cost,
    description: description.trim(),
    date: new Date().toISOString().split('T')[0]
  });
  
  mpUpdateUI();
  mpSaveData();
  
  showNotification(`Expense added: $${cost.toFixed(2)}`, 'success');
}

function mpOpenInventory() {
  const modal = document.createElement('div');
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 20px;
  `;
  
  modal.innerHTML = `
    <div style="background: var(--panel); padding: 24px; border-radius: 12px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto;">
      <h3 style="color: var(--accent); margin: 0 0 16px 0;">ğŸ“¦ Inventory Management</h3>
      
      <div style="display: grid; gap: 16px; margin-bottom: 20px;">
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Boxes Packed</label>
          <div style="display: flex; gap: 10px; align-items: center;">
            <button onclick="mpUpdateInventory('boxes', -1)" style="padding: 8px 12px; background: var(--glass); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer;">-</button>
            <input id="mp-inv-boxes" type="number" value="${mp.inventory.boxes}" 
                   style="flex: 1; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text); text-align: center;" />
            <button onclick="mpUpdateInventory('boxes', 1)" style="padding: 8px 12px; background: var(--glass); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer;">+</button>
          </div>
        </div>
        
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Fragile Items Count</label>
          <input id="mp-inv-fragile" type="number" value="${mp.inventory.fragile}" 
                 style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
        </div>
        
        <div>
          <label style="display: block; font-size: 12px; color: var(--accent); margin-bottom: 6px;">Room-by-Room Inventory</label>
          <div id="mp-inv-rooms" style="max-height: 200px; overflow-y: auto; padding-right: 8px;">
            ${Object.entries(mp.inventory.rooms).map(([room, count]) => `
              <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid var(--border);">
                <span style="color: var(--text);">${escapeHtml(room)}</span>
                <span style="color: var(--accent); font-weight: 600;">${count} boxes</span>
              </div>
            `).join('')}
            ${Object.keys(mp.inventory.rooms).length === 0 ? 
              '<div style="color: var(--muted); font-style: italic; text-align: center; padding: 20px;">No rooms added</div>' : ''}
          </div>
          
          <div style="display: flex; gap: 8px; margin-top: 12px;">
            <input id="mp-new-room" type="text" placeholder="Room name" 
                   style="flex: 1; padding: 8px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
            <input id="mp-room-boxes" type="number" placeholder="Boxes" min="0" 
                   style="width: 80px; padding: 8px; border-radius: 6px; border: 1px solid var(--border); background: var(--glass); color: var(--text);" />
            <button onclick="mpAddRoom()" style="padding: 8px 12px; background: var(--accent); border: none; border-radius: 6px; color: #000; cursor: pointer; font-weight: 600;">Add</button>
          </div>
        </div>
      </div>
      
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                style="padding: 10px 20px; background: var(--glass); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer;">
          Cancel
        </button>
        <button onclick="mpSaveInventory()" 
                style="padding: 10px 20px; background: var(--accent); border: none; border-radius: 6px; color: #000; cursor: pointer; font-weight: 600;">
          Save Inventory
        </button>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function mpUpdateInventory(type, change) {
  const input = document.getElementById(`mp-inv-${type}`);
  if (input) {
    let value = parseInt(input.value) || 0;
    value = Math.max(0, value + change);
    input.value = value;
  }
}

function mpAddRoom() {
  const nameInput = document.getElementById('mp-new-room');
  const boxesInput = document.getElementById('mp-room-boxes');
  
  const name = nameInput.value.trim();
  const boxes = parseInt(boxesInput.value) || 0;
  
  if (!name) {
    showNotification('Please enter a room name', 'warning');
    return;
  }
  
  mp.inventory.rooms[name] = (mp.inventory.rooms[name] || 0) + boxes;
  
  // Update display
  mpOpenInventory(); // Refresh modal
  updateInventorySummary();
  
  nameInput.value = '';
  boxesInput.value = '';
}

function mpSaveInventory() {
  const boxesInput = document.getElementById('mp-inv-boxes');
  const fragileInput = document.getElementById('mp-inv-fragile');
  
  mp.inventory.boxes = parseInt(boxesInput.value) || 0;
  mp.inventory.fragile = parseInt(fragileInput.value) || 0;
  
  // Close modal
  document.querySelector('[style*="position: fixed"]').remove();
  
  // Update UI
  updateInventorySummary();
  mpSaveData();
  
  showNotification('Inventory saved!', 'success');
}

// ========== UTILITY FUNCTIONS ==========
function mpResetForm() {
  document.getElementById('mp-task').value = '';
  document.getElementById('mp-assigned').value = '';
  document.getElementById('mp-date').value = formatDate(new Date());
  document.getElementById('mp-cost').value = '';
  document.getElementById('mp-category').selectedIndex = 0;
  document.getElementById('mp-priority').selectedIndex = 1;
  document.getElementById('mp-task').focus();
}

function mpViewCalendar() {
  alert('Calendar view would show all tasks on a calendar. This feature requires additional implementation.');
}

function mpToggleTips() {
  const tips = document.getElementById('mp-tips-content');
  const btn = document.querySelector('button[onclick="mpToggleTips()"]');
  
  if (tips.style.display === 'none') {
    tips.style.display = 'grid';
    btn.textContent = 'Hide';
  } else {
    tips.style.display = 'none';
    btn.textContent = 'Show';
  }
}

function mpResetAll() {
  if (confirm('Are you sure you want to reset everything? This cannot be undone.')) {
    mp.tasks = [];
    mp.team = [];
    mp.budget = { estimated: 0, spent: 0, expenses: [] };
    mp.inventory = { boxes: 0, fragile: 0, rooms: {} };
    mp.selectedTasks.clear();
    
    document.getElementById('mp-moving-from').value = '';
    document.getElementById('mp-moving-to').value = '';
    
    const moveDate = new Date();
    moveDate.setDate(moveDate.getDate() + 30);
    document.getElementById('mp-move-date').value = formatDate(moveDate);
    
    mpUpdateUI();
    updateTeamList();
    mpSaveData();
    
    showNotification('All data reset', 'info');
    announceToScreenReader('Moving plan reset to default');
  }
}

// ========== DATA PERSISTENCE ==========
function mpSaveData() {
  const data = {
    tasks: mp.tasks,
    team: mp.team,
    budget: mp.budget,
    settings: {
      moveDate: document.getElementById('mp-move-date').value,
      fromAddress: document.getElementById('mp-moving-from').value,
      toAddress: document.getElementById('mp-moving-to').value
    },
    inventory: mp.inventory,
    version: '2.0',
    lastUpdated: new Date().toISOString()
  };
  
  localStorage.setItem('movingPlannerData', JSON.stringify(data));
}

function mpLoadData() {
  try {
    const saved = localStorage.getItem('movingPlannerData');
    if (saved) {
      const data = JSON.parse(saved);
      
      mp.tasks = data.tasks || [];
      mp.team = data.team || [];
      mp.budget = data.budget || { estimated: 0, spent: 0, expenses: [] };
      mp.inventory = data.inventory || { boxes: 0, fragile: 0, rooms: {} };
      
      // Load settings
      if (data.settings) {
        document.getElementById('mp-move-date').value = data.settings.moveDate || '';
        document.getElementById('mp-moving-from').value = data.settings.fromAddress || '';
        document.getElementById('mp-moving-to').value = data.settings.toAddress || '';
      }
      
      console.log('Moving planner data loaded:', mp.tasks.length, 'tasks');
    }
  } catch (error) {
    console.error('Failed to load moving planner data:', error);
    // Start fresh
    mp.tasks = [];
    mp.team = [];
    mp.budget = { estimated: 0, spent: 0, expenses: [] };
    mp.inventory = { boxes: 0, fragile: 0, rooms: {} };
  }
}

// ========== HELPER FUNCTIONS ==========
function formatDate(date) {
  if (!date) return '';
  const d = new Date(date);
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, '0');
  const day = String(d.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

function formatDateDisplay(dateStr) {
  if (!dateStr) return '';
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { 
    month: 'short', 
    day: 'numeric', 
    year: 'numeric' 
  });
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

function arrayToCSV(data) {
  if (data.length === 0) return '';
  
  const headers = Object.keys(data[0]);
  const rows = data.map(row => 
    headers.map(header => {
      const value = row[header];
      if (typeof value === 'string' && (value.includes(',') || value.includes('\n') || value.includes('"'))) {
        return `"${value.replace(/"/g, '""')}"`;
      }
      return value;
    }).join(',')
  );
  
  return [headers.join(','), ...rows].join('\n');
}

function downloadCSV(content, filename) {
  const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = filename;
  link.click();
  URL.revokeObjectURL(url);
}

function showNotification(message, type = 'info') {
  // Remove existing notifications
  document.querySelectorAll('.mp-notification').forEach(el => el.remove());
  
  const notification = document.createElement('div');
  notification.className = 'mp-notification';
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 12px 16px;
    border-radius: 8px;
    background: ${type === 'error' ? '#ff2d55' : type === 'warning' ? '#ff9500' : type === 'success' ? '#39ff14' : 'var(--accent)'};
    color: #000;
    font-weight: 600;
    z-index: 10001;
    animation: slideIn 0.3s ease;
    max-width: 300px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  `;
  
  notification.textContent = message;
  document.body.appendChild(notification);
  
  // Auto-remove after 3 seconds
  setTimeout(() => {
    notification.style.animation = 'slideOut 0.3s ease';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

function announceToScreenReader(message) {
  const liveRegion = document.getElementById('mp-screen-reader') || (() => {
    const region = document.createElement('div');
    region.id = 'mp-screen-reader';
    region.setAttribute('aria-live', 'polite');
    region.setAttribute('aria-atomic', 'true');
    region.style.cssText = 'position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;';
    document.body.appendChild(region);
    return region;
  })();
  
  liveRegion.textContent = message;
  setTimeout(() => { liveRegion.textContent = ''; }, 1000);
}

// ========== GLOBAL EXPORTS ==========
window.mpAddTask = mpAddTask;
window.mpAddMultiple = mpAddMultiple;
window.mpResetForm = mpResetForm;
window.mpToggleTask = mpToggleTask;
window.mpDeleteTask = mpDeleteTask;
window.mpEditTask = mpEditTask;
window.mpFilter = mpFilter;
window.mpToggleSelect = mpToggleSelect;
window.mpBulkComplete = mpBulkComplete;
window.mpBulkDelete = mpBulkDelete;
window.mpClearBulk = mpClearBulk;
window.mpShowTemplates = mpShowTemplates;
window.mpQuickTask = mpQuickTask;
window.mpExportTasks = mpExportTasks;
window.mpExportPDF = mpExportPDF;
window.mpExportCSV = mpExportCSV;
window.mpBackupData = mpBackupData;
window.mpImportData = mpImportData;
window.mpPrintPlan = mpPrintPlan;
window.mpSharePlan = mpSharePlan;
window.mpAddExpense = mpAddExpense;
window.mpOpenInventory = mpOpenInventory;
window.mpUpdateInventory = mpUpdateInventory;
window.mpAddRoom = mpAddRoom;
window.mpSaveInventory = mpSaveInventory;
window.mpViewCalendar = mpViewCalendar;
window.mpToggleTips = mpToggleTips;
window.mpAddTeamMember = mpAddTeamMember;
window.mpRemoveTeamMember = mpRemoveTeamMember;
window.mpResetAll = mpResetAll;

// Add CSS animations
const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }
  
  @keyframes slideOut {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
  }
  
  .task-item:hover {
    background: rgba(255,255,255,0.05) !important;
    transform: translateY(-1px);
  }
  
  #mp-task-list::-webkit-scrollbar {
    width: 6px;
  }
  
  #mp-task-list::-webkit-scrollbar-track {
    background: var(--glass);
    border-radius: 3px;
  }
  
  #mp-task-list::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 3px;
  }
  
  @media (max-width: 768px) {
    .dashboard .card {
      grid-template-columns: 1fr;
    }
    
    .row {
      grid-template-columns: 1fr !important;
    }
  }
`;
document.head.appendChild(style);

console.log('Ultimate Moving Planner loaded successfully!');
</script>
