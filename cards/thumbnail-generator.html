<h2 id="thumbnail-generator-title" style="margin-top:0;color:var(--accent);">üñºÔ∏è Universal Thumbnail Generator</h2>

<form aria-describedby="thumbnail-generator-desc" style="margin-bottom:20px;">
    <p id="thumbnail-generator-desc" class="small" style="margin-bottom:20px;color:rgba(var(--text-rgb, 230,250,255),0.9);">
        Generate perfectly sized thumbnails for any platform with advanced editing tools.
        <span style="color:var(--accent);">No upload required - all processing happens locally.</span>
    </p>
    
    <!-- UPLOAD SECTION -->
    <div class="field" style="margin-bottom:24px;">
        <label style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
            Upload or Capture Image
        </label>
        
        <!-- DRAG & DROP AREA -->
        <div id="thumb-dropzone" 
             style="border:2px dashed rgba(var(--accent-rgb, 45,212,255),0.4);border-radius:12px;padding:40px 20px;text-align:center;background:rgba(var(--accent-rgb, 45,212,255),0.05);cursor:pointer;margin-bottom:16px;transition:all 0.3s ease;">
            <div style="font-size:48px;color:rgba(var(--accent-rgb, 45,212,255),0.6);margin-bottom:12px;">üìÅ</div>
            <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Drop image here or click to upload</div>
            <div style="color:rgba(var(--text-rgb, 230,250,255),0.7);font-size:14px;">Supports JPG, PNG, GIF, WebP (Max 10MB)</div>
        </div>
        
        <!-- FILE INPUT & CAMERA -->
        <div style="display:flex;gap:12px;margin-top:12px;">
            <div style="flex:1;">
                <input id="thumbgen-file" type="file" accept="image/*" 
                       style="width:100%;padding:12px;border-radius:10px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.3);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;font-size:14px;display:none;" />
                <button type="button" onclick="thumbShowFileDialog()"
                        style="width:100%;padding:12px;border-radius:10px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.3);background:rgba(var(--accent-rgb, 45,212,255),0.1);color:var(--accent);cursor:pointer;font-weight:500;">
                    üìÅ Choose File
                </button>
            </div>
            <button type="button" onclick="thumbCaptureFromCamera()"
                    style="padding:12px 24px;border-radius:10px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.1);color:#39ff14;cursor:pointer;font-weight:500;">
                üì∏ Use Camera
            </button>
        </div>
        
        <!-- IMAGE PREVIEW -->
        <div id="thumb-preview-container" style="display:none;margin-top:20px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                <h4 style="margin:0;color:var(--accent);font-size:14px;font-weight:600;">Image Preview</h4>
                <button type="button" onclick="thumbClearImage()"
                        style="padding:6px 12px;border-radius:6px;border:1px solid rgba(255,77,77,0.3);background:rgba(255,77,77,0.1);color:#ff4d4d;cursor:pointer;font-size:12px;">
                    Clear Image
                </button>
            </div>
            <div id="thumb-preview" style="max-width:100%;max-height:200px;border-radius:8px;overflow:hidden;border:2px solid rgba(var(--accent-rgb, 45,212,255),0.2);"></div>
            <div id="thumb-file-info" style="color:rgba(var(--text-rgb, 230,250,255),0.7);font-size:12px;margin-top:8px;"></div>
        </div>
    </div>
    
    <!-- PLATFORM SELECTION -->
    <div class="field" style="margin-bottom:24px;">
        <label for="thumbgen-service" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
            Platform & Size
        </label>
        
        <!-- QUICK PLATFORM BUTTONS -->
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;">
            <button type="button" onclick="thumbSetPlatform('youtube-standard')" 
                    style="padding:8px 12px;border-radius:6px;border:1px solid rgba(255,77,77,0.3);background:rgba(255,77,77,0.1);color:#ff4d4d;cursor:pointer;font-size:12px;">
                YouTube
            </button>
            <button type="button" onclick="thumbSetPlatform('instagram-post')" 
                    style="padding:8px 12px;border-radius:6px;border:1px solid rgba(255,77,255,0.3);background:rgba(255,77,255,0.1);color:#ff4dff;cursor:pointer;font-size:12px;">
                Instagram
            </button>
            <button type="button" onclick="thumbSetPlatform('twitter-header')" 
                    style="padding:8px 12px;border-radius:6px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.1);color:var(--accent);cursor:pointer;font-size:12px;">
                Twitter/X
            </button>
            <button type="button" onclick="thumbSetPlatform('facebook-cover')" 
                    style="padding:8px 12px;border-radius:6px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.1);color:#39ff14;cursor:pointer;font-size:12px;">
                Facebook
            </button>
            <button type="button" onclick="thumbSetPlatform('tiktok')" 
                    style="padding:8px 12px;border-radius:6px;border:1px solid rgba(255,204,0,0.3);background:rgba(255,204,0,0.1);color:#ffcc00;cursor:pointer;font-size:12px;">
                TikTok
            </button>
        </div>
        
        <!-- PLATFORM SELECT -->
        <select id="thumbgen-service" 
                style="width:100%;padding:12px;border-radius:10px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.3);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;font-size:15px;">
            <option value="youtube-standard" selected>üé• YouTube Standard (1280√ó720)</option>
            <option value="youtube-small">üé• YouTube Small (640√ó360)</option>
            <option value="youtube-channel">üé• YouTube Channel Art (2560√ó1440)</option>
            <option value="youtube-profile">üé• YouTube Profile (800√ó800)</option>
            <option value="twitch-banner">üéÆ Twitch Banner (1200√ó480)</option>
            <option value="twitch-profile">üéÆ Twitch Profile (800√ó800)</option>
            <option value="tiktok">üì± TikTok/Shorts Vertical (1080√ó1920)</option>
            <option value="instagram-post">üì∏ Instagram Post (1080√ó1080)</option>
            <option value="instagram-story">üì∏ Instagram Story (1080√ó1920)</option>
            <option value="facebook-cover">üìò Facebook Cover (820√ó312)</option>
            <option value="twitter-header">üê¶ Twitter/X Header (1500√ó500)</option>
            <option value="twitter-profile">üê¶ Twitter/X Profile (400√ó400)</option>
            <option value="linkedin-banner">üíº LinkedIn Banner (1584√ó396)</option>
            <option value="linkedin-profile">üíº LinkedIn Profile (400√ó400)</option>
            <option value="custom">üîß Custom Size</option>
        </select>
        
        <!-- CUSTOM SIZE INPUTS -->
        <div id="thumb-custom-size" style="display:none;margin-top:12px;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
                <div>
                    <label for="thumb-custom-width" style="display:block;margin-bottom:6px;color:var(--accent);font-size:13px;">
                        Width (px)
                    </label>
                    <input id="thumb-custom-width" type="number" min="10" max="10000" value="500" step="1"
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.2);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;" />
                </div>
                <div>
                    <label for="thumb-custom-height" style="display:block;margin-bottom:6px;color:var(--accent);font-size:13px;">
                        Height (px)
                    </label>
                    <input id="thumb-custom-height" type="number" min="10" max="10000" value="500" step="1"
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.2);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;" />
                </div>
            </div>
        </div>
        
        <!-- SIZE DISPLAY -->
        <div id="thumb-size-display" style="color:var(--accent);font-weight:600;margin-top:8px;font-size:14px;">
            Selected: 1280√ó720 pixels (16:9)
        </div>
    </div>
    
    <!-- EDITING OPTIONS -->
    <div style="background:rgba(0,0,0,0.15);border-radius:12px;padding:16px;margin-bottom:20px;border:1px solid rgba(255,255,255,0.05);">
        <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;font-size:14px;font-weight:600;">‚öôÔ∏è Editing Options</h4>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
            <div>
                <label for="thumb-quality" style="display:block;margin-bottom:6px;color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:13px;">
                    Quality
                </label>
                <div style="display:flex;align-items:center;gap:8px;">
                    <input id="thumb-quality" type="range" min="0.1" max="1" value="0.92" step="0.01"
                           style="flex:1;height:6px;" />
                    <span id="thumb-quality-value" style="color:var(--accent);font-weight:600;min-width:40px;">92%</span>
                </div>
            </div>
            
            <div>
                <label for="thumb-format" style="display:block;margin-bottom:6px;color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:13px;">
                    Format
                </label>
                <select id="thumb-format" 
                        style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.2);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;font-size:14px;">
                    <option value="jpeg">JPEG (.jpg)</option>
                    <option value="png">PNG (.png)</option>
                    <option value="webp">WebP (.webp)</option>
                </select>
            </div>
            
            <div>
                <label for="thumb-crop-mode" style="display:block;margin-bottom:6px;color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:13px;">
                    Crop Mode
                </label>
                <select id="thumb-crop-mode" 
                        style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.2);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;font-size:14px;">
                    <option value="cover" selected>Cover (Fill entire area)</option>
                    <option value="contain">Contain (Fit within area)</option>
                    <option value="stretch">Stretch (Force fit)</option>
                </select>
            </div>
            
            <div>
                <label for="thumb-add-text" style="display:block;margin-bottom:6px;color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:13px;">
                    Add Text Overlay
                </label>
                <input id="thumb-add-text" type="text" placeholder="Optional text overlay"
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.2);background:rgba(var(--accent-rgb, 45,212,255),0.05);color:inherit;font-size:14px;" />
            </div>
        </div>
    </div>
    
    <!-- ACTION BUTTONS -->
    <div class="actions" style="margin-top:24px;display:flex;gap:10px;">
        <button type="button" onclick="thumbGenerate(this)" 
                style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(255,77,255,0.2), rgba(255,77,255,0.1));border:1px solid rgba(255,77,255,0.4);border-radius:10px;color:#ff4dff;cursor:pointer;font-weight:600;font-size:15px;">
            üñºÔ∏è Generate Thumbnail
        </button>
        <button type="button" onclick="thumbResetAll(this)"
                style="padding:14px 20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:inherit;cursor:pointer;">
            Reset All
        </button>
    </div>
</form>

<!-- RESULTS SECTION -->
<div class="results" aria-live="polite" style="margin-top:20px;">
    <h3 class="small" style="color:var(--accent);margin-bottom:16px;font-weight:600;">üìä Generated Thumbnail</h3>
    
    <!-- THUMBNAIL DISPLAY -->
    <div id="thumb-main-result" style="background:linear-gradient(135deg, rgba(255,77,255,0.1), rgba(255,77,255,0.05));border:2px solid rgba(255,77,255,0.3);border-radius:12px;padding:20px;margin-bottom:20px;text-align:center;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
            <h4 style="margin:0;color:#ff4dff;font-size:14px;font-weight:600;">Preview</h4>
            <div id="thumb-generated-size" style="color:rgba(255,255,255,0.7);font-size:12px;">--</div>
        </div>
        
        <div id="thumbgen-output" style="min-height:200px;display:flex;align-items:center;justify-content:center;">
            <div style="color:rgba(255,255,255,0.3);font-size:14px;">
                Upload an image and generate a thumbnail
            </div>
        </div>
    </div>
    
    <!-- DOWNLOAD & SHARE OPTIONS -->
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px;">
        <button id="thumb-download-btn" onclick="thumbDownload()" disabled
                style="padding:12px;border-radius:10px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.1);color:#39ff14;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;">
            üíæ Download
        </button>
        <button id="thumb-copy-btn" onclick="thumbCopyToClipboard()" disabled
                style="padding:12px;border-radius:10px;border:1px solid rgba(var(--accent-rgb, 45,212,255),0.3);background:rgba(var(--accent-rgb, 45,212,255),0.1);color:var(--accent);cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;">
            üìã Copy Image
        </button>
        <button id="thumb-share-btn" onclick="thumbShare()" disabled
                style="padding:12px;border-radius:10px;border:1px solid rgba(255,204,0,0.3);background:rgba(255,204,0,0.1);color:#ffcc00;cursor:pointer;font-weight:500;display:flex;align-items:center;justify-content:center;gap:8px;">
            üì§ Share
        </button>
    </div>
    
    <!-- THUMBNAIL INFO -->
    <div style="background:rgba(0,0,0,0.2);border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(255,255,255,0.05);">
        <h4 style="color:var(--accent);margin:0 0 12px 0;font-size:14px;font-weight:600;">‚ÑπÔ∏è Thumbnail Information</h4>
        <div id="thumb-info" style="color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:14px;line-height:1.5;">
            No thumbnail generated yet. Upload an image and select a platform to get started.
        </div>
    </div>
</div>

<!-- SOCIAL MEDIA SIZE GUIDE -->
<details style="margin-top:20px;border:1px solid rgba(255,255,255,0.1);border-radius:10px;padding:12px;background:rgba(0,0,0,0.15);">
    <summary style="color:var(--accent);font-weight:600;cursor:pointer;outline:none;user-select:none;">üì± Social Media Size Guide</summary>
    <div style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.05);">
        
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:16px;">
            <div>
                <div style="color:#ff4d4d;font-weight:600;margin-bottom:4px;">YouTube</div>
                <div style="color:rgba(var(--text-rgb, 230,250,255),0.8);font-size:13px;line-height:1.5;">
                    ‚Ä¢ <strong>Standard:</strong> 1280√ó720 (16:9)<br>
                    ‚Ä¢ <strong>Channel Art:</strong> 2560√ó1440 (16:9)<br>
                    ‚Ä¢ <strong>Profile:</strong> 800√ó800 (1:1)<br>
                    ‚Ä¢ <strong>Small:</strong> 640√ó360 (16:9)
                </div>
            </div>
            <div>
                <div style="color:#ff4dff;font-weight:600;margin-bottom:4px;">Instagram</div>
                <div style="color:rgba(var(--text-rgb, 230,250,255),0.8);font-size:13px;line-height:1.5;">
                    ‚Ä¢ <strong>Post:</strong> 1080√ó1080 (1:1)<br>
                    ‚Ä¢ <strong>Story:</strong> 1080√ó1920 (9:16)<br>
                    ‚Ä¢ <strong>Reels:</strong> 1080√ó1920 (9:16)<br>
                    ‚Ä¢ <strong>Profile:</strong> 320√ó320 (1:1)
                </div>
            </div>
            <div>
                <div style="color:#2dd4ff;font-weight:600;margin-bottom:4px;">Twitter/X</div>
                <div style="color:rgba(var(--text-rgb, 230,250,255),0.8);font-size:13px;line-height:1.5;">
                    ‚Ä¢ <strong>Header:</strong> 1500√ó500 (3:1)<br>
                    ‚Ä¢ <strong>Profile:</strong> 400√ó400 (1:1)<br>
                    ‚Ä¢ <strong>Card Image:</strong> 1200√ó628 (‚âà1.91:1)<br>
                    ‚Ä¢ <strong>Tweet Image:</strong> 1200√ó675 (16:9)
                </div>
            </div>
            <div>
                <div style="color:#39ff14;font-weight:600;margin-bottom:4px;">Other Platforms</div>
                <div style="color:rgba(var(--text-rgb, 230,250,255),0.8);font-size:13px;line-height:1.5;">
                    ‚Ä¢ <strong>Facebook Cover:</strong> 820√ó312 (‚âà2.63:1)<br>
                    ‚Ä¢ <strong>TikTok:</strong> 1080√ó1920 (9:16)<br>
                    ‚Ä¢ <strong>Twitch Banner:</strong> 1200√ó480 (2.5:1)<br>
                    ‚Ä¢ <strong>LinkedIn Banner:</strong> 1584√ó396 (4:1)
                </div>
            </div>
        </div>
        
        <div style="background:rgba(var(--accent-rgb, 45,212,255),0.05);border-radius:8px;padding:12px;border-left:3px solid var(--accent);">
            <strong style="color:var(--accent);">Best Practices:</strong><br>
            <span style="color:rgba(var(--text-rgb, 230,250,255),0.9);font-size:13px;">
                ‚Ä¢ <strong>File Size:</strong> Keep under 5MB for web performance<br>
                ‚Ä¢ <strong>Resolution:</strong> Use 72 DPI for web, 300 DPI for print<br>
                ‚Ä¢ <strong>Format:</strong> JPEG for photos, PNG for graphics with transparency<br>
                ‚Ä¢ <strong>Colors:</strong> Use sRGB color space for consistent web display<br>
                ‚Ä¢ <strong>Aspect Ratio:</strong> Always maintain the recommended ratio
            </span>
        </div>
        
        <p style="color:rgba(var(--text-rgb, 230,250,255),0.7);font-size:13px;line-height:1.5;margin-top:12px;">
            <span style="color:#ffcc00;">üí° Pro Tip:</span> All image processing happens locally in your browser. 
            Your images are never uploaded to any server, ensuring complete privacy and security. 
            This tool uses HTML5 Canvas for processing, which works entirely offline.
        </p>
    </div>
</details>

<!-- SCRIPT -->
<script>
/* thumbnail-generator.html - Universal Thumbnail Generator
   - Prefix: thumb
   - Generates thumbnails for social media platforms
   - All processing happens locally (no uploads)
   - Includes editing tools and multiple export options
*/

// Size mapping with aspect ratios
const THUMB_SIZE_MAP = {
    "youtube-standard": { w: 1280, h: 720, ratio: "16:9", name: "YouTube Standard" },
    "youtube-small": { w: 640, h: 360, ratio: "16:9", name: "YouTube Small" },
    "youtube-channel": { w: 2560, h: 1440, ratio: "16:9", name: "YouTube Channel Art" },
    "youtube-profile": { w: 800, h: 800, ratio: "1:1", name: "YouTube Profile" },
    "twitch-banner": { w: 1200, h: 480, ratio: "2.5:1", name: "Twitch Banner" },
    "twitch-profile": { w: 800, h: 800, ratio: "1:1", name: "Twitch Profile" },
    "tiktok": { w: 1080, h: 1920, ratio: "9:16", name: "TikTok/Shorts" },
    "instagram-post": { w: 1080, h: 1080, ratio: "1:1", name: "Instagram Post" },
    "instagram-story": { w: 1080, h: 1920, ratio: "9:16", name: "Instagram Story" },
    "facebook-cover": { w: 820, h: 312, ratio: "2.63:1", name: "Facebook Cover" },
    "twitter-header": { w: 1500, h: 500, ratio: "3:1", name: "Twitter/X Header" },
    "twitter-profile": { w: 400, h: 400, ratio: "1:1", name: "Twitter/X Profile" },
    "linkedin-banner": { w: 1584, h: 396, ratio: "4:1", name: "LinkedIn Banner" },
    "linkedin-profile": { w: 400, h: 400, ratio: "1:1", name: "LinkedIn Profile" },
    "custom": { w: 500, h: 500, ratio: "Custom", name: "Custom Size" }
};

let thumbOriginalImage = null;
let thumbGeneratedDataUrl = null;
let thumbFileName = "thumbnail";

// Initialize drag & drop
function thumbInitDragDrop() {
    const card = document.currentScript?.closest('.card') || document;
    const dropzone = card.querySelector('#thumb-dropzone');
    const fileInput = card.querySelector('#thumbgen-file');
    
    if (!dropzone || !fileInput) return;
    
    // Click to upload
    dropzone.addEventListener('click', () => {
        fileInput.click();
    });
    
    // Drag over
    dropzone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.style.borderColor = 'var(--accent)';
        dropzone.style.background = 'rgba(var(--accent-rgb, 45,212,255),0.1)';
    });
    
    // Drag leave
    dropzone.addEventListener('dragleave', () => {
        dropzone.style.borderColor = 'rgba(var(--accent-rgb, 45,212,255),0.4)';
        dropzone.style.background = 'rgba(var(--accent-rgb, 45,212,255),0.05)';
    });
    
    // Drop
    dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropzone.style.borderColor = 'rgba(var(--accent-rgb, 45,212,255),0.4)';
        dropzone.style.background = 'rgba(var(--accent-rgb, 45,212,255),0.05)';
        
        if (e.dataTransfer.files.length > 0) {
            const file = e.dataTransfer.files[0];
            if (file.type.startsWith('image/')) {
                thumbLoadImage(file);
            } else {
                alert('Please drop an image file (JPG, PNG, GIF, WebP)');
            }
        }
    });
}

// Show file dialog
function thumbShowFileDialog() {
    const card = document.currentScript?.closest('.card') || document;
    const fileInput = card.querySelector('#thumbgen-file');
    fileInput.click();
}

// Handle file input change
function thumbHandleFileSelect(event) {
    const file = event.target.files[0];
    if (file) {
        thumbLoadImage(file);
    }
}

// Load image from file
function thumbLoadImage(file) {
    if (!file.type.startsWith('image/')) {
        alert('Please select an image file (JPG, PNG, GIF, WebP)');
        return;
    }
    
    if (file.size > 10 * 1024 * 1024) { // 10MB limit
        alert('Image size must be less than 10MB');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        thumbOriginalImage = new Image();
        thumbOriginalImage.onload = function() {
            thumbShowPreview(thumbOriginalImage, file);
        };
        thumbOriginalImage.src = e.target.result;
        
        // Store filename without extension
        thumbFileName = file.name.replace(/\.[^/.]+$/, "");
    };
    reader.readAsDataURL(file);
}

// Show image preview
function thumbShowPreview(image, file) {
    const card = document.currentScript?.closest('.card') || document;
    const previewContainer = card.querySelector('#thumb-preview-container');
    const preview = card.querySelector('#thumb-preview');
    const fileInfo = card.querySelector('#thumb-file-info');
    
    // Clear previous preview
    preview.innerHTML = '';
    
    // Create preview image
    const previewImg = document.createElement('img');
    previewImg.src = image.src;
    previewImg.style.maxWidth = '100%';
    previewImg.style.maxHeight = '200px';
    previewImg.style.objectFit = 'contain';
    preview.appendChild(previewImg);
    
    // Show file info
    const fileSize = (file.size / 1024).toFixed(1);
    fileInfo.textContent = `${file.name} ‚Ä¢ ${image.width}√ó${image.height} ‚Ä¢ ${fileSize}KB`;
    
    // Show container
    previewContainer.style.display = 'block';
    
    console.log(`Image loaded: ${image.width}√ó${image.height}, ${fileSize}KB`);
}

// Clear image
function thumbClearImage() {
    const card = document.currentScript?.closest('.card') || document;
    const previewContainer = card.querySelector('#thumb-preview-container');
    const fileInput = card.querySelector('#thumbgen-file');
    const dropzone = card.querySelector('#thumb-dropzone');
    
    thumbOriginalImage = null;
    previewContainer.style.display = 'none';
    fileInput.value = '';
    
    // Reset dropzone
    dropzone.style.borderColor = 'rgba(var(--accent-rgb, 45,212,255),0.4)';
    dropzone.style.background = 'rgba(var(--accent-rgb, 45,212,255),0.05)';
    
    // Clear generated thumbnail
    const output = card.querySelector('#thumbgen-output');
    output.innerHTML = '<div style="color:rgba(255,255,255,0.3);font-size:14px;">Upload an image and generate a thumbnail</div>';
    
    // Disable download buttons
    thumbSetDownloadButtons(false);
    
    console.log('Image cleared');
}

// Capture from camera
function thumbCaptureFromCamera() {
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        alert('Camera access is not supported in your browser');
        return;
    }
    
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(function(stream) {
            const video = document.createElement('video');
            video.srcObject = stream;
            video.play();
            
            // Create canvas for capture
            setTimeout(() => {
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0);
                
                // Convert to image
                thumbOriginalImage = new Image();
                thumbOriginalImage.onload = function() {
                    thumbShowPreview(thumbOriginalImage, {
                        name: 'camera-capture.jpg',
                        size: canvas.toDataURL('image/jpeg').length
                    });
                };
                thumbOriginalImage.src = canvas.toDataURL('image/jpeg');
                thumbFileName = 'camera-capture';
                
                // Stop camera
                stream.getTracks().forEach(track => track.stop());
            }, 100);
        })
        .catch(function(err) {
            console.error('Camera error:', err);
            alert('Unable to access camera. Please check permissions.');
        });
}

// Set platform
function thumbSetPlatform(platform) {
    const card = document.currentScript?.closest('.card') || document;
    const select = card.querySelector('#thumbgen-service');
    const customSizeDiv = card.querySelector('#thumb-custom-size');
    const sizeDisplay = card.querySelector('#thumb-size-display');
    
    select.value = platform;
    
    // Show/hide custom size inputs
    if (platform === 'custom') {
        customSizeDiv.style.display = 'block';
        const width = card.querySelector('#thumb-custom-width').value;
        const height = card.querySelector('#thumb-custom-height').value;
        sizeDisplay.textContent = `Selected: ${width}√ó${height} pixels (Custom)`;
    } else {
        customSizeDiv.style.display = 'none';
        const size = THUMB_SIZE_MAP[platform];
        sizeDisplay.textContent = `Selected: ${size.w}√ó${size.h} pixels (${size.ratio})`;
    }
    
    console.log(`Platform set to: ${platform}`);
}

// Update quality display
function thumbUpdateQualityDisplay() {
    const card = document.currentScript?.closest('.card') || document;
    const qualityInput = card.querySelector('#thumb-quality');
    const qualityValue = card.querySelector('#thumb-quality-value');
    
    if (qualityInput && qualityValue) {
        const value = Math.round(qualityInput.value * 100);
        qualityValue.textContent = value + '%';
    }
}

// Get selected size
function thumbGetSelectedSize() {
    const card = document.currentScript?.closest('.card') || document;
    const platform = card.querySelector('#thumbgen-service').value;
    
    if (platform === 'custom') {
        const width = parseInt(card.querySelector('#thumb-custom-width').value) || 500;
        const height = parseInt(card.querySelector('#thumb-custom-height').value) || 500;
        return { w: width, h: height, ratio: 'Custom', name: 'Custom Size' };
    }
    
    return THUMB_SIZE_MAP[platform] || THUMB_SIZE_MAP['youtube-standard'];
}

// Calculate crop coordinates
function thumbCalculateCrop(sourceWidth, sourceHeight, targetWidth, targetHeight, mode) {
    const sourceRatio = sourceWidth / sourceHeight;
    const targetRatio = targetWidth / targetHeight;
    
    let sx = 0, sy = 0, sWidth = sourceWidth, sHeight = sourceHeight;
    
    if (mode === 'cover') {
        // Cover: Crop to fill (maintain aspect ratio)
        if (sourceRatio > targetRatio) {
            // Source is wider, crop horizontally
            sWidth = sourceHeight * targetRatio;
            sx = (sourceWidth - sWidth) / 2;
        } else {
            // Source is taller, crop vertically
            sHeight = sourceWidth / targetRatio;
            sy = (sourceHeight - sHeight) / 2;
        }
    } else if (mode === 'contain') {
        // Contain: Fit within (add padding)
        if (sourceRatio > targetRatio) {
            // Source is wider, letterbox top/bottom
            sHeight = sourceWidth / targetRatio;
            sy = (sourceHeight - sHeight) / 2;
        } else {
            // Source is taller, letterbox left/right
            sWidth = sourceHeight * targetRatio;
            sx = (sourceWidth - sWidth) / 2;
        }
    }
    // For 'stretch': Use entire source image
    
    return { sx, sy, sWidth, sHeight };
}

// Generate thumbnail
function thumbGenerate(btn) {
    if (!thumbOriginalImage) {
        alert('Please upload or capture an image first');
        return;
    }
    
    const card = btn.closest('.card') || document;
    const output = card.querySelector('#thumbgen-output');
    const generatedSize = card.querySelector('#thumb-generated-size');
    const info = card.querySelector('#thumb-info');
    
    try {
        // Get settings
        const size = thumbGetSelectedSize();
        const quality = parseFloat(card.querySelector('#thumb-quality').value);
        const format = card.querySelector('#thumb-format').value;
        const cropMode = card.querySelector('#thumb-crop-mode').value;
        const textOverlay = card.querySelector('#thumb-add-text').value.trim();
        
        // Create canvas
        const canvas = document.createElement('canvas');
        canvas.width = size.w;
        canvas.height = size.h;
        const ctx = canvas.getContext('2d');
        
        // Calculate crop
        const crop = thumbCalculateCrop(
            thumbOriginalImage.width,
            thumbOriginalImage.height,
            size.w,
            size.h,
            cropMode
        );
        
        // Draw background (for contain mode)
        if (cropMode === 'contain') {
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, size.w, size.h);
            
            // Calculate position to center the image
            const scale = Math.min(size.w / crop.sWidth, size.h / crop.sHeight);
            const x = (size.w - crop.sWidth * scale) / 2;
            const y = (size.h - crop.sHeight * scale) / 2;
            
            ctx.drawImage(
                thumbOriginalImage,
                crop.sx, crop.sy, crop.sWidth, crop.sHeight,
                x, y, crop.sWidth * scale, crop.sHeight * scale
            );
        } else {
            // Draw image (cover or stretch)
            ctx.drawImage(
                thumbOriginalImage,
                crop.sx, crop.sy, crop.sWidth, crop.sHeight,
                0, 0, size.w, size.h
            );
        }
        
        // Add text overlay if provided
        if (textOverlay) {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, size.h - 60, size.w, 60);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(textOverlay, size.w / 2, size.h - 25);
        }
        
        // Convert to data URL
        let mimeType = 'image/jpeg';
        if (format === 'png') mimeType = 'image/png';
        if (format === 'webp') mimeType = 'image/webp';
        
        thumbGeneratedDataUrl = canvas.toDataURL(mimeType, quality);
        
        // Display result
        output.innerHTML = '';
        const resultImg = document.createElement('img');
        resultImg.src = thumbGeneratedDataUrl;
        resultImg.style.maxWidth = '100%';
        resultImg.style.maxHeight = '400px';
        resultImg.style.objectFit = 'contain';
        resultImg.style.borderRadius = '8px';
        resultImg.style.boxShadow = '0 4px 20px rgba(0,0,0,0.3)';
        output.appendChild(resultImg);
        
        // Update info
        generatedSize.textContent = `${size.w}√ó${size.h}`;
        
        const fileSize = Math.round((thumbGeneratedDataUrl.length * 3) / 4 / 1024);
        info.innerHTML = `
            <strong>Thumbnail Details:</strong><br>
            ‚Ä¢ Size: ${size.w}√ó${size.h} pixels (${size.ratio})<br>
            ‚Ä¢ Format: ${format.toUpperCase()}<br>
            ‚Ä¢ Quality: ${Math.round(quality * 100)}%<br>
            ‚Ä¢ File Size: ~${fileSize} KB<br>
            ‚Ä¢ Crop Mode: ${cropMode}<br>
            ‚Ä¢ Platform: ${size.name}
        `;
        
        // Enable download buttons
        thumbSetDownloadButtons(true);
        
        // Visual feedback
        const mainResult = card.querySelector('#thumb-main-result');
        mainResult.style.animation = 'pulse 0.5s ease';
        setTimeout(() => {
            mainResult.style.animation = '';
        }, 500);
        
        console.log(`Thumbnail generated: ${size.w}√ó${size.h}, ${format}, ${quality} quality`);
        
    } catch (error) {
        console.error('Thumbnail generation error:', error);
        alert('Error generating thumbnail. Please try again with a different image.');
    }
}

// Set download buttons state
function thumbSetDownloadButtons(enabled) {
    const card = document.currentScript?.closest('.card') || document;
    const downloadBtn = card.querySelector('#thumb-download-btn');
    const copyBtn = card.querySelector('#thumb-copy-btn');
    const shareBtn = card.querySelector('#thumb-share-btn');
    
    if (enabled) {
        downloadBtn.disabled = false;
        downloadBtn.style.opacity = '1';
        downloadBtn.style.cursor = 'pointer';
        
        copyBtn.disabled = false;
        copyBtn.style.opacity = '1';
        copyBtn.style.cursor = 'pointer';
        
        shareBtn.disabled = false;
        shareBtn.style.opacity = '1';
        shareBtn.style.cursor = 'pointer';
    } else {
        downloadBtn.disabled = true;
        downloadBtn.style.opacity = '0.5';
        downloadBtn.style.cursor = 'not-allowed';
        
        copyBtn.disabled = true;
        copyBtn.style.opacity = '0.5';
        copyBtn.style.cursor = 'not-allowed';
        
        shareBtn.disabled = true;
        shareBtn.style.opacity = '0.5';
        shareBtn.style.cursor = 'not-allowed';
    }
}

// Download thumbnail
function thumbDownload() {
    if (!thumbGeneratedDataUrl) return;
    
    const card = document.currentScript?.closest('.card') || document;
    const format = card.querySelector('#thumb-format').value;
    const size = thumbGetSelectedSize();
    
    const extension = format === 'png' ? 'png' : format === 'webp' ? 'webp' : 'jpg';
    const filename = `${thumbFileName}_${size.w}x${size.h}.${extension}`;
    
    const link = document.createElement('a');
    link.href = thumbGeneratedDataUrl;
    link.download = filename;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    console.log(`Thumbnail downloaded: ${filename}`);
}

// Copy to clipboard
async function thumbCopyToClipboard() {
    if (!thumbGeneratedDataUrl) return;
    
    try {
        // Convert data URL to blob
        const response = await fetch(thumbGeneratedDataUrl);
        const blob = await response.blob();
        
        // Copy to clipboard
        await navigator.clipboard.write([
            new ClipboardItem({
                [blob.type]: blob
            })
        ]);
        
        // Visual feedback
        const card = document.currentScript?.closest('.card') || document;
        const copyBtn = card.querySelector('#thumb-copy-btn');
        const originalText = copyBtn.innerHTML;
        copyBtn.innerHTML = '‚úÖ Copied!';
        copyBtn.style.background = 'rgba(57,255,20,0.2)';
        copyBtn.style.borderColor = 'rgba(57,255,20,0.4)';
        copyBtn.style.color = '#39ff14';
        
        setTimeout(() => {
            copyBtn.innerHTML = originalText;
            copyBtn.style.background = 'rgba(var(--accent-rgb, 45,212,255),0.1)';
            copyBtn.style.borderColor = 'rgba(var(--accent-rgb, 45,212,255),0.3)';
            copyBtn.style.color = 'var(--accent)';
        }, 2000);
        
        console.log('Thumbnail copied to clipboard');
        
    } catch (error) {
        console.error('Copy to clipboard failed:', error);
        alert('Unable to copy image to clipboard. Please use the download option instead.');
    }
}

// Share thumbnail
async function thumbShare() {
    if (!thumbGeneratedDataUrl) return;
    
    try {
        // Convert data URL to blob
        const response = await fetch(thumbGeneratedDataUrl);
        const blob = await response.blob();
        
        // Create file for sharing
        const size = thumbGetSelectedSize();
        const format = document.querySelector('#thumb-format').value;
        const extension = format === 'png' ? 'png' : format === 'webp' ? 'webp' : 'jpg';
        const filename = `${thumbFileName}_${size.w}x${size.h}.${extension}`;
        
        const file = new File([blob], filename, { type: blob.type });
        
        // Check if Web Share API is available
        if (navigator.share && navigator.canShare({ files: [file] })) {
            await navigator.share({
                files: [file],
                title: 'Generated Thumbnail',
                text: `Thumbnail generated using The Most Useful Site in the World - ${size.w}√ó${size.h}`
            });
        } else {
            // Fallback: Open in new tab
            window.open(thumbGeneratedDataUrl, '_blank');
        }
        
    } catch (error) {
        console.error('Share failed:', error);
        // Fallback: Open in new tab
        window.open(thumbGeneratedDataUrl, '_blank');
    }
}

// Reset all
function thumbResetAll(btn) {
    if (confirm('Reset will clear all images and settings. Continue?')) {
        const card = btn.closest('.card') || document;
        
        // Clear image
        thumbClearImage();
        
        // Reset form
        card.querySelector('#thumbgen-service').value = 'youtube-standard';
        card.querySelector('#thumb-quality').value = 0.92;
        card.querySelector('#thumb-format').value = 'jpeg';
        card.querySelector('#thumb-crop-mode').value = 'cover';
        card.querySelector('#thumb-add-text').value = '';
        card.querySelector('#thumb-custom-width').value = 500;
        card.querySelector('#thumb-custom-height').value = 500;
        
        // Reset displays
        card.querySelector('#thumb-size-display').textContent = 'Selected: 1280√ó720 pixels (16:9)';
        card.querySelector('#thumb-custom-size').style.display = 'none';
        card.querySelector('#thumb-generated-size').textContent = '--';
        card.querySelector('#thumb-info').textContent = 'No thumbnail generated yet. Upload an image and select a platform to get started.';
        
        thumbGeneratedDataUrl = null;
        
        console.log('Thumbnail Generator reset');
    }
}

// Initialize on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.currentScript?.closest('.card') || document;
        
        // Initialize drag & drop
        thumbInitDragDrop();
        
        // Set up file input change
        const fileInput = card.querySelector('#thumbgen-file');
        if (fileInput) {
            fileInput.addEventListener('change', thumbHandleFileSelect);
        }
        
        // Set up platform change
        const platformSelect = card.querySelector('#thumbgen-service');
        if (platformSelect) {
            platformSelect.addEventListener('change', function() {
                thumbSetPlatform(this.value);
            });
        }
        
        // Set up quality slider
        const qualityInput = card.querySelector('#thumb-quality');
        if (qualityInput) {
            qualityInput.addEventListener('input', thumbUpdateQualityDisplay);
            thumbUpdateQualityDisplay();
        }
        
        // Set up custom size inputs
        const customWidth = card.querySelector('#thumb-custom-width');
        const customHeight = card.querySelector('#thumb-custom-height');
        if (customWidth && customHeight) {
            customWidth.addEventListener('change', function() {
                if (platformSelect.value === 'custom') {
                    thumbSetPlatform('custom');
                }
            });
            customHeight.addEventListener('change', function() {
                if (platformSelect.value === 'custom') {
                    thumbSetPlatform('custom');
                }
            });
        }
        
        console.log('Thumbnail Generator initialized');
    });
}
</script>

<!-- CARD-SPECIFIC STYLES -->
<style>
/* Pulse animation for results */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
}

/* Custom range slider */
#thumb-quality::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    box-shadow: 0 0 10px rgba(45, 212, 255, 0.5);
}

#thumb-quality::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    border: none;
    box-shadow: 0 0 10px rgba(45, 212, 255, 0.5);
}

/* Button hover effects */
button[onclick*="thumbSetPlatform"]:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    transition: all 0.2s ease;
}

/* Drag & drop hover effects */
#thumb-dropzone:hover {
    border-color: var(--accent) !important;
    background: rgba(var(--accent-rgb, 45,212,255),0.1) !important;
}

/* Generated image styling */
#thumbgen-output img {
    transition: transform 0.3s ease;
}

#thumbgen-output img:hover {
    transform: scale(1.01);
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    #thumbnail-generator-title {
        font-size: 1.3rem !important;
    }
    
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100%;
        margin: 4px 0 !important;
    }
    
    /* Stack upload buttons */
    .field > div[style*="display:flex;gap:12px;"] {
        flex-direction: column;
    }
    
    /* Stack editing options grid */
    div[style*="grid-template-columns:1fr 1fr"] {
        grid-template-columns: 1fr !important;
    }
    
    /* Stack download buttons */
    .results > div[style*="grid-template-columns:repeat(3,1fr)"] {
        grid-template-columns: 1fr !important;
    }
}

/* Small screen adjustments */
@media (max-width: 480px) {
    #thumbnail-generator-title {
        font-size: 1.1rem !important;
    }
    
    /* Adjust platform buttons */
    .field > div[style*="display:flex;gap:8px;flex-wrap:wrap;"] {
        justify-content: center;
    }
    
    button[style*="padding:8px 12px;"] {
        padding: 6px 8px !important;
        font-size: 11px !important;
    }
    
    /* Reduce dropzone padding */
    #thumb-dropzone {
        padding: 30px 15px !important;
    }
}
</style>
