<!-- cards/environmental-science.html -->
<h2 id="environmental-science-title" style="margin-top:0;color:var(--accent);">ğŸŒ Environmental Science Tools</h2>

<form aria-describedby="environmental-science-desc">
  <p id="environmental-science-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.8);">
    Calculate environmental impacts, explore sustainability metrics, and learn fascinating facts about Earth's systems. 
    <span style="color:var(--accent);font-weight:500;">Make informed decisions for a greener planet!</span>
  </p>

  <div class="field" style="margin-bottom:16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
      <label for="env-tool" style="color:var(--accent);font-weight:500;">Select Environmental Tool</label>
      <span id="env-tool-description" class="small" style="color:rgba(45,212,255,0.7);font-size:12px;">Calculates COâ‚‚ emissions</span>
    </div>
    <select id="env-tool" 
            style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:15px;"
            onchange="envUpdateInputFields()">
      <option value="carbon-footprint" selected>Carbon Footprint Calculator</option>
      <option value="water-usage">Water Usage Calculator</option>
      <option value="energy-consumption">Energy Consumption</option>
      <option value="recycling-impact">Recycling Impact</option>
      <option value="food-footprint">Food Carbon Footprint</option>
      <option value="tree-equivalent">Tree Equivalent (COâ‚‚ offset)</option>
      <option value="waste-generation">Waste Generation</option>
      <option value="air-travel-impact">Air Travel Impact</option>
    </select>
  </div>

  <!-- Dynamic Input Fields -->
  <div id="env-input-fields" style="margin-bottom:20px;">
    <!-- Carbon Footprint Inputs -->
    <div id="env-carbon-inputs" style="display:block;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
        <div class="field">
          <label for="env-driving" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Driving (km)</label>
          <input id="env-driving" type="number" min="0" step="1" placeholder="e.g. 100" 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        </div>
        <div class="field">
          <label for="env-electricity" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Electricity (kWh)</label>
          <input id="env-electricity" type="number" min="0" step="1" placeholder="e.g. 300" 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div class="field">
          <label for="env-diet" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Diet Type</label>
          <select id="env-diet" 
                  style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            <option value="vegan">Vegan</option>
            <option value="vegetarian">Vegetarian</option>
            <option value="average" selected>Average</option>
            <option value="meat-heavy">Meat-Heavy</option>
          </select>
        </div>
        <div class="field">
          <label for="env-household" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Household Size</label>
          <input id="env-household" type="number" min="1" max="10" step="1" value="1" 
                 style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        </div>
      </div>
    </div>
  </div>

  <div style="display:flex;gap:12px;align-items:center;margin-bottom:16px;">
    <div style="flex:1;">
      <label for="env-fact-frequency" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Fact Frequency</label>
      <select id="env-fact-frequency" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="low">Few facts</option>
        <option value="medium" selected>Moderate</option>
        <option value="high">Many facts</option>
        <option value="none">No facts</option>
      </select>
    </div>
    
    <div style="flex:1;">
      <label for="env-units" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Units</label>
      <select id="env-units" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
        <option value="metric" selected>Metric (kg, L, km)</option>
        <option value="imperial">Imperial (lbs, gal, mi)</option>
      </select>
    </div>
  </div>

  <div class="actions" style="display:flex;gap:10px;">
    <button type="button" onclick="envCalculate(this)" 
            style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(57,255,20,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);font-weight:600;cursor:pointer;font-size:16px;">
      ğŸŒ± Calculate Impact
    </button>
    <button type="button" onclick="envReset(this)"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset
    </button>
    <button type="button" onclick="envShowComparison(this)"
            style="padding:12px 16px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);border-radius:8px;color:#ffa500;cursor:pointer;">
      Compare
    </button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:20px;">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
    <h3 class="small" style="color:var(--accent);margin:0;">Environmental Impact Report</h3>
    <div id="env-impact-level" class="small" style="padding:4px 12px;border-radius:20px;background:rgba(45,212,255,0.1);color:var(--accent);"></div>
  </div>

  <div id="env-output" style="min-height:180px;">
    <!-- Results will be inserted here -->
  </div>

  <div id="env-progress-container" style="margin-top:16px;display:none;">
    <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
      <span class="small" style="color:var(--accent);">Your Impact Level</span>
      <span id="env-progress-percent" class="small" style="color:var(--accent);">0%</span>
    </div>
    <div style="height:10px;background:rgba(255,255,255,0.1);border-radius:5px;overflow:hidden;">
      <div id="env-progress-bar" style="height:100%;background:linear-gradient(90deg, #39ff14, #2dd4ff);width:0%;transition:width 0.5s ease;"></div>
    </div>
    <div style="display:flex;justify-content:space-between;margin-top:6px;">
      <span class="small" style="color:#39ff14;">Low Impact</span>
      <span class="small" style="color:#ffa500;">Average</span>
      <span class="small" style="color:#ff2d55;">High Impact</span>
    </div>
  </div>

  <div id="env-facts-container" style="margin-top:20px;display:none;">
    <h4 class="small" style="color:var(--accent);margin-bottom:12px;">ğŸŒ¿ Environmental Facts</h4>
    <div id="env-facts-content" class="small" style="color:rgba(230,250,255,0.8);line-height:1.6;">
      <!-- Facts will be inserted here -->
    </div>
  </div>

  <div id="env-suggestions-container" style="margin-top:16px;display:none;">
    <h4 class="small" style="color:#39ff14;margin-bottom:8px;">ğŸ’¡ Sustainability Tips</h4>
    <div id="env-suggestions" class="small" style="color:rgba(230,250,255,0.8);"></div>
  </div>

  <div style="margin-top:16px;display:flex;justify-content:space-between;align-items:center;">
    <div id="env-hint" class="small" style="color:#39ff14;"></div>
    <button onclick="envCopyResults()" 
            style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">
      ğŸ“‹ Copy Report
    </button>
  </div>
</div>

<script>
/* environmental-science.html
   - Comprehensive environmental impact calculator
   - Scoped with env- prefix
*/

// Environmental facts database
const envFacts = {
  carbon: [
    "ğŸŒ³ A single tree can absorb ~22 kg of COâ‚‚ per year.",
    "ğŸš— Switching to an electric vehicle can reduce emissions by 50-70%.",
    "ğŸ  Home insulation can cut heating/cooling emissions by 20-30%.",
    "âœˆï¸ One transatlantic flight emits about 1 ton of COâ‚‚ per passenger.",
    "ğŸ½ï¸ Plant-based diets produce 50% less greenhouse gases than meat-heavy diets."
  ],
  water: [
    "ğŸ’§ A running faucet wastes ~6 liters of water per minute.",
    "ğŸš¿ A 5-minute shower uses ~40 liters, while a bath uses ~80 liters.",
    "ğŸŒ Only 2.5% of Earth's water is freshwater, and less than 1% is accessible.",
    "ğŸš° It takes ~2,400 liters of water to produce 1 hamburger.",
    "ğŸŒ± Drip irrigation is 90% efficient compared to sprinklers at 70%."
  ],
  recycling: [
    "â™»ï¸ Recycling one aluminum can saves enough energy to power a TV for 3 hours.",
    "ğŸ“± One million recycled cell phones can recover 35,000 pounds of copper.",
    "ğŸ“„ Recycling paper uses 60% less energy than making it from raw materials.",
    "ğŸ¥¤ Plastic bottles can take 450 years to decompose in landfills.",
    "ğŸ”‹ Recycling lithium-ion batteries recovers valuable cobalt and lithium."
  ],
  energy: [
    "â˜€ï¸ Solar panels produce energy for 25+ years with minimal maintenance.",
    "ğŸ’¡ LED bulbs use 75% less energy and last 25 times longer than incandescent.",
    "ğŸ¢ Commercial buildings waste 30% of their energy through inefficiencies.",
    "ğŸŒ¬ï¸ Wind power is now cheaper than fossil fuels in many regions.",
    "ğŸ”Œ Standby power (phantom load) accounts for 5-10% of home energy use."
  ],
  general: [
    "ğŸŒ The last 7 years have been the warmest on record globally.",
    "ğŸ One-third of global food production depends on pollinators.",
    "ğŸŒŠ Oceans absorb about 30% of human-produced COâ‚‚ emissions.",
    "ğŸ¦ Wildlife populations have declined by 68% since 1970.",
    "ğŸŒ¿ Restoring degraded ecosystems could capture 30% of global COâ‚‚ emissions."
  ]
};

// Sustainability suggestions
const envSuggestions = {
  low: [
    "âœ… Excellent! You're already living sustainably.",
    "ğŸŒ± Consider sharing your habits with others to inspire change.",
    "â™»ï¸ You could explore zero-waste initiatives next.",
    "ğŸš¶ Maintain your walking/cycling habits for health and environment.",
    "ğŸ’¡ Look into renewable energy options for your home."
  ],
  medium: [
    "ğŸ“Š Good effort! Here's how to improve further:",
    "ğŸš— Reduce car usage by 20% through carpooling or public transport.",
    "ğŸ’¡ Switch to LED bulbs if you haven't already.",
    "ğŸ½ï¸ Try one meat-free day per week.",
    "ğŸš° Fix any leaking faucets to save water."
  ],
  high: [
    "âš ï¸ High environmental impact detected. Suggestions:",
    "ğŸš— Consider electric vehicles or public transportation",
    "ğŸ  Improve home insulation to reduce heating/cooling needs",
    "ğŸ›’ Reduce consumption and choose products with less packaging",
    "ğŸ’¡ Conduct an energy audit of your home",
    "ğŸ Shift toward plant-based foods more often"
  ]
};

// Conversion factors
const envConversionFactors = {
  // CO2 emissions (kg per unit)
  driving: 0.12, // kg CO2 per km (average car)
  electricity: 0.4, // kg CO2 per kWh (grid average)
  diet: {
    vegan: 1.5,
    vegetarian: 2.0,
    average: 3.0,
    'meat-heavy': 5.0
  },
  // Water usage (liters per unit)
  shower: 8, // liters per minute
  laundry: 50, // liters per load
  dishwasher: 15, // liters per load
  // Recycling savings (kWh per kg)
  aluminum: 14,
  plastic: 1.5,
  paper: 4,
  glass: 0.3
};

// Initialize tool
function envInit() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Set up event listeners
  const toolSelect = card.querySelector('#env-tool');
  if (toolSelect) {
    toolSelect.addEventListener('change', envUpdateInputFields);
  }
  
  // Initialize input fields
  envUpdateInputFields();
  
  console.log('Environmental Science Tools initialized');
}

// Update input fields based on selected tool
function envUpdateInputFields() {
  const card = document.currentScript?.closest('.card') || document;
  const tool = card.querySelector('#env-tool').value;
  const description = card.querySelector('#env-tool-description');
  const inputFields = card.querySelector('#env-input-fields');
  
  // Update description
  const descriptions = {
    'carbon-footprint': 'Calculates COâ‚‚ emissions from daily activities',
    'water-usage': 'Calculates water consumption',
    'energy-consumption': 'Estimates energy usage and costs',
    'recycling-impact': 'Shows environmental benefits of recycling',
    'food-footprint': 'Calculates carbon footprint of food choices',
    'tree-equivalent': 'Shows how many trees needed to offset COâ‚‚',
    'waste-generation': 'Estimates waste production',
    'air-travel-impact': 'Calculates flight emissions'
  };
  
  if (description) {
    description.textContent = descriptions[tool] || 'Environmental impact calculator';
  }
  
  // Generate appropriate input fields
  let html = '';
  
  switch (tool) {
    case 'carbon-footprint':
      html = `
        <div id="env-carbon-inputs" style="display:block;">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
            <div class="field">
              <label for="env-driving" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Driving (km/month)</label>
              <input id="env-driving" type="number" min="0" step="1" value="300" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
            <div class="field">
              <label for="env-electricity" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Electricity (kWh/month)</label>
              <input id="env-electricity" type="number" min="0" step="1" value="250" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
            <div class="field">
              <label for="env-diet" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Diet Type</label>
              <select id="env-diet" 
                      style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
                <option value="vegan">Vegan</option>
                <option value="vegetarian">Vegetarian</option>
                <option value="average" selected>Average</option>
                <option value="meat-heavy">Meat-Heavy</option>
              </select>
            </div>
            <div class="field">
              <label for="env-household" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Household Size</label>
              <input id="env-household" type="number" min="1" max="10" step="1" value="2" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
          </div>
        </div>
      `;
      break;
      
    case 'water-usage':
      html = `
        <div id="env-water-inputs" style="display:block;">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
            <div class="field">
              <label for="env-shower-time" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Shower Time (min/day)</label>
              <input id="env-shower-time" type="number" min="0" step="1" value="8" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
            <div class="field">
              <label for="env-laundry" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Laundry Loads/week</label>
              <input id="env-laundry" type="number" min="0" step="1" value="3" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
            <div class="field">
              <label for="env-dishwasher" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Dishwasher Loads/week</label>
              <input id="env-dishwasher" type="number" min="0" step="1" value="4" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
            <div class="field">
              <label for="env-garden" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Garden Watering (L/week)</label>
              <input id="env-garden" type="number" min="0" step="1" value="100" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
          </div>
        </div>
      `;
      break;
      
    case 'recycling-impact':
      html = `
        <div id="env-recycling-inputs" style="display:block;">
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:12px;">
            <div class="field">
              <label for="env-aluminum" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Aluminum (kg/month)</label>
              <input id="env-aluminum" type="number" min="0" step="0.1" value="0.5" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
            <div class="field">
              <label for="env-plastic" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Plastic (kg/month)</label>
              <input id="env-plastic" type="number" min="0" step="0.1" value="1.0" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
            <div class="field">
              <label for="env-paper" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Paper (kg/month)</label>
              <input id="env-paper" type="number" min="0" step="0.1" value="2.0" 
                     style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(255,255,255,0.05);color:inherit;">
            </div>
          </div>
        </div>
      `;
      break;
      
    default:
      html = `<div class="field"><p style="color:var(--accent);text-align:center;padding:20px;">Select a tool to see specific input fields</p></div>`;
  }
  
  inputFields.innerHTML = html;
}

// Calculate environmental impact
function envCalculate(btn) {
  const startTime = performance.now();
  const card = btn.closest('.card') || document;
  
  // Get inputs
  const tool = card.querySelector('#env-tool').value;
  const factFrequency = card.querySelector('#env-fact-frequency').value;
  const units = card.querySelector('#env-units').value;
  
  // Calculate based on tool
  let result = {};
  let impactScore = 0;
  
  switch (tool) {
    case 'carbon-footprint':
      result = envCalculateCarbonFootprint(card, units);
      impactScore = result.totalCO2 > 1000 ? 80 : result.totalCO2 > 500 ? 50 : 20;
      break;
      
    case 'water-usage':
      result = envCalculateWaterUsage(card, units);
      impactScore = result.totalWater > 100000 ? 80 : result.totalWater > 50000 ? 50 : 20;
      break;
      
    case 'recycling-impact':
      result = envCalculateRecyclingImpact(card, units);
      impactScore = result.energySaved > 100 ? 20 : result.energySaved > 50 ? 50 : 80;
      break;
      
    default:
      result = { message: 'Tool not implemented yet' };
  }
  
  // Display results
  envDisplayResults(card, tool, result, impactScore, factFrequency);
  
  // Show suggestions based on impact
  envShowSuggestions(card, impactScore);
  
  // Update progress bar
  const progressBar = card.querySelector('#env-progress-bar');
  const progressPercent = card.querySelector('#env-progress-percent');
  const progressContainer = card.querySelector('#env-progress-container');
  
  if (progressBar && progressPercent) {
    progressContainer.style.display = 'block';
    progressBar.style.width = `${impactScore}%`;
    progressPercent.textContent = `${impactScore}%`;
    
    // Color based on impact
    if (impactScore < 33) {
      progressBar.style.background = 'linear-gradient(90deg, #39ff14, #2dd4ff)';
    } else if (impactScore < 66) {
      progressBar.style.background = 'linear-gradient(90deg, #ffa500, #ffcc00)';
    } else {
      progressBar.style.background = 'linear-gradient(90deg, #ff2d55, #ff4d4d)';
    }
  }
  
  // Update impact level indicator
  const impactLevel = card.querySelector('#env-impact-level');
  if (impactLevel) {
    if (impactScore < 33) {
      impactLevel.textContent = 'Low Impact ğŸŒ¿';
      impactLevel.style.background = 'rgba(57,255,20,0.1)';
      impactLevel.style.color = '#39ff14';
    } else if (impactScore < 66) {
      impactLevel.textContent = 'Moderate Impact âš ï¸';
      impactLevel.style.background = 'rgba(255,165,0,0.1)';
      impactLevel.style.color = '#ffa500';
    } else {
      impactLevel.textContent = 'High Impact ğŸ”¥';
      impactLevel.style.background = 'rgba(255,45,85,0.1)';
      impactLevel.style.color = '#ff2d55';
    }
  }
  
  // Calculate and show execution time
  const endTime = performance.now();
  const timeTaken = (endTime - startTime).toFixed(2);
  
  // Update hint
  const hint = card.querySelector('#env-hint');
  hint.textContent = `Calculated in ${timeTaken}ms`;
  hint.style.color = '#39ff14';
}

// Calculate carbon footprint
function envCalculateCarbonFootprint(card, units) {
  const driving = parseFloat(card.querySelector('#env-driving').value) || 0;
  const electricity = parseFloat(card.querySelector('#env-electricity').value) || 0;
  const diet = card.querySelector('#env-diet').value;
  const household = parseFloat(card.querySelector('#env-household').value) || 1;
  
  // Calculate CO2
  const drivingCO2 = driving * envConversionFactors.driving;
  const electricityCO2 = electricity * envConversionFactors.electricity;
  const dietCO2 = envConversionFactors.diet[diet] * 30 * household; // Daily to monthly
  
  const totalCO2 = drivingCO2 + electricityCO2 + dietCO2;
  const perCapitaCO2 = totalCO2 / household;
  
  // Tree equivalent
  const treesNeeded = totalCO2 / 22; // One tree absorbs ~22kg CO2/year
  
  return {
    drivingCO2: drivingCO2.toFixed(1),
    electricityCO2: electricityCO2.toFixed(1),
    dietCO2: dietCO2.toFixed(1),
    totalCO2: totalCO2.toFixed(1),
    perCapitaCO2: perCapitaCO2.toFixed(1),
    treesNeeded: treesNeeded.toFixed(1),
    monthly: true
  };
}

// Calculate water usage
function envCalculateWaterUsage(card, units) {
  const showerTime = parseFloat(card.querySelector('#env-shower-time').value) || 0;
  const laundry = parseFloat(card.querySelector('#env-laundry').value) || 0;
  const dishwasher = parseFloat(card.querySelector('#env-dishwasher').value) || 0;
  const garden = parseFloat(card.querySelector('#env-garden').value) || 0;
  
  // Calculate water (liters per month)
  const showerWater = showerTime * envConversionFactors.shower * 30; // Daily to monthly
  const laundryWater = laundry * envConversionFactors.laundry * 4; // Weekly to monthly
  const dishwasherWater = dishwasher * envConversionFactors.dishwasher * 4; // Weekly to monthly
  const gardenWater = garden * 4; // Weekly to monthly
  
  const totalWater = showerWater + laundryWater + dishwasherWater + gardenWater;
  const dailyAverage = totalWater / 30;
  
  // Bottled water equivalent
  const bottles = totalWater / 0.5; // 500ml bottles
  
  return {
    showerWater: showerWater.toFixed(0),
    laundryWater: laundryWater.toFixed(0),
    dishwasherWater: dishwasherWater.toFixed(0),
    gardenWater: gardenWater.toFixed(0),
    totalWater: totalWater.toFixed(0),
    dailyAverage: dailyAverage.toFixed(0),
    bottles: bottles.toFixed(0),
    monthly: true
  };
}

// Calculate recycling impact
function envCalculateRecyclingImpact(card, units) {
  const aluminum = parseFloat(card.querySelector('#env-aluminum').value) || 0;
  const plastic = parseFloat(card.querySelector('#env-plastic').value) || 0;
  const paper = parseFloat(card.querySelector('#env-paper').value) || 0;
  
  // Calculate energy savings (kWh per month)
  const aluminumEnergy = aluminum * envConversionFactors.aluminum;
  const plasticEnergy = plastic * envConversionFactors.plastic;
  const paperEnergy = paper * envConversionFactors.paper;
  
  const totalEnergy = aluminumEnergy + plasticEnergy + paperEnergy;
  
  // CO2 savings (approx 0.5 kg CO2 per kWh saved)
  const co2Saved = totalEnergy * 0.5;
  
  // Equivalent TV hours
  const tvHours = totalEnergy * 10; // Approx 0.1 kWh per hour for modern TV
  
  return {
    aluminumEnergy: aluminumEnergy.toFixed(1),
    plasticEnergy: plasticEnergy.toFixed(1),
    paperEnergy: paperEnergy.toFixed(1),
    totalEnergy: totalEnergy.toFixed(1),
    co2Saved: co2Saved.toFixed(1),
    tvHours: tvHours.toFixed(0),
    monthly: true
  };
}

// Display results
function envDisplayResults(card, tool, result, impactScore, factFrequency) {
  const outputDiv = card.querySelector('#env-output');
  
  let html = '';
  
  switch (tool) {
    case 'carbon-footprint':
      html = `
        <div style="background:rgba(0,0,0,0.2);border-radius:10px;padding:16px;border:1px solid rgba(45,212,255,0.2);">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
            <div style="text-align:center;padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
              <div style="font-size:24px;font-weight:600;color:var(--accent);">${result.totalCO2} kg</div>
              <div class="small" style="color:rgba(230,250,255,0.7);">Total COâ‚‚ Emissions</div>
            </div>
            <div style="text-align:center;padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;">
              <div style="font-size:24px;font-weight:600;color:#39ff14;">${result.perCapitaCO2} kg</div>
              <div class="small" style="color:rgba(230,250,255,0.7);">Per Person</div>
            </div>
          </div>
          
          <div style="margin-bottom:16px;">
            <div class="small" style="color:var(--accent);margin-bottom:8px;">Breakdown:</div>
            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;">
              <div style="padding:8px;background:rgba(45,212,255,0.05);border-radius:6px;">
                <div class="small" style="color:var(--accent);">ğŸš— Transport</div>
                <div style="font-weight:600;">${result.drivingCO2} kg</div>
              </div>
              <div style="padding:8px;background:rgba(45,212,255,0.05);border-radius:6px;">
                <div class="small" style="color:var(--accent);">ğŸ’¡ Electricity</div>
                <div style="font-weight:600;">${result.electricityCO2} kg</div>
              </div>
              <div style="padding:8px;background:rgba(45,212,255,0.05);border-radius:6px;">
                <div class="small" style="color:var(--accent);">ğŸ½ï¸ Diet</div>
                <div style="font-weight:600;">${result.dietCO2} kg</div>
              </div>
            </div>
          </div>
          
          <div style="padding:12px;background
