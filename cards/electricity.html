<h2 id="electricity-title" style="margin-top:0;color:var(--accent);border-bottom:2px solid var(--accent);padding-bottom:10px;">
  ‚ö° Electrical Engineering Calculator
</h2>

<div class="tool-description" style="
  background:linear-gradient(135deg, rgba(45,212,255,0.08), rgba(45,212,255,0.04));
  border-left:4px solid var(--accent);
  padding:16px;
  border-radius:0 12px 12px 0;
  margin-bottom:20px;
">
  <p style="margin:0;display:flex;align-items:flex-start;gap:12px;">
    <span style="font-size:1.8em;flex-shrink:0;">üî¨</span>
    <span style="line-height:1.6;">
      A comprehensive electrical engineering toolkit for professionals and students.
      <strong style="color:var(--accent);">Includes circuit analysis, power calculations, and energy conversions with real-world context.</strong>
    </span>
  </p>
</div>

<!-- TOOL SELECTOR -->
<div class="tool-selector" style="margin-bottom:24px;">
  <div style="color:var(--accent);font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;">
    <span style="font-size:1.3em;">üõ†Ô∏è</span> Select Electrical Tool
  </div>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;">
    <button class="tool-btn active" data-tool="ohm" onclick="selectTool('ohm', this)" style="
      padding:16px 12px;background:rgba(45,212,255,0.15);border:2px solid var(--accent);border-radius:10px;color:var(--accent);cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.5em;margin-bottom:8px;">‚ö°</div>
      <div style="font-weight:600;">Ohm's Law</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">V = I √ó R</div>
    </button>
    
    <button class="tool-btn" data-tool="power" onclick="selectTool('power', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.5em;margin-bottom:8px;">üí°</div>
      <div style="font-weight:600;">Power</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">P = V √ó I</div>
    </button>
    
    <button class="tool-btn" data-tool="energy" onclick="selectTool('energy', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.5em;margin-bottom:8px;">üîã</div>
      <div style="font-weight:600;">Energy</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">E = P √ó t</div>
    </button>
    
    <button class="tool-btn" data-tool="series" onclick="selectTool('series', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.5em;margin-bottom:8px;">üîó</div>
      <div style="font-weight:600;">Series</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">R = R‚ÇÅ + R‚ÇÇ + ...</div>
    </button>
    
    <button class="tool-btn" data-tool="parallel" onclick="selectTool('parallel', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.5em;margin-bottom:8px;">üîÄ</div>
      <div style="font-weight:600;">Parallel</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">1/R = 1/R‚ÇÅ + 1/R‚ÇÇ + ...</div>
    </button>
  </div>
</div>

<!-- INPUT SECTION - Dynamic based on tool -->
<div id="input-section" style="
  background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px;
  padding:24px;
  margin-bottom:24px;
">
  <!-- Dynamic content will be inserted here -->
</div>

<!-- CALCULATE BUTTON -->
<div style="margin-bottom:24px;">
  <button onclick="calculateElectrical()" style="
    width:100%;
    padding:18px;
    background:linear-gradient(90deg, var(--accent), #0077cc);
    border:none;
    border-radius:12px;
    color:white;
    font-weight:700;
    font-size:1.1em;
    cursor:pointer;
    transition:all 0.3s;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
  " onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
    <span style="font-size:1.3em;">‚ö°</span>
    Calculate Electrical Values
    <span style="font-size:1.3em;">üî¨</span>
  </button>
</div>

<!-- RESULTS SECTION -->
<div id="results-section" style="
  background:linear-gradient(135deg, rgba(57,255,20,0.05), rgba(45,212,255,0.05));
  border:2px solid rgba(57,255,20,0.2);
  border-radius:16px;
  padding:24px;
  display:none;
">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
    <h3 style="margin:0;color:#39ff14;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.3em;">üìä</span> Electrical Calculation Results
    </h3>
    <div style="font-size:0.9em;color:rgba(230,250,255,0.7);background:rgba(0,0,0,0.3);padding:6px 12px;border-radius:20px;">
      <span id="current-tool-name">Ohm's Law</span>
    </div>
  </div>

  <!-- PRIMARY RESULT -->
  <div style="
    background:linear-gradient(135deg, rgba(45,212,255,0.1), rgba(45,212,255,0.05));
    border:1px solid rgba(45,212,255,0.2);
    border-radius:12px;
    padding:24px;
    text-align:center;
    margin-bottom:24px;
  ">
    <div style="font-size:0.9em;color:rgba(230,250,255,0.7);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.5px;">
      Calculated Result
    </div>
    <div id="primary-result" style="
      font-size:2.8em;
      font-weight:800;
      color:#39ff14;
      font-family:'Courier New', monospace;
      margin:8px 0;
      text-shadow:0 0 20px rgba(57,255,20,0.3);
    ">0.00</div>
    <div id="primary-unit" style="font-size:1.1em;color:rgba(230,250,255,0.9);margin-top:4px;">
      <span id="result-symbol">V</span> (Volts)
    </div>
  </div>

  <!-- DETAILED CALCULATION -->
  <div style="margin-bottom:24px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">üßÆ</span> Detailed Calculation Steps
    </div>
    
    <div style="
      background:rgba(0,0,0,0.3);
      border-radius:12px;
      padding:20px;
      font-family:'Courier New', monospace;
      font-size:0.95em;
      line-height:1.6;
      white-space:pre-wrap;
      margin-bottom:16px;
    " id="detailed-calculation">
      Select a tool and enter values to see detailed calculation...
    </div>
  </div>

  <!-- REAL-WORLD CONTEXT -->
  <div style="
    background:linear-gradient(135deg, rgba(255,204,0,0.08), rgba(255,204,0,0.04));
    border:1px solid rgba(255,204,0,0.2);
    border-radius:12px;
    padding:20px;
    margin-bottom:24px;
  ">
    <div style="color:#ffcc00;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">üåç</span> Real-World Context
    </div>
    
    <div id="real-world-context" style="line-height:1.6;color:rgba(230,250,255,0.9);">
      <p style="margin:0 0 12px 0;">Results will be compared to real-world electrical systems...</p>
    </div>
  </div>

  <!-- RELATED CALCULATIONS -->
  <div style="margin-bottom:24px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">üìà</span> Related Calculations
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;" id="related-calculations">
      <!-- Will be populated dynamically -->
    </div>
  </div>

  <!-- ACTION BUTTONS -->
  <div style="display:flex;gap:12px;flex-wrap:wrap;">
    <button onclick="exportElectricalReport()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(57,255,20,0.15);border:1px solid #39ff14;border-radius:10px;color:#39ff14;font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      üìÑ Export Report
    </button>
    
    <button onclick="copyElectricalResults()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(45,212,255,0.15);border:1px solid var(--accent);border-radius:10px;color:var(--accent);font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      üìã Copy Results
    </button>
    
    <button onclick="resetElectricalCalculator()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:10px;color:inherit;font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      üîÑ Reset Calculator
    </button>
  </div>
</div>

<!-- ELECTRICAL FACTS & COMPARISONS -->
<div style="
  background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px;
  padding:24px;
  margin-top:24px;
">
  <div style="color:var(--accent);font-weight:600;margin-bottom:20px;display:flex;align-items:center;gap:8px;">
    <span style="font-size:1.3em;">‚ö°</span> Electrical Facts & Comparisons
  </div>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:24px;">
    <div>
      <div style="color:#ffcc00;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
        <span>‚ö°</span> Lightning & Natural Electricity
      </div>
      <ul style="margin:0;padding-left:20px;color:rgba(230,250,255,0.9);line-height:1.6;font-size:0.95em;">
        <li>Lightning temperature: <strong style="color:#ffcc00;">30,000 K</strong> (5√ó Sun's surface)</li>
        <li>Single bolt energy: ~<strong style="color:#39ff14;">1 billion joules</strong></li>
        <li>Electric eel discharge: up to <strong style="color:#2dd4ff;">600V at 1A</strong></li>
        <li>Longest recorded bolt: <strong style="color:#ff2d55;">709 km</strong> (Brazil, 2020)</li>
        <li>Global lightning strikes: ~<strong>100 per second</strong></li>
      </ul>
    </div>
    
    <div>
      <div style="color:#39ff14;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
        <span>üîã</span> Energy Comparisons
      </div>
      <ul style="margin:0;padding-left:20px;color:rgba(230,250,255,0.9);line-height:1.6;font-size:0.95em;">
        <li>1 kWh = <strong style="color:#39ff14;">3.6 million joules</strong></li>
        <li>AA battery: ~<strong>9,000 joules</strong> (alkaline)</li>
        <li>Car battery: ~<strong style="color:#ffcc00;">2.6 million joules</strong></li>
        <li>Human daily energy: ~<strong>8.4 million joules</strong></li>
        <li>Lightning bolt: ~<strong style="color:#ff2d55;">1,000 kWh</strong></li>
      </ul>
    </div>
    
    <div>
      <div style="color:#2dd4ff;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
        <span>üí°</span> Common Electrical Values
      </div>
      <ul style="margin:0;padding-left:20px;color:rgba(230,250,255,0.9);line-height:1.6;font-size:0.95em;">
        <li>USB charger: <strong style="color:#2dd4ff;">5V, 2.4A</strong> (12W)</li>
        <li>Household outlet: <strong>120/240V, 15-20A</strong></li>
        <li>LED bulb: <strong style="color:#39ff14;">10W</strong> (vs 60W incandescent)</li>
        <li>Electric vehicle charger: <strong style="color:#ffcc00;">240V, 32A</strong> (7.7kW)</li>
        <li>Data center rack: <strong>4,000-8,000W</strong></li>
      </ul>
    </div>
  </div>
</div>

<script>
// Professional Electrical Engineering Calculator

let currentTool = 'ohm';

// Tool templates
const toolTemplates = {
  ohm: {
    name: "Ohm's Law Calculator",
    formula: "V = I √ó R",
    description: "Calculate voltage, current, or resistance when two values are known.",
    inputs: [
      { id: "voltage", label: "Voltage (V)", symbol: "V", unit: "volts", placeholder: "e.g., 12" },
      { id: "current", label: "Current (I)", symbol: "I", unit: "amperes", placeholder: "e.g., 0.5" },
      { id: "resistance", label: "Resistance (R)", symbol: "R", unit: "ohms", placeholder: "e.g., 24" }
    ]
  },
  
  power: {
    name: "Power Calculator",
    formula: "P = V √ó I",
    description: "Calculate electrical power from voltage and current, or find missing values.",
    inputs: [
      { id: "voltage", label: "Voltage (V)", symbol: "V", unit: "volts", placeholder: "e.g., 120" },
      { id: "current", label: "Current (I)", symbol: "I", unit: "amperes", placeholder: "e.g., 1.5" },
      { id: "power", label: "Power (P)", symbol: "P", unit: "watts", placeholder: "e.g., 180" }
    ]
  },
  
  energy: {
    name: "Energy Calculator",
    formula: "E = P √ó t",
    description: "Calculate electrical energy consumption over time.",
    inputs: [
      { id: "power", label: "Power (P)", symbol: "P", unit: "watts", placeholder: "e.g., 100" },
      { id: "time", label: "Time (t)", symbol: "t", unit: "hours", placeholder: "e.g., 5" },
      { id: "energy", label: "Energy (E)", symbol: "E", unit: "watt-hours", placeholder: "e.g., 500" }
    ]
  },
  
  series: {
    name: "Series Resistance Calculator",
    formula: "R‚Çú = R‚ÇÅ + R‚ÇÇ + ... + R‚Çô",
    description: "Calculate total resistance for resistors connected in series.",
    inputs: [
      { id: "r1", label: "Resistor 1 (R‚ÇÅ)", symbol: "R‚ÇÅ", unit: "ohms", placeholder: "e.g., 100" },
      { id: "r2", label: "Resistor 2 (R‚ÇÇ)", symbol: "R‚ÇÇ", unit: "ohms", placeholder: "e.g., 200" },
      { id: "r3", label: "Resistor 3 (R‚ÇÉ)", symbol: "R‚ÇÉ", unit: "ohms", placeholder: "e.g., 300 (optional)" },
      { id: "r4", label: "Resistor 4 (R‚ÇÑ)", symbol: "R‚ÇÑ", unit: "ohms", placeholder: "e.g., 400 (optional)" }
    ]
  },
  
  parallel: {
    name: "Parallel Resistance Calculator",
    formula: "1/R‚Çú = 1/R‚ÇÅ + 1/R‚ÇÇ + ... + 1/R‚Çô",
    description: "Calculate total resistance for resistors connected in parallel.",
    inputs: [
      { id: "r1", label: "Resistor 1 (R‚ÇÅ)", symbol: "R‚ÇÅ", unit: "ohms", placeholder: "e.g., 100" },
      { id: "r2", label: "Resistor 2 (R‚ÇÇ)", symbol: "R‚ÇÇ", unit: "ohms", placeholder: "e.g., 200" },
      { id: "r3", label: "Resistor 3 (R‚ÇÉ)", symbol: "R‚ÇÉ", unit: "ohms", placeholder: "e.g., 300 (optional)" },
      { id: "r4", label: "Resistor 4 (R‚ÇÑ)", symbol: "R‚ÇÑ", unit: "ohms", placeholder: "e.g., 400 (optional)" }
    ]
  }
};

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  loadToolInputs('ohm');
  updateCurrentToolName();
});

function selectTool(tool, button) {
  currentTool = tool;
  
  // Update button styles
  document.querySelectorAll('.tool-btn').forEach(btn => {
    btn.classList.remove('active');
    btn.style.background = 'rgba(255,255,255,0.05)';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
    btn.style.color = 'inherit';
  });
  
  button.classList.add('active');
  button.style.background = 'rgba(45,212,255,0.15)';
  button.style.border = '2px solid var(--accent)';
  button.style.color = 'var(--accent)';
  
  // Load appropriate inputs
  loadToolInputs(tool);
  updateCurrentToolName();
  
  // Hide results if showing
  document.getElementById('results-section').style.display = 'none';
}

function loadToolInputs(tool) {
  const template = toolTemplates[tool];
  const container = document.getElementById('input-section');
  
  let html = `
    <h3 style="margin-top:0;color:var(--accent);margin-bottom:16px;">${template.name}</h3>
    
    <div style="
      background:rgba(45,212,255,0.05);border-radius:10px;padding:16px;margin-bottom:20px;
      border-left:4px solid var(--accent);
    ">
      <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Formula:</div>
      <div style="font-size:1.2em;color:#39ff14;font-family:'Courier New', monospace;">
        ${template.formula}
      </div>
      <div style="color:rgba(230,250,255,0.8);margin-top:8px;font-size:0.95em;">
        ${template.description}
      </div>
    </div>
    
    <div style="color:var(--accent);font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">üìù</span> Input Values
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:20px;margin-bottom:20px;">
  `;
  
  template.inputs.forEach(input => {
    html += `
      <div>
        <label for="elec-${input.id}" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
          ${input.label}
          <span style="color:var(--accent);font-family:monospace;"> (${input.symbol})</span>
        </label>
        <div style="position:relative;">
          <input id="elec-${input.id}" type="number" step="any"
                 placeholder="${input.placeholder}"
                 style="width:100%;padding:12px 40px 12px 12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-family:monospace;">
          <span style="position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--accent);font-family:monospace;">${input.unit}</span>
        </div>
      </div>
    `;
  });
  
  html += `</div>`;
  
  container.innerHTML = html;
}

function updateCurrentToolName() {
  document.getElementById('current-tool-name').textContent = toolTemplates[currentTool].name;
}

function calculateElectrical() {
  const template = toolTemplates[currentTool];
  const inputs = {};
  
  // Collect input values
  template.inputs.forEach(input => {
    const element = document.getElementById(`elec-${input.id}`);
    if (element && element.value.trim() !== '') {
      inputs[input.id] = parseFloat(element.value);
    }
  });
  
  // Calculate based on tool
  let results;
  switch(currentTool) {
    case 'ohm':
      results = calculateOhmsLaw(inputs);
      break;
    case 'power':
      results = calculatePower(inputs);
      break;
    case 'energy':
      results = calculateEnergy(inputs);
      break;
    case 'series':
      results = calculateSeries(inputs);
      break;
    case 'parallel':
      results = calculateParallel(inputs);
      break;
  }
  
  if (results.error) {
    alert(results.error);
    return;
  }
  
  // Display results
  displayResults(results);
  
  // Show results section
  const resultsSection = document.getElementById('results-section');
  resultsSection.style.display = 'block';
  resultsSection.style.opacity = '0';
  resultsSection.style.transform = 'translateY(10px)';
  
  setTimeout(() => {
    resultsSection.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
    resultsSection.style.opacity = '1';
    resultsSection.style.transform = 'translateY(0)';
    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 10);
}

function calculateOhmsLaw(inputs) {
  const V = inputs.voltage;
  const I = inputs.current;
  const R = inputs.resistance;
  
  let result = 0;
  let calculation = '';
  let symbol = '';
  let unit = '';
  let missing = '';
  
  if (V && I && R) {
    // All three provided - check consistency
    const calculatedV = I * R;
    const tolerance = Math.abs((calculatedV - V) / V * 100);
    calculation = `Checking consistency:\nV = I √ó R\nV = ${I} √ó ${R}\nV = ${calculatedV.toFixed(2)} V\n\nProvided: ${V} V\nDifference: ${(calculatedV - V).toFixed(2)} V (${tolerance.toFixed(1)}%)`;
    result = V;
    symbol = 'V';
    unit = 'volts';
  } else if (V && I) {
    // Calculate R
    result = V / I;
    symbol = 'R';
    unit = 'ohms';
    calculation = `R = V √∑ I\nR = ${V} √∑ ${I}\nR = ${result.toFixed(2)} Œ©`;
    missing = `Resistance (R) = ${result.toFixed(2)} Œ©`;
  } else if (V && R) {
    // Calculate I
    result = V / R;
    symbol = 'I';
    unit = 'amperes';
    calculation = `I = V √∑ R\nI = ${V} √∑ ${R}\nI = ${result.toFixed(2)} A`;
    missing = `Current (I) = ${result.toFixed(2)} A`;
  } else if (I && R) {
    // Calculate V
    result = I * R;
    symbol = 'V';
    unit = 'volts';
    calculation = `V = I √ó R\nV = ${I} √ó ${R}\nV = ${result.toFixed(2)} V`;
    missing = `Voltage (V) = ${result.toFixed(2)} V`;
  } else {
    return { error: 'Please provide at least two values to calculate the third.' };
  }
  
  const realWorld = getOhmsLawRealWorld(result, symbol);
  
  return {
    result: result.toFixed(2),
    symbol: symbol,
    unit: unit,
    fullUnit: unit,
    calculation: calculation,
    realWorld: realWorld,
    missing: missing
  };
}

function calculatePower(inputs) {
  const V = inputs.voltage;
  const I = inputs.current;
  const P = inputs.power;
  
  let result = 0;
  let calculation = '';
  let symbol = '';
  let unit = '';
  let missing = '';
  
  if (V && I && P) {
    // All three provided - check consistency
    const calculatedP = V * I;
    const tolerance = Math.abs((calculatedP - P) / P * 100);
    calculation = `Checking consistency:\nP = V √ó I\nP = ${V} √ó ${I}\nP = ${calculatedP.toFixed(2)} W\n\nProvided: ${P} W\nDifference: ${(calculatedP - P).toFixed(2)} W (${tolerance.toFixed(1)}%)`;
    result = P;
    symbol = 'P';
    unit = 'watts';
  } else if (V && I) {
    // Calculate P
    result = V * I;
    symbol = 'P';
    unit = 'watts';
    calculation = `P = V √ó I\nP = ${V} √ó ${I}\nP = ${result.toFixed(2)} W`;
    missing = `Power (P) = ${result.toFixed(2)} W`;
  } else if (V && P) {
    // Calculate I
    result = P / V;
    symbol = 'I';
    unit = 'amperes';
    calculation = `I = P √∑ V\nI = ${P} √∑ ${V}\nI = ${result.toFixed(2)} A`;
    missing = `Current (I) = ${result.toFixed(2)} A`;
  } else if (I && P) {
    // Calculate V
    result = P / I;
    symbol = 'V';
    unit = 'volts';
    calculation = `V = P √∑ I\nV = ${P} √∑ ${I}\nV = ${result.toFixed(2)} V`;
    missing = `Voltage (V) = ${result.toFixed(2)} V`;
  } else {
    return { error: 'Please provide at least two values to calculate the third.' };
  }
  
  const realWorld = getPowerRealWorld(result, symbol);
  
  return {
    result: result.toFixed(2),
    symbol: symbol,
    unit: unit,
    fullUnit: unit,
    calculation: calculation,
    realWorld: realWorld,
    missing: missing
  };
}

function calculateEnergy(inputs) {
  const P = inputs.power;
  const t = inputs.time;
  const E = inputs.energy;
  
  let result = 0;
  let calculation = '';
  let symbol = '';
  let unit = '';
  let missing = '';
  
  if (P && t && E) {
    // All three provided - check consistency
    const calculatedE = P * t;
    const tolerance = Math.abs((calculatedE - E) / E * 100);
    calculation = `Checking consistency:\nE = P √ó t\nE = ${P} √ó ${t}\nE = ${calculatedE.toFixed(2)} Wh\n\nProvided: ${E} Wh\nDifference: ${(calculatedE - E).toFixed(2)} Wh (${tolerance.toFixed(1)}%)`;
    result = E;
    symbol = 'E';
    unit = 'watt-hours';
  } else if (P && t) {
    // Calculate E
    result = P * t;
    symbol = 'E';
    unit = 'watt-hours';
    calculation = `E = P √ó t\nE = ${P} √ó ${t}\nE = ${result.toFixed(2)} Wh`;
    missing = `Energy (E) = ${result.toFixed(2)} Wh`;
    
    // Also calculate in joules and kWh
    const joules = result * 3600;
    const kWh = result / 1000;
    calculation += `\n\nConversions:\n${result.toFixed(2)} Wh = ${joules.toFixed(0)} J\n${result.toFixed(2)} Wh = ${kWh.toFixed(3)} kWh`;
  } else if (P && E) {
    // Calculate t
    result = E / P;
    symbol = 't';
    unit = 'hours';
    calculation = `t = E √∑ P\nt = ${E} √∑ ${P}\nt = ${result.toFixed(2)} hours`;
    missing = `Time (t) = ${result.toFixed(2)} hours`;
  } else if (t && E) {
    // Calculate P
    result = E / t;
    symbol = 'P';
    unit = 'watts';
    calculation = `P = E √∑ t\nP = ${E} √∑ ${t}\nP = ${result.toFixed(2)} W`;
    missing = `Power (P) = ${result.toFixed(2)} W`;
  } else {
    return { error: 'Please provide at least two values to calculate the third.' };
  }
  
  const realWorld = getEnergyRealWorld(result, symbol, inputs);
  
  return {
    result: result.toFixed(2),
    symbol: symbol,
    unit: unit,
    fullUnit: unit,
    calculation: calculation,
    realWorld: realWorld,
    missing: missing
  };
}

function calculateSeries(inputs) {
  const resistors = [];
  let calculation = 'Series Resistance Formula:\nR‚Çú = R‚ÇÅ + R‚ÇÇ + ... + R‚Çô\n\n';
  
  for (let i = 1; i <= 4; i++) {
    if (inputs[`r${i}`]) {
      resistors.push(inputs[`r${i}`]);
    }
  }
  
  if (resistors.length < 2) {
    return { error: 'Please provide at least two resistor values.' };
  }
  
  const total = resistors.reduce((sum, r) => sum + r, 0);
  
  calculation += `Given resistors:\n`;
  resistors.forEach((r, i) => {
    calculation += `R${i+1} = ${r} Œ©\n`;
  });
  
  calculation += `\nCalculation:\nR‚Çú = ${resistors.join(' + ')}\nR‚Çú = ${total} Œ©`;
  
  // Calculate current if voltage is known (optional)
  const voltage = inputs.voltage;
  if (voltage) {
    const current = voltage / total;
    calculation += `\n\nWith voltage ${voltage} V:\nI = V √∑ R‚Çú = ${voltage} √∑ ${total} = ${current.toFixed(3)} A`;
    calculation += `\nPower: P = V √ó I = ${voltage} √ó ${current.toFixed(3)} = ${(voltage * current).toFixed(2)} W`;
  }
  
  const realWorld = getSeriesRealWorld(total, resistors);
  
  return {
    result: total.toFixed(2),
    symbol: 'R‚Çú',
    unit: 'ohms',
    fullUnit: 'ohms (Œ©)',
    calculation: calculation,
    realWorld: realWorld,
    missing: `Total Series Resistance = ${total} Œ©`
  };
}

function calculateParallel(inputs) {
  const resistors = [];
  let calculation = 'Parallel Resistance Formula:\n1/R‚Çú = 1/R‚ÇÅ + 1/R‚ÇÇ + ... + 1/R‚Çô\n\n';
  
  for (let i = 1; i <= 4; i++) {
    if (inputs[`r${i}`]) {
      resistors.push(inputs[`r${i}`]);
    }
  }
  
  if (resistors.length < 2) {
    return { error: 'Please provide at least two resistor values.' };
  }
  
  // Calculate reciprocal sum
  const reciprocalSum = resistors.reduce((sum, r) => sum + (1/r), 0);
  const total = 1 / reciprocalSum;
  
  calculation += `Given resistors:\n`;
  resistors.forEach((r, i) => {
    calculation += `R${i+1} = ${r} Œ©\n`;
  });
  
  calculation += `\nCalculation:\n1/R‚Çú = ${resistors.map(r => `1/${r}`).join(' + ')}\n1/R‚Çú = ${reciprocalSum.toFixed(4)}\nR‚Çú = 1 / ${reciprocalSum.toFixed(4)}\nR‚Çú = ${total.toFixed(2)} Œ©`;
  
  // Important note about parallel resistance
  calculation += `\n\nNote: Parallel resistance is always less than the smallest individual resistor (${Math.min(...resistors)} Œ©)`;
  
  const realWorld = getParallelRealWorld(total, resistors);
  
  return {
    result: total.toFixed(2),
    symbol: 'R‚Çú',
    unit: 'ohms',
    fullUnit: 'ohms (Œ©)',
    calculation: calculation,
    realWorld: realWorld,
    missing: `Total Parallel Resistance = ${total.toFixed(2)} Œ©`
  };
}

function getOhmsLawRealWorld(value, symbol) {
  let context = '';
  
  if (symbol === 'V') {
    if (value < 5) {
      context = `üîã This voltage is typical for USB devices and small electronics.`;
    } else if (value < 50) {
      context = `üí° Common for automotive systems and power tools.`;
    } else if (value < 240) {
      context = `üè† Standard household voltage range.`;
    } else if (value < 1000) {
      context = `‚ö° Industrial equipment and commercial applications.`;
    } else {
      context = `‚ö†Ô∏è High voltage - typical for power transmission lines.`;
    }
  } else if (symbol === 'I') {
    if (value < 0.1) {
      context = `üîã Very low current - typical for microelectronics and sensors.`;
    } else if (value < 1) {
      context = `üì± Common for smartphone chargers and small devices.`;
    } else if (value < 10) {
      context = `üí° Typical for household appliances and power tools.`;
    } else if (value < 100) {
      context = `‚ö° High current - industrial motors and electric vehicle charging.`;
    } else {
      context = `‚ö†Ô∏è Very high current - industrial equipment and power distribution.`;
    }
  } else if (symbol === 'R') {
    if (value < 10) {
      context = `üîå Very low resistance - heavy-duty conductors and power distribution.`;
    } else if (value < 1000) {
      context = `üí° Common resistor values for electronic circuits.`;
    } else if (value < 1000000) {
      context = `üî¨ Higher resistance values for precision circuits and sensors.`;
    } else {
      context = `‚ö° Very high resistance - insulation and measurement applications.`;
    }
  }
  
  return context;
}

function getPowerRealWorld(value, symbol) {
  let context = '';
  
  if (symbol === 'P') {
    if (value < 10) {
      context = `üîã LED lights, phone chargers, and small electronics.`;
    } else if (value < 100) {
      context = `üí° Incandescent bulbs, laptop chargers, small appliances.`;
    } else if (value < 1000) {
      context = `üè† Microwave ovens, gaming PCs, space heaters.`;
    } else if (value < 5000) {
      context = `‚ö° Electric kettles, hair dryers, window AC units.`;
    } else {
      context = `üè≠ Industrial equipment, electric vehicle chargers, large HVAC systems.`;
    }
  } else if (symbol === 'V') {
    context = getOhmsLawRealWorld(value, 'V');
  } else if (symbol === 'I') {
    context = getOhmsLawRealWorld(value, 'I');
  }
  
  return context;
}

function getEnergyRealWorld(value, symbol, inputs) {
  let context = '';
  
  if (symbol === 'E') {
    const kWh = value / 1000;
    const cost = kWh * 0.15; // Average electricity cost
    
    context = `üí∞ Energy Cost Estimate:\n`;
    context += `‚Ä¢ ${value.toFixed(2)} Wh = ${kWh.toFixed(3)} kWh\n`;
    context += `‚Ä¢ At $0.15/kWh: $${cost.toFixed(2)}\n`;
    
    if (inputs.power && inputs.time) {
      context += `\nüîã This could power:\n`;
      if (inputs.power <= 10) {
        context += `‚Ä¢ ${(value / (10 * inputs.time)).toFixed(1)} √ó LED bulbs for ${inputs.time} hours\n`;
      }
      if (inputs.power <= 60) {
        context += `‚Ä¢ A laptop for ${(value / 60).toFixed(1)} hours\n`;
      }
      context += `‚Ä¢ A smartphone ${(value / 10).toFixed(0)} times from 0-100%`;
    }
  } else if (symbol === 'P') {
    context = getPowerRealWorld(value, 'P');
  } else if (symbol === 't') {
    context = `‚è∞ Time required:\n`;
    if (value < 1) {
      context += `‚Ä¢ ${(value * 60).toFixed(0)} minutes\n`;
    } else if (value < 24) {
      context += `‚Ä¢ ${value.toFixed(1)} hours\n`;
    } else {
      context += `‚Ä¢ ${(value / 24).toFixed(1)} days\n`;
    }
    context += `For continuous operation at ${inputs.power}W`;
  }
  
  return context;
}

function getSeriesRealWorld(total, resistors) {
  let context = `üîó Series Circuit Characteristics:\n`;
  context += `‚Ä¢ Total resistance (${total} Œ©) is the sum of all resistors\n`;
  context += `‚Ä¢ Current is the same through all resistors\n`;
  context += `‚Ä¢ Voltage divides proportionally to resistance\n`;
  
  if (resistors.length >= 2) {
    const smallest = Math.min(...resistors);
    const largest = Math.max(...resistors);
    context += `\nüìä Resistor values range from ${smallest} Œ© to ${largest} Œ©\n`;
    context += `‚Ä¢ Largest resistor (${largest} Œ©) gets most voltage drop\n`;
    context += `‚Ä¢ All resistors must handle the same current\n`;
  }
  
  return context;
}

function getParallelRealWorld(total, resistors) {
  let context = `üîÄ Parallel Circuit Characteristics:\n`;
  context += `‚Ä¢ Total resistance (${total.toFixed(2)} Œ©) is less than smallest resistor (${Math.min(...resistors)} Œ©)\n`;
  context += `‚Ä¢ Voltage is the same across all resistors\n`;
  context += `‚Ä¢ Current divides inversely with resistance\n`;
  
  context += `\n‚ö° Current Distribution:\n`;
  resistors.forEach((r, i) => {
    const currentFraction = (total / r * 100).toFixed(1);
    context += `‚Ä¢ R${i+1} (${r} Œ©): ${currentFraction}% of total current\n`;
  });
  
  context += `\nüí° Practical Use: Parallel circuits provide multiple current paths and increase total current capacity.`;
  
  return context;
}

function displayResults(results) {
  document.getElementById('primary-result').textContent = results.result;
  document.getElementById('result-symbol').textContent = results.symbol;
  document.getElementById('primary-unit').innerHTML = `${results.symbol} (${results.fullUnit})`;
  document.getElementById('detailed-calculation').textContent = results.calculation;
  document.getElementById('real-world-context').innerHTML = results.realWorld.replace(/\n/g, '<br>');
  
  // Generate related calculations
  generateRelatedCalculations(results);
}

function generateRelatedCalculations(results) {
  const container = document.getElementById('related-calculations');
  container.innerHTML = '';
  
  const value = parseFloat(results.result);
  
  if (currentTool === 'ohm') {
    if (results.symbol === 'V') {
      // If we calculated voltage, suggest related calculations
      container.innerHTML = `
        <div style="padding:16px;background:rgba(45,212,255,0.08);border-radius:10px;border-left:3px solid var(--accent);">
          <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Related Calculations</div>
          <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
            With this voltage:<br>
            ‚Ä¢ At 10Œ©: I = ${(value/10).toFixed(2)}A, P = ${(value*value/10).toFixed(2)}W<br>
            ‚Ä¢ At 100Œ©: I = ${(value/100).toFixed(2)}A, P = ${(value*value/100).toFixed(2)}W
          </div>
        </div>
      `;
    }
  } else if (currentTool === 'power' && results.symbol === 'P') {
    // Show energy calculations for different times
    container.innerHTML = `
      <div style="padding:16px;background:rgba(57,255,20,0.08);border-radius:10px;border-left:3px solid #39ff14;">
        <div style="color:#39ff14;font-weight:600;margin-bottom:8px;">Energy Consumption</div>
        <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
          At ${value}W:<br>
          ‚Ä¢ 1 hour: ${value} Wh<br>
          ‚Ä¢ 1 day: ${(value*24).toFixed(0)} Wh<br>
          ‚Ä¢ 1 month: ${(value*24*30/1000).toFixed(1)} kWh
        </div>
      </div>
    `;
  }
}

function exportElectricalReport() {
  const tool = toolTemplates[currentTool].name;
  const result = document.getElementById('primary-result').textContent;
  const symbol = document.getElementById('result-symbol').textContent;
  const unit = document.getElementById('primary-unit').textContent;
  const calculation = document.getElementById('detailed-calculation').textContent;
  const realWorld = document.getElementById('real-world-context').textContent;
  
  const report = `
ELECTRICAL ENGINEERING CALCULATION REPORT
=========================================

Calculation: ${tool}
Date: ${new Date().toLocaleString()}

RESULT:
-------
${symbol} = ${result} ${unit}

DETAILED CALCULATION:
---------------------
${calculation}

REAL-WORLD CONTEXT:
-------------------
${realWorld}

ELECTRICAL FACTS:
----------------
‚Ä¢ Lightning temperature: 30,000 K (5√ó Sun's surface)
‚Ä¢ Single lightning bolt: ~1 billion joules
‚Ä¢ USB charger: 5V, 2.4A (12W)
‚Ä¢ Household outlet: 120/240V, 15-20A
‚Ä¢ LED bulb: 10W (vs 60W incandescent)
‚Ä¢ 1 kWh = 3.6 million joules

FORMULAS:
---------
‚Ä¢ Ohm's Law: V = I √ó R
‚Ä¢ Power: P = V √ó I
‚Ä¢ Energy: E = P √ó t
‚Ä¢ Series Resistance: R‚Çú = R‚ÇÅ + R‚ÇÇ + ...
‚Ä¢ Parallel Resistance: 1/R‚Çú = 1/R‚ÇÅ + 1/R‚ÇÇ + ...

NOTE: Professional electrical work should be performed by qualified electricians.
Always verify calculations with appropriate safety factors.

Generated by: The Most Useful Site in the World - Electrical Calculator
  `;
  
  const blob = new Blob([report], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const date = new Date().toISOString().split('T')[0];
  
  a.href = url;
  a.download = `Electrical_${currentTool}_${date}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

function copyElectricalResults() {
  const result = document.getElementById('primary-result').textContent;
  const symbol = document.getElementById('result-symbol').textContent;
  const unit = document.getElementById('primary-unit').textContent;
  
  const text = `${toolTemplates[currentTool].name}: ${symbol} = ${result} ${unit}`;
  
  navigator.clipboard.writeText(text).then(() => {
    const btn = event.target;
    const original = btn.innerHTML;
    btn.innerHTML = '‚úÖ Copied!';
    setTimeout(() => { btn.innerHTML = original; }, 2000);
  });
}

function resetElectricalCalculator() {
  loadToolInputs(currentTool);
  document.getElementById('results-section').style.display = 'none';
}

// Add hover effects
document.addEventListener('mouseover', function(e) {
  if (e.target.classList.contains('tool-btn')) {
    if (!e.target.classList.contains('active')) {
      e.target.style.transform = 'translateY(-4px)';
      e.target.style.boxShadow = '0 8px 25px rgba(45,212,255,0.15)';
    }
  }
});

document.addEventListener('mouseout', function(e) {
  if (e.target.classList.contains('tool-btn')) {
    if (!e.target.classList.contains('active')) {
      e.target.style.transform = 'translateY(0)';
      e.target.style.boxShadow = 'none';
    }
  }
});

</script>

<style>
/* Professional styling */
.tool-btn {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.tool-btn:hover {
  transform: translateY(-4px) !important;
  box-shadow: 0 8px 25px rgba(45,212,255,0.2) !important;
}

input {
  transition: all 0.2s ease;
}

input:focus {
  outline: none;
  border-color: var(--accent) !important;
  box-shadow: 0 0 0 2px rgba(45,212,255,0.2);
}

/* Smooth animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

#results-section {
  animation: fadeIn 0.5s ease-out;
}

/* Responsive design */
@media (max-width: 768px) {
  .tool-selector > div {
    grid-template-columns: repeat(2, 1fr) !important;
  }
  
  #input-section > div > div {
    grid-template-columns: 1fr !important;
  }
}

/* Print styles */
@media print {
  .tool-selector, button {
    display: none !important;
  }
  
  #results-section {
    display: block !important;
    border: none !important;
    padding: 0 !important;
  }
}

/* Professional typography */
#primary-result {
  font-variant-numeric: tabular-nums;
}
</style>
