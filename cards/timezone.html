<h2 id="timezone-converter-title">üåç Time Zone Converter</h2>

<form aria-describedby="timezone-converter-desc">
  <p id="timezone-converter-desc" class="small">
    Convert any date and time between time zones. 
    <span style="color:var(--accent)">Supports all major world time zones.</span>
  </p>
  
  <!-- Current Time Display -->
  <div style="margin-bottom:20px;padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;">
      <div style="color:var(--accent);font-weight:500;font-size:14px;">Current Times:</div>
      <div id="tz-current-times" style="font-family:monospace;font-size:13px;color:#e6faff;">
        Loading current times...
      </div>
    </div>
  </div>
  
  <!-- Date & Time Input -->
  <div class="field" style="margin-bottom:16px;">
    <label for="tz-datetime" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
      Date & Time
    </label>
    <input id="tz-datetime" type="datetime-local" 
           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;" />
    <div style="display:flex;gap:8px;margin-top:8px;">
      <button type="button" onclick="tzSetNow()" 
              style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">
        Use Current Time
      </button>
      <button type="button" onclick="tzSetBusinessHours()" 
              style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">
        09:00 AM
      </button>
    </div>
  </div>
  
  <!-- Time Zone Selection -->
  <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:12px;margin-bottom:16px;align-items:end;">
    <!-- From Zone -->
    <div>
      <label for="tz-from" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
        From Zone
      </label>
      <select id="tz-from" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
        <option value="UTC">UTC (Coordinated Universal Time)</option>
        <option value="America/New_York" selected>New York (EST/EDT)</option>
        <option value="America/Los_Angeles">Los Angeles (PST/PDT)</option>
        <option value="Europe/London">London (GMT/BST)</option>
        <option value="Europe/Paris">Paris (CET/CEST)</option>
        <option value="Asia/Tokyo">Tokyo (JST)</option>
        <option value="Australia/Sydney">Sydney (AEDT/AEST)</option>
        <option value="Asia/Dubai">Dubai (GST)</option>
        <option value="Asia/Shanghai">Shanghai (CST)</option>
        <option value="Asia/Kolkata">Mumbai (IST)</option>
      </select>
      <div id="tz-from-offset" style="font-size:12px;color:rgba(230,250,255,0.7);margin-top:4px;text-align:center;"></div>
    </div>
    
    <!-- Swap Button -->
    <div style="text-align:center;padding-bottom:8px;">
      <button type="button" onclick="tzSwapZones()" 
              style="background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;padding:8px 12px;font-size:16px;"
              title="Swap time zones">
        ‚áÑ
      </button>
    </div>
    
    <!-- To Zone -->
    <div>
      <label for="tz-to" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
        To Zone
      </label>
      <select id="tz-to" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
        <option value="UTC">UTC (Coordinated Universal Time)</option>
        <option value="America/New_York">New York (EST/EDT)</option>
        <option value="America/Los_Angeles">Los Angeles (PST/PDT)</option>
        <option value="Europe/London" selected>London (GMT/BST)</option>
        <option value="Europe/Paris">Paris (CET/CEST)</option>
        <option value="Asia/Tokyo">Tokyo (JST)</option>
        <option value="Australia/Sydney">Sydney (AEDT/AEST)</option>
        <option value="Asia/Dubai">Dubai (GST)</option>
        <option value="Asia/Shanghai">Shanghai (CST)</option>
        <option value="Asia/Kolkata">Mumbai (IST)</option>
      </select>
      <div id="tz-to-offset" style="font-size:12px;color:rgba(230,250,255,0.7);margin-top:4px;text-align:center;"></div>
    </div>
  </div>
  
  <!-- Quick Time Zones -->
  <div style="margin-bottom:20px;">
    <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">Quick Select:</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
      <button type="button" onclick="tzSetQuick('America/New_York', 'Europe/London')" 
              style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">
        NY ‚Üí London
      </button>
      <button type="button" onclick="tzSetQuick('America/Los_Angeles', 'Asia/Tokyo')" 
              style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">
        LA ‚Üí Tokyo
      </button>
      <button type="button" onclick="tzSetQuick('Europe/London', 'Australia/Sydney')" 
              style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">
        London ‚Üí Sydney
      </button>
      <button type="button" onclick="tzSetQuick('UTC', 'Asia/Kolkata')" 
              style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">
        UTC ‚Üí Mumbai
      </button>
    </div>
  </div>
  
  <!-- Actions -->
  <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
    <button type="button" onclick="tzCalculate()" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      Convert Time
    </button>
    <button type="button" onclick="tzReset()"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset
    </button>
  </div>
</form>

<!-- Results -->
<div class="results" aria-live="polite" style="margin-top:16px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üïí Conversion Result</h3>
  
  <div id="tz-output" style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);font-family:monospace;white-space:pre-line;">
    Enter a date and time to convert.
  </div>
  
  <!-- Additional Time Information -->
  <div id="tz-additional" style="margin-top:12px;display:none;">
    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid rgba(255,255,255,0.06);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Time Difference</div>
        <div id="tz-difference" style="font-weight:600;color:#39ff14;"></div>
      </div>
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid rgba(255,255,255,0.06);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Day of Week</div>
        <div id="tz-day" style="font-weight:600;color:#2dd4ff;"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* timezone-converter.html
   - Time zone converter with comprehensive zone support
   - Scoped with tz- prefix
   - Supports current time display and offsets
*/

// Cache DOM elements
let tzElements = {};

// Initialize on load
function tzInitialize() {
    const card = document.currentScript?.closest('.card') || document;
    
    // Cache elements
    tzElements = {
        datetime: card.querySelector('#tz-datetime'),
        fromZone: card.querySelector('#tz-from'),
        toZone: card.querySelector('#tz-to'),
        output: card.querySelector('#tz-output'),
        additional: card.querySelector('#tz-additional'),
        difference: card.querySelector('#tz-difference'),
        day: card.querySelector('#tz-day'),
        fromOffset: card.querySelector('#tz-from-offset'),
        toOffset: card.querySelector('#tz-to-offset'),
        currentTimes: card.querySelector('#tz-current-times')
    };
    
    // Set default to current time
    tzSetNow();
    
    // Update time zone offsets
    tzUpdateOffsets();
    
    // Start current time updater
    tzUpdateCurrentTimes();
    setInterval(tzUpdateCurrentTimes, 30000); // Update every 30 seconds
    
    // Auto-convert when inputs change
    tzElements.datetime.addEventListener('change', tzCalculate);
    tzElements.fromZone.addEventListener('change', function() {
        tzUpdateOffsets();
        tzCalculate();
    });
    tzElements.toZone.addEventListener('change', function() {
        tzUpdateOffsets();
        tzCalculate();
    });
    
    console.log('Timezone Converter initialized');
}

// Format timezone offset
function tzFormatOffset(offset) {
    const hours = Math.floor(Math.abs(offset) / 60);
    const minutes = Math.abs(offset) % 60;
    const sign = offset >= 0 ? '+' : '-';
    return `UTC${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
}

// Update timezone offset displays
function tzUpdateOffsets() {
    try {
        const now = new Date();
        
        // From zone offset
        const fromZone = tzElements.fromZone.value;
        const fromTime = new Date(now.toLocaleString('en-US', { timeZone: fromZone }));
        const fromOffset = (fromTime - now) / 60000; // Convert to minutes
        tzElements.fromOffset.textContent = tzFormatOffset(fromOffset);
        
        // To zone offset
        const toZone = tzElements.toZone.value;
        const toTime = new Date(now.toLocaleString('en-US', { timeZone: toZone }));
        const toOffset = (toTime - now) / 60000;
        tzElements.toOffset.textContent = tzFormatOffset(toOffset);
    } catch (e) {
        console.error('Error updating offsets:', e);
    }
}

// Update current times display
function tzUpdateCurrentTimes() {
    try {
        const now = new Date();
        const zones = ['UTC', 'America/New_York', 'Europe/London', 'Asia/Tokyo'];
        
        const times = zones.map(zone => {
            const timeStr = now.toLocaleTimeString('en-US', { 
                timeZone: zone, 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit'
            });
            const zoneAbbr = zone.split('/').pop();
            return `${zoneAbbr}: ${timeStr}`;
        }).join(' ‚Ä¢ ');
        
        tzElements.currentTimes.textContent = times;
    } catch (e) {
        tzElements.currentTimes.textContent = 'Unable to load current times';
    }
}

// Set to current time
function tzSetNow() {
    const now = new Date();
    // Format for datetime-local input (YYYY-MM-DDTHH:mm)
    const year = now.getFullYear();
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const day = now.getDate().toString().padStart(2, '0');
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    
    tzElements.datetime.value = `${year}-${month}-${day}T${hours}:${minutes}`;
    tzCalculate();
}

// Set to business hours
function tzSetBusinessHours() {
    const now = new Date();
    const year = now.getFullYear();
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const day = now.getDate().toString().padStart(2, '0');
    
    tzElements.datetime.value = `${year}-${month}-${day}T09:00`;
    tzCalculate();
}

// Swap time zones
function tzSwapZones() {
    const fromValue = tzElements.fromZone.value;
    const toValue = tzElements.toZone.value;
    
    tzElements.fromZone.value = toValue;
    tzElements.toZone.value = fromValue;
    
    tzUpdateOffsets();
    tzCalculate();
}

// Set quick preset
function tzSetQuick(from, to) {
    tzElements.fromZone.value = from;
    tzElements.toZone.value = to;
    
    tzUpdateOffsets();
    tzCalculate();
}

// Main calculation function
function tzCalculate() {
    const datetime = tzElements.datetime.value;
    const fromZone = tzElements.fromZone.value;
    const toZone = tzElements.toZone.value;
    
    if (!datetime) {
        tzElements.output.textContent = "Please enter a date and time.";
        tzElements.additional.style.display = 'none';
        return;
    }
    
    try {
        // Parse input date (datetime-local input gives us local time in the fromZone context)
        const localDate = new Date(datetime);
        
        // Create date strings for the source timezone
        const fromOptions = { 
            timeZone: fromZone, 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit', 
            minute: '2-digit',
            hour12: false,
            timeZoneName: 'short'
        };
        
        const fromDateStr = localDate.toLocaleString('en-US', fromOptions);
        
        // Convert to target timezone
        const toOptions = { 
            timeZone: toZone, 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric',
            hour: '2-digit', 
            minute: '2-digit',
            hour12: false,
            timeZoneName: 'short'
        };
        
        const toDateStr = new Intl.DateTimeFormat('en-US', toOptions).format(localDate);
        
        // Calculate time difference
        const fromTime = new Date(localDate.toLocaleString('en-US', { timeZone: fromZone }));
        const toTime = new Date(localDate.toLocaleString('en-US', { timeZone: toZone }));
        const diffMinutes = (toTime - fromTime) / 60000;
        const diffHours = diffMinutes / 60;
        
        // Get day of week
        const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const dayOfWeek = dayNames[toTime.getDay()];
        
        // Format difference string
        let diffStr;
        if (Math.abs(diffHours) < 1) {
            diffStr = `${Math.abs(diffMinutes)} minute${Math.abs(diffMinutes) !== 1 ? 's' : ''} ${diffMinutes > 0 ? 'ahead' : 'behind'}`;
        } else {
            const hours = Math.floor(Math.abs(diffHours));
            const minutes = Math.floor(Math.abs(diffMinutes) % 60);
            diffStr = `${hours}h${minutes > 0 ? ` ${minutes}m` : ''} ${diffHours > 0 ? 'ahead' : 'behind'}`;
        }
        
        // Format output
        const output = `üïê FROM (${fromZone.split('/').pop()}):\n${fromDateStr}\n\n` +
                      `üïê TO (${toZone.split('/').pop()}):\n${toDateStr}\n\n` +
                      `‚è±Ô∏è  Time difference: ${diffStr}`;
        
        tzElements.output.textContent = output;
        
        // Show additional info
        tzElements.difference.textContent = diffStr;
        tzElements.day.textContent = dayOfWeek;
        tzElements.additional.style.display = 'block';
        
    } catch (error) {
        console.error('Timezone conversion error:', error);
        tzElements.output.textContent = "Error: Unable to convert time zone. Please check your inputs.";
        tzElements.additional.style.display = 'none';
    }
}

// Reset function
function tzReset() {
    tzElements.datetime.value = '';
    tzElements.fromZone.value = 'America/New_York';
    tzElements.toZone.value = 'Europe/London';
    tzElements.output.textContent = 'Enter a date and time to convert.';
    tzElements.additional.style.display = 'none';
    
    tzUpdateOffsets();
    tzSetNow(); // Reset to current time
}

// Initialize on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', tzInitialize);
} else {
    tzInitialize();
}
</script>

<style>
/* Card-specific styles */
#timezone-converter-title {
    color: var(--accent);
    margin-top: 0;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .tz-quick-select {
        flex-direction: column;
    }
    
    .tz-quick-select button {
        width: 100%;
    }
    
    .tz-time-display {
        flex-direction: column;
        gap: 8px;
    }
    
    .tz-time-display > div {
        width: 100%;
    }
}

/* Scrollbar styling for timezone selects */
select {
    scrollbar-width: thin;
    scrollbar-color: rgba(45,212,255,0.3) transparent;
}

select::-webkit-scrollbar {
    width: 8px;
}

select::-webkit-scrollbar-track {
    background: transparent;
}

select::-webkit-scrollbar-thumb {
    background-color: rgba(45,212,255,0.3);
    border-radius: 4px;
}
</style>
