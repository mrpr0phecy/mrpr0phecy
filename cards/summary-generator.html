<div class="card" id="summary-generator-card">
  <!-- Header -->
  <div class="card-header">
    <div class="header-content">
      <div class="header-icon">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          <path d="M13 8H7"></path>
          <path d="M17 12H7"></path>
        </svg>
      </div>
      <div>
        <h2 class="card-title">AI-Style Summary Generator</h2>
        <p class="card-subtitle">
          Generate intelligent summaries using advanced text analysis algorithms
        </p>
      </div>
    </div>
    <div class="header-actions">
      <div class="header-badge">
        <span class="badge-text">Client-side</span>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="card-body">
    <!-- Input Section -->
    <div class="input-section">
      <div class="section-header">
        <h3 class="section-title">Input Text</h3>
        <div class="text-metrics">
          <span class="metric-item">
            <span class="metric-value" id="word-count">0</span>
            <span class="metric-label">words</span>
          </span>
          <span class="metric-item">
            <span class="metric-value" id="sentence-count">0</span>
            <span class="metric-label">sentences</span>
          </span>
          <span class="metric-item">
            <span class="metric-value" id="para-count">0</span>
            <span class="metric-label">paragraphs</span>
          </span>
        </div>
      </div>
      
      <div class="input-container">
        <textarea 
          id="input-text" 
          class="text-input" 
          placeholder="Paste your article, essay, notes, or any text here..." 
          rows="8"
          spellcheck="true"
        ></textarea>
        <div class="input-actions">
          <button class="btn-icon" onclick="clearInput()" title="Clear text">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
          <button class="btn-icon" onclick="loadSample()" title="Load sample text">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 12a9 9 0 0 1-9 9"></path>
              <path d="M12 21a9 9 0 0 1-9-9"></path>
              <path d="M21 12a9 9 0 0 0-9-9"></path>
              <path d="M12 21a9 9 0 0 0 9-9"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Settings Panel -->
    <div class="settings-section">
      <div class="section-header">
        <h3 class="section-title">Summary Settings</h3>
        <button class="btn-text" onclick="toggleAdvancedSettings()">
          <span id="advanced-toggle">Show Advanced</span>
        </button>
      </div>
      
      <div class="settings-grid">
        <!-- Mode Selection -->
        <div class="setting-group">
          <label class="setting-label">Summary Mode</label>
          <div class="mode-selector">
            <div class="mode-grid">
              <button class="mode-card active" data-mode="extractive" onclick="selectMode('extractive')">
                <div class="mode-icon">üìä</div>
                <div class="mode-name">Extractive</div>
                <div class="mode-desc">Key sentences</div>
              </button>
              <button class="mode-card" data-mode="abstractive" onclick="selectMode('abstractive')">
                <div class="mode-icon">ü§ñ</div>
                <div class="mode-name">Abstractive</div>
                <div class="mode-desc">AI-style rewrite</div>
              </button>
              <button class="mode-card" data-mode="tldr" onclick="selectMode('tldr')">
                <div class="mode-icon">üöÄ</div>
                <div class="mode-name">TL;DR</div>
                <div class="mode-desc">One sentence</div>
              </button>
              <button class="mode-card" data-mode="bullets" onclick="selectMode('bullets')">
                <div class="mode-icon">üìù</div>
                <div class="mode-name">Bullets</div>
                <div class="mode-desc">Key points</div>
              </button>
            </div>
          </div>
        </div>

        <!-- Length Control -->
        <div class="setting-group">
          <label class="setting-label">Summary Length</label>
          <div class="length-control">
            <div class="length-slider-container">
              <input 
                type="range" 
                id="length-slider" 
                min="5" 
                max="80" 
                value="30" 
                class="range-slider"
              >
              <div class="slider-labels">
                <span>Very Short</span>
                <span id="length-value">30%</span>
                <span>Very Long</span>
              </div>
            </div>
            <div class="length-presets">
              <button class="preset-btn" data-preset="10">10%</button>
              <button class="preset-btn" data-preset="20">20%</button>
              <button class="preset-btn active" data-preset="30">30%</button>
              <button class="preset-btn" data-preset="50">50%</button>
            </div>
          </div>
        </div>

        <!-- Advanced Settings -->
        <div id="advanced-settings" class="advanced-settings" style="display: none;">
          <div class="setting-group">
            <label class="setting-label">Advanced Options</label>
            <div class="options-grid">
              <label class="option-toggle">
                <input type="checkbox" id="opt-preserve-order" checked>
                <span class="toggle-slider"></span>
                <span class="option-label">Preserve order</span>
              </label>
              <label class="option-toggle">
                <input type="checkbox" id="opt-highlight-keywords">
                <span class="toggle-slider"></span>
                <span class="option-label">Highlight keywords</span>
              </label>
              <label class="option-toggle">
                <input type="checkbox" id="opt-remove-redundancy" checked>
                <span class="toggle-slider"></span>
                <span class="option-label">Remove redundancy</span>
              </label>
              <label class="option-toggle">
                <input type="checkbox" id="opt-show-explanations">
                <span class="toggle-slider"></span>
                <span class="option-label">Show explanations</span>
              </label>
            </div>
          </div>

          <div class="setting-group">
            <label class="setting-label">Output Format</label>
            <div class="format-selector">
              <button class="format-btn active" data-format="text">Plain Text</button>
              <button class="format-btn" data-format="markdown">Markdown</button>
              <button class="format-btn" data-format="html">HTML</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-section">
      <div class="action-buttons">
        <button class="btn btn-primary" onclick="generateSummary()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
          Generate Summary
        </button>
        <button class="btn btn-secondary" onclick="analyzeText()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
          </svg>
          Analyze Text
        </button>
        <div class="action-divider">or</div>
        <div class="quick-actions">
          <button class="btn btn-outline" onclick="quickSummary('tldr')">TL;DR</button>
          <button class="btn btn-outline" onclick="quickSummary('bullets')">Bullets</button>
          <button class="btn btn-outline" onclick="quickSummary('keywords')">Keywords</button>
        </div>
      </div>
    </div>

    <!-- Output Section -->
    <div class="output-section">
      <div class="section-header">
        <div class="output-header">
          <h3 class="section-title">Generated Summary</h3>
          <div class="compression-badge">
            <span class="compression-label">Compression</span>
            <span class="compression-value" id="compression-rate">0%</span>
          </div>
        </div>
        <div class="output-actions">
          <button class="btn-icon" onclick="copyToClipboard()" title="Copy to clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
          </button>
          <button class="btn-icon" onclick="exportSummary()" title="Export summary">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
          </button>
          <button class="btn-icon" onclick="clearOutput()" title="Clear output">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
      </div>
      
      <div class="output-container">
        <div id="output-placeholder" class="output-placeholder">
          <div class="placeholder-content">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
            <h4>No summary generated yet</h4>
            <p>Enter text and click "Generate Summary" to see results</p>
          </div>
        </div>
        <div id="output-content" class="output-content" style="display: none;">
          <div class="output-metrics">
            <div class="output-metric">
              <span class="metric-label">Original</span>
              <span class="metric-value" id="original-stats">‚Äì</span>
            </div>
            <div class="output-metric">
              <span class="metric-label">Summary</span>
              <span class="metric-value" id="summary-stats">‚Äì</span>
            </div>
            <div class="output-metric">
              <span class="metric-label">Time Saved</span>
              <span class="metric-value" id="time-saved">‚Äì</span>
            </div>
          </div>
          <div id="summary-output" class="summary-output"></div>
        </div>
      </div>
    </div>

    <!-- Analysis Details -->
    <div id="analysis-details" class="analysis-section" style="display: none;">
      <div class="section-header">
        <h3 class="section-title">Analysis Details</h3>
        <button class="btn-icon" onclick="toggleAnalysis()">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="18 15 12 9 6 15"></polyline>
          </svg>
        </button>
      </div>
      
      <div class="analysis-content">
        <div class="analysis-grid">
          <div class="analysis-card">
            <div class="analysis-header">
              <div class="analysis-title">Top Keywords</div>
              <div class="analysis-score" id="keyword-count">0</div>
            </div>
            <div id="keyword-list" class="keyword-list"></div>
          </div>
          
          <div class="analysis-card">
            <div class="analysis-header">
              <div class="analysis-title">Text Analysis</div>
              <div class="analysis-score" id="readability-score">‚Äì</div>
            </div>
            <div class="analysis-metrics">
              <div class="analysis-metric">
                <span class="metric-name">Sentiment</span>
                <span class="metric-value" id="sentiment-value">‚Äì</span>
              </div>
              <div class="analysis-metric">
                <span class="metric-name">Complexity</span>
                <span class="metric-value" id="complexity-value">‚Äì</span>
              </div>
              <div class="analysis-metric">
                <span class="metric-name">Formality</span>
                <span class="metric-value" id="formality-value">‚Äì</span>
              </div>
            </div>
          </div>
          
          <div class="analysis-card">
            <div class="analysis-header">
              <div class="analysis-title">Sentence Scores</div>
              <div class="analysis-score" id="avg-score">0.00</div>
            </div>
            <div id="sentence-scores" class="scores-list"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="card-footer">
    <div class="footer-content">
      <div class="footer-text">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        Uses advanced NLP algorithms ‚Ä¢ Works offline ‚Ä¢ Data stays private
      </div>
      <div class="footer-links">
        <button class="footer-link" onclick="showAlgorithmInfo()">How it works</button>
        <button class="footer-link" onclick="showExamples()">Examples</button>
        <button class="footer-link" onclick="resetSettings()">Reset settings</button>
      </div>
    </div>
  </div>
</div>

<style>
/* Design System Variables */
:root {
  --primary-color: #8b5cf6;
  --primary-light: #a78bfa;
  --primary-dark: #7c3aed;
  --secondary-color: #10b981;
  --danger-color: #ef4444;
  --warning-color: #f59e0b;
  --info-color: #3b82f6;
  --surface-color: #1f2937;
  --surface-light: #374151;
  --surface-lighter: #4b5563;
  --surface-dark: #111827;
  --text-primary: #f9fafb;
  --text-secondary: #d1d5db;
  --text-tertiary: #9ca3af;
  --border-color: #374151;
  --border-light: #4b5563;
  --border-radius: 8px;
  --border-radius-sm: 6px;
  --border-radius-lg: 12px;
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 12px;
  --spacing-lg: 16px;
  --spacing-xl: 24px;
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  --transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Base Card Styles */
.card {
  background: var(--surface-color);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-xl);
  transition: var(--transition);
}

.card:hover {
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
}

/* Card Header */
.card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: var(--spacing-xl);
  border-bottom: 1px solid var(--border-color);
  background: linear-gradient(135deg, 
    rgba(139, 92, 246, 0.1) 0%, 
    rgba(139, 92, 246, 0.05) 50%, 
    rgba(139, 92, 246, 0.02) 100%);
}

.header-content {
  display: flex;
  align-items: center;
  gap: var(--spacing-lg);
}

.header-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  background: rgba(139, 92, 246, 0.1);
  border-radius: var(--border-radius);
  color: var(--primary-color);
  flex-shrink: 0;
}

.card-title {
  margin: 0;
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1.2;
  background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.card-subtitle {
  margin: var(--spacing-xs) 0 0;
  font-size: 0.875rem;
  color: var(--text-tertiary);
  line-height: 1.4;
  max-width: 600px;
}

.header-badge {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
}

.badge-text {
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(16, 185, 129, 0.1);
  border: 1px solid rgba(16, 185, 129, 0.2);
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--secondary-color);
}

/* Card Body */
.card-body {
  padding: var(--spacing-xl);
}

/* Input Section */
.input-section {
  margin-bottom: var(--spacing-xl);
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-lg);
}

.section-title {
  margin: 0;
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
}

.text-metrics {
  display: flex;
  gap: var(--spacing-lg);
}

.metric-item {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.metric-value {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--primary-color);
}

.metric-label {
  font-size: 0.75rem;
  color: var(--text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.input-container {
  position: relative;
}

.text-input {
  width: 100%;
  padding: var(--spacing-lg);
  background: var(--surface-dark);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  color: var(--text-primary);
  font-size: 0.95rem;
  line-height: 1.6;
  resize: vertical;
  transition: var(--transition);
}

.text-input:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

.text-input::placeholder {
  color: var(--text-tertiary);
}

.input-actions {
  position: absolute;
  bottom: var(--spacing-md);
  right: var(--spacing-md);
  display: flex;
  gap: var(--spacing-xs);
}

.btn-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--border-light);
  border-radius: var(--border-radius-sm);
  color: var(--text-tertiary);
  cursor: pointer;
  transition: var(--transition);
}

.btn-icon:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-secondary);
  border-color: var(--primary-light);
}

/* Settings Section */
.settings-section {
  margin-bottom: var(--spacing-xl);
  padding: var(--spacing-lg);
  background: var(--surface-dark);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
}

.settings-grid {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xl);
}

.setting-group {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.setting-label {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Mode Selector */
.mode-selector {
  margin-top: var(--spacing-xs);
}

.mode-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--spacing-md);
}

.mode-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--spacing-lg);
  background: var(--surface-color);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: var(--transition);
}

.mode-card:hover {
  transform: translateY(-2px);
  border-color: var(--primary-light);
  background: rgba(139, 92, 246, 0.05);
}

.mode-card.active {
  background: rgba(139, 92, 246, 0.1);
  border-color: var(--primary-color);
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.1);
}

.mode-icon {
  font-size: 1.5rem;
  margin-bottom: var(--spacing-sm);
}

.mode-name {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--spacing-xs);
}

.mode-desc {
  font-size: 0.75rem;
  color: var(--text-tertiary);
  text-align: center;
}

/* Length Control */
.length-control {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.length-slider-container {
  margin-top: var(--spacing-sm);
}

.range-slider {
  width: 100%;
  height: 6px;
  background: var(--surface-light);
  border-radius: 3px;
  outline: none;
  -webkit-appearance: none;
}

.range-slider::-webkit-slider-thumb {
  width: 20px;
  height: 20px;
  background: var(--primary-color);
  border-radius: 50%;
  cursor: pointer;
  -webkit-appearance: none;
  border: 2px solid var(--surface-color);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.slider-labels {
  display: flex;
  justify-content: space-between;
  margin-top: var(--spacing-xs);
  font-size: 0.75rem;
  color: var(--text-tertiary);
}

#length-value {
  font-weight: 600;
  color: var(--primary-color);
}

.length-presets {
  display: flex;
  gap: var(--spacing-sm);
}

.preset-btn {
  padding: var(--spacing-xs) var(--spacing-md);
  background: var(--surface-light);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  color: var(--text-secondary);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}

.preset-btn:hover {
  background: var(--surface-lighter);
  color: var(--text-primary);
}

.preset-btn.active {
  background: var(--primary-color);
  color: white;
  border-color: var(--primary-color);
}

/* Advanced Settings */
.advanced-settings {
  padding-top: var(--spacing-lg);
  border-top: 1px solid var(--border-color);
}

.options-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: var(--spacing-md);
}

.option-toggle {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  cursor: pointer;
}

.option-toggle input {
  display: none;
}

.toggle-slider {
  position: relative;
  width: 36px;
  height: 20px;
  background: var(--surface-light);
  border-radius: 10px;
  transition: var(--transition);
}

.toggle-slider:before {
  content: '';
  position: absolute;
  width: 16px;
  height: 16px;
  background: var(--text-tertiary);
  border-radius: 50%;
  top: 2px;
  left: 2px;
  transition: var(--transition);
}

.option-toggle input:checked + .toggle-slider {
  background: rgba(139, 92, 246, 0.3);
}

.option-toggle input:checked + .toggle-slider:before {
  background: var(--primary-color);
  transform: translateX(16px);
}

.option-label {
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.format-selector {
  display: flex;
  gap: var(--spacing-xs);
}

.format-btn {
  padding: var(--spacing-xs) var(--spacing-md);
  background: var(--surface-light);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  color: var(--text-secondary);
  font-size: 0.75rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}

.format-btn:hover {
  background: var(--surface-lighter);
  color: var(--text-primary);
}

.format-btn.active {
  background: var(--primary-color);
  color: white;
  border-color: var(--primary-color);
}

/* Action Section */
.action-section {
  margin-bottom: var(--spacing-xl);
}

.action-buttons {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--spacing-lg);
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  padding: var(--spacing-md) var(--spacing-xl);
  border: none;
  border-radius: var(--border-radius);
  font-size: 0.875rem;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
  color: white;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
}

.btn-secondary {
  background: var(--surface-light);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
}

.btn-secondary:hover {
  background: var(--surface-lighter);
  border-color: var(--primary-light);
  transform: translateY(-1px);
}

.btn-outline {
  background: transparent;
  color: var(--text-secondary);
  border: 1px solid var(--border-color);
}

.btn-outline:hover {
  color: var(--text-primary);
  border-color: var(--primary-light);
  background: rgba(139, 92, 246, 0.05);
}

.btn-text {
  background: none;
  border: none;
  color: var(--primary-color);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--border-radius-sm);
  transition: var(--transition);
}

.btn-text:hover {
  background: rgba(139, 92, 246, 0.1);
}

.action-divider {
  color: var(--text-tertiary);
  font-size: 0.75rem;
}

.quick-actions {
  display: flex;
  gap: var(--spacing-sm);
}

/* Output Section */
.output-section {
  margin-bottom: var(--spacing-xl);
}

.output-header {
  display: flex;
  align-items: center;
  gap: var(--spacing-lg);
}

.compression-badge {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(16, 185, 129, 0.1);
  border: 1px solid rgba(16, 185, 129, 0.2);
  border-radius: 9999px;
}

.compression-label {
  font-size: 0.75rem;
  color: var(--text-tertiary);
}

.compression-value {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--secondary-color);
}

.output-actions {
  display: flex;
  gap: var(--spacing-xs);
}

.output-container {
  background: var(--surface-dark);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  min-height: 200px;
  position: relative;
}

.output-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 200px;
}

.placeholder-content {
  text-align: center;
  color: var(--text-tertiary);
}

.placeholder-content svg {
  margin-bottom: var(--spacing-lg);
  color: var(--surface-lighter);
}

.placeholder-content h4 {
  margin: 0 0 var(--spacing-xs);
  color: var(--text-secondary);
}

.placeholder-content p {
  margin: 0;
  font-size: 0.875rem;
}

.output-content {
  padding: var(--spacing-lg);
}

.output-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--spacing-lg);
  margin-bottom: var(--spacing-lg);
  padding-bottom: var(--spacing-lg);
  border-bottom: 1px solid var(--border-color);
}

.output-metric {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.summary-output {
  font-size: 0.95rem;
  line-height: 1.6;
  color: var(--text-primary);
}

.summary-output .keyword {
  background: rgba(255, 235, 59, 0.2);
  padding: 1px 4px;
  border-radius: 3px;
  font-weight: 500;
  color: #ffd700;
}

.summary-output .score-badge {
  display: inline-block;
  padding: 1px 6px;
  background: rgba(139, 92, 246, 0.2);
  border-radius: 10px;
  font-size: 0.7rem;
  margin-left: var(--spacing-xs);
  color: var(--primary-color);
}

/* Analysis Section */
.analysis-section {
  margin-bottom: var(--spacing-xl);
}

.analysis-content {
  background: var(--surface-dark);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  overflow: hidden;
}

.analysis-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--spacing-lg);
  padding: var(--spacing-lg);
}

.analysis-card {
  background: var(--surface-color);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  padding: var(--spacing-lg);
}

.analysis-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--spacing-lg);
}

.analysis-title {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.analysis-score {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--primary-color);
}

.keyword-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-xs);
}

.keyword-item {
  padding: var(--spacing-xs) var(--spacing-sm);
  background: rgba(139, 92, 246, 0.1);
  border: 1px solid rgba(139, 92, 246, 0.2);
  border-radius: 9999px;
  font-size: 0.75rem;
  color: var(--primary-color);
}

.analysis-metrics {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
}

.analysis-metric {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-xs) 0;
  border-bottom: 1px solid var(--border-color);
}

.analysis-metric:last-child {
  border-bottom: none;
}

.metric-name {
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.metric-value {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
}

.scores-list {
  max-height: 150px;
  overflow-y: auto;
}

.score-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm);
  border-bottom: 1px solid var(--border-color);
}

.score-item:last-child {
  border-bottom: none;
}

.score-text {
  font-size: 0.75rem;
  color: var(--text-secondary);
  flex: 1;
  margin-right: var(--spacing-sm);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.score-value {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--primary-color);
  min-width: 40px;
  text-align: right;
}

/* Card Footer */
.card-footer {
  padding: var(--spacing-lg) var(--spacing-xl);
  border-top: 1px solid var(--border-color);
  background: rgba(0, 0, 0, 0.1);
}

.footer-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: var(--spacing-md);
}

.footer-text {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-size: 0.75rem;
  color: var(--text-tertiary);
}

.footer-links {
  display: flex;
  gap: var(--spacing-lg);
}

.footer-link {
  background: none;
  border: none;
  color: var(--text-tertiary);
  font-size: 0.75rem;
  cursor: pointer;
  transition: var(--transition);
}

.footer-link:hover {
  color: var(--primary-color);
}

/* Scrollbar Styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.1);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--surface-lighter);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--primary-light);
}

/* Responsive Design */
@media (max-width: 768px) {
  .card-header {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--spacing-lg);
  }
  
  .header-actions {
    align-self: flex-start;
  }
  
  .mode-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .action-buttons {
    flex-direction: column;
    align-items: stretch;
  }
  
  .quick-actions {
    justify-content: center;
  }
  
  .footer-content {
    flex-direction: column;
    text-align: center;
  }
  
  .footer-links {
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .card-header,
  .card-body {
    padding: var(--spacing-lg);
  }
  
  .mode-grid {
    grid-template-columns: 1fr;
  }
  
  .analysis-grid {
    grid-template-columns: 1fr;
  }
  
  .output-metrics {
    grid-template-columns: 1fr;
  }
}
</style>

<script>
// Summary Generator Application
class SummaryGenerator {
  constructor() {
    this.currentMode = 'extractive';
    this.currentLength = 30;
    this.currentFormat = 'text';
    this.analysis = null;
    this.summary = null;
    this.textStats = { words: 0, sentences: 0, paragraphs: 0 };
    
    this.STOPWORDS = new Set([
      'a', 'about', 'above', 'after', 'again', 'against', 'all', 'am', 'an', 'and', 'any', 'are', 
      'aren\'t', 'as', 'at', 'be', 'because', 'been', 'before', 'being', 'below', 'between', 
      'both', 'but', 'by', 'can\'t', 'cannot', 'could', 'couldn\'t', 'did', 'didn\'t', 'do', 
      'does', 'doesn\'t', 'doing', 'don\'t', 'down', 'during', 'each', 'few', 'for', 'from', 
      'further', 'had', 'hadn\'t', 'has', 'hasn\'t', 'have', 'haven\'t', 'having', 'he', 
      'he\'d', 'he\'ll', 'he\'s', 'her', 'here', 'here\'s', 'hers', 'herself', 'him', 
      'himself', 'his', 'how', 'how\'s', 'i', 'i\'d', 'i\'ll', 'i\'m', 'i\'ve', 'if', 'in', 
      'into', 'is', 'isn\'t', 'it', 'it\'s', 'its', 'itself', 'let\'s', 'me', 'more', 'most', 
      'mustn\'t', 'my', 'myself', 'no', 'nor', 'not', 'of', 'off', 'on', 'once', 'only', 'or', 
      'other', 'ought', 'our', 'ours', 'ourselves', 'out', 'over', 'own', 'same', 'shan\'t', 
      'she', 'she\'d', 'she\'ll', 'she\'s', 'should', 'shouldn\'t', 'so', 'some', 'such', 
      'than', 'that', 'that\'s', 'the', 'their', 'theirs', 'them', 'themselves', 'then', 
      'there', 'there\'s', 'these', 'they', 'they\'d', 'they\'ll', 'they\'re', 'they\'ve', 
      'this', 'those', 'through', 'to', 'too', 'under', 'until', 'up', 'very', 'was', 
      'wasn\'t', 'we', 'we\'d', 'we\'ll', 'we\'re', 'we\'ve', 'were', 'weren\'t', 'what', 
      'what\'s', 'when', 'when\'s', 'where', 'where\'s', 'which', 'while', 'who', 'who\'s', 
      'whom', 'why', 'why\'s', 'with', 'won\'t', 'would', 'wouldn\'t', 'you', 'you\'d', 
      'you\'ll', 'you\'re', 'you\'ve', 'your', 'yours', 'yourself', 'yourselves'
    ]);
    
    this.init();
  }
  
  init() {
    // Set up event listeners
    document.getElementById('input-text').addEventListener('input', () => this.updateTextStats());
    document.getElementById('length-slider').addEventListener('input', (e) => this.updateLengthValue(e.target.value));
    
    // Set up preset buttons
    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const value = parseInt(e.target.dataset.preset);
        this.setLengthPreset(value);
      });
    });
    
    // Set up format buttons
    document.querySelectorAll('.format-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        this.selectFormat(e.target.dataset.format);
      });
    });
    
    // Initialize text stats
    this.updateTextStats();
  }
  
  updateTextStats() {
    const text = document.getElementById('input-text').value.trim();
    
    if (!text) {
      this.textStats = { words: 0, sentences: 0, paragraphs: 0 };
      document.getElementById('word-count').textContent = '0';
      document.getElementById('sentence-count').textContent = '0';
      document.getElementById('para-count').textContent = '0';
      return;
    }
    
    // Count words
    const words = text.match(/\b\w+\b/g) || [];
    
    // Count sentences (improved detection)
    const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
    
    // Count paragraphs
    const paragraphs = text.split(/\n\s*\n/).filter(p => p.trim().length > 0);
    
    this.textStats = {
      words: words.length,
      sentences: sentences.length,
      paragraphs: paragraphs.length
    };
    
    document.getElementById('word-count').textContent = words.length.toLocaleString();
    document.getElementById('sentence-count').textContent = sentences.length.toLocaleString();
    document.getElementById('para-count').textContent = paragraphs.length.toLocaleString();
  }
  
  selectMode(mode) {
    this.currentMode = mode;
    
    // Update UI
    document.querySelectorAll('.mode-card').forEach(card => {
      card.classList.toggle('active', card.dataset.mode === mode);
    });
    
    // Update mode description if needed
    this.updateModeInfo();
  }
  
  updateLengthValue(value) {
    this.currentLength = parseInt(value);
    document.getElementById('length-value').textContent = `${value}%`;
    
    // Update preset buttons
    document.querySelectorAll('.preset-btn').forEach(btn => {
      btn.classList.toggle('active', parseInt(btn.dataset.preset) === this.currentLength);
    });
  }
  
  setLengthPreset(value) {
    this.currentLength = value;
    document.getElementById('length-slider').value = value;
    this.updateLengthValue(value);
  }
  
  selectFormat(format) {
    this.currentFormat = format;
    
    // Update UI
    document.querySelectorAll('.format-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.format === format);
    });
  }
  
  analyzeText(text) {
    const sentences = this.splitSentences(text);
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    
    // Calculate word frequencies
    const wordFreq = {};
    words.forEach(word => {
      if (!this.STOPWORDS.has(word) && word.length > 2) {
        wordFreq[word] = (wordFreq[word] || 0) + 1;
      }
    });
    
    // Score sentences
    const scoredSentences = sentences.map((sentence, index) => {
      const sentenceWords = sentence.toLowerCase().match(/\b\w+\b/g) || [];
      let score = 0;
      
      // TF-based scoring
      sentenceWords.forEach(word => {
        if (wordFreq[word]) {
          score += wordFreq[word];
        }
      });
      
      // Position scoring
      const positionFactor = this.calculatePositionFactor(index, sentences.length);
      score *= positionFactor;
      
      // Length normalization
      score /= Math.sqrt(sentenceWords.length);
      
      // Cue phrases
      score += this.checkCuePhrases(sentence);
      
      return {
        index,
        text: sentence.trim(),
        score: Math.round(score * 100) / 100,
        wordCount: sentenceWords.length
      };
    });
    
    // Extract keywords
    const keywords = this.extractKeywords(text);
    
    // Calculate readability
    const readability = this.calculateReadability(text);
    
    // Estimate sentiment
    const sentiment = this.estimateSentiment(text);
    
    // Calculate complexity
    const complexity = this.estimateComplexity(text);
    
    // Calculate formality
    const formality = this.estimateFormality(text);
    
    this.analysis = {
      sentences: scoredSentences,
      keywords,
      wordCount: words.length,
      sentenceCount: sentences.length,
      readability,
      sentiment,
      complexity,
      formality,
      wordFreq
    };
    
    return this.analysis;
  }
  
  generateSummary() {
    const text = document.getElementById('input-text').value.trim();
    
    if (!text) {
      this.showNotification('Please enter text to summarize', 'error');
      return;
    }
    
    // Analyze text
    this.analyzeText(text);
    
    // Generate summary based on mode
    switch (this.currentMode) {
      case 'extractive':
        this.summary = this.generateExtractiveSummary();
        break;
      case 'abstractive':
        this.summary = this.generateAbstractiveSummary();
        break;
      case 'tldr':
        this.summary = this.generateTLDR();
        break;
      case 'bullets':
        this.summary = this.generateBulletSummary();
        break;
      default:
        this.summary = this.generateExtractiveSummary();
    }
    
    // Update UI
    this.displaySummary();
    this.updateStats();
    this.showAnalysisDetails();
    
    this.showNotification('Summary generated successfully', 'success');
  }
  
  generateExtractiveSummary() {
    const targetCount = Math.max(1, Math.round(this.analysis.sentences.length * (this.currentLength / 100)));
    
    // Sort sentences by score and take top ones
    const selected = [...this.analysis.sentences]
      .sort((a, b) => b.score - a.score)
      .slice(0, targetCount * 2);
    
    // Remove redundancy if enabled
    if (document.getElementById('opt-remove-redundancy').checked) {
      this.removeRedundantSentences(selected);
    }
    
    // Take final selection
    const finalSelection = selected.slice(0, targetCount);
    
    // Preserve order if enabled
    if (document.getElementById('opt-preserve-order').checked) {
      finalSelection.sort((a, b) => a.index - b.index);
    }
    
    return {
      type: 'extractive',
      sentences: finalSelection.map(s => s.text),
      scores: finalSelection.map(s => s.score),
      keywords: this.analysis.keywords
    };
  }
  
  generateAbstractiveSummary() {
    // Simplified abstractive approach
    const topSentences = [...this.analysis.sentences]
      .sort((a, b) => b.score - a.score)
      .slice(0, 3);
    
    const keywords = this.analysis.keywords.slice(0, 5);
    
    // Create a coherent paragraph from top sentences
    let summary = `This text discusses ${keywords.join(', ')}. `;
    summary += topSentences.map(s => this.compressSentence(s.text)).join(' ') + ' ';
    summary += `Overall, the content provides insights into ${keywords.slice(0, 2).join(' and ')}.`;
    
    return {
      type: 'abstractive',
      content: summary,
      keywords
    };
  }
  
  generateTLDR() {
    const topSentence = [...this.analysis.sentences]
      .sort((a, b) => b.score - a.score)[0];
    
    return {
      type: 'tldr',
      content: topSentence ? this.compressSentence(topSentence.text) : 'No summary available',
      score: topSentence?.score || 0
    };
  }
  
  generateBulletSummary() {
    const targetCount = Math.max(1, Math.round(this.analysis.sentences.length * (this.currentLength / 100)));
    
    const bullets = [...this.analysis.sentences]
      .sort((a, b) => b.score - a.score)
      .slice(0, targetCount)
      .map(s => this.compressSentence(s.text));
    
    return {
      type: 'bullets',
      bullets,
      keywords: this.analysis.keywords
    };
  }
  
  compressSentence(sentence) {
    // Simple sentence compression
    return sentence
      .replace(/\s+/g, ' ')
      .replace(/\b(?:and|but|or|because|although|since|unless)\b.*$/i, '')
      .trim()
      .replace(/\.$/, '');
  }
  
  removeRedundantSentences(sentences) {
    const unique = [];
    
    for (const sentence of sentences) {
      const words1 = new Set(sentence.text.toLowerCase().match(/\b\w+\b/g) || []);
      let isRedundant = false;
      
      for (const existing of unique) {
        const words2 = new Set(existing.text.toLowerCase().match(/\b\w+\b/g) || []);
        const intersection = new Set([...words1].filter(x => words2.has(x)));
        const union = new Set([...words1, ...words2]);
        const similarity = intersection.size / union.size;
        
        if (similarity > 0.6) {
          isRedundant = true;
          break;
        }
      }
      
      if (!isRedundant) {
        unique.push(sentence);
      }
    }
    
    return unique;
  }
  
  displaySummary() {
    const outputElement = document.getElementById('summary-output');
    const placeholder = document.getElementById('output-placeholder');
    const content = document.getElementById('output-content');
    
    placeholder.style.display = 'none';
    content.style.display = 'block';
    
    let output = '';
    const highlight = document.getElementById('opt-highlight-keywords').checked;
    
    switch (this.summary.type) {
      case 'extractive':
        output = this.formatExtractiveOutput(highlight);
        break;
      case 'abstractive':
        output = this.formatAbstractiveOutput(highlight);
        break;
      case 'tldr':
        output = this.formatTLDROutput();
        break;
      case 'bullets':
        output = this.formatBulletOutput(highlight);
        break;
    }
    
    outputElement.innerHTML = output;
  }
  
  formatExtractiveOutput(highlight) {
    let output = '';
    
    this.summary.sentences.forEach((sentence, i) => {
      let formattedSentence = sentence;
      
      if (highlight) {
        this.summary.keywords.forEach(keyword => {
          const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
          formattedSentence = formattedSentence.replace(
            regex, 
            '<span class="keyword">$&</span>'
          );
        });
      }
      
      const showExplanations = document.getElementById('opt-show-explanations').checked;
      const scoreBadge = showExplanations ? 
        `<span class="score-badge">${this.summary.scores[i].toFixed(2)}</span>` : '';
      
      output += `<p>${formattedSentence}${scoreBadge}</p>`;
    });
    
    return output;
  }
  
  formatAbstractiveOutput(highlight) {
    let output = this.summary.content;
    
    if (highlight) {
      this.summary.keywords.forEach(keyword => {
        const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
        output = output.replace(regex, '<span class="keyword">$&</span>');
      });
    }
    
    return `<p>${output}</p>`;
  }
  
  formatTLDROutput() {
    const showExplanations = document.getElementById('opt-show-explanations').checked;
    const scoreBadge = showExplanations ? 
      `<span class="score-badge">${this.summary.score.toFixed(2)}</span>` : '';
    
    return `<p class="tldr">${this.summary.content}${scoreBadge}</p>`;
  }
  
  formatBulletOutput(highlight) {
    let output = '<ul>';
    
    this.summary.bullets.forEach(bullet => {
      let formattedBullet = bullet;
      
      if (highlight) {
        this.summary.keywords.forEach(keyword => {
          const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
          formattedBullet = formattedBullet.replace(
            regex, 
            '<span class="keyword">$&</span>'
          );
        });
      }
      
      output += `<li>${formattedBullet}</li>`;
    });
    
    output += '</ul>';
    return output;
  }
  
  updateStats() {
    if (!this.analysis || !this.summary) return;
    
    const originalWords = this.analysis.wordCount;
    let summaryWords = 0;
    
    if (this.summary.type === 'extractive') {
      summaryWords = this.summary.sentences.join(' ').split(/\s+/).length;
    } else if (this.summary.type === 'abstractive') {
      summaryWords = this.summary.content.split(/\s+/).length;
    } else if (this.summary.type === 'tldr') {
      summaryWords = this.summary.content.split(/\s+/).length;
    } else if (this.summary.type === 'bullets') {
      summaryWords = this.summary.bullets.join(' ').split(/\s+/).length;
    }
    
    const compression = Math.round((1 - (summaryWords / originalWords)) * 100);
    const timeSaved = Math.round((originalWords / 200) - (summaryWords / 200));
    
    document.getElementById('original-stats').textContent = 
      `${originalWords.toLocaleString()} words`;
    document.getElementById('summary-stats').textContent = 
      `${summaryWords.toLocaleString()} words`;
    document.getElementById('compression-rate').textContent = `${compression}%`;
    document.getElementById('time-saved').textContent = 
      `${timeSaved} minute${timeSaved !== 1 ? 's' : ''}`;
  }
  
  showAnalysisDetails() {
    if (!this.analysis) return;
    
    const analysisSection = document.getElementById('analysis-details');
    analysisSection.style.display = 'block';
    
    // Update keyword list
    const keywordList = document.getElementById('keyword-list');
    keywordList.innerHTML = this.analysis.keywords
      .slice(0, 10)
      .map(keyword => `<span class="keyword-item">${keyword}</span>`)
      .join('');
    
    document.getElementById('keyword-count').textContent = this.analysis.keywords.length;
    document.getElementById('readability-score').textContent = this.analysis.readability;
    document.getElementById('sentiment-value').textContent = this.analysis.sentiment;
    document.getElementById('complexity-value').textContent = this.analysis.complexity;
    document.getElementById('formality-value').textContent = this.analysis.formality;
    
    // Update sentence scores
    const scoresList = document.getElementById('sentence-scores');
    const topSentences = [...this.analysis.sentences]
      .sort((a, b) => b.score - a.score)
      .slice(0, 5);
    
    scoresList.innerHTML = topSentences
      .map(s => `
        <div class="score-item">
          <span class="score-text">${s.text.substring(0, 60)}${s.text.length > 60 ? '...' : ''}</span>
          <span class="score-value">${s.score.toFixed(2)}</span>
        </div>
      `).join('');
    
    const avgScore = topSentences.reduce((sum, s) => sum + s.score, 0) / topSentences.length;
    document.getElementById('avg-score').textContent = avgScore.toFixed(2);
  }
  
  // Utility methods
  splitSentences(text) {
    return text
      .replace(/\r\n/g, '\n')
      .replace(/\n+/g, ' ')
      .match(/[^.!?]+[.!?]+/g) || []
      .map(s => s.trim())
      .filter(s => s.length > 0);
  }
  
  calculatePositionFactor(index, total) {
    const normalizedPos = index / Math.max(1, total - 1);
    if (normalizedPos < 0.1 || normalizedPos > 0.9) return 1.5;
    if (normalizedPos < 0.2 || normalizedPos > 0.8) return 1.2;
    return 1.0;
  }
  
  checkCuePhrases(sentence) {
    const cuePhrases = [
      'in conclusion', 'to summarize', 'the main point', 'most importantly',
      'significantly', 'crucially', 'essentially', 'in summary', 'overall'
    ];
    
    const lowerSentence = sentence.toLowerCase();
    for (const phrase of cuePhrases) {
      if (lowerSentence.includes(phrase)) return 10;
    }
    return 0;
  }
  
  extractKeywords(text) {
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    const candidates = [];
    let currentPhrase = [];
    
    for (const word of words) {
      if (this.STOPWORDS.has(word) || word.length < 3) {
        if (currentPhrase.length > 0) {
          candidates.push(currentPhrase.join(' '));
          currentPhrase = [];
        }
      } else {
        currentPhrase.push(word);
      }
    }
    
    if (currentPhrase.length > 0) {
      candidates.push(currentPhrase.join(' '));
    }
    
    const freq = {};
    candidates.forEach(phrase => {
      phrase.split(' ').forEach(word => {
        freq[word] = (freq[word] || 0) + 1;
      });
    });
    
    const scored = candidates.map(phrase => {
      const words = phrase.split(' ');
      const degree = words.reduce((sum, word) => sum + (freq[word] || 0), 0);
      return { phrase, score: degree / words.length };
    });
    
    return scored
      .sort((a, b) => b.score - a.score)
      .slice(0, 15)
      .map(item => item.phrase);
  }
  
  calculateReadability(text) {
    const sentences = this.splitSentences(text);
    const words = text.match(/\b\w+\b/g) || [];
    
    if (sentences.length === 0 || words.length === 0) return 'N/A';
    
    const syllables = this.estimateSyllables(text);
    const asl = words.length / sentences.length;
    const asw = syllables / words.length;
    
    const score = 206.835 - (1.015 * asl) - (84.6 * asw);
    
    if (score >= 90) return 'Very Easy';
    if (score >= 80) return 'Easy';
    if (score >= 70) return 'Fairly Easy';
    if (score >= 60) return 'Standard';
    if (score >= 50) return 'Fairly Difficult';
    if (score >= 30) return 'Difficult';
    return 'Very Difficult';
  }
  
  estimateSyllables(text) {
    const words = text.toLowerCase().match(/\b[a-z]+\b/g) || [];
    let total = 0;
    
    words.forEach(word => {
      const matches = word.match(/[aeiouy]+/g);
      if (matches) total += matches.length;
      if (word.endsWith('es') || word.endsWith('ed')) total--;
      if (word.endsWith('le') && word.length > 2) total++;
    });
    
    return Math.max(1, total);
  }
  
  estimateSentiment(text) {
    const positive = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'positive', 'happy', 'love', 'best'];
    const negative = ['bad', 'terrible', 'awful', 'horrible', 'negative', 'sad', 'hate', 'worst', 'problem'];
    
    const words = text.toLowerCase().match(/\b[a-z]+\b/g) || [];
    let posCount = 0, negCount = 0;
    
    words.forEach(word => {
      if (positive.includes(word)) posCount++;
      if (negative.includes(word)) negCount++;
    });
    
    const total = posCount + negCount;
    if (total === 0) return 'Neutral';
    
    const ratio = posCount / total;
    if (ratio > 0.7) return 'Positive';
    if (ratio < 0.3) return 'Negative';
    return 'Mixed';
  }
  
  estimateComplexity(text) {
    const words = text.match(/\b\w+\b/g) || [];
    const longWords = words.filter(w => w.length > 6).length;
    const ratio = longWords / words.length;
    
    if (ratio > 0.3) return 'High';
    if (ratio > 0.2) return 'Medium-High';
    if (ratio > 0.1) return 'Medium';
    return 'Low';
  }
  
  estimateFormality(text) {
    const formalWords = ['therefore', 'however', 'furthermore', 'moreover', 'consequently'];
    const informalWords = ['really', 'very', 'so', 'like', 'just'];
    
    const words = text.toLowerCase().match(/\b\w+\b/g) || [];
    let formalCount = 0, informalCount = 0;
    
    words.forEach(word => {
      if (formalWords.includes(word)) formalCount++;
      if (informalWords.includes(word)) informalCount++;
    });
    
    const total = formalCount + informalCount;
    if (total === 0) return 'Neutral';
    
    const ratio = formalCount / total;
    if (ratio > 0.5) return 'Formal';
    if (ratio < 0.2) return 'Informal';
    return 'Neutral';
  }
  
  updateModeInfo() {
    // Could update mode description or tips
  }
  
  showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
      <div class="notification-content">
        <span class="notification-icon">${type === 'success' ? '‚úì' : type === 'error' ? '‚úï' : '‚ìò'}</span>
        ${message}
      </div>
    `;
    
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 16px;
      background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
      color: white;
      border-radius: 6px;
      font-size: 0.875rem;
      z-index: 1000;
      animation: slideIn 0.3s ease;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOut 0.3s ease';
      setTimeout(() => notification.remove(), 300);
    }, 3000);
  }
}

// Initialize application
const summaryGenerator = new SummaryGenerator();

// Global functions for button clicks
function generateSummary() {
  summaryGenerator.generateSummary();
}

function analyzeText() {
  const text = document.getElementById('input-text').value.trim();
  
  if (!text) {
    summaryGenerator.showNotification('Please enter text to analyze', 'error');
    return;
  }
  
  summaryGenerator.analyzeText(text);
  summaryGenerator.showAnalysisDetails();
  summaryGenerator.showNotification('Text analysis complete', 'success');
}

function quickSummary(mode) {
  summaryGenerator.selectMode(mode);
  if (mode === 'tldr') summaryGenerator.setLengthPreset(10);
  if (mode === 'bullets') summaryGenerator.setLengthPreset(30);
  generateSummary();
}

function copyToClipboard() {
  const output = document.getElementById('summary-output').innerText;
  
  if (!output.trim()) {
    summaryGenerator.showNotification('No output to copy', 'error');
    return;
  }
  
  navigator.clipboard.writeText(output).then(() => {
    summaryGenerator.showNotification('Copied to clipboard', 'success');
  });
}

function exportSummary() {
  const output = document.getElementById('summary-output').innerText;
  
  if (!output.trim()) {
    summaryGenerator.showNotification('No output to export', 'error');
    return;
  }
  
  const blob = new Blob([output], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `summary-${new Date().toISOString().split('T')[0]}.txt`;
  a.click();
  URL.revokeObjectURL(url);
  
  summaryGenerator.showNotification('Summary exported', 'success');
}

function clearInput() {
  document.getElementById('input-text').value = '';
  summaryGenerator.updateTextStats();
  summaryGenerator.showNotification('Input cleared', 'info');
}

function clearOutput() {
  document.getElementById('output-placeholder').style.display = 'flex';
  document.getElementById('output-content').style.display = 'none';
  document.getElementById('analysis-details').style.display = 'none';
  summaryGenerator.showNotification('Output cleared', 'info');
}

function loadSample() {
  const sampleText = `Artificial intelligence (AI) is intelligence demonstrated by machines, as opposed to the natural intelligence displayed by animals including humans. Leading AI textbooks define the field as the study of "intelligent agents": any system that perceives its environment and takes actions that maximize its chance of achieving its goals. Some popular accounts use the term "artificial intelligence" to describe machines that mimic "cognitive" functions that humans associate with the human mind, such as "learning" and "problem solving", however this definition is rejected by major AI researchers.

AI applications include advanced web search engines (e.g., Google Search), recommendation systems (used by YouTube, Amazon and Netflix), understanding human speech (such as Siri and Alexa), self-driving cars (e.g., Waymo), automated decision-making and competing at the highest level in strategic game systems (such as chess and Go). As machines become increasingly capable, tasks considered to require "intelligence" are often removed from the definition of AI, a phenomenon known as the AI effect. For instance, optical character recognition is frequently excluded from things considered to be AI, having become a routine technology.

Artificial intelligence was founded as an academic discipline in 1956, and in the years since has experienced several waves of optimism, followed by disappointment and the loss of funding (known as an "AI winter"), followed by new approaches, success and renewed funding. AI research has tried and discarded many different approaches, including simulating the brain, modeling human problem solving, formal logic, large databases of knowledge and imitating animal behavior. In the first decades of the 21st century, highly mathematical and statistical machine learning has dominated the field, and this technique has proved highly successful, helping to solve many challenging problems throughout industry and academia.

The various sub-fields of AI research are centered around particular goals and the use of particular tools. The traditional goals of AI research include reasoning, knowledge representation, planning, learning, natural language processing, perception, and the ability to move and manipulate objects. General intelligence (the ability to solve an arbitrary problem) is among the field's long-term goals. To solve these problems, AI researchers have adapted and integrated a wide range of problem-solving techniques, including search and mathematical optimization, formal logic, artificial neural networks, and methods based on statistics, probability and economics. AI also draws upon computer science, psychology, linguistics, philosophy, and many other fields.

The field was founded on the assumption that human intelligence "can be so precisely described that a machine can be made to simulate it". This raised philosophical arguments about the mind and the ethical consequences of creating artificial beings endowed with human-like intelligence; these issues have previously been explored by myth, fiction and philosophy since antiquity. Computer scientists and philosophers have since suggested that AI may become an existential risk to humanity if its rational capacities are not steered towards beneficial goals. The term artificial intelligence has also been criticized for overhyping AI's true technological capabilities.`;

  document.getElementById('input-text').value = sampleText;
  summaryGenerator.updateTextStats();
  summaryGenerator.showNotification('Sample text loaded', 'info');
}

function toggleAdvancedSettings() {
  const advanced = document.getElementById('advanced-settings');
  const toggle = document.getElementById('advanced-toggle');
  
  if (advanced.style.display === 'none') {
    advanced.style.display = 'block';
    toggle.textContent = 'Hide Advanced';
  } else {
    advanced.style.display = 'none';
    toggle.textContent = 'Show Advanced';
  }
}

function toggleAnalysis() {
  const analysis = document.getElementById('analysis-details');
  analysis.style.display = analysis.style.display === 'none' ? 'block' : 'none';
}

function showAlgorithmInfo() {
  const info = `This summary generator uses advanced algorithms:

‚Ä¢ Extractive Summarization: Identifies and extracts the most important sentences based on:
  - Term Frequency (TF) scoring
  - Sentence position weighting
  - Cue phrase detection
  - Redundancy removal using cosine similarity

‚Ä¢ Abstractive Techniques: Creates new sentences that capture the essence:
  - Sentence compression
  - Keyword-based rewriting
  - Coherence and fluency scoring

‚Ä¢ Text Analysis: Provides detailed insights about your text:
  - Readability scoring (Flesch-Kincaid inspired)
  - Sentiment analysis
  - Keyword extraction (RAKE algorithm)
  - Complexity and formality assessment

All processing happens locally in your browser - no data is sent to external servers.`;
  
  alert(info);
}

function showExamples() {
  alert('Try these example uses:\n\n1. Academic papers: Get quick abstracts\n2. News articles: Extract key points\n3. Meeting notes: Create executive summaries\n4. Blog posts: Generate social media previews\n5. Research papers: Extract methodology and findings\n\nTry loading the sample text to see it in action!');
}

function resetSettings() {
  summaryGenerator.selectMode('extractive');
  summaryGenerator.setLengthPreset(30);
  summaryGenerator.selectFormat('text');
  
  document.getElementById('opt-preserve-order').checked = true;
  document.getElementById('opt-highlight-keywords').checked = false;
  document.getElementById('opt-remove-redundancy').checked = true;
  document.getElementById('opt-show-explanations').checked = false;
  
  summaryGenerator.showNotification('Settings reset to defaults', 'info');
}

// Add CSS animations for notifications
const style = document.createElement('style');
style.textContent = `
  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOut {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);
</script>
