<h2 id="sleep-title" style="margin-top:0;">Sleep Calculator</h2>

<form aria-describedby="sleep-desc">
  <p id="sleep-desc" class="small">Find the best times to wake up or go to bed based on 90‑minute sleep cycles.</p>

  <div class="field">
    <label for="sleep-bedtime">Planned bedtime</label>
    <input id="sleep-bedtime" type="time" value="23:00" />
  </div>

  <div class="field">
    <label for="sleep-cycles">Number of cycles</label>
    <input id="sleep-cycles" type="number" min="1" max="6" value="5" />
  </div>

  <div class="actions">
    <button type="button" onclick="sleepCalc(this)">Calculate</button>
    <button type="button" class="secondary" onclick="sleepReset(this)">Reset</button>
  </div>
</form>

<div class="results" aria-live="polite">
  <div class="result">
    <div class="label">Wake‑up time</div>
    <div class="value" id="sleep-res">–</div>
  </div>
</div>

<details class="small" style="margin-top:12px;">
  <summary>How it works</summary>
  <p>
    Sleep cycles last ~90 minutes. This calculator adds cycles to your bedtime to suggest optimal wake‑up times.
  </p>
</details>

<script>
function sleepCalc(btn) {
  const card = btn.closest('.card');
  const bedtimeStr = card.querySelector('#sleep-bedtime').value;
  const cycles = parseInt(card.querySelector('#sleep-cycles').value, 10) || 5;

  if (!bedtimeStr) {
    card.querySelector('#sleep-res').textContent = "–";
    return;
  }

  const [hours, minutes] = bedtimeStr.split(":").map(Number);
  const bedtime = new Date();
  bedtime.setHours(hours, minutes, 0, 0);

  const wakeTime = new Date(bedtime.getTime() + cycles * 90 * 60000);
  const hh = wakeTime.getHours().toString().padStart(2,"0");
  const mm = wakeTime.getMinutes().toString().padStart(2,"0");

  card.querySelector('#sleep-res').textContent = `${hh}:${mm}`;
}

function sleepReset(btn) {
  const card = btn.closest('.card');
  card.querySelector('form').reset();
  card.querySelector('#sleep-res').textContent = '–';
}
</script>
