<!-- FILE: cards/trigonometry-helper.html -->

<h2 id="trigonometry-title">üìê Trigonometry Helper</h2>
<p id="trigonometry-desc">Calculate sine, cosine, tangent, and related functions with visualization and unit circle relationships.</p>

<form id="trigonometry-form">
  <!-- Input Controls -->
  <div class="input-group" style="background: var(--bg-glass); border-radius: var(--radius-md); padding: var(--space-lg); border: 1px solid var(--border-light); margin-bottom: var(--space-lg);">
    
    <!-- Angle Input & Mode -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-md);">
      <div class="field">
        <label for="trig-angle" style="display: block; margin-bottom: var(--space-xs); color: var(--accent); font-weight: 600; font-size: var(--text-sm);">Angle (Œ∏)</label>
        <input id="trig-angle" type="number" placeholder="e.g., 45" step="any" 
               style="width: 100%; padding: var(--space-md); border-radius: var(--radius-sm); border: 1px solid var(--border-light); background: rgba(255, 255, 255, 0.05); color: var(--text); font-family: inherit;" />
        <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-xs);">Enter angle value</div>
      </div>

      <div class="field">
        <label for="trig-mode" style="display: block; margin-bottom: var(--space-xs); color: var(--accent); font-weight: 600; font-size: var(--text-sm);">Angle Mode</label>
        <select id="trig-mode" 
                style="width: 100%; padding: var(--space-md); border-radius: var(--radius-sm); border: 1px solid var(--border-light); background: rgba(255, 255, 255, 0.05); color: var(--text); font-family: inherit;">
          <option value="deg" selected>Degrees (¬∞)</option>
          <option value="rad">Radians (rad)</option>
          <option value="grad">Gradians (gon)</option>
        </select>
        <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-xs);">Select angle unit</div>
      </div>
    </div>

    <!-- Triangle Sides -->
    <div class="field" style="margin-bottom: var(--space-md);">
      <label for="trig-sides" style="display: block; margin-bottom: var(--space-xs); color: var(--accent); font-weight: 600; font-size: var(--text-sm);">Triangle Sides (Optional)</label>
      <input id="trig-sides" type="text" placeholder="a=3, b=4, c=5 or a=5, b=12" 
             style="width: 100%; padding: var(--space-md); border-radius: var(--radius-sm); border: 1px solid var(--border-light); background: rgba(255, 255, 255, 0.05); color: var(--text); font-family: inherit;" />
      <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-xs);">
        Enter side lengths (comma separated) to check Pythagorean theorem
      </div>
    </div>

    <!-- Quick Angles -->
    <div style="margin-bottom: var(--space-md);">
      <div style="color: var(--accent); font-weight: 600; margin-bottom: var(--space-xs); font-size: var(--text-sm);">Quick Angles:</div>
      <div style="display: flex; gap: var(--space-xs); flex-wrap: wrap;">
        <button type="button" onclick="trigSetAngle(0)" class="quick-angle-btn">0¬∞</button>
        <button type="button" onclick="trigSetAngle(30)" class="quick-angle-btn">30¬∞</button>
        <button type="button" onclick="trigSetAngle(45)" class="quick-angle-btn">45¬∞</button>
        <button type="button" onclick="trigSetAngle(60)" class="quick-angle-btn">60¬∞</button>
        <button type="button" onclick="trigSetAngle(90)" class="quick-angle-btn">90¬∞</button>
        <button type="button" onclick="trigSetAngle(Math.PI/4)" class="quick-angle-btn">œÄ/4</button>
        <button type="button" onclick="trigSetAngle(Math.PI/3)" class="quick-angle-btn">œÄ/3</button>
        <button type="button" onclick="trigSetAngle(Math.PI/2)" class="quick-angle-btn">œÄ/2</button>
      </div>
    </div>

    <!-- Settings -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: var(--space-md);">
      <div class="field">
        <label for="trig-show-steps" style="display: block; margin-bottom: var(--space-xs); color: var(--text-secondary); font-weight: 600; font-size: var(--text-xs);">Show Steps</label>
        <select id="trig-show-steps" 
                style="width: 100%; padding: var(--space-sm); border-radius: var(--radius-sm); border: 1px solid var(--border-light); background: rgba(255, 255, 255, 0.05); color: var(--text); font-size: var(--text-sm); font-family: inherit;">
          <option value="yes" selected>Yes - Show calculations</option>
          <option value="no">No - Results only</option>
        </select>
      </div>

      <div class="field">
        <label for="trig-precision" style="display: block; margin-bottom: var(--space-xs); color: var(--text-secondary); font-weight: 600; font-size: var(--text-xs);">Decimal Precision</label>
        <select id="trig-precision" 
                style="width: 100%; padding: var(--space-sm); border-radius: var(--radius-sm); border: 1px solid var(--border-light); background: rgba(255, 255, 255, 0.05); color: var(--text); font-size: var(--text-sm); font-family: inherit;">
          <option value="2">2 decimals</option>
          <option value="4" selected>4 decimals</option>
          <option value="6">6 decimals</option>
          <option value="8">8 decimals</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions" style="margin-top: var(--space-lg); display: flex; gap: var(--space-md); flex-wrap: wrap;">
    <button type="button" onclick="trigCalculate()" class="primary-btn">
      üìê Calculate Trig Functions
    </button>
    <button type="button" onclick="trigCopyResults()" class="secondary-btn">
      üìã Copy Results
    </button>
    <button type="button" onclick="trigResetForm()" class="danger-btn">
      üîÑ Reset
    </button>
  </div>
</form>

<!-- Results Section -->
<div class="results" aria-live="polite" style="margin-top: var(--space-lg);">
  <h3 style="color: var(--accent); margin-bottom: var(--space-md); font-size: var(--text-lg);">üìä Trigonometric Results</h3>
  
  <!-- Primary Results -->
  <div id="trig-output" class="output-box">
    Enter an angle to calculate trigonometric functions.
  </div>
  
  <!-- Unit Circle Visualization -->
  <div id="trig-unit-circle" style="display: none; margin-bottom: var(--space-lg);">
    <div class="visualization-box">
      <div style="color: var(--success); font-weight: 600; margin-bottom: var(--space-md);">‚≠ï Unit Circle Visualization</div>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg); align-items: center;">
        <div style="text-align: center;">
          <div class="unit-circle">
            <div id="trig-circle-point" class="circle-point"></div>
            <div id="trig-circle-line" class="circle-line"></div>
          </div>
          <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-sm);">
            Point position: (cos Œ∏, sin Œ∏)
          </div>
        </div>
        <div>
          <div style="font-size: var(--text-sm); line-height: var(--leading-base); color: var(--text-secondary);">
            <div><strong style="color: var(--accent);">sin Œ∏</strong> = y-coordinate</div>
            <div><strong style="color: var(--accent);">cos Œ∏</strong> = x-coordinate</div>
            <div><strong style="color: var(--accent);">tan Œ∏</strong> = y/x = slope</div>
            <div style="margin-top: var(--space-md); font-size: var(--text-xs); color: var(--text-tertiary);">
              The unit circle has radius = 1
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Additional Functions -->
  <div id="trig-advanced" style="display: none; margin-bottom: var(--space-lg);">
    <div class="advanced-box">
      <div style="color: var(--warning); font-weight: 600; margin-bottom: var(--space-md);">üî¢ Additional Functions</div>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-md);">
        <div class="function-box">
          <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-bottom: var(--space-xs);">Reciprocal Functions</div>
          <div id="trig-reciprocal" style="font-size: var(--text-sm); color: var(--text);"></div>
        </div>
        <div class="function-box">
          <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-bottom: var(--space-xs);">Inverse Functions</div>
          <div id="trig-inverse" style="font-size: var(--text-sm); color: var(--text);"></div>
        </div>
        <div class="function-box">
          <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-bottom: var(--space-xs);">Pythagorean Identity</div>
          <div id="trig-identity" style="font-size: var(--text-sm); color: var(--text);"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Steps & Explanation -->
  <div id="trig-steps-container" style="display: none;">
    <div class="steps-box">
      <div style="color: var(--accent); font-weight: 600; margin-bottom: var(--space-md);">üìù Calculation Steps</div>
      <div id="trig-steps" style="font-size: var(--text-sm); line-height: var(--leading-base); color: var(--text-secondary);"></div>
    </div>
  </div>
  
  <!-- Status Bar -->
  <div style="margin-top: var(--space-lg); display: flex; justify-content: space-between; align-items: center; font-size: var(--text-sm); color: var(--text-tertiary);">
    <div>
      <span id="trig-status">Ready</span>
      <span id="trig-hint" style="margin-left: var(--space-sm);"></span>
    </div>
    <div id="trig-mode-indicator">Mode: Degrees</div>
  </div>
</div>

<!-- Embed Section -->
<div class="embed-section" style="margin-top: var(--space-xl); padding-top: var(--space-md); border-top: 1px solid var(--border-light);">
  <div style="color: var(--text-secondary); font-size: var(--text-sm); font-weight: 600;">Share this card</div>
  <button onclick="trigCopyEmbed()" class="embed-btn">
    <span>üîó</span>
    <span>Copy Embed Code</span>
  </button>
</div>

<script>
// ==================== CONFIGURATION ====================
const trigConfig = {
  exactValues: {
    0: { sin: 0, cos: 1, tan: 0 },
    30: { sin: 0.5, cos: Math.sqrt(3)/2, tan: 1/Math.sqrt(3) },
    45: { sin: Math.sqrt(2)/2, cos: Math.sqrt(2)/2, tan: 1 },
    60: { sin: Math.sqrt(3)/2, cos: 0.5, tan: Math.sqrt(3) },
    90: { sin: 1, cos: 0, tan: Infinity },
    180: { sin: 0, cos: -1, tan: 0 },
    270: { sin: -1, cos: 0, tan: Infinity },
    360: { sin: 0, cos: 1, tan: 0 }
  }
};

// ==================== UTILITY FUNCTIONS ====================
function trigToRadians(angle, mode) {
  switch(mode) {
    case 'deg': return angle * Math.PI / 180;
    case 'rad': return angle;
    case 'grad': return angle * Math.PI / 200;
    default: return angle;
  }
}

function trigFormatAngle(angle, mode, precision) {
  const formatted = parseFloat(angle.toFixed(precision));
  switch(mode) {
    case 'deg': return `${formatted}¬∞`;
    case 'rad': return `${formatted} rad`;
    case 'grad': return `${formatted} gon`;
    default: return formatted;
  }
}

function trigFormatValue(val, precision) {
  if (!isFinite(val)) return '‚àû';
  if (Math.abs(val) < Math.pow(10, -precision)) return '0';
  return val.toFixed(precision);
}

// ==================== CORE FUNCTIONS ====================
function trigInitialize() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Set default angle
  card.querySelector('#trig-angle').value = '45';
  
  // Update mode indicator on change
  card.querySelector('#trig-mode').addEventListener('change', function() {
    const modes = {
      'deg': 'Degrees (¬∞)',
      'rad': 'Radians (rad)',
      'grad': 'Gradians (gon)'
    };
    card.querySelector('#trig-mode-indicator').textContent = `Mode: ${modes[this.value]}`;
  });
  
  // Auto-calculate on angle change
  card.querySelector('#trig-angle').addEventListener('change', function() {
    if (this.value.trim()) {
      setTimeout(() => trigCalculate(), 100);
    }
  });
  
  console.log('üìê Trigonometry Helper initialized');
}

function trigSetAngle(angle) {
  const card = document.currentScript?.closest('.card') || document;
  const mode = card.querySelector('#trig-mode').value;
  
  if (mode === 'rad') {
    card.querySelector('#trig-angle').value = angle;
  } else {
    card.querySelector('#trig-angle').value = angle;
  }
  
  setTimeout(() => trigCalculate(), 100);
}

function trigResetForm() {
  const card = document.currentScript?.closest('.card') || document;
  
  card.querySelector('#trig-angle').value = '';
  card.querySelector('#trig-sides').value = '';
  card.querySelector('#trig-show-steps').value = 'yes';
  card.querySelector('#trig-precision').value = '4';
  card.querySelector('#trig-mode').value = 'deg';
  
  card.querySelector('#trig-output').textContent = 'Enter an angle to calculate trigonometric functions.';
  card.querySelector('#trig-unit-circle').style.display = 'none';
  card.querySelector('#trig-advanced').style.display = 'none';
  card.querySelector('#trig-steps-container').style.display = 'none';
  card.querySelector('#trig-status').textContent = 'Reset';
  card.querySelector('#trig-hint').textContent = '';
  card.querySelector('#trig-mode-indicator').textContent = 'Mode: Degrees';
  
  if (typeof showNotification === 'function') {
    showNotification('Trigonometry Helper reset', 'success');
  }
}

function trigCopyResults() {
  const card = document.currentScript?.closest('.card') || document;
  const output = card.querySelector('#trig-output').textContent;
  
  if (!output.trim() || output.includes('Enter an angle')) {
    card.querySelector('#trig-hint').textContent = 'Nothing to copy';
    card.querySelector('#trig-hint').style.color = 'var(--warning)';
    return;
  }
  
  navigator.clipboard.writeText(output).then(() => {
    card.querySelector('#trig-hint').textContent = 'Copied to clipboard!';
    card.querySelector('#trig-hint').style.color = 'var(--success)';
    
    if (typeof showNotification === 'function') {
      showNotification('Results copied to clipboard', 'success');
    }
    
    setTimeout(() => {
      card.querySelector('#trig-hint').textContent = '';
    }, 2000);
  }).catch(err => {
    card.querySelector('#trig-hint').textContent = 'Copy failed';
    card.querySelector('#trig-hint').style.color = 'var(--error)';
    console.error('Copy failed:', err);
  });
}

function trigCalculate() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Get inputs
  const angleInput = card.querySelector('#trig-angle').value.trim();
  const mode = card.querySelector('#trig-mode').value;
  const sidesInput = card.querySelector('#trig-sides').value.trim();
  const showSteps = card.querySelector('#trig-show-steps').value === 'yes';
  const precision = parseInt(card.querySelector('#trig-precision').value);
  
  // Validate angle
  if (!angleInput) {
    card.querySelector('#trig-status').textContent = 'Error';
    card.querySelector('#trig-hint').textContent = 'Please enter an angle';
    card.querySelector('#trig-hint').style.color = 'var(--error)';
    return;
  }
  
  const angle = parseFloat(angleInput);
  if (isNaN(angle)) {
    card.querySelector('#trig-status').textContent = 'Error';
    card.querySelector('#trig-hint').textContent = 'Invalid angle value';
    card.querySelector('#trig-hint').style.color = 'var(--error)';
    return;
  }
  
  card.querySelector('#trig-status').textContent = 'Calculating...';
  card.querySelector('#trig-hint').textContent = '';
  
  // Convert to radians for calculations
  const rad = trigToRadians(angle, mode);
  
  // Calculate basic functions
  const sinVal = Math.sin(rad);
  const cosVal = Math.cos(rad);
  const tanVal = Math.tan(rad);
  
  // Calculate additional functions
  const cscVal = sinVal !== 0 ? 1 / sinVal : Infinity;
  const secVal = cosVal !== 0 ? 1 / cosVal : Infinity;
  const cotVal = tanVal !== 0 ? 1 / tanVal : Infinity;
  
  // Calculate inverse functions (in radians)
  const asinVal = Math.asin(sinVal);
  const acosVal = Math.acos(cosVal);
  const atanVal = Math.atan(tanVal);
  
  // Build results
  const angleDisplay = trigFormatAngle(angle, mode, precision);
  
  let result = `üìê TRIGONOMETRIC FUNCTIONS\n`;
  result += '‚ïê'.repeat(40) + '\n\n';
  
  result += `Angle: ${angleDisplay}\n`;
  result += `Radians: ${rad.toFixed(6)} rad\n\n`;
  
  result += `Primary Functions:\n`;
  result += `  sin(${angleDisplay}) = ${trigFormatValue(sinVal, precision)}\n`;
  result += `  cos(${angleDisplay}) = ${trigFormatValue(cosVal, precision)}\n`;
  result += `  tan(${angleDisplay}) = ${trigFormatValue(tanVal, precision)}\n\n`;
  
  result += `Reciprocal Functions:\n`;
  result += `  csc(${angleDisplay}) = ${trigFormatValue(cscVal, precision)}\n`;
  result += `  sec(${angleDisplay}) = ${trigFormatValue(secVal, precision)}\n`;
  result += `  cot(${angleDisplay}) = ${trigFormatValue(cotVal, precision)}\n\n`;
  
  result += `Pythagorean Identity:\n`;
  result += `  sin¬≤ + cos¬≤ = ${(sinVal*sinVal + cosVal*cosVal).toFixed(precision)} (‚âà1)\n`;
  
  // Check if it's a common angle
  if (mode === 'deg' && trigConfig.exactValues[Math.round(angle)]) {
    const exact = trigConfig.exactValues[Math.round(angle)];
    if (Math.abs(sinVal - exact.sin) < 0.0001) {
      result += `\nüåü Exact Values (${Math.round(angle)}¬∞):\n`;
      result += `  sin = ${exact.sin}\n`;
      result += `  cos = ${exact.cos}\n`;
      result += `  tan = ${exact.tan}\n`;
    }
  }
  
  // Check triangle sides if provided
  if (sidesInput) {
    const parsed = {};
    sidesInput.split(',').forEach(pair => {
      const [key, value] = pair.split('=').map(s => s.trim());
      if (key && value && !isNaN(parseFloat(value))) {
        parsed[key.toLowerCase()] = parseFloat(value);
      }
    });
    
    if (parsed.a && parsed.b && parsed.c) {
      const a2 = parsed.a * parsed.a;
      const b2 = parsed.b * parsed.b;
      const c2 = parsed.c * parsed.c;
      const isRight = Math.abs(c2 - (a2 + b2)) < 0.0001;
      
      result += `\nüìè Triangle Check (Pythagorean Theorem):\n`;
      result += `  a¬≤ + b¬≤ = ${a2} + ${b2} = ${(a2 + b2).toFixed(2)}\n`;
      result += `  c¬≤ = ${c2.toFixed(2)}\n`;
      result += `  Result: ${isRight ? '‚úì Valid right triangle' : '‚úó Not a right triangle'}\n`;
    } else if (parsed.a && parsed.b) {
      const c = Math.sqrt(parsed.a * parsed.a + parsed.b * parsed.b);
      result += `\nüìè Calculated Hypotenuse:\n`;
      result += `  a = ${parsed.a}, b = ${parsed.b}\n`;
      result += `  c = ‚àö(${parsed.a}¬≤ + ${parsed.b}¬≤) = ${c.toFixed(2)}\n`;
    }
  }
  
  // Update output
  card.querySelector('#trig-output').textContent = result;
  
  // Show visualizations
  trigUpdateUnitCircle(angle, mode, sinVal, cosVal);
  card.querySelector('#trig-unit-circle').style.display = 'block';
  
  // Update advanced functions
  trigUpdateAdvanced(sinVal, cosVal, tanVal, asinVal, acosVal, atanVal, precision);
  card.querySelector('#trig-advanced').style.display = 'block';
  
  // Show steps if requested
  if (showSteps) {
    trigShowSteps(angle, mode, rad, sinVal, cosVal, tanVal, precision);
    card.querySelector('#trig-steps-container').style.display = 'block';
  } else {
    card.querySelector('#trig-steps-container').style.display = 'none';
  }
  
  // Update status
  card.querySelector('#trig-status').textContent = 'Complete';
  card.querySelector('#trig-hint').textContent = `${precision} decimal precision`;
  card.querySelector('#trig-hint').style.color = 'var(--success)';
  
  // Track usage in analytics
  if (window.plausible) {
    window.plausible('Card Used', { props: { card: 'trigonometry-helper' } });
  }
}

function trigUpdateUnitCircle(angle, mode, sinVal, cosVal) {
  const card = document.currentScript?.closest('.card') || document;
  const point = card.querySelector('#trig-circle-point');
  const line = card.querySelector('#trig-circle-line');
  
  if (!point || !line) return;
  
  // Convert angle to degrees for rotation
  let angleDeg;
  if (mode === 'deg') {
    angleDeg = angle % 360;
  } else if (mode === 'rad') {
    angleDeg = (angle * 180 / Math.PI) % 360;
  } else {
    angleDeg = (angle * 180 / 200) % 360;
  }
  
  // Calculate point position
  const radius = 80;
  const centerX = radius;
  const centerY = radius;
  const pointX = centerX + cosVal * radius;
  const pointY = centerY - sinVal * radius;
  
  // Update point position
  point.style.left = `${pointX}px`;
  point.style.top = `${pointY}px`;
  
  // Update line rotation
  line.style.transform = `rotate(${angleDeg}deg)`;
}

function trigUpdateAdvanced(sinVal, cosVal, tanVal, asinVal, acosVal, atanVal, precision) {
  const card = document.currentScript?.closest('.card') || document;
  
  // Reciprocal functions
  const reciprocalHTML = `
    csc Œ∏ = 1/sin Œ∏ = ${trigFormatValue(1/sinVal, precision)}<br>
    sec Œ∏ = 1/cos Œ∏ = ${trigFormatValue(1/cosVal, precision)}<br>
    cot Œ∏ = 1/tan Œ∏ = ${trigFormatValue(1/tanVal, precision)}
  `;
  card.querySelector('#trig-reciprocal').innerHTML = reciprocalHTML;
  
  // Inverse functions
  const inverseHTML = `
    arcsin(sin Œ∏) = ${asinVal.toFixed(precision)} rad<br>
    arccos(cos Œ∏) = ${acosVal.toFixed(precision)} rad<br>
    arctan(tan Œ∏) = ${atanVal.toFixed(precision)} rad
  `;
  card.querySelector('#trig-inverse').innerHTML = inverseHTML;
  
  // Pythagorean identity
  const identityHTML = `
    sin¬≤Œ∏ + cos¬≤Œ∏ = 1<br>
    ${(sinVal*sinVal).toFixed(precision)} + ${(cosVal*cosVal).toFixed(precision)}<br>
    = ${(sinVal*sinVal + cosVal*cosVal).toFixed(precision)}
  `;
  card.querySelector('#trig-identity').innerHTML = identityHTML;
}

function trigShowSteps(angle, mode, rad, sinVal, cosVal, tanVal, precision) {
  const card = document.currentScript?.closest('.card') || document;
  
  const angleDisplay = trigFormatAngle(angle, mode, precision);
  const radDisplay = rad.toFixed(6);
  
  let steps = `
    <strong>Step 1: Convert to Radians</strong><br>
    ${angleDisplay} ‚Üí ${radDisplay} rad<br><br>
    
    <strong>Step 2: Calculate Primary Functions</strong><br>
    ‚Ä¢ sin(${angleDisplay}) = sin(${radDisplay} rad) = ${sinVal.toFixed(precision)}<br>
    ‚Ä¢ cos(${angleDisplay}) = cos(${radDisplay} rad) = ${cosVal.toFixed(precision)}<br>
    ‚Ä¢ tan(${angleDisplay}) = sin/cos = ${sinVal.toFixed(precision)}/${cosVal.toFixed(precision)} = ${tanVal.toFixed(precision)}<br><br>
    
    <strong>Step 3: Verify Pythagorean Identity</strong><br>
    sin¬≤ + cos¬≤ = (${sinVal.toFixed(precision)})¬≤ + (${cosVal.toFixed(precision)})¬≤ = ${(sinVal*sinVal + cosVal*cosVal).toFixed(precision)} ‚âà 1<br><br>
    
    <strong>Step 4: Reciprocal Functions</strong><br>
    ‚Ä¢ csc Œ∏ = 1/sin Œ∏ = 1/${sinVal.toFixed(precision)} = ${(1/sinVal).toFixed(precision)}<br>
    ‚Ä¢ sec Œ∏ = 1/cos Œ∏ = 1/${cosVal.toFixed(precision)} = ${(1/cosVal).toFixed(precision)}<br>
    ‚Ä¢ cot Œ∏ = 1/tan Œ∏ = 1/${tanVal.toFixed(precision)} = ${(1/tanVal).toFixed(precision)}
  `;
  
  card.querySelector('#trig-steps').innerHTML = steps;
}

function trigCopyEmbed() {
  const embedCode = `<iframe src="${window.location.origin}/cards/trigonometry-helper.html" width="100%" height="500" style="border:none;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.3);" title="Trigonometry Helper - The Most Useful Site"></iframe>`;
  
  navigator.clipboard.writeText(embedCode).then(() => {
    if (typeof showNotification === 'function') {
      showNotification('Embed code copied to clipboard', 'success');
    }
    
    const embedBtn = document.querySelector('.embed-btn');
    if (embedBtn) {
      const originalHTML = embedBtn.innerHTML;
      embedBtn.innerHTML = '<span>‚úÖ</span><span>Copied!</span>';
      embedBtn.classList.add('copied');
      
      setTimeout(() => {
        embedBtn.innerHTML = originalHTML;
        embedBtn.classList.remove('copied');
      }, 2000);
    }
  }).catch(err => {
    console.error('Copy failed:', err);
    if (typeof showNotification === 'function') {
      showNotification('Failed to copy embed code', 'error');
    }
  });
}

// ==================== INITIALIZATION ====================
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', trigInitialize);
} else {
  trigInitialize();
}
</script>

<style>
/* Card-specific styles using CSS variables */
#trigonometry-title {
  color: var(--accent);
  margin-bottom: var(--space-sm);
  font-size: var(--text-xl);
}

#trigonometry-desc {
  color: var(--text-secondary);
  margin-bottom: var(--space-lg);
  font-size: var(--text-base);
}

/* Button Styles */
.quick-angle-btn {
  padding: var(--space-xs) var(--space-sm);
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-sm);
  color: var(--text);
  cursor: pointer;
  font-size: var(--text-sm);
  transition: all var(--transition-fast);
}

.quick-angle-btn:hover {
  background: rgba(45, 212, 255, 0.1);
  border-color: var(--accent);
  color: var(--accent);
}

.primary-btn {
  flex: 1;
  min-width: 200px;
  padding: var(--space-md);
  background: linear-gradient(135deg, rgba(45, 212, 255, 0.2), rgba(45, 212, 255, 0.1));
  border: 1px solid rgba(45, 212, 255, 0.4);
  border-radius: var(--radius-md);
  color: var(--accent);
  cursor: pointer;
  font-weight: 600;
  font-family: inherit;
  transition: all var(--transition-fast);
}

.primary-btn:hover {
  background: linear-gradient(135deg, rgba(45, 212, 255, 0.3), rgba(45, 212, 255, 0.2));
  transform: translateY(-2px);
}

.secondary-btn {
  padding: var(--space-md) var(--space-lg);
  background: rgba(57, 255, 20, 0.1);
  border: 1px solid rgba(57, 255, 20, 0.3);
  color: var(--success);
  border-radius: var(--radius-md);
  cursor: pointer;
  font-family: inherit;
  transition: all var(--transition-fast);
}

.secondary-btn:hover {
  background: rgba(57, 255, 20, 0.2);
  transform: translateY(-2px);
}

.danger-btn {
  padding: var(--space-md) var(--space-lg);
  background: rgba(255, 77, 77, 0.1);
  border: 1px solid rgba(255, 77, 77, 0.3);
  color: var(--error);
  border-radius: var(--radius-md);
  cursor: pointer;
  font-family: inherit;
  transition: all var(--transition-fast);
}

.danger-btn:hover {
  background: rgba(255, 77, 77, 0.2);
  transform: translateY(-2px);
}

/* Box Styles */
.output-box {
  padding: var(--space-lg);
  background: rgba(0, 0, 0, 0.2);
  border-radius: var(--radius-md);
  border: 1px solid rgba(45, 212, 255, 0.2);
  font-family: monospace;
  white-space: pre-line;
  max-height: 300px;
  overflow-y: auto;
  margin-bottom: var(--space-lg);
  font-size: var(--text-sm);
  line-height: var(--leading-base);
}

.visualization-box {
  padding: var(--space-lg);
  background: rgba(0, 0, 0, 0.2);
  border-radius: var(--radius-md);
  border: 1px solid rgba(57, 255, 20, 0.2);
}

.advanced-box {
  padding: var(--space-lg);
  background: rgba(0, 0, 0, 0.2);
  border-radius: var(--radius-md);
  border: 1px solid rgba(255, 204, 0, 0.2);
}

.steps-box {
  padding: var(--space-lg);
  background: rgba(255, 255, 255, 0.03);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-light);
}

.function-box {
  padding: var(--space-md);
  background: rgba(255, 255, 255, 0.03);
  border-radius: var(--radius-sm);
}

/* Unit Circle */
.unit-circle {
  width: 160px;
  height: 160px;
  border: 2px solid rgba(45, 212, 255, 0.3);
  border-radius: 50%;
  margin: 0 auto var(--space-md);
  position: relative;
  background: rgba(45, 212, 255, 0.05);
}

.circle-point {
  position: absolute;
  width: 6px;
  height: 6px;
  background: #ff2d55;
  border-radius: 50%;
  top: 50%;
  left: 50%;
  margin: -3px 0 0 -3px;
  transform-origin: center;
  transition: all var(--transition-base);
}

.circle-line {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 2px;
  height: 80px;
  background: rgba(45, 212, 255, 0.5);
  transform-origin: 0 0;
  transition: transform var(--transition-base);
}

/* Embed Button */
.embed-btn {
  background: rgba(45, 212, 255, 0.1);
  color: var(--accent);
  border: 1px solid var(--border-accent);
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--text-sm);
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-family: inherit;
  transition: all var(--transition-fast);
}

.embed-btn:hover {
  background: rgba(45, 212, 255, 0.2);
  transform: translateY(-2px);
}

.embed-btn.copied {
  background: rgba(57, 255, 20, 0.1);
  color: var(--success);
  border-color: rgba(57, 255, 20, 0.3);
}

/* Responsive Design */
@media (max-width: 768px) {
  .primary-btn {
    min-width: 100%;
    margin-bottom: var(--space-sm);
  }
  
  .secondary-btn,
  .danger-btn {
    flex: 1;
    text-align: center;
  }
  
  .output-box {
    max-height: 250px;
    font-size: var(--text-xs);
  }
  
  .unit-circle {
    width: 120px;
    height: 120px;
  }
  
  .circle-line {
    height: 60px;
  }
}

/* Scrollbar Styling */
.output-box::-webkit-scrollbar {
  width: 8px;
}

.output-box::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: var(--radius-sm);
}

.output-box::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: var(--radius-sm);
  opacity: 0.5;
}

.output-box::-webkit-scrollbar-thumb:hover {
  opacity: 0.8;
}
</style>
