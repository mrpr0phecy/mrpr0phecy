<h2 id="trigonometry-title" style="margin-top:0;color:var(--accent);">üìê Trigonometry Helper</h2>

<form aria-describedby="trigonometry-desc">
  <p id="trigonometry-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.8);">
    Calculate sine, cosine, tangent, and related trigonometric functions. Visualize unit circle relationships, solve triangles, and understand formulas.
    <span style="color:var(--accent);font-weight:500;">Perfect for students and professionals!</span>
  </p>

  <!-- Input Section -->
  <div style="background:rgba(255,255,255,0.03);border-radius:8px;padding:16px;margin-bottom:16px;border:1px solid rgba(255,255,255,0.06);">
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
      <!-- Angle Input -->
      <div class="field">
        <label for="tri-angle" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Angle (Œ∏)</label>
        <input id="tri-angle" type="number" placeholder="e.g. 45" step="any" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;" />
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-top:4px;">Enter angle value</div>
      </div>

      <!-- Mode Selection -->
      <div class="field">
        <label for="tri-mode" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Angle Mode</label>
        <select id="tri-mode" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
          <option value="deg" selected>Degrees (¬∞)</option>
          <option value="rad">Radians (rad)</option>
          <option value="grad">Gradians (gon)</option>
        </select>
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-top:4px;">Select angle unit</div>
      </div>
    </div>

    <!-- Triangle Sides (Optional) -->
    <div class="field" style="margin-bottom:16px;">
      <label for="tri-sides" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Triangle Sides (Optional)</label>
      <input id="tri-sides" type="text" placeholder="a=3, b=4, c=5 or a=5, b=12" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;" />
      <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-top:4px;">
        Enter side lengths (comma separated) to check Pythagorean theorem
      </div>
    </div>

    <!-- Quick Angles -->
    <div style="margin-bottom:12px;">
      <div style="color:var(--accent);font-weight:500;margin-bottom:6px;font-size:13px;">Quick Angles:</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button type="button" onclick="triSetAngle(0)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">0¬∞</button>
        <button type="button" onclick="triSetAngle(30)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">30¬∞</button>
        <button type="button" onclick="triSetAngle(45)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">45¬∞</button>
        <button type="button" onclick="triSetAngle(60)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">60¬∞</button>
        <button type="button" onclick="triSetAngle(90)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">90¬∞</button>
        <button type="button" onclick="triSetAngle(Math.PI/4)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">œÄ/4</button>
        <button type="button" onclick="triSetAngle(Math.PI/3)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">œÄ/3</button>
        <button type="button" onclick="triSetAngle(Math.PI/2)" 
                style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">œÄ/2</button>
      </div>
    </div>

    <!-- Settings -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;">
      <div class="field">
        <label for="tri-show-steps" style="display:block;margin-bottom:6px;color:rgba(230,250,255,0.9);font-weight:500;font-size:13px;">Show Steps</label>
        <select id="tri-show-steps" 
                style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:13px;">
          <option value="yes" selected>Yes - Show calculations</option>
          <option value="no">No - Results only</option>
        </select>
      </div>

      <div class="field">
        <label for="tri-precision" style="display:block;margin-bottom:6px;color:rgba(230,250,255,0.9);font-weight:500;font-size:13px;">Decimal Precision</label>
        <select id="tri-precision" 
                style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:13px;">
          <option value="2">2 decimals</option>
          <option value="4" selected>4 decimals</option>
          <option value="6">6 decimals</option>
          <option value="8">8 decimals</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Actions -->
  <div class="actions" style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap;">
    <button type="button" onclick="triSolve()" 
            style="flex:1;min-width:200px;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      üìê Calculate Trig Functions
    </button>
    <button type="button" onclick="triCopy()"
            style="padding:12px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;">
      üìã Copy Results
    </button>
    <button type="button" onclick="triReset()"
            style="padding:12px 16px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;">
      üîÑ Reset
    </button>
  </div>
</form>

<!-- Results -->
<div class="results" aria-live="polite" style="margin-top:16px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üìä Trigonometric Results</h3>
  
  <!-- Primary Results -->
  <div id="tri-output" style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);font-family:monospace;white-space:pre-line;max-height:300px;overflow-y:auto;margin-bottom:16px;">
    Enter an angle to calculate trigonometric functions.
  </div>
  
  <!-- Unit Circle Visualization -->
  <div id="tri-unit-circle" style="display:none;margin-bottom:16px;">
    <div style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(57,255,20,0.2);">
      <div style="color:#39ff14;font-weight:500;margin-bottom:12px;">‚≠ï Unit Circle Visualization</div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;align-items:center;">
        <div style="text-align:center;">
          <div style="width:160px;height:160px;border:2px solid rgba(45,212,255,0.3);border-radius:50%;margin:0 auto 12px;position:relative;background:rgba(45,212,255,0.05);">
            <div id="tri-circle-point" style="position:absolute;width:6px;height:6px;background:#ff2d55;border-radius:50%;top:50%;left:50%;margin:-3px 0 0 -3px;transform-origin:center;"></div>
            <div style="position:absolute;top:50%;left:50%;width:2px;height:80px;background:rgba(45,212,255,0.5);transform-origin:0 0;transform:rotate(45deg);" id="tri-circle-line"></div>
          </div>
          <div style="font-size:12px;color:rgba(230,250,255,0.7);">
            Point position: (cos Œ∏, sin Œ∏)
          </div>
        </div>
        <div>
          <div style="font-size:14px;line-height:1.6;color:rgba(230,250,255,0.9);">
            <div><strong style="color:#2dd4ff;">sin Œ∏</strong> = y-coordinate</div>
            <div><strong style="color:#2dd4ff;">cos Œ∏</strong> = x-coordinate</div>
            <div><strong style="color:#2dd4ff;">tan Œ∏</strong> = y/x = slope</div>
            <div style="margin-top:8px;font-size:12px;color:rgba(230,250,255,0.7);">
              The unit circle has radius = 1
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Additional Functions -->
  <div id="tri-advanced" style="display:none;">
    <div style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(255,204,0,0.2);">
      <div style="color:#ffcc00;font-weight:500;margin-bottom:12px;">üî¢ Additional Functions</div>
      <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
        <div style="padding:10px;background:rgba(255,255,255,0.03);border-radius:6px;">
          <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Reciprocal Functions</div>
          <div id="tri-reciprocal" style="font-size:13px;color:#e6faff;"></div>
        </div>
        <div style="padding:10px;background:rgba(255,255,255,0.03);border-radius:6px;">
          <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Inverse Functions</div>
          <div id="tri-inverse" style="font-size:13px;color:#e6faff;"></div>
        </div>
        <div style="padding:10px;background:rgba(255,255,255,0.03);border-radius:6px;">
          <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Pythagorean Identity</div>
          <div id="tri-identity" style="font-size:13px;color:#e6faff;"></div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Steps & Explanation -->
  <div id="tri-steps-container" style="display:none;margin-top:16px;">
    <div style="padding:16px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid rgba(255,255,255,0.06);">
      <div style="color:var(--accent);font-weight:500;margin-bottom:8px;">üìù Calculation Steps</div>
      <div id="tri-steps" style="font-size:13px;line-height:1.5;color:rgba(230,250,255,0.8);"></div>
    </div>
  </div>
  
  <!-- Status Bar -->
  <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center;font-size:13px;color:rgba(230,250,255,0.7);">
    <div>
      <span id="tri-status">Ready</span>
      <span id="tri-hint" style="margin-left:8px;"></span>
    </div>
    <div id="tri-mode-indicator">Mode: Degrees</div>
  </div>
</div>

<script>
/* trigonometry.html - Enhanced Trigonometry Helper
   - Calculates all trigonometric functions with visualization
   - Shows unit circle relationships and formulas
   - Scoped with tri- prefix
*/

// Common angles in degrees and their exact values
const triExactValues = {
    0: { sin: 0, cos: 1, tan: 0 },
    30: { sin: 0.5, cos: Math.sqrt(3)/2, tan: 1/Math.sqrt(3) },
    45: { sin: Math.sqrt(2)/2, cos: Math.sqrt(2)/2, tan: 1 },
    60: { sin: Math.sqrt(3)/2, cos: 0.5, tan: Math.sqrt(3) },
    90: { sin: 1, cos: 0, tan: Infinity },
    180: { sin: 0, cos: -1, tan: 0 },
    270: { sin: -1, cos: 0, tan: Infinity },
    360: { sin: 0, cos: 1, tan: 0 }
};

// Initialize
function triInitialize() {
    const card = document.currentScript?.closest('.card') || document;
    
    // Set default angle
    card.querySelector('#tri-angle').value = '45';
    
    // Update mode indicator
    card.querySelector('#tri-mode').addEventListener('change', function() {
        const modes = {
            'deg': 'Degrees (¬∞)',
            'rad': 'Radians (rad)',
            'grad': 'Gradians (gon)'
        };
        card.querySelector('#tri-mode-indicator').textContent = `Mode: ${modes[this.value]}`;
    });
    
    console.log('Trigonometry Helper initialized');
}

// Set quick angle
function triSetAngle(angle) {
    const card = document.currentScript?.closest('.card') || document;
    const mode = card.querySelector('#tri-mode').value;
    
    if (mode === 'rad') {
        // If angle is in radians (like œÄ/4), show it as is
        card.querySelector('#tri-angle').value = angle;
    } else {
        card.querySelector('#tri-angle').value = angle;
    }
    
    // Auto-calculate
    setTimeout(() => triSolve(), 100);
}

// Reset form
function triReset() {
    const card = document.currentScript?.closest('.card') || document;
    
    card.querySelector('#tri-angle').value = '';
    card.querySelector('#tri-sides').value = '';
    card.querySelector('#tri-show-steps').value = 'yes';
    card.querySelector('#tri-precision').value = '4';
    card.querySelector('#tri-mode').value = 'deg';
    
    card.querySelector('#tri-output').textContent = 'Enter an angle to calculate trigonometric functions.';
    card.querySelector('#tri-unit-circle').style.display = 'none';
    card.querySelector('#tri-advanced').style.display = 'none';
    card.querySelector('#tri-steps-container').style.display = 'none';
    card.querySelector('#tri-status').textContent = 'Reset';
    card.querySelector('#tri-hint').textContent = '';
    card.querySelector('#tri-mode-indicator').textContent = 'Mode: Degrees';
    
    console.log('Trigonometry Helper reset');
}

// Copy results to clipboard
function triCopy() {
    const card = document.currentScript?.closest('.card') || document;
    const output = card.querySelector('#tri-output').textContent;
    
    if (!output.trim() || output.includes('Enter an angle')) {
        card.querySelector('#tri-hint').textContent = 'Nothing to copy';
        return;
    }
    
    navigator.clipboard.writeText(output).then(() => {
        card.querySelector('#tri-hint').textContent = 'Copied to clipboard!';
        card.querySelector('#tri-hint').style.color = '#39ff14';
        
        setTimeout(() => {
            card.querySelector('#tri-hint').textContent = '';
            card.querySelector('#tri-hint').style.color = '';
        }, 2000);
    }).catch(err => {
        card.querySelector('#tri-hint').textContent = 'Copy failed';
        card.querySelector('#tri-hint').style.color = '#ff4d4d';
        console.error('Copy failed:', err);
    });
}

// Convert angle to radians based on mode
function triToRadians(angle, mode) {
    switch(mode) {
        case 'deg': return angle * Math.PI / 180;
        case 'rad': return angle;
        case 'grad': return angle * Math.PI / 200; // 200 gradians = œÄ radians
        default: return angle;
    }
}

// Format angle display
function triFormatAngle(angle, mode, precision) {
    const formatted = parseFloat(angle.toFixed(precision));
    switch(mode) {
        case 'deg': return `${formatted}¬∞`;
        case 'rad': return `${formatted} rad`;
        case 'grad': return `${formatted} gon`;
        default: return formatted;
    }
}

// Main calculation function
function triSolve() {
    const card = document.currentScript?.closest('.card') || document;
    
    // Get inputs
    const angleInput = card.querySelector('#tri-angle').value.trim();
    const mode = card.querySelector('#tri-mode').value;
    const sidesInput = card.querySelector('#tri-sides').value.trim();
    const showSteps = card.querySelector('#tri-show-steps').value === 'yes';
    const precision = parseInt(card.querySelector('#tri-precision').value);
    
    // Validate angle
    if (!angleInput) {
        card.querySelector('#tri-status').textContent = 'Error';
        card.querySelector('#tri-hint').textContent = 'Please enter an angle';
        card.querySelector('#tri-hint').style.color = '#ff4d4d';
        return;
    }
    
    const angle = parseFloat(angleInput);
    if (isNaN(angle)) {
        card.querySelector('#tri-status').textContent = 'Error';
        card.querySelector('#tri-hint').textContent = 'Invalid angle value';
        card.querySelector('#tri-hint').style.color = '#ff4d4d';
        return;
    }
    
    card.querySelector('#tri-status').textContent = 'Calculating...';
    card.querySelector('#tri-hint').textContent = '';
    
    // Convert to radians for calculations
    const rad = triToRadians(angle, mode);
    
    // Calculate basic functions
    const sinVal = Math.sin(rad);
    const cosVal = Math.cos(rad);
    const tanVal = Math.tan(rad);
    
    // Calculate additional functions
    const cscVal = sinVal !== 0 ? 1 / sinVal : Infinity;
    const secVal = cosVal !== 0 ? 1 / cosVal : Infinity;
    const cotVal = tanVal !== 0 ? 1 / tanVal : Infinity;
    
    // Calculate inverse functions (in radians)
    const asinVal = Math.asin(sinVal);
    const acosVal = Math.acos(cosVal);
    const atanVal = Math.atan(tanVal);
    
    // Check Pythagorean identity
    const identityCheck = (sinVal * sinVal + cosVal * cosVal).toFixed(precision);
    
    // Format values
    const format = (val) => {
        if (!isFinite(val)) return '‚àû';
        return val.toFixed(precision);
    };
    
    const angleDisplay = triFormatAngle(angle, mode, precision);
    
    // Build results
    let result = `üìê TRIGONOMETRIC FUNCTIONS\n`;
    result += '‚ïê'.repeat(40) + '\n\n';
    
    result += `Angle: ${angleDisplay}\n`;
    result += `Radians: ${rad.toFixed(6)} rad\n\n`;
    
    result += `Primary Functions:\n`;
    result += `  sin(${angleDisplay}) = ${format(sinVal)}\n`;
    result += `  cos(${angleDisplay}) = ${format(cosVal)}\n`;
    result += `  tan(${angleDisplay}) = ${format(tanVal)}\n\n`;
    
    result += `Reciprocal Functions:\n`;
    result += `  csc(${angleDisplay}) = ${format(cscVal)}\n`;
    result += `  sec(${angleDisplay}) = ${format(secVal)}\n`;
    result += `  cot(${angleDisplay}) = ${format(cotVal)}\n\n`;
    
    result += `Pythagorean Identity:\n`;
    result += `  sin¬≤ + cos¬≤ = ${identityCheck} (‚âà1)\n`;
    
    // Check if it's a common angle
    if (mode === 'deg' && triExactValues[Math.round(angle)]) {
        const exact = triExactValues[Math.round(angle)];
        if (Math.abs(sinVal - exact.sin) < 0.0001) {
            result += `\nüåü Exact Values (${Math.round(angle)}¬∞):\n`;
            result += `  sin = ${exact.sin}\n`;
            result += `  cos = ${exact.cos}\n`;
            result += `  tan = ${exact.tan}\n`;
        }
    }
    
    // Check triangle sides if provided
    if (sidesInput) {
        const parsed = {};
        sidesInput.split(',').forEach(pair => {
            const [key, value] = pair.split('=').map(s => s.trim());
            if (key && value && !isNaN(parseFloat(value))) {
                parsed[key.toLowerCase()] = parseFloat(value);
            }
        });
        
        if (parsed.a && parsed.b && parsed.c) {
            const a2 = parsed.a * parsed.a;
            const b2 = parsed.b * parsed.b;
            const c2 = parsed.c * parsed.c;
            const isRight = Math.abs(c2 - (a2 + b2)) < 0.0001;
            
            result += `\nüìè Triangle Check (Pythagorean Theorem):\n`;
            result += `  a¬≤ + b¬≤ = ${a2} + ${b2} = ${(a2 + b2).toFixed(2)}\n`;
            result += `  c¬≤ = ${c2.toFixed(2)}\n`;
            result += `  Result: ${isRight ? '‚úì Valid right triangle' : '‚úó Not a right triangle'}\n`;
        } else if (parsed.a && parsed.b) {
            const c = Math.sqrt(parsed.a * parsed.a + parsed.b * parsed.b);
            result += `\nüìè Calculated Hypotenuse:\n`;
            result += `  a = ${parsed.a}, b = ${parsed.b}\n`;
            result += `  c = ‚àö(${parsed.a}¬≤ + ${parsed.b}¬≤) = ${c.toFixed(2)}\n`;
        }
    }
    
    // Update output
    card.querySelector('#tri-output').textContent = result;
    
    // Show unit circle visualization
    triUpdateUnitCircle(angle, mode, sinVal, cosVal);
    card.querySelector('#tri-unit-circle').style.display = 'block';
    
    // Update advanced functions
    triUpdateAdvanced(sinVal, cosVal, tanVal, asinVal, acosVal, atanVal, precision);
    card.querySelector('#tri-advanced').style.display = 'block';
    
    // Show steps if requested
    if (showSteps) {
        triShowSteps(angle, mode, rad, sinVal, cosVal, tanVal, precision);
        card.querySelector('#tri-steps-container').style.display = 'block';
    } else {
        card.querySelector('#tri-steps-container').style.display = 'none';
    }
    
    // Update status
    card.querySelector('#tri-status').textContent = 'Complete';
    card.querySelector('#tri-hint').textContent = `${precision} decimal precision`;
    card.querySelector('#tri-hint').style.color = '#39ff14';
}

// Update unit circle visualization
function triUpdateUnitCircle(angle, mode, sinVal, cosVal) {
    const card = document.currentScript?.closest('.card') || document;
    const point = card.querySelector('#tri-circle-point');
    const line = card.querySelector('#tri-circle-line');
    
    if (!point || !line) return;
    
    // Convert angle to degrees for rotation
    let angleDeg;
    if (mode === 'deg') {
        angleDeg = angle % 360;
    } else if (mode === 'rad') {
        angleDeg = (angle * 180 / Math.PI) % 360;
    } else {
        angleDeg = (angle * 180 / 200) % 360; // grad to deg
    }
    
    // Calculate point position (center is at 80,80 in 160px circle)
    const radius = 80;
    const centerX = radius;
    const centerY = radius;
    const pointX = centerX + cosVal * radius;
    const pointY = centerY - sinVal * radius; // Negative because y increases downward
    
    // Update point position
    point.style.left = `${pointX}px`;
    point.style.top = `${pointY}px`;
    
    // Update line rotation
    line.style.transform = `rotate(${angleDeg}deg)`;
}

// Update advanced functions display
function triUpdateAdvanced(sinVal, cosVal, tanVal, asinVal, acosVal, atanVal, precision) {
    const card = document.currentScript?.closest('.card') || document;
    
    const format = (val) => isFinite(val) ? val.toFixed(precision) : '‚àû';
    
    // Reciprocal functions
    const reciprocalHTML = `
        csc Œ∏ = 1/sin Œ∏ = ${format(1/sinVal)}<br>
        sec Œ∏ = 1/cos Œ∏ = ${format(1/cosVal)}<br>
        cot Œ∏ = 1/tan Œ∏ = ${format(1/tanVal)}
    `;
    card.querySelector('#tri-reciprocal').innerHTML = reciprocalHTML;
    
    // Inverse functions
    const inverseHTML = `
        arcsin(sin Œ∏) = ${asinVal.toFixed(precision)} rad<br>
        arccos(cos Œ∏) = ${acosVal.toFixed(precision)} rad<br>
        arctan(tan Œ∏) = ${atanVal.toFixed(precision)} rad
    `;
    card.querySelector('#tri-inverse').innerHTML = inverseHTML;
    
    // Pythagorean identity
    const identityHTML = `
        sin¬≤Œ∏ + cos¬≤Œ∏ = 1<br>
        ${(sinVal*sinVal).toFixed(precision)} + ${(cosVal*cosVal).toFixed(precision)}<br>
        = ${(sinVal*sinVal + cosVal*cosVal).toFixed(precision)}
    `;
    card.querySelector('#tri-identity').innerHTML = identityHTML;
}

// Show calculation steps
function triShowSteps(angle, mode, rad, sinVal, cosVal, tanVal, precision) {
    const card = document.currentScript?.closest('.card') || document;
    
    const angleDisplay = triFormatAngle(angle, mode, precision);
    const radDisplay = rad.toFixed(6);
    
    let steps = `
        <strong>Step 1: Convert to Radians</strong><br>
        ${angleDisplay} ‚Üí ${radDisplay} rad<br><br>
        
        <strong>Step 2: Calculate Primary Functions</strong><br>
        ‚Ä¢ sin(${angleDisplay}) = sin(${radDisplay} rad) = ${sinVal.toFixed(precision)}<br>
        ‚Ä¢ cos(${angleDisplay}) = cos(${radDisplay} rad) = ${cosVal.toFixed(precision)}<br>
        ‚Ä¢ tan(${angleDisplay}) = sin/cos = ${sinVal.toFixed(precision)}/${cosVal.toFixed(precision)} = ${tanVal.toFixed(precision)}<br><br>
        
        <strong>Step 3: Verify Pythagorean Identity</strong><br>
        sin¬≤ + cos¬≤ = (${sinVal.toFixed(precision)})¬≤ + (${cosVal.toFixed(precision)})¬≤ = ${(sinVal*sinVal + cosVal*cosVal).toFixed(precision)} ‚âà 1<br><br>
        
        <strong>Step 4: Reciprocal Functions</strong><br>
        ‚Ä¢ csc Œ∏ = 1/sin Œ∏ = 1/${sinVal.toFixed(precision)} = ${(1/sinVal).toFixed(precision)}<br>
        ‚Ä¢ sec Œ∏ = 1/cos Œ∏ = 1/${cosVal.toFixed(precision)} = ${(1/cosVal).toFixed(precision)}<br>
        ‚Ä¢ cot Œ∏ = 1/tan Œ∏ = 1/${tanVal.toFixed(precision)} = ${(1/tanVal).toFixed(precision)}
    `;
    
    card.querySelector('#tri-steps').innerHTML = steps;
}

// Initialize when DOM is loaded
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', triInitialize);
} else {
    triInitialize();
}

// Auto-calculate when angle changes
document.addEventListener('DOMContentLoaded', function() {
    const card = document.currentScript?.closest('.card') || document;
    const angleInput = card.querySelector('#tri-angle');
    
    if (angleInput) {
        angleInput.addEventListener('change', function() {
            if (this.value.trim()) {
                triSolve();
            }
        });
    }
});
</script>

<style>
#trigonometry-title {
    color: var(--accent);
    margin-top: 0;
    font-size: 1.2rem;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .actions button {
        min-width: 100% !important;
        margin-bottom: 8px;
    }
    
    #tri-output {
        max-height: 250px;
        font-size: 14px;
    }
}

/* Scrollbar styling */
#tri-output::-webkit-scrollbar {
    width: 8px;
}

#tri-output::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
}

#tri-output::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 4px;
}
</style>
