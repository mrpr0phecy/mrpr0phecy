<!-- cards/gift-helper.html -->

<h2 id="gift-helper-title">Gift Helper üéÅ</h2>

<form aria-describedby="gift-helper-desc">
  <p id="gift-helper-desc" class="small">Find the perfect gift with smart suggestions, reminders, and inspiration for every occasion.</p>

  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div>
      <label for="gh-recipient" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Recipient</label>
      <input id="gh-recipient" type="text" placeholder="e.g. Mum, Best Friend" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gh-occasion" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Occasion</label>
      <select id="gh-occasion" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="Birthday">üéÇ Birthday</option>
        <option value="Anniversary">üíñ Anniversary</option>
        <option value="Wedding">üíç Wedding</option>
        <option value="Graduation">üéì Graduation</option>
        <option value="Holiday">üéÑ Holiday</option>
        <option value="Baby Shower">üë∂ Baby Shower</option>
        <option value="Housewarming">üè† Housewarming</option>
        <option value="Retirement">üë¥ Retirement</option>
        <option value="Thank You">üôè Thank You</option>
        <option value="Just Because">üòä Just Because</option>
      </select>
    </div>
    
    <div>
      <label for="gh-year" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
        Year <span style="color:rgba(230,250,255,0.6);font-size:12px;">(anniversary only)</span>
      </label>
      <input id="gh-year" type="number" min="1" max="100" placeholder="e.g. 20" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gh-budget" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Budget (¬£)</label>
      <div style="position:relative;">
        <span style="position:absolute;left:10px;top:50%;transform:translateY(-50%);color:rgba(230,250,255,0.7);">¬£</span>
        <input id="gh-budget" type="number" min="0" step="0.01" placeholder="0.00" 
               style="width:100%;padding:10px 10px 10px 24px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
      </div>
    </div>
  </div>

  <div style="margin-top:20px;display:flex;gap:10px;">
    <button type="button" onclick="ghAddGift(this)" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      üéÅ Add Gift Plan
    </button>
    <button type="button" onclick="ghReset(this)"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset
    </button>
    <button type="button" onclick="ghExport(this)"
            style="padding:12px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;">
      Export List
    </button>
  </div>
</form>

<div aria-live="polite" style="margin-top:20px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:8px;">Gift Ideas & Plans</h3>
  <div id="gh-gift-list" style="max-height:400px;overflow-y:auto;padding-right:8px;">
    <!-- Gift plans will appear here -->
    <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
      No gift plans yet. Add your first gift idea above!
    </div>
  </div>
</div>

<div style="margin-top:20px;padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
  <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;">üí° Quick Gift Ideas</h4>
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;font-size:13px;">
    <div>
      <div style="color:#ff6b9d;font-weight:600;margin-bottom:4px;">üéÇ Birthday</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Personalized jewelry</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Experience gifts</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Subscription boxes</div>
    </div>
    <div>
      <div style="color:#9d4edd;font-weight:600;margin-bottom:4px;">üíñ Anniversary</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Custom photo book</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Romantic getaway</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Jewelry (see themes)</div>
    </div>
    <div>
      <div style="color:#2dd4ff;font-weight:600;margin-bottom:4px;">üéì Graduation</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Professional watch</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Laptop/tablet</div>
      <div style="color:rgba(230,250,255,0.8);">‚Ä¢ Travel vouchers</div>
    </div>
  </div>
</div>

<script>
/* gift-helper.html
   - Gift planning and suggestion tool
   - Scoped with gh- prefix
*/

// Enhanced anniversary themes with gift suggestions
const anniversaryThemes = {
  1: { 
    traditional: "Paper", 
    modern: "Clocks", 
    gemstone: "Gold",
    suggestions: ["Personalized letter", "Wall clock", "Gold-plated jewelry"]
  },
  5: { 
    traditional: "Wood", 
    modern: "Silverware", 
    gemstone: "Sapphire",
    suggestions: ["Wooden watch", "Silver cutlery set", "Sapphire earrings"]
  },
  10: { 
    traditional: "Tin/Aluminium", 
    modern: "Diamond Jewelry", 
    gemstone: "Silver",
    suggestions: ["Custom tin art", "Diamond pendant", "Silver bracelet"]
  },
  15: { 
    traditional: "Crystal", 
    modern: "Watches", 
    gemstone: "Ruby",
    suggestions: ["Crystal vase", "Luxury watch", "Ruby necklace"]
  },
  20: { 
    traditional: "China", 
    modern: "Platinum", 
    gemstone: "Emerald",
    suggestions: ["Fine china set", "Platinum ring", "Emerald earrings"]
  },
  25: { 
    traditional: "Silver", 
    modern: "Silver", 
    gemstone: "Silver",
    suggestions: ["Silver photo frame", "Silver jewelry set", "Silver keepsake"]
  },
  30: { 
    traditional: "Pearl", 
    modern: "Diamond", 
    gemstone: "Pearl",
    suggestions: ["Pearl necklace", "Diamond anniversary band", "Pearl earrings"]
  },
  40: { 
    traditional: "Ruby", 
    modern: "Ruby", 
    gemstone: "Ruby",
    suggestions: ["Ruby tennis bracelet", "Ruby jewelry set", "Ruby anniversary gift"]
  },
  50: { 
    traditional: "Gold", 
    modern: "Gold", 
    gemstone: "Gold",
    suggestions: ["Gold watch", "Gold jewelry", "Golden anniversary keepsake"]
  },
  60: { 
    traditional: "Diamond", 
    modern: "Diamond", 
    gemstone: "Diamond",
    suggestions: ["Diamond eternity ring", "Diamond jewelry", "Diamond anniversary gift"]
  }
};

// Occasion-specific gift ideas
const occasionIdeas = {
  'Birthday': [
    'Personalized photo album',
    'Experience gift (concert tickets, spa day)',
    'Subscription box (coffee, books, snacks)',
    'Custom jewelry with birthstone',
    'Gourmet food hamper'
  ],
  'Anniversary': [
    'Romantic weekend getaway',
    'Custom star map of wedding date',
    'Engraved jewelry',
    'Love letter time capsule',
    'Professional couple photoshoot'
  ],
  'Wedding': [
    'Quality kitchen appliance',
    'Luxury bedding set',
    'Home decor item',
    'Cash for honeymoon fund',
    'Personalized wedding gift'
  ],
  'Graduation': [
    'Professional briefcase/laptop bag',
    'Quality watch',
    'Gift cards for work attire',
    'Career-related books',
    'Portable power bank'
  ],
  'Holiday': [
    'Cozy blanket or throw',
    'Gourmet food basket',
    'Scented candles set',
    'Festive pajamas',
    'Board games collection'
  ],
  'Baby Shower': [
    'Personalized baby blanket',
    'Diaper cake',
    'Children\'s books collection',
    'Baby milestone cards',
    'Practical baby care kit'
  ],
  'Housewarming': [
    'Quality cookware set',
    'Indoor plants',
    'Smart home device',
    'Cozy throw pillows',
    'Wine or cocktail set'
  ],
  'Retirement': [
    'Travel luggage set',
    'Hobby starter kit',
    'Personalized retirement clock',
    'Golf or fishing gear',
    'Memory scrapbook'
  ],
  'Thank You': [
    'Gourmet chocolate box',
    'Personalized thank you card',
    'Flower bouquet delivery',
    'Quality coffee/tea selection',
    'Gift card to favorite store'
  ],
  'Just Because': [
    'Book by favorite author',
    'Plant with cute pot',
    'Artisanal food item',
    'Cozy socks or slippers',
    'Fun novelty item'
  ]
};

// Budget-based suggestions
const budgetSuggestions = {
  '0-20': [
    'Handwritten letter/card',
    'Homemade baked goods',
    'Small potted plant',
    'Custom playlist',
    'Coffee shop gift card'
  ],
  '20-50': [
    'Quality candle set',
    'Book by favorite author',
    'Gourmet food basket',
    'Movie theater tickets',
    'Small jewelry item'
  ],
  '50-100': [
    'Quality kitchen gadget',
    'Experience voucher',
    'Brand name perfume/cologne',
    'Wireless earbuds',
    'Personalized home decor'
  ],
  '100-250': [
    'Smart watch/fitness tracker',
    'Luxury skincare set',
    'Quality headphones',
    'Weekend getaway voucher',
    'Fine jewelry piece'
  ],
  '250+': [
    'Designer handbag/wallet',
    'High-end electronics',
    'Weekend spa retreat',
    'Fine dining experience',
    'Luxury watch'
  ]
};

let giftPlans = [];
const STORAGE_KEY = 'gift-helper-plans';

// Load saved plans
function ghLoad() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      giftPlans = JSON.parse(saved);
      ghRender();
    }
  } catch (e) {
    console.error('Failed to load gift plans:', e);
  }
}

// Save plans
function ghSave() {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(giftPlans));
  } catch (e) {
    console.error('Failed to save gift plans:', e);
  }
}

function ghAddGift(btn) {
  const card = btn.closest('.card') || document;
  const recipient = card.querySelector('#gh-recipient').value.trim();
  const occasion = card.querySelector('#gh-occasion').value;
  const year = parseInt(card.querySelector('#gh-year').value) || null;
  const budget = parseFloat(card.querySelector('#gh-budget').value) || 0;

  if (!recipient) {
    ghShowMessage(card, 'Please enter a recipient name', '#ff4d4d');
    return;
  }

  const giftId = Date.now();
  giftPlans.push({ 
    id: giftId,
    recipient, 
    occasion, 
    year, 
    budget,
    date: new Date().toLocaleDateString(),
    status: 'planned'
  });
  
  ghRender();
  ghSave();
  
  // Reset form
  card.querySelector('#gh-recipient').value = '';
  card.querySelector('#gh-year').value = '';
  card.querySelector('#gh-budget').value = '';
  card.querySelector('#gh-recipient').focus();
  
  ghShowMessage(card, `‚úÖ Gift plan added for ${recipient}`, '#39ff14');
}

function ghRender() {
  const card = document.currentScript?.closest('.card') || document;
  const list = card.querySelector('#gh-gift-list');
  
  if (giftPlans.length === 0) {
    list.innerHTML = `
      <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
        No gift plans yet. Add your first gift idea above!
      </div>
    `;
    return;
  }
  
  let html = '';
  giftPlans.forEach((g, index) => {
    // Get budget category
    let budgetCategory = 'Custom';
    if (g.budget <= 20) budgetCategory = '0-20';
    else if (g.budget <= 50) budgetCategory = '20-50';
    else if (g.budget <= 100) budgetCategory = '50-100';
    else if (g.budget <= 250) budgetCategory = '100-250';
    else if (g.budget > 250) budgetCategory = '250+';
    
    html += `
      <div class="gift-plan" data-id="${g.id}" 
           style="background:rgba(255,255,255,0.03);border-left:3px solid rgba(45,212,255,0.5);margin-bottom:12px;padding:12px;border-radius:8px;">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;">
          <div style="flex:1;">
            <div style="font-weight:600;color:var(--accent);font-size:16px;">${g.recipient}</div>
            <div style="display:flex;gap:12px;margin-top:6px;font-size:13px;">
              <span style="color:rgba(230,250,255,0.9);background:rgba(45,212,255,0.1);padding:2px 8px;border-radius:12px;">${g.occasion}</span>
              ${g.budget > 0 ? `<span style="color:#39ff14;background:rgba(57,255,20,0.1);padding:2px 8px;border-radius:12px;">¬£${g.budget.toFixed(2)}</span>` : ''}
              <span style="color:rgba(230,250,255,0.7);padding:2px 8px;">Added: ${g.date}</span>
            </div>
          </div>
          <div>
            <button onclick="ghMarkPurchased('${g.id}')" style="background:transparent;border:none;color:#39ff14;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">‚úì Purchased</button>
            <button onclick="ghRemoveGift('${g.id}')" style="background:transparent;border:none;color:#ff4d4d;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">‚úï Remove</button>
          </div>
        </div>
    `;
    
    // Anniversary guidance
    if (g.occasion === 'Anniversary' && g.year) {
      const theme = anniversaryThemes[g.year];
      if (theme) {
        html += `
          <div style="margin-top:10px;padding:8px 12px;background:rgba(255,107,157,0.1);border-radius:6px;border-left:3px solid #ff6b9d;">
            <div style="color:#ff6b9d;font-weight:600;font-size:13px;">${g.year}th Anniversary Themes:</div>
            <div style="display:flex;gap:12px;margin-top:4px;font-size:12px;">
              <span>Traditional: ${theme.traditional}</span>
              <span>Modern: ${theme.modern}</span>
              <span>Gemstone: ${theme.gemstone}</span>
            </div>
            <div style="margin-top:4px;font-size:12px;color:rgba(230,250,255,0.8);">
              Ideas: ${theme.suggestions.slice(0, 2).join(', ')}
            </div>
          </div>
        `;
      }
    }
    
    // Budget-based suggestions
    if (g.budget > 0 && budgetSuggestions[budgetCategory]) {
      const suggestions = budgetSuggestions[budgetCategory];
      html += `
        <div style="margin-top:8px;padding:8px 12px;background:rgba(45,212,255,0.1);border-radius:6px;">
          <div style="color:var(--accent);font-weight:600;font-size:13px;">üí° Budget Suggestions (¬£${budgetCategory}):</div>
          <div style="margin-top:4px;font-size:12px;color:rgba(230,250,255,0.8);">
            ${suggestions.slice(0, 3).map(s => `‚Ä¢ ${s}`).join('<br>')}
          </div>
        </div>
      `;
    }
    
    // Occasion-specific ideas
    if (occasionIdeas[g.occasion]) {
      const ideas = occasionIdeas[g.occasion];
      html += `
        <div style="margin-top:8px;padding:8px 12px;background:rgba(157,78,221,0.1);border-radius:6px;">
          <div style="color:#9d4edd;font-weight:600;font-size:13px;">üéØ ${g.occasion} Ideas:</div>
          <div style="margin-top:4px;font-size:12px;color:rgba(230,250,255,0.8);">
            ${ideas.slice(0, 3).map(idea => `‚Ä¢ ${idea}`).join('<br>')}
          </div>
        </div>
      `;
    }
    
    html += `</div>`;
  });
  
  list.innerHTML = html;
}

function ghMarkPurchased(giftId) {
  const gift = giftPlans.find(g => g.id == giftId);
  if (gift) {
    gift.status = 'purchased';
    ghRender();
    ghSave();
    
    const card = document.currentScript?.closest('.card') || document;
    ghShowMessage(card, `‚úÖ Marked as purchased for ${gift.recipient}`, '#39ff14');
  }
}

function ghRemoveGift(giftId) {
  if (!confirm('Remove this gift plan?')) return;
  
  giftPlans = giftPlans.filter(g => g.id != giftId);
  ghRender();
  ghSave();
}

function ghReset(btn) {
  const card = btn.closest('.card') || document;
  card.querySelector('#gh-recipient').value = '';
  card.querySelector('#gh-occasion').value = 'Birthday';
  card.querySelector('#gh-year').value = '';
  card.querySelector('#gh-budget').value = '';
  card.querySelector('#gh-recipient').focus();
}

function ghExport(btn) {
  if (giftPlans.length === 0) {
    const card = document.currentScript?.closest('.card') || document;
    ghShowMessage(card, 'No gift plans to export', '#ff4d4d');
    return;
  }
  
  let csv = 'Recipient,Occasion,Year,Budget,Status,Date Added\n';
  giftPlans.forEach(g => {
    csv += `"${g.recipient}","${g.occasion}",${g.year || ''},${g.budget || 0},"${g.status}","${g.date}"\n`;
  });
  
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'gift-plans.csv';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  const card = document.currentScript?.closest('.card') || document;
  ghShowMessage(card, '‚úÖ Gift plans exported as CSV', '#39ff14');
}

function ghShowMessage(card, message, color = '#2dd4ff') {
  // Create a temporary message div
  const messageDiv = document.createElement('div');
  messageDiv.textContent = message;
  messageDiv.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(20,20,20,0.95);
    color: ${color};
    padding: 12px 16px;
    border-radius: 8px;
    border: 1px solid ${color}40;
    z-index: 10000;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  `;
  
  document.body.appendChild(messageDiv);
  
  setTimeout(() => {
    messageDiv.style.opacity = '0';
    messageDiv.style.transform = 'translateX(20px)';
    setTimeout(() => {
      if (messageDiv.parentNode) {
        document.body.removeChild(messageDiv);
      }
    }, 300);
  }, 2000);
}

// Load saved plans on startup
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(ghLoad, 100);
  });
} else {
  setTimeout(ghLoad, 100);
}
</script>

<style>
#gift-helper-title {
  color: var(--accent);
  margin-top: 0;
  border-bottom: 1px solid rgba(45,212,255,0.2);
  padding-bottom: 10px;
  margin-bottom: 16px;
}

.gift-plan {
  transition: all 0.2s ease;
}

.gift-plan:hover {
  background: rgba(45,212,255,0.05) !important;
  transform: translateX(2px);
}

#gh-gift-list::-webkit-scrollbar {
  width: 6px;
}

#gh-gift-list::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#gh-gift-list::-webkit-scrollbar-thumb {
  background: rgba(45,212,255,0.3);
  border-radius: 3px;
}

@media (max-width: 768px) {
  div[style*="grid-template-columns:repeat(auto-fit"] {
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }
  
  .actions {
    flex-direction: column !important;
  }
  
  .actions button {
    width: 100% !important;
    margin-bottom: 8px;
  }
  
  .gift-plan > div:first-child {
    flex-direction: column !important;
    gap: 8px;
  }
  
  .gift-plan > div:first-child > div:last-child {
    align-self: flex-end;
  }
}
</style>
