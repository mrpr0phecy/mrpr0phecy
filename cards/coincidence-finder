<!-- cards/coincidence-finder.html -->
<h2 id="coincidence-finder-title">üîÆ Coincidence Finder & Synchronicity Tracker</h2>

<form aria-describedby="coincidence-finder-desc">
    <p id="coincidence-finder-desc" class="small">
        Discover meaningful coincidences and synchronicities across multiple real-time data sources.
        <span style="color:var(--accent)">Tracks news, numbers, dates, names, and global patterns!</span>
    </p>
    
    <!-- SEARCH MODES -->
    <div class="section" style="margin-bottom:20px;padding:16px;background:rgba(45,212,255,0.05);border-radius:10px;border:1px solid rgba(45,212,255,0.2);">
        <h3 style="color:var(--accent);margin-top:0;margin-bottom:12px;">üéØ Search Modes</h3>
        
        <div style="display:flex;gap:12px;margin-bottom:16px;flex-wrap:wrap;">
            <button type="button" onclick="cfSwitchMode('numbers')" id="cf-mode-numbers" 
                    style="padding:10px 16px;background:rgba(45,212,255,0.2);border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
                üî¢ Numbers & Dates
            </button>
            <button type="button" onclick="cfSwitchMode('names')" id="cf-mode-names" 
                    style="padding:10px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
                üë• Names & People
            </button>
            <button type="button" onclick="cfSwitchMode('events')" id="cf-mode-events" 
                    style="padding:10px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
                üì∞ News & Events
            </button>
            <button type="button" onclick="cfSwitchMode('patterns')" id="cf-mode-patterns" 
                    style="padding:10px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
                üåÄ Patterns & Symbols
            </button>
        </div>
        
        <!-- NUMBERS MODE -->
        <div id="cf-numbers-input" style="display:block;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:12px;">
                <div>
                    <label for="cf-number-input" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Number or Date
                    </label>
                    <input id="cf-number-input" type="text" placeholder="e.g., 777, 11:11, 2024-03-15" 
                           style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.03);color:inherit;" />
                </div>
                <div>
                    <label for="cf-number-type" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Analysis Type
                    </label>
                    <select id="cf-number-type" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                        <option value="numerology">Numerology</option>
                        <option value="angel">Angel Numbers</option>
                        <option value="date">Date Analysis</option>
                        <option value="time">Time Patterns</option>
                        <option value="math">Mathematical</option>
                    </select>
                </div>
            </div>
            
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
                <button type="button" onclick="cfSetNumber('111')" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">111</button>
                <button type="button" onclick="cfSetNumber('333')" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">333</button>
                <button type="button" onclick="cfSetNumber('777')" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">777</button>
                <button type="button" onclick="cfSetDate('today')" style="padding:6px 12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:12px;">Today's Date</button>
                <button type="button" onclick="cfSetDate('birth')" style="padding:6px 12px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);border-radius:6px;color:#ffcc00;cursor:pointer;font-size:12px;">Your Birthday</button>
            </div>
        </div>
        
        <!-- NAMES MODE -->
        <div id="cf-names-input" style="display:none;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                <div>
                    <label for="cf-name-input" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Name or Word
                    </label>
                    <input id="cf-name-input" type="text" placeholder="e.g., John, Maria, Phoenix" 
                           style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.03);color:inherit;" />
                </div>
                <div>
                    <label for="cf-name-analysis" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Analysis Method
                    </label>
                    <select id="cf-name-analysis" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                        <option value="gematria">Gematria (Numerical)</option>
                        <option value="synchronicity">Name Synchronicity</option>
                        <option value="celebrity">Celebrity Matches</option>
                        <option value="historical">Historical Figures</option>
                        <option value="anagram">Anagram Finder</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- EVENTS MODE -->
        <div id="cf-events-input" style="display:none;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                <div>
                    <label for="cf-event-input" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Event or Topic
                    </label>
                    <input id="cf-event-input" type="text" placeholder="e.g., eclipse, election, discovery" 
                           style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.03);color:inherit;" />
                </div>
                <div>
                    <label for="cf-event-source" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                        Data Source
                    </label>
                    <select id="cf-event-source" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                        <option value="news">Current News</option>
                        <option value="historical">Historical Events</option>
                        <option value="scientific">Scientific Discoveries</option>
                        <option value="cultural">Cultural Events</option>
                        <option value="all">All Sources</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- PATTERNS MODE -->
        <div id="cf-patterns-input" style="display:none;">
            <div style="margin-bottom:12px;">
                <label for="cf-pattern-input" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Pattern or Symbol
                </label>
                <input id="cf-pattern-input" type="text" placeholder="e.g., spiral, triangle, fibonacci" 
                       style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.03);color:inherit;" />
            </div>
            
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
                <button type="button" onclick="cfSetPattern('golden')" style="padding:6px 12px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);border-radius:6px;color:#ffcc00;cursor:pointer;font-size:12px;">Golden Ratio</button>
                <button type="button" onclick="cfSetPattern('fibonacci')" style="padding:6px 12px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);border-radius:6px;color:#ffcc00;cursor:pointer;font-size:12px;">Fibonacci</button>
                <button type="button" onclick="cfSetPattern('mandala')" style="padding:6px 12px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);border-radius:6px;color:#9d4edd;cursor:pointer;font-size:12px;">Sacred Geometry</button>
                <button type="button" onclick="cfSetPattern('repeating')" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Repeating Patterns</button>
            </div>
        </div>
    </div>
    
    <!-- COINCIDENCE SETTINGS -->
    <div class="section" style="margin-bottom:20px;padding:16px;background:rgba(157,78,221,0.05);border-radius:10px;border:1px solid rgba(157,78,221,0.2);">
        <h3 style="color:#9d4edd;margin-top:0;margin-bottom:12px;">‚öôÔ∏è Coincidence Settings</h3>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:16px;">
            <div>
                <label for="cf-probability" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                    Probability Threshold
                </label>
                <select id="cf-probability" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(157,78,221,0.3);background:rgba(157,78,221,0.05);color:inherit;">
                    <option value="0.001">Very Rare (0.1%)</option>
                    <option value="0.01" selected>Rare (1%)</option>
                    <option value="0.05">Uncommon (5%)</option>
                    <option value="0.10">Somewhat Common (10%)</option>
                    <option value="0.25">Common (25%)</option>
                </select>
            </div>
            
            <div>
                <label for="cf-timeframe" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                    Time Frame
                </label>
                <select id="cf-timeframe" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(157,78,221,0.3);background:rgba(157,78,221,0.05);color:inherit;">
                    <option value="24h">Last 24 Hours</option>
                    <option value="7d" selected>Last 7 Days</option>
                    <option value="30d">Last 30 Days</option>
                    <option value="year">This Year</option>
                    <option value="all">All Time</option>
                </select>
            </div>
            
            <div>
                <label for="cf-significance" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                    Significance Level
                </label>
                <select id="cf-significance" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(157,78,221,0.3);background:rgba(157,78,221,0.05);color:inherit;">
                    <option value="high">High (Meaningful)</option>
                    <option value="medium" selected>Medium (Interesting)</option>
                    <option value="low">Low (All Patterns)</option>
                </select>
            </div>
        </div>
        
        <!-- DATA SOURCES -->
        <div style="margin-bottom:12px;">
            <div style="color:var(--accent);font-weight:500;margin-bottom:8px;font-size:14px;">Data Sources</div>
            <div style="display:flex;flex-wrap:wrap;gap:8px;">
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-source-news" checked style="accent-color:#39ff14;">
                    <span style="color:#39ff14;font-size:13px;">News APIs</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-source-wiki" checked style="accent-color:#2dd4ff;">
                    <span style="color:#2dd4ff;font-size:13px;">Wikipedia</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-source-nasa" checked style="accent-color:#ffcc00;">
                    <span style="color:#ffcc00;font-size:13px;">NASA/ESA Data</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-source-weather" checked style="accent-color:#ff2d55;">
                    <span style="color:#ff2d55;font-size:13px;">Weather Data</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-source-social" style="accent-color:#9d4edd;">
                    <span style="color:#9d4edd;font-size:13px;">Social Trends</span>
                </label>
            </div>
        </div>
        
        <!-- ADVANCED OPTIONS -->
        <div>
            <div style="color:var(--accent);font-weight:500;margin-bottom:8px;font-size:14px;">Advanced Options</div>
            <div style="display:flex;flex-wrap:wrap;gap:12px;">
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-advanced-probability" style="accent-color:var(--accent);">
                    <span style="font-size:13px;">Calculate Probability</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-advanced-timeline" checked style="accent-color:var(--accent);">
                    <span style="font-size:13px;">Show Timeline</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;">
                    <input type="checkbox" id="cf-advanced-crossref" checked style="accent-color:var(--accent);">
                    <span style="font-size:13px;">Cross-Reference Sources</span>
                </label>
            </div>
        </div>
    </div>
    
    <!-- ACTION BUTTONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="cfFindCoincidences()" 
                style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(157,78,221,0.3), rgba(45,212,255,0.2));border:1px solid rgba(157,78,221,0.6);border-radius:10px;color:#9d4edd;cursor:pointer;font-weight:600;font-size:16px;">
            üîç Find Coincidences
        </button>
        <button type="button" onclick="cfRandomSearch()"
                style="padding:14px 20px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600;">
            üé≤ Random Search
        </button>
        <button type="button" onclick="cfResetAll()"
                style="padding:14px 20px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:10px;color:#ff4d4d;cursor:pointer;font-weight:600;">
            üîÑ Reset
        </button>
    </div>
</form>

<!-- LIVE DATA FEED -->
<div class="section" style="margin-top:24px;padding:20px;background:rgba(0,0,0,0.2);border-radius:10px;border:1px solid rgba(255,255,255,0.1);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="color:var(--accent);margin:0;">üì° Live Data Sources</h3>
        <button type="button" onclick="cfRefreshSources()" 
                style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">
            üîÑ Refresh
        </button>
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:12px;margin-bottom:20px;">
        <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;text-align:center;">
            <div style="font-size:24px;color:#39ff14;" id="cf-source-news-status">‚úì</div>
            <div style="font-size:11px;color:rgba(230,250,255,0.7);">News API</div>
        </div>
        
        <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;text-align:center;">
            <div style="font-size:24px;color:#2dd4ff;" id="cf-source-wiki-status">‚úì</div>
            <div style="font-size:11px;color:rgba(230,250,255,0.7);">Wikipedia</div>
        </div>
        
        <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:8px;text-align:center;">
            <div style="font-size:24px;color:#ffcc00;" id="cf-source-nasa-status">‚úì</div>
            <div style="font-size:11px;color:rgba(230,250,255,0.7);">Space Data</div>
        </div>
        
        <div style="padding:12px;background:rgba(255,45,85,0.05);border-radius:8px;text-align:center;">
            <div style="font-size:24px;color:#ff2d55;" id="cf-source-weather-status">‚úì</div>
            <div style="font-size:11px;color:rgba(230,250,255,0.7);">Weather</div>
        </div>
        
        <div style="padding:12px;background:rgba(157,78,221,0.05);border-radius:8px;text-align:center;">
            <div style="font-size:24px;color:#9d4edd;" id="cf-source-social-status">‚Äì</div>
            <div style="font-size:11px;color:rgba(230,250,255,0.7);">Social Trends</div>
        </div>
    </div>
    
    <!-- CURRENT COINCIDENCES -->
    <div style="margin-top:16px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:12px;">üåç Current Global Coincidences</div>
        
        <div id="cf-live-coincidences" style="display:flex;flex-direction:column;gap:8px;">
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid #39ff14;">
                <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                    <div style="color:#39ff14;font-weight:500;font-size:13px;">Numerical Patterns</div>
                    <div style="font-size:11px;color:rgba(230,250,255,0.6);">Just now</div>
                </div>
                <div style="font-size:12px;color:rgba(230,250,255,0.9);">
                    Multiple news outlets reporting similar statistics today (e.g., "7.7% increase" appearing across 5+ sources)
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid #ffcc00;">
                <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                    <div style="color:#ffcc00;font-weight:500;font-size:13px;">Name Synchronicity</div>
                    <div style="font-size:11px;color:rgba(230,250,255,0.6);">2 hours ago</div>
                </div>
                <div style="font-size:12px;color:rgba(230,250,255,0.9);">
                    3 major events today involve individuals named "Alex" or "Alexander" across different fields
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid #2dd4ff;">
                <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                    <div style="color:#2dd4ff;font-weight:500;font-size:13px;">Date Coincidence</div>
                    <div style="font-size:11px;color:rgba(230,250,255,0.6);">Today</div>
                </div>
                <div style="font-size:12px;color:rgba(230,250,255,0.9);">
                    Today's date (March 15) matches historical events from exactly 10, 50, and 100 years ago
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ANALYSIS RESULTS -->
<div class="section" style="margin-top:24px;padding:24px;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(157,78,221,0.05));border-radius:12px;border:1px solid rgba(45,212,255,0.2);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
        <h3 style="color:var(--accent);margin:0;">üìä Coincidence Analysis</h3>
        <div style="display:flex;gap:8px;align-items:center;">
            <div style="font-size:12px;color:rgba(230,250,255,0.7);" id="cf-analysis-status">Ready to analyze</div>
            <button type="button" onclick="cfExportResults()" 
                    style="padding:6px 12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:12px;">
                üì• Export
            </button>
        </div>
    </div>
    
    <!-- COINCIDENCE METRICS -->
    <div style="margin-bottom:24px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:12px;text-align:center;">üìà Coincidence Metrics</div>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));gap:12px;margin-bottom:16px;">
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;text-align:center;">
                <div style="font-size:24px;font-weight:bold;color:#39ff14;" id="cf-metric-count">0</div>
                <div style="font-size:11px;color:rgba(230,250,255,0.7);">Found Coincidences</div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;text-align:center;">
                <div style="font-size:24px;font-weight:bold;color:#ffcc00;" id="cf-metric-probability">0%</div>
                <div style="font-size:11px;color:rgba(230,250,255,0.7);">Probability</div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;text-align:center;">
                <div style="font-size:24px;font-weight:bold;color:#2dd4ff;" id="cf-metric-significance">0.0</div>
                <div style="font-size:11px;color:rgba(230,250,255,0.7);">Significance Score</div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;text-align:center;">
                <div style="font-size:24px;font-weight:bold;color:#ff2d55;" id="cf-metric-sources">0</div>
                <div style="font-size:11px;color:rgba(230,250,255,0.7);">Data Sources</div>
            </div>
        </div>
        
        <!-- PROBABILITY INDICATOR -->
        <div style="margin-top:16px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                <div style="color:var(--accent);font-weight:500;font-size:14px;">Probability Indicator</div>
                <div style="color:rgba(230,250,255,0.7);font-size:12px;" id="cf-probability-label">Not Analyzed</div>
            </div>
            
            <div style="height:12px;background:linear-gradient(90deg, #39ff14, #ffcc00, #ff2d55);border-radius:6px;overflow:hidden;">
                <div id="cf-probability-bar" style="height:100%;width:0%;background:rgba(0,0,0,0.3);transition:width 1s ease;"></div>
            </div>
            
            <div style="display:flex;justify-content:space-between;margin-top:6px;font-size:11px;color:rgba(230,250,255,0.6);">
                <span>Expected</span>
                <span>Random</span>
                <span>Significant</span>
            </div>
        </div>
    </div>
    
    <!-- COINCIDENCE RESULTS -->
    <div id="cf-results-container" style="max-height:600px;overflow-y:auto;padding-right:8px;">
        <div style="text-align:center;padding:40px;color:rgba(230,250,255,0.5);">
            <div style="font-size:48px;margin-bottom:16px;">üîÆ</div>
            <div style="font-size:16px;color:var(--accent);margin-bottom:8px;">No Analysis Yet</div>
            <div style="font-size:14px;">Enter search criteria and click "Find Coincidences" to begin</div>
        </div>
    </div>
    
    <!-- TIMELINE VISUALIZATION -->
    <div id="cf-timeline" style="display:none;margin-top:24px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:12px;text-align:center;">‚è≥ Coincidence Timeline</div>
        
        <div style="padding:20px;background:rgba(0,0,0,0.3);border-radius:10px;">
            <div style="height:200px;position:relative;" id="cf-timeline-visual">
                <!-- Timeline will be drawn here -->
                <div style="position:absolute;bottom:0;left:0;right:0;height:2px;background:rgba(255,255,255,0.2);"></div>
                <div style="position:absolute;bottom:0;left:0;width:100%;height:2px;background:linear-gradient(90deg, #39ff14, #2dd4ff, #ffcc00, #ff2d55, #9d4edd);"></div>
            </div>
            
            <div style="display:flex;justify-content:space-between;margin-top:12px;font-size:11px;color:rgba(230,250,255,0.6);">
                <span id="cf-timeline-start">Past</span>
                <span id="cf-timeline-mid">Present</span>
                <span id="cf-timeline-end">Future</span>
            </div>
        </div>
    </div>
</div>

<!-- INTERPRETATION & MEANING -->
<div class="section" style="margin-top:24px;padding:20px;background:rgba(0,0,0,0.2);border-radius:10px;border:1px solid rgba(255,255,255,0.1);">
    <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;text-align:center;">üí≠ Interpretation & Meaning</h3>
    
    <div id="cf-interpretation">
        <div style="text-align:center;padding:20px;color:rgba(230,250,255,0.7);">
            Coincidence analysis will appear here. Discover patterns, meanings, and potential significance.
        </div>
    </div>
    
    <!-- SYMBOLIC MEANINGS -->
    <div style="margin-top:20px;">
        <div style="color:var(--accent);font-weight:500;margin-bottom:12px;">üîÆ Common Symbolic Meanings</div>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
            <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
                <div style="color:#39ff14;font-weight:600;margin-bottom:4px;font-size:13px;">111 & 1111</div>
                <div style="font-size:12px;color:rgba(230,250,255,0.8);">
                    New beginnings, alignment, manifestation. Often called "angel numbers."
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
                <div style="color:#ffcc00;font-weight:600;margin-bottom:4px;font-size:13px;">333</div>
                <div style="font-size:12px;color:rgba(230,250,255,0.8);">
                    Growth, creativity, divine protection. Associated with spiritual guides.
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
                <div style="color:#ff2d55;font-weight:600;margin-bottom:4px;font-size:13px;">777</div>
                <div style="font-size:12px;color:rgba(230,250,255,0.8);">
                    Luck, spiritual awakening, inner wisdom. Considered highly auspicious.
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;">
                <div style="color:#9d4edd;font-weight:600;margin-bottom:4px;font-size:13px;">Namesakes</div>
                <div style="font-size:12px;color:rgba(230,250,255,0.8);">
                    Shared names across events may indicate thematic connections or patterns.
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ACTIONS -->
<div class="actions" style="margin-top:24px;display:flex;gap:10px;">
    <button type="button" onclick="cfSaveAnalysis()" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
        üíæ Save Analysis
    </button>
    <button type="button" onclick="cfShareResults()"
            style="padding:12px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;">
        üîó Share
    </button>
</div>

<script>
/* coincidence-finder.html
   - Advanced coincidence and synchronicity analyzer
   - Scoped with cf- prefix
*/

let cfCurrentMode = 'numbers';
let cfAnalysisResults = [];
let cfDataSourceStatus = {
    news: true,
    wiki: true,
    nasa: false,
    weather: true,
    social: false
};

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    console.log('Coincidence Finder ready');
    
    // Initialize data source status
    cfUpdateDataSourceStatus();
    
    // Load example coincidences
    setTimeout(cfLoadExampleCoincidences, 1000);
    
    // Setup number input
    const numberInput = document.getElementById('cf-number-input');
    numberInput.addEventListener('input', function() {
        // Auto-detect date format
        const value = this.value.trim();
        if (/^\d{4}-\d{2}-\d{2}$/.test(value)) {
            document.getElementById('cf-number-type').value = 'date';
        } else if (/^\d{1,2}:\d{2}$/.test(value)) {
            document.getElementById('cf-number-type').value = 'time';
        }
    });
});

// Switch search modes
function cfSwitchMode(mode) {
    cfCurrentMode = mode;
    
    // Update button styles
    ['numbers', 'names', 'events', 'patterns'].forEach(m => {
        const btn = document.getElementById(`cf-mode-${m}`);
        btn.style.background = m === mode ? 'rgba(45,212,255,0.2)' : 'rgba(255,255,255,0.05)';
        btn.style.border = m === mode ? '1px solid rgba(45,212,255,0.4)' : '1px solid rgba(255,255,255,0.1)';
        btn.style.color = m === mode ? 'var(--accent)' : 'inherit';
        btn.style.fontWeight = m === mode ? '600' : 'normal';
    });
    
    // Show/hide input sections
    document.getElementById('cf-numbers-input').style.display = mode === 'numbers' ? 'block' : 'none';
    document.getElementById('cf-names-input').style.display = mode === 'names' ? 'block' : 'none';
    document.getElementById('cf-events-input').style.display = mode === 'events' ? 'block' : 'none';
    document.getElementById('cf-patterns-input').style.display = mode === 'patterns' ? 'block' : 'none';
}

// Set number shortcuts
function cfSetNumber(number) {
    document.getElementById('cf-number-input').value = number;
    document.getElementById('cf-number-type').value = number.length === 3 ? 'angel' : 'numerology';
}

// Set date shortcuts
function cfSetDate(type) {
    const now = new Date();
    if (type === 'today') {
        const dateStr = now.toISOString().split('T')[0];
        document.getElementById('cf-number-input').value = dateStr;
        document.getElementById('cf-number-type').value = 'date';
    } else if (type === 'birth') {
        // Default to famous birth date (Albert Einstein)
        document.getElementById('cf-number-input').value = '1879-03-14';
        document.getElementById('cf-number-type').value = 'date';
    }
}

// Set pattern shortcuts
function cfSetPattern(pattern) {
    const patterns = {
        'golden': '1.618 (Golden Ratio)',
        'fibonacci': 'Fibonacci Sequence',
        'mandala': 'Sacred Geometry',
        'repeating': 'Repeating Numbers'
    };
    document.getElementById('cf-pattern-input').value = patterns[pattern];
}

// Update data source status
function cfUpdateDataSourceStatus() {
    // This would check actual API availability
    // For now, simulate status
    
    const statusElements = {
        'news': document.getElementById('cf-source-news-status'),
        'wiki': document.getElementById('cf-source-wiki-status'),
        'nasa': document.getElementById('cf-source-nasa-status'),
        'weather': document.getElementById('cf-source-weather-status'),
        'social': document.getElementById('cf-source-social-status')
    };
    
    // Simulate different statuses
    const statuses = {
        'news': { symbol: '‚úì', color: '#39ff14' },
        'wiki': { symbol: '‚úì', color: '#2dd4ff' },
        'nasa': { symbol: '‚ö†', color: '#ffcc00' },
        'weather': { symbol: '‚úì', color: '#ff2d55' },
        'social': { symbol: '‚Äì', color: '#9d4edd' }
    };
    
    Object.entries(statusElements).forEach(([source, element]) => {
        const status = statuses[source];
        element.textContent = status.symbol;
        element.style.color = status.color;
    });
}

// Refresh data sources
function cfRefreshSources() {
    const btn = document.querySelector('button[onclick="cfRefreshSources()"]');
    const originalText = btn.textContent;
    btn.textContent = 'Refreshing...';
    btn.disabled = true;
    
    setTimeout(() => {
        cfUpdateDataSourceStatus();
        btn.textContent = originalText;
        btn.disabled = false;
        cfShowMessage('Data sources refreshed', 'success');
    }, 1500);
}

// Load example coincidences
function cfLoadExampleCoincidences() {
    // These would come from APIs in a real implementation
    const examples = [
        {
            type: 'Numerical Patterns',
            time: 'Just now',
            description: 'Multiple news outlets reporting similar statistics today (e.g., "7.7% increase" appearing across 5+ sources)',
            color: '#39ff14',
            probability: 0.02
        },
        {
            type: 'Name Synchronicity',
            time: '2 hours ago',
            description: '3 major events today involve individuals named "Alex" or "Alexander" across different fields',
            color: '#ffcc00',
            probability: 0.05
        },
        {
            type: 'Date Coincidence',
            time: 'Today',
            description: "Today's date (March 15) matches historical events from exactly 10, 50, and 100 years ago",
            color: '#2dd4ff',
            probability: 0.01
        }
    ];
    
    const container = document.getElementById('cf-live-coincidences');
    container.innerHTML = '';
    
    examples.forEach(example => {
        const div = document.createElement('div');
        div.style.cssText = 'padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid ' + example.color + ';';
        
        div.innerHTML = `
            <div style="display:flex;justify-content:space-between;margin-bottom:4px;">
                <div style="color:${example.color};font-weight:500;font-size:13px;">${example.type}</div>
                <div style="font-size:11px;color:rgba(230,250,255,0.6);">${example.time}</div>
            </div>
            <div style="font-size:12px;color:rgba(230,250,255,0.9);">
                ${example.description}
            </div>
        `;
        
        container.appendChild(div);
    });
}

// Main coincidence finding function
function cfFindCoincidences() {
    let searchTerm = '';
    let searchType = '';
    
    // Get search criteria based on current mode
    switch(cfCurrentMode) {
        case 'numbers':
            searchTerm = document.getElementById('cf-number-input').value.trim();
            searchType = document.getElementById('cf-number-type').value;
            break;
        case 'names':
            searchTerm = document.getElementById('cf-name-input').value.trim();
            searchType = document.getElementById('cf-name-analysis').value;
            break;
        case 'events':
            searchTerm = document.getElementById('cf-event-input').value.trim();
            searchType = document.getElementById('cf-event-source').value;
            break;
        case 'patterns':
            searchTerm = document.getElementById('cf-pattern-input').value.trim();
            searchType = 'pattern';
            break;
    }
    
    if (!searchTerm) {
        cfShowMessage('Please enter search criteria', 'warning');
        return;
    }
    
    // Show loading state
    const findBtn = document.querySelector('button[onclick="cfFindCoincidences()"]');
    const originalText = findBtn.textContent;
    findBtn.textContent = 'üîç Searching...';
    findBtn.disabled = true;
    
    document.getElementById('cf-analysis-status').textContent = 'Analyzing...';
    document.getElementById('cf-analysis-status').style.color = '#ffcc00';
    
    // Get settings
    const probability = parseFloat(document.getElementById('cf-probability').value);
    const timeframe = document.getElementById('cf-timeframe').value;
    const significance = document.getElementById('cf-significance').value;
    const advancedProb = document.getElementById('cf-advanced-probability').checked;
    const showTimeline = document.getElementById('cf-advanced-timeline').checked;
    
    // Simulate API search (in real implementation, this would call multiple APIs)
    setTimeout(() => {
        try {
            // Generate mock coincidences based on search
            cfAnalysisResults = cfGenerateMockCoincidences(searchTerm, searchType, {
                probability,
                timeframe,
                significance,
                advancedProb
            });
            
            // Display results
            cfDisplayResults(cfAnalysisResults);
            
            // Update metrics
            cfUpdateMetrics(cfAnalysisResults);
            
            // Show timeline if enabled
            if (showTimeline && cfAnalysisResults.length > 0) {
                document.getElementById('cf-timeline').style.display = 'block';
                cfDrawTimeline(cfAnalysisResults);
            } else {
                document.getElementById('cf-timeline').style.display = 'none';
            }
            
            // Generate interpretation
            cfGenerateInterpretation(cfAnalysisResults, searchTerm, searchType);
            
            cfShowMessage(`Found ${cfAnalysisResults.length} coincidences`, 'success');
            
        } catch (error) {
            console.error('Analysis error:', error);
            cfShowMessage('Analysis failed - try different criteria', 'error');
        } finally {
            // Restore button
            findBtn.textContent = originalText;
            findBtn.disabled = false;
            document.getElementById('cf-analysis-status').textContent = 'Analysis complete';
            document.getElementById('cf-analysis-status').style.color = '#39ff14';
        }
    }, 2000);
}

// Generate mock coincidences (simulating API responses)
function cfGenerateMockCoincidences(term, type, settings) {
    const results = [];
    const now = new Date();
    
    // Generate between 3-8 random coincidences
    const count = 3 + Math.floor(Math.random() * 6);
    
    const coincidenceTypes = [
        { name: 'Numerical Match', color: '#39ff14', icon: 'üî¢' },
        { name: 'Name Synchronicity', color: '#2dd4ff', icon: 'üë§' },
        { name: 'Date Alignment', color: '#ffcc00', icon: 'üìÖ' },
        { name: 'Event Correlation', color: '#ff2d55', icon: 'üì∞' },
        { name: 'Pattern Recognition', color: '#9d4edd', icon: 'üåÄ' },
        { name: 'Symbolic Connection', color: '#39ff14', icon: 'üîÆ' },
        { name: 'Statistical Anomaly', color: '#ff2d55', icon: 'üìä' },
        { name: 'Historical Parallel', color: '#ffcc00', icon: 'üèõÔ∏è' }
    ];
    
    const sources = ['News API', 'Wikipedia', 'Historical Database', 'Scientific Journal', 'Social Media', 'Government Data'];
    
    for (let i = 0; i < count; i++) {
        const typeIndex = Math.floor(Math.random() * coincidenceTypes.length);
        const coincidenceType = coincidenceTypes[typeIndex];
        const sourceCount = 1 + Math.floor(Math.random() * 4);
        const selectedSources = [];
        
        for (let j = 0; j < sourceCount; j++) {
            const sourceIndex = Math.floor(Math.random() * sources.length);
            if (!selectedSources.includes(sources[sourceIndex])) {
                selectedSources.push(sources[sourceIndex]);
            }
        }
        
        // Calculate random probability (lower is more significant)
        const probability = Math.random() * 0.1;
        
        // Generate timestamp (within timeframe)
        let timestamp = new Date();
        const hoursAgo = Math.floor(Math.random() * 168); // Up to 7 days
        timestamp.setHours(timestamp.getHours() - hoursAgo);
        
        results.push({
            id: Date.now() + i,
            type: coincidenceType.name,
            color: coincidenceType.color,
            icon: coincidenceType.icon,
            description: cfGenerateDescription(term, type, coincidenceType.name),
            sources: selectedSources,
            probability: probability,
            significance: 1 - probability, // Higher significance for lower probability
            timestamp: timestamp,
            confidence: 70 + Math.floor(Math.random() * 30), // 70-99%
            connections: 1 + Math.floor(Math.random() * 5)
        });
    }
    
    // Sort by probability (most significant first)
    return results.sort((a, b) => a.probability - b.probability);
}

// Generate description based on search and coincidence type
function cfGenerateDescription(term, searchType, coincidenceType) {
    const descriptions = {
        'Numerical Match': [
            `The number "${term}" appears in ${2 + Math.floor(Math.random() * 5)} unrelated major news stories today`,
            `Statistical anomaly: "${term}" appears ${10 + Math.floor(Math.random() * 20)}x more frequently than expected`,
            `Mathematical coincidence: "${term}" connects ${2 + Math.floor(Math.random() * 3)} seemingly unrelated phenomena`
        ],
        'Name Synchronicity': [
            `Name "${term}" appears in ${2 + Math.floor(Math.random() * 4)} different significant events this week`,
            `Historical parallel: Individuals named "${term}" involved in similar events across different eras`,
            `Cultural coincidence: "${term}" appears in news, entertainment, and science simultaneously`
        ],
        'Date Alignment': [
            `Date "${term}" aligns with ${2 + Math.floor(Math.random() * 3)} major historical anniversaries`,
            `Temporal pattern: Events repeating on similar dates involving "${term}"`,
            `Calendar coincidence: "${term}" connects events separated by meaningful time intervals`
        ],
        'Event Correlation': [
            `Unrelated events involving "${term}" showing surprising parallel developments`,
            `Global coincidence: "${term}" appearing in news from different continents simultaneously`,
            `Thematic connection: Multiple "${term}"-related events converging this week`
        ],
        'Pattern Recognition': [
            `Pattern "${term}" detected across ${3 + Math.floor(Math.random() * 4)} different data sources`,
            `Fractal-like repetition: "${term}" appearing at multiple scales and contexts`,
            `Emergent pattern: "${term}" forming unexpected connections between disparate events`
        ]
    };
    
    const defaultDescs = [
        `Significant coincidence detected involving "${term}"`,
        `Unusual pattern identified related to "${term}"`,
        `Synchronicity found: "${term}" connecting multiple events`,
        `Statistical significance detected for "${term}" occurrences`
    ];
    
    const typeDescs = descriptions[coincidenceType] || defaultDescs;
    return typeDescs[Math.floor(Math.random() * typeDescs.length)];
}

// Display results
function cfDisplayResults(results) {
    const container = document.getElementById('cf-results-container');
    
    if (results.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:40px;color:rgba(230,250,255,0.5);">
                <div style="font-size:48px;margin-bottom:16px;">üîç</div>
                <div style="font-size:16px;color:var(--accent);margin-bottom:8px;">No Coincidences Found</div>
                <div style="font-size:14px;">Try adjusting your search criteria or probability threshold</div>
            </div>
        `;
        return;
    }
    
    let html = '<div style="display:flex;flex-direction:column;gap:12px;">';
    
    results.forEach((result, index) => {
        const probabilityPercent = (result.probability * 100).toFixed(2);
        const significancePercent = (result.significance * 100).toFixed(0);
        const timeStr = cfFormatTimeAgo(result.timestamp);
        
        html += `
            <div class="coincidence-item" style="padding:16px;background:rgba(0,0,0,0.3);border-radius:10px;border-left:4px solid ${result.color};">
                <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:12px;">
                    <div style="display:flex;align-items:center;gap:8px;">
                        <div style="font-size:20px;">${result.icon}</div>
                        <div>
                            <div style="color:${result.color};font-weight:600;font-size:14px;">${result.type}</div>
                            <div style="font-size:11px;color:rgba(230,250,255,0.6);">${timeStr} ‚Ä¢ ${result.confidence}% confidence</div>
                        </div>
                    </div>
                    
                    <div style="text-align:right;">
                        <div style="color:#39ff14;font-weight:600;font-size:18px;">${probabilityPercent}%</div>
                        <div style="font-size:11px;color:rgba(230,250,255,0.6);">probability</div>
                    </div>
                </div>
                
                <div style="color:rgba(230,250,255,0.9);margin-bottom:12px;font-size:13px;line-height:1.4;">
                    ${result.description}
                </div>
                
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <div style="display:flex;gap:6px;flex-wrap:wrap;">
                        ${result.sources.map(source => `
                            <div style="padding:4px 8px;background:rgba(255,255,255,0.05);border-radius:4px;font-size:10px;color:rgba(230,250,255,0.7);">
                                ${source}
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="display:flex;gap:12px;font-size:11px;color:rgba(230,250,255,0.7);">
                        <div>
                            <div style="color:#ffcc00;">${significancePercent}%</div>
                            <div>significance</div>
                        </div>
                        <div>
                            <div style="color:#2dd4ff;">${result.connections}</div>
                            <div>connections</div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    container.innerHTML = html;
}

// Format time ago
function cfFormatTimeAgo(date) {
    const now = new Date();
    const diffMs = now - date;
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMins / 60);
    const diffDays = Math.floor(diffHours / 24);
    
    if (diffMins < 60) {
        return `${diffMins} minute${diffMins !== 1 ? 's' : ''} ago`;
    } else if (diffHours < 24) {
        return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
    } else {
        return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
    }
}

// Update metrics
function cfUpdateMetrics(results) {
    const count = results.length;
    
    // Calculate average probability
    const avgProbability = results.length > 0 
        ? results.reduce((sum, r) => sum + r.probability, 0) / results.length 
        : 0;
    
    // Calculate average significance
    const avgSignificance = results.length > 0 
        ? results.reduce((sum, r) => sum + r.significance, 0) / results.length 
        : 0;
    
    // Count unique sources
    const allSources = results.flatMap(r => r.sources);
    const uniqueSources = [...new Set(allSources)].length;
    
    // Update displays
    document.getElementById('cf-metric-count').textContent = count;
    document.getElementById('cf-metric-probability').textContent = (avgProbability * 100).toFixed(1) + '%';
    document.getElementById('cf-metric-significance').textContent = avgSignificance.toFixed(2);
    document.getElementById('cf-metric-sources').textContent = uniqueSources;
    
    // Update probability bar
    const probabilityBar = document.getElementById('cf-probability-bar');
    const probabilityLabel = document.getElementById('cf-probability-label');
    
    // Convert probability to position (lower probability = further right = more significant)
    const barPosition = Math.min(100, Math.max(0, (1 - avgProbability) * 100));
    probabilityBar.style.width = `${barPosition}%`;
    
    // Set label
    if (avgProbability < 0.01) {
        probabilityLabel.textContent = 'Highly Significant';
        probabilityLabel.style.color = '#39ff14';
    } else if (avgProbability < 0.05) {
        probabilityLabel.textContent = 'Significant';
        probabilityLabel.style.color = '#ffcc00';
    } else if (avgProbability < 0.10) {
        probabilityLabel.textContent = 'Notable';
        probabilityLabel.style.color = '#ff2d55';
    } else {
        probabilityLabel.textContent = 'Expected';
        probabilityLabel.style.color = '#9d4edd';
    }
}

// Draw timeline
function cfDrawTimeline(results) {
    const container = document.getElementById('cf-timeline-visual');
    const now = new Date();
    
    // Clear previous timeline
    container.innerHTML = '';
    
    // Create timeline base
    const timelineBase = document.createElement('div');
    timelineBase.style.cssText = 'position:absolute;bottom:0;left:0;right:0;height:2px;background:rgba(255,255,255,0.2);';
    container.appendChild(timelineBase);
    
    const gradientLine = document.createElement('div');
    gradientLine.style.cssText = 'position:absolute;bottom:0;left:0;width:100%;height:2px;background:linear-gradient(90deg, #39ff14, #2dd4ff, #ffcc00, #ff2d55, #9d4edd);';
    container.appendChild(gradientLine);
    
    // Add current time marker
    const nowMarker = document.createElement('div');
    nowMarker.style.cssText = 'position:absolute;bottom:-4px;left:50%;width:2px;height:20px;background:#ffffff;transform:translateX(-50%);';
    container.appendChild(nowMarker);
    
    // Add coincidence markers
    results.forEach((result, index) => {
        // Calculate position based on time
        const hoursAgo = (now - result.timestamp) / (1000 * 60 * 60);
        const maxHours = 168; // 7 days
        const position = Math.min(100, Math.max(0, (maxHours - hoursAgo) / maxHours * 100));
        
        const marker = document.createElement('div');
        marker.style.cssText = `
            position:absolute;
            bottom:0;
            left:${position}%;
            width:8px;
            height:8px;
            background:${result.color};
            border-radius:50%;
            transform:translateX(-50%);
            cursor:pointer;
            box-shadow:0 0 8px ${result.color};
        `;
        
        marker.title = `${result.type}: ${cfFormatTimeAgo(result.timestamp)}`;
        container.appendChild(marker);
    });
    
    // Update timeline labels
    const daysAgo = ['7d ago', '5d ago', '3d ago', '1d ago', 'Now'];
    document.getElementById('cf-timeline-start').textContent = '7d ago';
    document.getElementById('cf-timeline-mid').textContent = '3d ago';
    document.getElementById('cf-timeline-end').textContent = 'Now';
}

// Generate interpretation
function cfGenerateInterpretation(results, searchTerm, searchType) {
    const container = document.getElementById('cf-interpretation');
    
    if (results.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:20px;color:rgba(230,250,255,0.7);">
                No significant coincidences found for "${searchTerm}".
            </div>
        `;
        return;
    }
    
    const interpretations = [
        {
            title: 'Meaningful Pattern Detected',
            color: '#39ff14',
            content: `The ${results.length} coincidences found suggest a meaningful pattern rather than random chance.`,
            icon: 'üîÆ'
        },
        {
            title: 'Statistical Significance',
            color: '#2dd4ff',
            content: `With an average probability of ${(results.reduce((s, r) => s + r.probability, 0) / results.length * 100).toFixed(2)}%, these occurrences are statistically noteworthy.`,
            icon: 'üìä'
        },
        {
            title: 'Synchronicity Interpretation',
            color: '#ffcc00',
            content: `Carl Jung defined synchronicity as "meaningful coincidence." These ${results.length} connections may indicate underlying patterns in reality.`,
            icon: 'üåÄ'
        },
        {
            title: 'Practical Implications',
            color: '#9d4edd',
            content: 'While fascinating, remember correlation does not imply causation. Use these insights for creative inspiration rather than decision-making.',
            icon: 'üí°'
        }
    ];
    
    let html = '<div style="display:flex;flex-direction:column;gap:16px;">';
    
    interpretations.forEach(interpretation => {
        html += `
            <div style="display:flex;gap:12px;padding:16px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid ${interpretation.color};">
                <div style="font-size:24px;">${interpretation.icon}</div>
                <div style="flex:1;">
                    <div style="color:${interpretation.color};font-weight:600;margin-bottom:6px;">${interpretation.title}</div>
                    <div style="color:rgba(230,250,255,0.9);font-size:14px;">${interpretation.content}</div>
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    container.innerHTML = html;
}

// Random search
function cfRandomSearch() {
    const randomModes = ['numbers', 'names', 'events', 'patterns'];
    const randomMode = randomModes[Math.floor(Math.random() * randomModes.length)];
    
    cfSwitchMode(randomMode);
    
    const randomTerms = {
        numbers: ['111', '333', '777', '2024', '3.14', '11:11'],
        names: ['Alex', 'Maria', 'Jordan', 'Taylor', 'Phoenix', 'River'],
        events: ['eclipse', 'election', 'discovery', 'invention', 'award', 'breakthrough'],
        patterns: ['spiral', 'triangle', 'circle', 'symmetry', 'repetition', 'fractal']
    };
    
    const randomTerm = randomTerms[randomMode][Math.floor(Math.random() * randomTerms[randomMode].length)];
    
    // Set the random term
    switch(randomMode) {
        case 'numbers':
            document.getElementById('cf-number-input').value = randomTerm;
            break;
        case 'names':
            document.getElementById('cf-name-input').value = randomTerm;
            break;
        case 'events':
            document.getElementById('cf-event-input').value = randomTerm;
            break;
        case 'patterns':
            document.getElementById('cf-pattern-input').value = randomTerm;
            break;
    }
    
    cfShowMessage(`Random search: "${randomTerm}" (${randomMode})`, 'info');
}

// Reset all
function cfResetAll() {
    if (confirm('Reset all inputs and results?')) {
        // Reset inputs
        document.getElementById('cf-number-input').value = '';
        document.getElementById('cf-name-input').value = '';
        document.getElementById('cf-event-input').value = '';
        document.getElementById('cf-pattern-input').value = '';
        
        // Reset to default mode
        cfSwitchMode('numbers');
        
        // Reset results
        document.getElementById('cf-results-container').innerHTML = `
            <div style="text-align:center;padding:40px;color:rgba(230,250,255,0.5);">
                <div style="font-size:48px;margin-bottom:16px;">üîÆ</div>
                <div style="font-size:16px;color:var(--accent);margin-bottom:8px;">No Analysis Yet</div>
                <div style="font-size:14px;">Enter search criteria and click "Find Coincidences" to begin</div>
            </div>
        `;
        
        // Reset metrics
        document.getElementById('cf-metric-count').textContent = '0';
        document.getElementById('cf-metric-probability').textContent = '0%';
        document.getElementById('cf-metric-significance').textContent = '0.0';
        document.getElementById('cf-metric-sources').textContent = '0';
        
        // Reset probability bar
        document.getElementById('cf-probability-bar').style.width = '0%';
        document.getElementById('cf-probability-label').textContent = 'Not Analyzed';
        document.getElementById('cf-probability-label').style.color = 'rgba(230,250,255,0.7)';
        
        // Hide timeline
        document.getElementById('cf-timeline').style.display = 'none';
        
        // Reset interpretation
        document.getElementById('cf-interpretation').innerHTML = `
            <div style="text-align:center;padding:20px;color:rgba(230,250,255,0.7);">
                Coincidence analysis will appear here. Discover patterns, meanings, and potential significance.
            </div>
        `;
        
        cfShowMessage('Reset complete', 'success');
    }
}

// Show message
function cfShowMessage(message, type) {
    const colors = {
        success: '#39ff14',
        warning: '#ffcc00',
        error: '#ff2d55',
        info: '#2dd4ff'
    };
    
    // Remove existing message
    const existingMsg = document.querySelector('.cf-message');
    if (existingMsg) existingMsg.remove();
    
    // Create new message
    const msg = document.createElement('div');
    msg.className = 'cf-message';
    msg.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        background: rgba(0,0,0,0.9);
        border: 1px solid ${colors[type]};
        border-radius: 8px;
        color: ${colors[type]};
        z-index: 10000;
        font-weight: 500;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        animation: cfSlideIn 0.3s ease-out;
    `;
    
    msg.textContent = message;
    document.body.appendChild(msg);
    
    // Remove after 3 seconds
    setTimeout(() => {
        msg.style.animation = 'cfSlideOut 0.3s ease-out';
        setTimeout(() => msg.remove(), 300);
    }, 3000);
}

// Add CSS for animations
if (!document.querySelector('#cf-styles')) {
    const style = document.createElement('style');
    style.id = 'cf-styles';
    style.textContent = `
        @keyframes cfSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes cfSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .coincidence-item {
            animation: fadeInUp 0.5s ease-out;
            animation-fill-mode: both;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    `;
    document.head.appendChild(style);
}

// Export results
function cfExportResults() {
    if (cfAnalysisResults.length === 0) {
        cfShowMessage('No results to export', 'warning');
        return;
    }
    
    let exportText = `COINCIDENCE ANALYSIS REPORT\n`;
    exportText += `Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}\n`;
    exportText += `Search Mode: ${cfCurrentMode}\n`;
    exportText += '='.repeat(50) + '\n\n';
    
    exportText += `SUMMARY\n`;
    exportText += `Total Coincidences: ${cfAnalysisResults.length}\n`;
    
    const avgProbability = cfAnalysisResults.reduce((s, r) => s + r.probability, 0) / cfAnalysisResults.length;
    exportText += `Average Probability: ${(avgProbability * 100).toFixed(2)}%\n`;
    
    const uniqueSources = [...new Set(cfAnalysisResults.flatMap(r => r.sources))];
    exportText += `Data Sources: ${uniqueSources.join(', ')}\n\n`;
    
    exportText += `COINCIDENCES\n`;
    exportText += '='.repeat(50) + '\n\n';
    
    cfAnalysisResults.forEach((result, index) => {
        exportText += `${index + 1}. ${result.type}\n`;
        exportText += `   Probability: ${(result.probability * 100).toFixed(2)}%\n`;
        exportText += `   Significance: ${(result.significance * 100).toFixed(0)}%\n`;
        exportText += `   Sources: ${result.sources.join(', ')}\n`;
        exportText += `   Description: ${result.description}\n\n`;
    });
    
    exportText += `INTERPRETATION\n`;
    exportText += '='.repeat(50) + '\n\n';
    
    if (avgProbability < 0.01) {
        exportText += 'Highly significant pattern detected. The probability of these coincidences occurring by random chance is extremely low.\n\n';
    } else if (avgProbability < 0.05) {
        exportText += 'Statistically significant pattern detected. These coincidences are unlikely to be purely random.\n\n';
    } else {
        exportText += 'Interesting pattern detected. While not statistically significant, these coincidences may still be meaningful.\n\n';
    }
    
    exportText += 'Generated by The Most Useful Site - Coincidence Finder\n';
    
    // Create and download file
    const blob = new Blob([exportText], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `coincidence-analysis-${new Date().getTime()}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    cfShowMessage('Report downloaded!', 'success');
}

// Share results
function cfShareResults() {
    if (cfAnalysisResults.length === 0) {
        cfShowMessage('No results to share', 'warning');
        return;
    }
    
    const avgProbability = cfAnalysisResults.reduce((s, r) => s + r.probability, 0) / cfAnalysisResults.length;
    const significance = (1 - avgProbability) * 100;
    
    const text = `üîÆ Found ${cfAnalysisResults.length} coincidences with ${significance.toFixed(0)}% significance!\n\n` +
                `Analysis by The Most Useful Site`;
    
    if (navigator.share) {
        navigator.share({
            title: 'Coincidence Analysis Results',
            text: text,
            url: window.location.href
        }).catch(err => {
            console.log('Share cancelled:', err);
        });
    } else {
        navigator.clipboard.writeText(text).then(() => {
            cfShowMessage('Results copied to clipboard!', 'success');
        });
    }
}

// Save analysis
function cfSaveAnalysis() {
    if (cfAnalysisResults.length === 0) {
        cfShowMessage('No analysis to save', 'warning');
        return;
    }
    
    const saveData = {
        timestamp: new Date().toISOString(),
        mode: cfCurrentMode,
        results: cfAnalysisResults,
        settings: {
            probability: document.getElementById('cf-probability').value,
            timeframe: document.getElementById('cf-timeframe').value,
            significance: document.getElementById('cf-significance').value
        }
    };
    
    // Save to localStorage
    const saves = JSON.parse(localStorage.getItem('cf-saves') || '[]');
    saves.push(saveData);
    
    // Keep only last 10 saves
    if (saves.length > 10) {
        saves.shift();
    }
    
    localStorage.setItem('cf-saves', JSON.stringify(saves));
    
    cfShowMessage('Analysis saved!', 'success');
}
</script>

<style>
#coincidence-finder-title {
    color: var(--accent);
    margin-top: 0;
    background: linear-gradient(135deg, #9d4edd, #2dd4ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.section {
    animation: fadeIn 0.5s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Custom scrollbar */
#cf-results-container {
    max-height: 600px;
    overflow-y: auto;
}

#cf-results-container::-webkit-scrollbar {
    width: 8px;
}

#cf-results-container::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
}

#cf-results-container::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 4px;
}

#cf-results-container::-webkit-scrollbar-thumb:hover {
    background: rgba(45,212,255,0.8);
}

/* Timeline styling */
#cf-timeline-visual {
    position: relative;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .section > div > div {
        grid-template-columns: 1fr !important;
    }
    
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100%;
    }
    
    #cf-mode-numbers, #cf-mode-names, #cf-mode-events, #cf-mode-patterns {
        padding: 8px !important;
        font-size: 12px !important;
        flex: 1;
        min-width: 120px;
    }
}
</style>
