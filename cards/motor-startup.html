<h2 id="motor-startup-title" style="margin-top:0;color:var(--accent);">‚ö° Motor Startup Calculator</h2>

<form aria-describedby="motor-startup-desc">
  <p id="motor-startup-desc" class="small" style="color:var(--muted);margin-bottom:20px;">
    Calculate motor running/starting currents, cable sizing, protection devices, and voltage drop analysis for electrical installations.
    <span style="color:var(--accent);display:block;margin-top:4px;">üîß Running current ‚Ä¢ Starting current ‚Ä¢ Cable sizing ‚Ä¢ Protection devices ‚Ä¢ Voltage drop ‚Ä¢ Safety guidelines</span>
  </p>

  <!-- MAIN MOTOR SPECIFICATIONS -->
  <div style="background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:20px;">
      <div>
        <label for="motor-power" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üè≠ Motor Power
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input 
            id="motor-power" 
            type="number" 
            placeholder="e.g. 5"
            min="0.1"
            step="0.1"
            value="5"
            style="flex:1;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;"
          />
          <select id="motor-power-unit" style="padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;cursor:pointer;">
            <option value="kW">kW</option>
            <option value="hp">HP</option>
          </select>
        </div>
        <div style="display:flex;gap:6px;margin-top:8px;">
          <button type="button" onclick="msSetMotorPower(2.2)" style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;flex:1;">2.2 kW</button>
          <button type="button" onclick="msSetMotorPower(5.5)" style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;flex:1;">5.5 kW</button>
          <button type="button" onclick="msSetMotorPower(11)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;flex:1;">11 kW</button>
        </div>
      </div>

      <div>
        <label for="motor-voltage" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          ‚ö° Supply Voltage
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input 
            id="motor-voltage" 
            type="number" 
            placeholder="e.g. 400"
            min="100"
            step="1"
            value="400"
            style="flex:1;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;"
          />
          <div style="color:rgba(230,250,255,0.7);font-size:13px;white-space:nowrap;">Volts</div>
        </div>
        <div style="display:flex;gap:6px;margin-top:8px;">
          <button type="button" onclick="msSetVoltage(230)" style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;flex:1;">230V</button>
          <button type="button" onclick="msSetVoltage(400)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;flex:1;">400V</button>
          <button type="button" onclick="msSetVoltage(480)" style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;flex:1;">480V</button>
        </div>
      </div>

      <div>
        <label for="motor-phase" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üîÑ Phase Configuration
        </label>
        <select id="motor-phase" 
                style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;cursor:pointer;">
          <option value="three" selected>Three-phase (3√ò)</option>
          <option value="single">Single-phase (1√ò)</option>
        </select>
        <div style="color:rgba(230,250,255,0.6);font-size:12px;margin-top:4px;">
          <span id="ms-phase-info">Industrial standard</span>
        </div>
      </div>
    </div>

    <!-- MOTOR CHARACTERISTICS -->
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-bottom:20px;">
      <div>
        <label for="motor-pf" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üìä Power Factor (cos œÜ)
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input 
            id="motor-pf" 
            type="number" 
            step="0.01"
            placeholder="0.85"
            min="0.5"
            max="1.0"
            value="0.85"
            style="flex:1;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;"
          />
          <div style="color:rgba(230,250,255,0.7);font-size:13px;white-space:nowrap;">PF</div>
        </div>
        <div style="color:rgba(230,250,255,0.6);font-size:12px;margin-top:4px;">
          <span id="ms-pf-info">Typical motor PF</span>
        </div>
      </div>

      <div>
        <label for="motor-eff" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          ‚öôÔ∏è Motor Efficiency
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input 
            id="motor-eff" 
            type="number" 
            step="0.1"
            placeholder="90"
            min="50"
            max="98"
            value="90"
            style="flex:1;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;"
          />
          <div style="color:rgba(230,250,255,0.7);font-size:13px;white-space:nowrap;">%</div>
        </div>
        <div style="color:rgba(230,250,255,0.6);font-size:12px;margin-top:4px;">
          <span id="ms-eff-info">Standard IE3 motor</span>
        </div>
      </div>

      <div>
        <label for="motor-method" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üöÄ Starting Method
        </label>
        <select id="motor-method" 
                style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;cursor:pointer;">
          <option value="dol" selected>Direct-on-line (DOL)</option>
          <option value="star-delta">Star-Delta (Y-Œî)</option>
          <option value="soft">Soft Starter</option>
          <option value="vfd">Variable Frequency Drive (VFD)</option>
          <option value="auto">Autotransformer</option>
          <option value="reactor">Series Reactor</option>
        </select>
        <div style="color:rgba(230,250,255,0.6);font-size:12px;margin-top:4px;">
          <span id="ms-method-info">High inrush current</span>
        </div>
      </div>
    </div>

    <!-- INSTALLATION PARAMETERS -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
      <div>
        <label for="ms-cable-length" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üìè Cable Length
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input 
            id="ms-cable-length" 
            type="number" 
            placeholder="50"
            min="1"
            step="1"
            value="50"
            style="flex:1;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;"
          />
          <select id="ms-cable-unit" style="padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;cursor:pointer;">
            <option value="m">Meters</option>
            <option value="ft">Feet</option>
          </select>
        </div>
      </div>

      <div>
        <label for="ms-cable-material" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;font-size:14px;">
          üîå Cable Material
        </label>
        <select id="ms-cable-material" 
                style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;cursor:pointer;">
          <option value="cu" selected>Copper (Cu)</option>
          <option value="al">Aluminum (Al)</option>
        </select>
      </div>
    </div>

    <!-- ADDITIONAL OPTIONS -->
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;margin-top:16px;">
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
        <input type="checkbox" id="ms-show-protection" checked style="cursor:pointer;width:18px;height:18px;">
        <div>
          <div style="color:var(--accent);font-size:13px;font-weight:500;">Protection Devices</div>
          <div style="color:rgba(230,250,255,0.6);font-size:11px;">MCB, MCCB, Fuse sizing</div>
        </div>
      </label>

      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
        <input type="checkbox" id="ms-show-voltage-drop" checked style="cursor:pointer;width:18px;height:18px;">
        <div>
          <div style="color:var(--accent);font-size:13px;font-weight:500;">Voltage Drop</div>
          <div style="color:rgba(230,250,255,0.6);font-size:11px;">Cable sizing check</div>
        </div>
      </label>

      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;">
        <input type="checkbox" id="ms-show-safety" checked style="cursor:pointer;width:18px;height:18px;">
        <div>
          <div style="color:var(--accent);font-size:13px;font-weight:500;">Safety Guidelines</div>
          <div style="color:rgba(230,250,255,0.6);font-size:11px;">Installation warnings</div>
        </div>
      </label>
    </div>
  </div>

  <!-- ACTION BUTTONS -->
  <div style="display:flex;gap:12px;margin-bottom:20px;">
    <button type="button" onclick="msCalculate(this)" 
            style="flex:2;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;font-size:16px;">
      ‚ö° Calculate Motor Parameters
    </button>
    <button type="button" onclick="msReset(this)"
            style="flex:1;padding:14px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;font-weight:500;">
      üîÑ Reset
    </button>
    <button type="button" onclick="msExport(this)"
            style="padding:14px 20px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;font-weight:500;">
      üíæ Export
    </button>
  </div>
</form>

<!-- RESULTS SECTION -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <!-- MAIN RESULTS SUMMARY -->
  <div style="background:linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border-radius:12px;border:1px solid rgba(255,255,255,0.08);padding:24px;margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
      <div style="color:var(--accent);font-weight:600;font-size:16px;">üìä Motor Calculation Results</div>
      <div id="ms-status" style="color:rgba(230,250,255,0.7);font-size:13px;">Ready to calculate</div>
    </div>

    <!-- CURRENT CALCULATIONS -->
    <div style="display:grid;grid-template-columns:repeat(4, 1fr);gap:16px;margin-bottom:24px;">
      <div style="text-align:center;padding:16px;background:rgba(45,212,255,0.05);border-radius:10px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:6px;">Running Current</div>
        <div id="ms-running-current" style="font-size:24px;font-weight:700;color:var(--accent);">‚Äì</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">Full Load Current (FLC)</div>
      </div>

      <div style="text-align:center;padding:16px;background:rgba(255,45,85,0.05);border-radius:10px;border:1px solid rgba(255,45,85,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:6px;">Starting Current</div>
        <div id="ms-starting-current" style="font-size:24px;font-weight:700;color:#ff2d55;">‚Äì</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">Locked Rotor Current (LRC)</div>
      </div>

      <div style="text-align:center;padding:16px;background:rgba(57,255,20,0.05);border-radius:10px;border:1px solid rgba(57,255,20,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:6px;">Inrush Ratio</div>
        <div id="ms-inrush-ratio" style="font-size:24px;font-weight:700;color:#39ff14;">‚Äì</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">LRC/FLC</div>
      </div>

      <div style="text-align:center;padding:16px;background:rgba(255,204,0,0.05);border-radius:10px;border:1px solid rgba(255,204,0,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:6px;">Power Consumption</div>
        <div id="ms-power-consumption" style="font-size:24px;font-weight:700;color:#ffcc00;">‚Äì</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">Input Power (kVA)</div>
      </div>
    </div>

    <!-- DETAILED BREAKDOWN -->
    <div style="display:grid;grid-template-columns:repeat(3, 1fr);gap:12px;margin-bottom:20px;">
      <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">üìà Motor Power</div>
        <div id="ms-motor-power" style="font-size:16px;font-weight:600;color:var(--accent);">‚Äì</div>
      </div>
      <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">‚ö° Supply Voltage</div>
        <div id="ms-supply-voltage" style="font-size:16px;font-weight:600;color:#39ff14;">‚Äì</div>
      </div>
      <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">üîß Starting Method</div>
        <div id="ms-starting-method" style="font-size:16px;font-weight:600;color:#ffcc00;">‚Äì</div>
      </div>
    </div>
  </div>

  <!-- CABLE SIZING & VOLTAGE DROP -->
  <div id="ms-cable-container" style="display:none;background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:16px;font-size:16px;">üîå Cable Sizing & Voltage Drop</div>
    
    <div style="display:grid;grid-template-columns:repeat(4, 1fr);gap:12px;margin-bottom:20px;">
      <div style="text-align:center;padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Minimum Cable Size</div>
        <div id="ms-cable-size" style="font-size:18px;font-weight:700;color:var(--accent);">‚Äì</div>
      </div>
      <div style="text-align:center;padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;border:1px solid rgba(57,255,20,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Voltage Drop</div>
        <div id="ms-voltage-drop" style="font-size:18px;font-weight:700;color:#39ff14;">‚Äì</div>
      </div>
      <div style="text-align:center;padding:12px;background:rgba(255,204,0,0.05);border-radius:8px;border:1px solid rgba(255,204,0,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Drop Percentage</div>
        <div id="ms-drop-percentage" style="font-size:18px;font-weight:700;color:#ffcc00;">‚Äì</div>
      </div>
      <div style="text-align:center;padding:12px;background:rgba(157,78,221,0.05);border-radius:8px;border:1px solid rgba(157,78,221,0.1);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Recommended Cable</div>
        <div id="ms-recommended-cable" style="font-size:18px;font-weight:700;color:#9d4edd;">‚Äì</div>
      </div>
    </div>

    <!-- VOLTAGE DROP VISUALIZATION -->
    <div style="height:80px;background:rgba(0,0,0,0.2);border-radius:8px;margin-bottom:16px;position:relative;overflow:hidden;">
      <div id="ms-voltage-bar" style="position:absolute;top:0;left:0;height:100%;background:linear-gradient(90deg, #39ff14, #ffcc00, #ff2d55);width:0%;transition:width 1s ease;"></div>
      <div style="position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:space-between;padding:0 12px;font-size:12px;color:rgba(230,250,255,0.9);">
        <div>0% Drop</div>
        <div>3% Acceptable</div>
        <div>5% Max</div>
        <div>>5% Critical</div>
      </div>
    </div>
    
    <div id="ms-drop-status" style="text-align:center;color:rgba(230,250,255,0.7);font-size:13px;"></div>
  </div>

  <!-- PROTECTION DEVICES -->
  <div id="ms-protection-container" style="display:none;background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:16px;font-size:16px;">üõ°Ô∏è Protection Device Sizing</div>
    
    <div style="display:grid;grid-template-columns:repeat(3, 1fr);gap:12px;margin-bottom:20px;">
      <div style="padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:14px;color:var(--accent);font-weight:500;margin-bottom:8px;">Circuit Breaker (MCB/MCCB)</div>
        <div id="ms-circuit-breaker" style="font-size:20px;font-weight:700;color:var(--accent);">‚Äì</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-top:4px;">Based on FLC √ó 1.25</div>
      </div>
      
      <div style="padding:16px;background:rgba(255,45,85,0.05);border-radius:8px;border:1px solid rgba(255,45,85,0.1);">
        <div style="font-size:14px;color:#ff2d55;font-weight:500;margin-bottom:8px;">Fuse Rating</div>
        <div id="ms-fuse-rating" style="font-size:20px;font-weight:700;color:#ff2d55;">‚Äì</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-top:4px;">Gg type (time-delay)</div>
      </div>
      
      <div style="padding:16px;background:rgba(57,255,20,0.05);border-radius:8px;border:1px solid rgba(57,255,20,0.1);">
        <div style="font-size:14px;color:#39ff14;font-weight:500;margin-bottom:8px;">Thermal Overload</div>
        <div id="ms-overload-setting" style="font-size:20px;font-weight:700;color:#39ff14;">‚Äì</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-top:4px;">90-110% of FLC</div>
      </div>
    </div>
    
    <div style="color:rgba(230,250,255,0.8);font-size:13px;line-height:1.6;">
      <strong>Protection Guidelines:</strong><br>
      ‚Ä¢ Circuit breaker must withstand starting current (magnetic trip delay)<br>
      ‚Ä¢ Fuses should be time-delay type for motor starting<br>
      ‚Ä¢ Thermal overload protects against prolonged overload conditions
    </div>
  </div>

  <!-- STARTING METHOD COMPARISON -->
  <div style="background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <div style="color:var(--accent);font-weight:600;font-size:16px;">üìà Starting Method Comparison</div>
      <button onclick="msNewComparison()" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;font-weight:500;">
        üîÑ Compare
      </button>
    </div>
    
    <div style="height:200px;">
      <canvas id="ms-comparison-chart" style="width:100%;height:100%;"></canvas>
    </div>
    
    <div style="margin-top:16px;display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:13px;color:var(--accent);font-weight:500;margin-bottom:4px;">DOL</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.8);">High torque, high inrush</div>
      </div>
      <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;border:1px solid rgba(57,255,20,0.1);">
        <div style="font-size:13px;color:#39ff14;font-weight:500;margin-bottom:4px;">Star-Delta</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.8);">33% starting current</div>
      </div>
      <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:8px;border:1px solid rgba(255,204,0,0.1);">
        <div style="font-size:13px;color:#ffcc00;font-weight:500;margin-bottom:4px;">Soft Starter</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.8);">Controlled acceleration</div>
      </div>
      <div style="padding:12px;background:rgba(157,78,221,0.05);border-radius:8px;border:1px solid rgba(157,78,221,0.1);">
        <div style="font-size:13px;color:#9d4edd;font-weight:500;margin-bottom:4px;">VFD</div>
        <div style="font-size:12px;color:rgba(230,250,255,0.8);">Best control, lowest inrush</div>
      </div>
    </div>
  </div>

  <!-- SAFETY GUIDELINES -->
  <div id="ms-safety-container" style="display:none;background:rgba(255,255,255,0.02);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.05);">
    <div style="color:var(--accent);font-weight:600;margin-bottom:16px;font-size:16px;">‚ö†Ô∏è Safety & Installation Guidelines</div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:12px;">
      <div style="padding:12px;background:rgba(255,45,85,0.05);border-radius:8px;border:1px solid rgba(255,45,85,0.1);">
        <div style="color:#ff2d55;font-weight:500;margin-bottom:6px;font-size:14px;">‚ö° Electrical Safety</div>
        <ul style="margin:0;padding-left:16px;color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          <li>Always de-energize before installation</li>
          <li>Use proper PPE (gloves, goggles)</li>
          <li>Follow lockout-tagout procedures</li>
          <li>Verify zero voltage before touching</li>
        </ul>
      </div>
      
      <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:8px;border:1px solid rgba(255,204,0,0.1);">
        <div style="color:#ffcc00;font-weight:500;margin-bottom:6px;font-size:14px;">üîß Installation</div>
        <ul style="margin:0;padding-left:16px;color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          <li>Proper cable sizing and termination</li>
          <li>Correct motor rotation direction</li>
          <li>Adequate ventilation and cooling</li>
          <li>Secure mounting and alignment</li>
        </ul>
      </div>
      
      <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;border:1px solid rgba(57,255,20,0.1);">
        <div style="color:#39ff14;font-weight:500;margin-bottom:6px;font-size:14px;">üìã Testing & Commissioning</div>
        <ul style="margin:0;padding-left:16px;color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          <li>Insulation resistance test (>1 MŒ©)</li>
          <li>Check phase sequence and balance</li>
          <li>Verify protection device settings</li>
          <li>Monitor starting current and time</li>
        </ul>
      </div>
    </div>
    
    <div style="margin-top:16px;padding:12px;background:rgba(0,0,0,0.3);border-radius:8px;border:1px solid rgba(255,45,85,0.3);">
      <div style="color:#ff2d55;font-weight:600;font-size:14px;margin-bottom:6px;">‚ö†Ô∏è IMPORTANT DISCLAIMER</div>
      <div style="color:rgba(230,250,255,0.9);font-size:13px;line-height:1.6;">
        This tool provides educational estimates only. All electrical work must be performed by qualified electricians 
        following local electrical codes and regulations (IEC, NEC, BS, etc.). Always consult manufacturer specifications 
        and perform proper calculations before installation.
      </div>
    </div>
  </div>
</div>

<!-- TECHNICAL INFORMATION -->
<details style="margin-top:20px;background:rgba(255,255,255,0.02);border-radius:10px;border:1px solid rgba(255,255,255,0.05);overflow:hidden;">
  <summary style="padding:16px;color:var(--accent);font-weight:600;font-size:15px;cursor:pointer;list-style:none;">
    üìö Motor Calculation Formulas & Standards
  </summary>
  <div style="padding:16px;border-top:1px solid rgba(255,255,255,0.05);">
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:16px;">
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="color:var(--accent);font-weight:500;margin-bottom:6px;font-size:14px;">‚ö° Running Current Formula</div>
        <div style="color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          <strong>3-phase:</strong> I = P / (‚àö3 √ó V √ó PF √ó Œ∑)<br>
          <strong>1-phase:</strong> I = P / (V √ó PF √ó Œ∑)<br>
          Where:<br>
          I = Current (A)<br>
          P = Power (W)<br>
          V = Voltage (V)<br>
          PF = Power Factor<br>
          Œ∑ = Efficiency
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(255,45,85,0.05);border-radius:8px;border:1px solid rgba(255,45,85,0.1);">
        <div style="color:#ff2d55;font-weight:500;margin-bottom:6px;font-size:14px;">üöÄ Starting Current Multipliers</div>
        <div style="color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          ‚Ä¢ DOL: 6‚Äì8√ó FLC<br>
          ‚Ä¢ Star-Delta: 2‚Äì3√ó FLC<br>
          ‚Ä¢ Soft Starter: 1.5‚Äì3√ó FLC<br>
          ‚Ä¢ VFD: 1‚Äì1.5√ó FLC<br>
          ‚Ä¢ Autotransformer: 2‚Äì4√ó FLC<br>
          Actual values vary by motor design
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;border:1px solid rgba(57,255,20,0.1);">
        <div style="color:#39ff14;font-weight:500;margin-bottom:6px;font-size:14px;">üîå Voltage Drop Formula</div>
        <div style="color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          V<sub>drop</sub> = ‚àö3 √ó I √ó L √ó (R cosœÜ + X sinœÜ)<br>
          Where:<br>
          I = Current (A)<br>
          L = Cable length (m)<br>
          R = Resistance (Œ©/m)<br>
          X = Reactance (Œ©/m)<br>
          Acceptable drop: &lt;3% for motors
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:8px;border:1px solid rgba(255,204,0,0.1);">
        <div style="color:#ffcc00;font-weight:500;margin-bottom:6px;font-size:14px;">üè≠ IEC/NEC Standards</div>
        <div style="color:rgba(230,250,255,0.8);font-size:13px;line-height:1.5;">
          ‚Ä¢ IEC 60034: Rotating electrical machines<br>
          ‚Ä¢ IEC 60947: Low-voltage switchgear<br>
          ‚Ä¢ NEC Article 430: Motors & controllers<br>
          ‚Ä¢ BS 7671: UK wiring regulations<br>
          Always follow local codes and standards
        </div>
      </div>
    </div>
  </div>
</details>

<script>
/* motor-startup-calculator.html
   Professional motor startup calculator for electrical engineers and technicians
   Scoped with 'ms' prefix (motor startup)
*/

// APPLICATION STATE
let msState = {
  calculationData: null,
  comparisonChart: null,
  chartType: 'current',
  currency: 'GBP'
};

// CABLE RESISTANCE DATA (Œ©/km at 20¬∞C)
const msCableResistance = {
  cu: { // Copper
    '1.5': 12.1,
    '2.5': 7.41,
    '4': 4.61,
    '6': 3.08,
    '10': 1.83,
    '16': 1.15,
    '25': 0.727,
    '35': 0.524,
    '50': 0.387,
    '70': 0.268,
    '95': 0.193,
    '120': 0.153,
    '150': 0.124,
    '185': 0.0991,
    '240': 0.0754
  },
  al: { // Aluminum
    '16': 1.91,
    '25': 1.2,
    '35': 0.868,
    '50': 0.641,
    '70': 0.443,
    '95': 0.32,
    '120': 0.253,
    '150': 0.206,
    '185': 0.164,
    '240': 0.125
  }
};

// STARTING METHOD MULTIPLIERS
const msStartingMultipliers = {
  'dol': { current: 6.0, torque: 1.5, description: 'Direct-on-line (full voltage)' },
  'star-delta': { current: 2.0, torque: 0.33, description: 'Reduced voltage starting' },
  'soft': { current: 2.5, torque: 0.5, description: 'Controlled acceleration' },
  'vfd': { current: 1.2, torque: 1.0, description: 'Variable frequency drive' },
  'auto': { current: 3.0, torque: 0.5, description: 'Autotransformer starting' },
  'reactor': { current: 4.0, torque: 0.64, description: 'Series reactor starting' }
};

// CABLE CURRENT CARRYING CAPACITY (A) - Based on IEC 60364
const msCableCurrentRating = {
  cu: {
    '1.5': 16,
    '2.5': 21,
    '4': 28,
    '6': 36,
    '10': 46,
    '16': 61,
    '25': 80,
    '35': 99,
    '50': 119,
    '70': 151,
    '95': 182,
    '120': 210,
    '150': 245,
    '185': 280,
    '240': 335
  },
  al: {
    '16': 51,
    '25': 67,
    '35': 83,
    '50': 100,
    '70': 126,
    '95': 152,
    '120': 176,
    '150': 205,
    '185': 234,
    '240': 280
  }
};

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  // Update phase info
  msUpdatePhaseInfo();
  
  // Add event listeners
  document.getElementById('motor-phase').addEventListener('change', msUpdatePhaseInfo);
  document.getElementById('motor-power-unit').addEventListener('change', msUpdatePowerUnit);
  document.getElementById('motor-pf').addEventListener('input', msUpdatePFInfo);
  document.getElementById('motor-eff').addEventListener('input', msUpdateEffInfo);
  document.getElementById('motor-method').addEventListener('change', msUpdateMethodInfo);
  
  // Generate initial comparison chart
  msGenerateComparisonChart();
  
  console.log('Motor Startup Calculator initialized');
});

// Update phase information
function msUpdatePhaseInfo() {
  const phase = document.getElementById('motor-phase').value;
  const info = document.getElementById('ms-phase-info');
  
  if (phase === 'three') {
    info.textContent = 'Industrial standard';
    info.style.color = '#39ff14';
  } else {
    info.textContent = 'Residential/small commercial';
    info.style.color = '#ffcc00';
  }
}

// Update power unit
function msUpdatePowerUnit() {
  const unit = document.getElementById('motor-power-unit').value;
  // Could add conversion logic here if needed
}

// Update power factor info
function msUpdatePFInfo() {
  const pf = parseFloat(document.getElementById('motor-pf').value) || 0.85;
  const info = document.getElementById('ms-pf-info');
  
  if (pf < 0.7) {
    info.textContent = 'Poor - consider power factor correction';
    info.style.color = '#ff2d55';
  } else if (pf < 0.85) {
    info.textContent = 'Average industrial motor';
    info.style.color = '#ffcc00';
  } else {
    info.textContent = 'Good - high efficiency motor';
    info.style.color = '#39ff14';
  }
}

// Update efficiency info
function msUpdateEffInfo() {
  const eff = parseFloat(document.getElementById('motor-eff').value) || 90;
  const info = document.getElementById('ms-eff-info');
  
  if (eff < 80) {
    info.textContent = 'Low efficiency (IE1)';
    info.style.color = '#ff2d55';
  } else if (eff < 90) {
    info.textContent = 'Standard efficiency (IE2)';
    info.style.color = '#ffcc00';
  } else if (eff < 94) {
    info.textContent = 'High efficiency (IE3)';
    info.style.color = '#39ff14';
  } else {
    info.textContent = 'Premium efficiency (IE4)';
    info.style.color = '#2dd4ff';
  }
}

// Update method info
function msUpdateMethodInfo() {
  const method = document.getElementById('motor-method').value;
  const info = document.getElementById('ms-method-info');
  const multiplier = msStartingMultipliers[method];
  
  if (multiplier) {
    info.textContent = `${multiplier.current.toFixed(1)}√ó FLC, ${multiplier.description}`;
    info.style.color = '#ffcc00';
  }
}

// Set motor power
function msSetMotorPower(power) {
  document.getElementById('motor-power').value = power;
}

// Set voltage
function msSetVoltage(voltage) {
  document.getElementById('motor-voltage').value = voltage;
}

// Main calculation function
function msCalculate(btn) {
  // Get input values
  const powerInput = parseFloat(document.getElementById('motor-power').value) || 0;
  const powerUnit = document.getElementById('motor-power-unit').value;
  const voltage = parseFloat(document.getElementById('motor-voltage').value) || 0;
  const phase = document.getElementById('motor-phase').value;
  const pf = parseFloat(document.getElementById('motor-pf').value) || 0.85;
  const eff = parseFloat(document.getElementById('motor-eff').value) || 90;
  const method = document.getElementById('motor-method').value;
  const cableLength = parseFloat(document.getElementById('ms-cable-length').value) || 50;
  const cableUnit = document.getElementById('ms-cable-unit').value;
  const cableMaterial = document.getElementById('ms-cable-material').value;
  
  // Convert power to watts
  let powerWatts;
  if (powerUnit === 'kW') {
    powerWatts = powerInput * 1000;
  } else { // HP to kW to watts
    powerWatts = powerInput * 0.7457 * 1000; // 1 HP = 0.7457 kW
  }
  
  // Calculate running current (Full Load Current)
  let runningCurrent = 0;
  if (phase === 'three') {
    // 3-phase formula: I = P / (‚àö3 √ó V √ó PF √ó Œ∑)
    runningCurrent = powerWatts / (Math.sqrt(3) * voltage * pf * (eff / 100));
  } else {
    // 1-phase formula: I = P / (V √ó PF √ó Œ∑)
    runningCurrent = powerWatts / (voltage * pf * (eff / 100));
  }
  
  // Calculate starting current
  const multiplier = msStartingMultipliers[method] || msStartingMultipliers['dol'];
  const startingCurrent = runningCurrent * multiplier.current;
  const inrushRatio = multiplier.current;
  
  // Calculate apparent power (kVA)
  const apparentPowerKVA = (phase === 'three') 
    ? (Math.sqrt(3) * voltage * runningCurrent) / 1000
    : (voltage * runningCurrent) / 1000;
  
  // Format results
  document.getElementById('ms-running-current').textContent = `${runningCurrent.toFixed(2)} A`;
  document.getElementById('ms-starting-current').textContent = `${startingCurrent.toFixed(2)} A`;
  document.getElementById('ms-inrush-ratio').textContent = `${inrushRatio.toFixed(1)}√ó`;
  document.getElementById('ms-power-consumption').textContent = `${apparentPowerKVA.toFixed(2)} kVA`;
  
  // Update details
  document.getElementById('ms-motor-power').textContent = `${powerInput} ${powerUnit}`;
  document.getElementById('ms-supply-voltage').textContent = `${voltage} V ${phase === 'three' ? '3√ò' : '1√ò'}`;
  document.getElementById('ms-starting-method').textContent = multiplier.description;
  
  // Update status
  document.getElementById('ms-status').textContent = 'Calculated';
  document.getElementById('ms-status').style.color = '#39ff14';
  
  // Calculate cable sizing and voltage drop
  msCalculateCableSizing(runningCurrent, startingCurrent, cableLength, cableMaterial, voltage, phase, pf);
  
  // Calculate protection devices
  msCalculateProtectionDevices(runningCurrent, startingCurrent, method);
  
  // Show/hide containers based on settings
  const showProtection = document.getElementById('ms-show-protection').checked;
  const showVoltageDrop = document.getElementById('ms-show-voltage-drop').checked;
  const showSafety = document.getElementById('ms-show-safety').checked;
  
  document.getElementById('ms-cable-container').style.display = showVoltageDrop ? 'block' : 'none';
  document.getElementById('ms-protection-container').style.display = showProtection ? 'block' : 'none';
  document.getElementById('ms-safety-container').style.display = showSafety ? 'block' : 'none';
  
  // Store calculation data
  msState.calculationData = {
    runningCurrent,
    startingCurrent,
    inrushRatio,
    apparentPowerKVA,
    powerInput,
    powerUnit,
    voltage,
    phase,
    method: multiplier.description
  };
  
  // Update comparison chart
  msUpdateComparisonChart(runningCurrent, method);
  
  // Visual feedback
  btn.innerHTML = '‚úÖ Calculated!';
  setTimeout(() => {
    btn.innerHTML = '‚ö° Calculate Motor Parameters';
  }, 1000);
}

// Calculate cable sizing and voltage drop
function msCalculateCableSizing(runningCurrent, startingCurrent, length, material, voltage, phase, pf) {
  // Convert length to meters if in feet
  let lengthMeters = length;
  if (document.getElementById('ms-cable-unit').value === 'ft') {
    lengthMeters = length * 0.3048;
  }
  
  // Find appropriate cable size
  const ratings = msCableCurrentRating[material];
  let selectedSize = null;
  
  for (const [size, rating] of Object.entries(ratings).sort((a, b) => parseFloat(a) - parseFloat(b))) {
    if (rating >= runningCurrent * 1.25) { // 125% of FLC for cable sizing
      selectedSize = size;
      break;
    }
  }
  
  // If no cable found, use largest
  if (!selectedSize) {
    const sizes = Object.keys(ratings);
    selectedSize = sizes[sizes.length - 1];
  }
  
  // Calculate voltage drop
  const resistancePerMeter = msCableResistance[material][selectedSize] / 1000; // Convert Œ©/km to Œ©/m
  const reactancePerMeter = 0.08 / 1000; // Approximate reactance (Œ©/m)
  
  let voltageDrop;
  if (phase === 'three') {
    // 3-phase voltage drop: Vd = ‚àö3 √ó I √ó L √ó (R cosœÜ + X sinœÜ)
    const sinPhi = Math.sqrt(1 - pf * pf);
    voltageDrop = Math.sqrt(3) * runningCurrent * lengthMeters * (resistancePerMeter * pf + reactancePerMeter * sinPhi);
  } else {
    // 1-phase voltage drop: Vd = 2 √ó I √ó L √ó (R cosœÜ + X sinœÜ)
    const sinPhi = Math.sqrt(1 - pf * pf);
    voltageDrop = 2 * runningCurrent * lengthMeters * (resistancePerMeter * pf + reactancePerMeter * sinPhi);
  }
  
  const voltageDropPercent = (voltageDrop / voltage) * 100;
  
  // Update display
  document.getElementById('ms-cable-size').textContent = `${selectedSize} mm¬≤`;
  document.getElementById('ms-voltage-drop').textContent = `${voltageDrop.toFixed(2)} V`;
  document.getElementById('ms-drop-percentage').textContent = `${voltageDropPercent.toFixed(2)}%`;
  document.getElementById('ms-recommended-cable').textContent = `${selectedSize} mm¬≤ ${material.toUpperCase()}`;
  
  // Update voltage drop visualization
  const bar = document.getElementById('ms-voltage-bar');
  const status = document.getElementById('ms-drop-status');
  
  let barWidth = Math.min(100, voltageDropPercent * 20); // Scale for visualization
  bar.style.width = `${barWidth}%`;
  
  // Set bar color based on drop percentage
  if (voltageDropPercent < 3) {
    bar.style.background = 'linear-gradient(90deg, #39ff14, #2dd4ff)';
    status.textContent = '‚úÖ Voltage drop within acceptable limits (<3%)';
    status.style.color = '#39ff14';
  } else if (voltageDropPercent < 5) {
    bar.style.background = 'linear-gradient(90deg, #ffcc00, #ff9500)';
    status.textContent = '‚ö†Ô∏è Voltage drop borderline (3-5%). Consider larger cable.';
    status.style.color = '#ffcc00';
  } else {
    bar.style.background = 'linear-gradient(90deg, #ff2d55, #ff0066)';
    status.textContent = '‚ùå Voltage drop excessive (>5%). Increase cable size immediately.';
    status.style.color = '#ff2d55';
  }
}

// Calculate protection devices
function msCalculateProtectionDevices(runningCurrent, startingCurrent, method) {
  // Circuit breaker rating (125% of FLC per NEC 430.52)
  const circuitBreakerRating = runningCurrent * 1.25;
  
  // Find standard breaker size
  const standardBreakers = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 315, 400];
  let selectedBreaker = standardBreakers.find(b => b >= circuitBreakerRating) || 400;
  
  // Fuse rating (typically 175% of FLC for time-delay fuses)
  const fuseRating = runningCurrent * 1.75;
  const standardFuses = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 315, 400];
  let selectedFuse = standardFuses.find(f => f >= fuseRating) || 400;
  
  // Thermal overload setting (90-110% of FLC)
  const overloadSetting = runningCurrent * 1.0; // Typically set at 100% of FLC
  
  // Update display
  document.getElementById('ms-circuit-breaker').textContent = `${selectedBreaker} A`;
  document.getElementById('ms-fuse-rating').textContent = `${selectedFuse} A`;
  document.getElementById('ms-overload-setting').textContent = `${overloadSetting.toFixed(2)} A`;
  
  // Add note about starting method
  if (method === 'dol') {
    document.getElementById('ms-circuit-breaker').innerHTML += '<br><span style="font-size:12px;color:#ff2d55;">Use D-curve breaker</span>';
  }
}

// Generate comparison chart
function msGenerateComparisonChart() {
  const canvas = document.getElementById('ms-comparison-chart');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  
  // Sample data for comparison
  const methods = ['DOL', 'Star-Delta', 'Soft Starter', 'VFD'];
  const inrushMultipliers = [6.0, 2.0, 2.5, 1.2];
  const torqueMultipliers = [1.5, 0.33, 0.5, 1.0];
  
  msState.comparisonChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: methods,
      datasets: [
        {
          label: 'Starting Current (√ó FLC)',
          data: inrushMultipliers,
          backgroundColor: 'rgba(45,212,255,0.7)',
          borderColor: 'rgba(45,212,255,1)',
          borderWidth: 1,
          yAxisID: 'y'
        },
        {
          label: 'Starting Torque (√ó Full)',
          data: torqueMultipliers,
          backgroundColor: 'rgba(57,255,20,0.7)',
          borderColor: 'rgba(57,255,20,1)',
          borderWidth: 1,
          yAxisID: 'y1'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: {
            color: 'rgba(230,250,255,0.9)'
          }
        }
      },
      scales: {
        x: {
          grid: {
            color: 'rgba(255,255,255,0.1)'
          },
          ticks: {
            color: 'rgba(230,250,255,0.7)'
          }
        },
        y: {
          type: 'linear',
          display: true,
          position: 'left',
          title: {
            display: true,
            text: 'Current Multiplier',
            color: 'rgba(230,250,255,0.7)'
          },
          grid: {
            color: 'rgba(255,255,255,0.1)'
          },
          ticks: {
            color: 'rgba(230,250,255,0.7)'
          }
        },
        y1: {
          type: 'linear',
          display: true,
          position: 'right',
          title: {
            display: true,
            text: 'Torque Multiplier',
            color: 'rgba(230,250,255,0.7)'
          },
          grid: {
            drawOnChartArea: false
          },
          ticks: {
            color: 'rgba(230,250,255,0.7)'
          }
        }
      }
    }
  });
}

// Update comparison chart with current data
function msUpdateComparisonChart(runningCurrent, method) {
  if (!msState.comparisonChart || !runningCurrent) return;
  
  const methods = ['DOL', 'Star-Delta', 'Soft Starter', 'VFD'];
  const inrushCurrents = methods.map(m => {
    const key = m.toLowerCase().replace(' ', '-').replace('star-delta', 'star-delta');
    const multiplier = msStartingMultipliers[key]?.current || 1;
    return runningCurrent * multiplier;
  });
  
  msState.comparisonChart.data.datasets[0].data = inrushCurrents;
  
  // Highlight current method
  const methodIndex = methods.findIndex(m => 
    m.toLowerCase().replace(' ', '-').replace('star-delta', 'star-delta') === method
  );
  
  if (methodIndex !== -1) {
    msState.comparisonChart.data.datasets[0].backgroundColor = methods.map((_, i) => 
      i === methodIndex ? 'rgba(255,45,85,0.7)' : 'rgba(45,212,255,0.7)'
    );
  }
  
  msState.comparisonChart.update();
}

// Generate new comparison
function msNewComparison() {
  if (msState.calculationData) {
    msUpdateComparisonChart(msState.calculationData.runningCurrent, 
      document.getElementById('motor-method').value);
  }
  
  // Visual feedback
  const btn = document.querySelector('[onclick="msNewComparison()"]');
  btn.innerHTML = 'üîÑ Comparing...';
  setTimeout(() => {
    btn.innerHTML = 'üîÑ Compare';
  }, 500);
}

// Export data
function msExport(btn) {
  if (!msState.calculationData) {
    alert('Calculate motor parameters first before exporting.');
    return;
  }
  
  const data = {
    calculationDate: new Date().toISOString(),
    motorSpecifications: {
      power: document.getElementById('motor-power').value + ' ' + document.getElementById('motor-power-unit').value,
      voltage: document.getElementById('motor-voltage').value + ' V',
      phase: document.getElementById('motor-phase').value === 'three' ? 'Three-phase' : 'Single-phase',
      powerFactor: document.getElementById('motor-pf').value,
      efficiency: document.getElementById('motor-eff').value + '%',
      startingMethod: document.getElementById('motor-method').options[document.getElementById('motor-method').selectedIndex].text
    },
    calculationResults: {
      runningCurrent: msState.calculationData.runningCurrent.toFixed(2) + ' A',
      startingCurrent: msState.calculationData.startingCurrent.toFixed(2) + ' A',
      inrushRatio: msState.calculationData.inrushRatio.toFixed(1) + '√ó',
      apparentPower: msState.calculationData.apparentPowerKVA.toFixed(2) + ' kVA'
    },
    cableSizing: {
      recommendedSize: document.getElementById('ms-cable-size').textContent,
      voltageDrop: document.getElementById('ms-voltage-drop').textContent,
      dropPercentage: document.getElementById('ms-drop-percentage').textContent
    },
    protectionDevices: {
      circuitBreaker: document.getElementById('ms-circuit-breaker').textContent,
      fuseRating: document.getElementById('ms-fuse-rating').textContent,
      overloadSetting: document.getElementById('ms-overload-setting').textContent
    },
    disclaimer: 'This calculation is for educational purposes only. Always consult with a qualified electrician and follow local electrical codes.'
  };
  
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `motor-calculation-${new Date().toISOString().split('T')[0]}.json`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  // Visual feedback
  btn.innerHTML = '‚úÖ Exported!';
  setTimeout(() => {
    btn.innerHTML = 'üíæ Export';
  }, 1000);
}

// Reset calculator
function msReset(btn) {
  // Reset inputs
  document.querySelector('form').reset();
  
  // Reset displays
  document.getElementById('ms-running-current').textContent = '‚Äì';
  document.getElementById('ms-starting-current').textContent = '‚Äì';
  document.getElementById('ms-inrush-ratio').textContent = '‚Äì';
  document.getElementById('ms-power-consumption').textContent = '‚Äì';
  document.getElementById('ms-motor-power').textContent = '‚Äì';
  document.getElementById('ms-supply-voltage').textContent = '‚Äì';
  document.getElementById('ms-starting-method').textContent = '‚Äì';
  
  // Reset status
  document.getElementById('ms-status').textContent = 'Ready to calculate';
  document.getElementById('ms-status').style.color = 'rgba(230,250,255,0.7)';
  
  // Reset cable container
  document.getElementById('ms-cable-size').textContent = '‚Äì';
  document.getElementById('ms-voltage-drop').textContent = '‚Äì';
  document.getElementById('ms-drop-percentage').textContent = '‚Äì';
  document.getElementById('ms-recommended-cable').textContent = '‚Äì';
  document.getElementById('ms-voltage-bar').style.width = '0%';
  document.getElementById('ms-drop-status').textContent = '';
  
  // Reset protection container
  document.getElementById('ms-circuit-breaker').textContent = '‚Äì';
  document.getElementById('ms-fuse-rating').textContent = '‚Äì';
  document.getElementById('ms-overload-setting').textContent = '‚Äì';
  
  // Hide containers
  document.getElementById('ms-cable-container').style.display = 'none';
  document.getElementById('ms-protection-container').style.display = 'none';
  document.getElementById('ms-safety-container').style.display = 'none';
  
  // Reset comparison chart
  if (msState.comparisonChart) {
    msState.comparisonChart.data.datasets[0].backgroundColor = 'rgba(45,212,255,0.7)';
    msState.comparisonChart.update();
  }
  
  // Reset state
  msState.calculationData = null;
  
  // Update info displays
  msUpdatePhaseInfo();
  msUpdatePFInfo();
  msUpdateEffInfo();
  msUpdateMethodInfo();
  
  // Visual feedback
  btn.innerHTML = '‚úÖ Reset!';
  setTimeout(() => {
    btn.innerHTML = 'üîÑ Reset';
  }, 1000);
}
</script>

<!-- CUSTOM STYLES -->
<style>
#motor-startup-title {
  background: linear-gradient(135deg, var(--accent), #ff2d55);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 8px;
}

/* Animations */
@keyframes msPulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}

@keyframes msSlideIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes msWarning {
  0% { border-color: rgba(255,45,85,0.3); }
  50% { border-color: rgba(255,45,85,0.7); }
  100% { border-color: rgba(255,45,85,0.3); }
}

.ms-warning {
  animation: msWarning 2s infinite;
}

/* Voltage drop bar animation */
#ms-voltage-bar {
  transition: width 1s ease-in-out, background 0.5s ease;
}

/* Responsive adjustments */
@media (max-width: 1024px) {
  .ms-input-grid {
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }
  
  .ms-results-grid {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

@media (max-width: 768px) {
  .ms-results-grid {
    grid-template-columns: 1fr !important;
  }
  
  .ms-cable-grid,
  .ms-protection-grid {
    grid-template-columns: 1fr !important;
  }
  
  .actions {
    flex-direction: column !important;
  }
  
  .actions button {
    width: 100% !important;
    margin: 4px 0 !important;
  }
  
  .ms-safety-grid {
    grid-template-columns: 1fr !important;
  }
}

/* Print styles */
@media print {
  button, details, .ms-chart-container {
    display: none !important;
  }
  
  .ms-result-card {
    break-inside: avoid;
    border: 1px solid #000 !important;
    background: white !important;
    color: black !important;
  }
}

/* Input focus effects */
input:focus, select:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Status indicator colors */
.ms-status-good { color: #39ff14 !important; }
.ms-status-warning { color: #ffcc00 !important; }
.ms-status-danger { color: #ff2d55 !important; }

/* Chart customization */
.chartjs-tooltip {
  background: rgba(0,0,0,0.9) !important;
  border: 1px solid var(--accent) !important;
  border-radius: 6px !important;
  padding: 8px 12px !important;
  color: white !important;
}

/* Cable size indicators */
.ms-cable-small { color: #ff2d55 !important; }
.ms-cable-medium { color: #ffcc00 !important; }
.ms-cable-large { color: #39ff14 !important; }

/* Safety warning styles */
.ms-safety-warning {
  border-left: 4px solid #ff2d55;
  padding-left: 12px;
}

/* Loading animation */
@keyframes msLoading {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.ms-loading {
  animation: msLoading 1s linear infinite;
  display: inline-block;
  margin-right: 8px;
}

/* Highlight important values */
.ms-highlight {
  background: linear-gradient(135deg, rgba(45,212,255,0.1), rgba(57,255,20,0.1));
  border-radius: 6px;
  padding: 4px 8px;
  font-weight: 600;
}

/* Motor icon animation */
@keyframes motorSpin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.ms-motor-icon {
  display: inline-block;
  animation: motorSpin 3s linear infinite;
}
</style>
