<!-- cards/literature-analyzer.html -->
<h2 id="literature-analyzer-title" style="margin-top:0;color:var(--accent);font-size:1.4rem;margin-bottom:8px;">üìö AI Literature Analyzer</h2>

<form aria-describedby="literature-analyzer-desc" style="margin-bottom:20px;">
    <p id="literature-analyzer-desc" class="small" style="color:rgba(230,250,255,0.9);margin-bottom:20px;line-height:1.5;">
        <span style="color:var(--accent);font-weight:500;">üöÄ Ultimate literary toolkit:</span> Analyze any text AND generate study materials. Perfect for students, teachers, and book lovers.
    </p>
    
    <!-- DUAL MODE SELECTOR -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px;">
        <button type="button" onclick="laSetMode('analyze')" class="mode-btn active" 
                style="padding:12px;border-radius:8px;background:rgba(45,212,255,0.2);border:2px solid var(--accent);color:var(--accent);cursor:pointer;display:flex;align-items:center;gap:8px;justify-content:center;transition:all 0.2s ease;">
            <span style="font-size:18px;">üîç</span> Text Analysis
        </button>
        <button type="button" onclick="laSetMode('study')" class="mode-btn"
                style="padding:12px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;display:flex;align-items:center;gap:8px;justify-content:center;transition:all 0.2s ease;">
            <span style="font-size:18px;">üß†</span> Study Tools
        </button>
    </div>
    
    <!-- QUICK EXAMPLES - VISIBLE IN ANALYSIS MODE -->
    <div id="la-examples-section" style="margin-bottom:16px;">
        <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:8px;">üé≠ Quick Examples:</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="laLoadExample('shakespeare')" class="example-btn" style="flex:1;min-width:120px;padding:8px 12px;border-radius:8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);color:var(--accent);cursor:pointer;font-size:13px;">üé≠ Shakespeare</button>
            <button type="button" onclick="laLoadExample('poe')" class="example-btn" style="flex:1;min-width:120px;padding:8px 12px;border-radius:8px;background:rgba(255,45,85,0.1);border:1px solid rgba(255,45,85,0.3);color:#ff2d55;cursor:pointer;font-size:13px;">ü¶á Edgar Allan Poe</button>
            <button type="button" onclick="laLoadExample('fitzgerald')" class="example-btn" style="flex:1;min-width:120px;padding:8px 12px;border-radius:8px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;cursor:pointer;font-size:13px;">üíé Gatsby</button>
            <button type="button" onclick="laLoadExample('speech')" class="example-btn" style="flex:1;min-width:120px;padding:8px 12px;border-radius:8px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);color:#9d4edd;cursor:pointer;font-size:13px;">üó£Ô∏è Famous Speech</button>
        </div>
    </div>
    
    <!-- MAIN TEXT AREA -->
    <div class="field" style="margin-bottom:16px;position:relative;">
        <label for="la-text" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            <span style="display:flex;align-items:center;gap:6px;">
                <span id="la-text-icon" style="font-size:18px;">‚úçÔ∏è</span>
                <span id="la-text-label">Your Literary Passage</span>
            </span>
            <span id="la-text-hint" style="font-weight:normal;font-size:12px;color:rgba(230,250,255,0.7);">(Paste poem, novel excerpt, speech, or any text)</span>
        </label>
        <textarea id="la-text" rows="8" 
                  placeholder="To be, or not to be, that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles
And by opposing end them..."
                  style="width:100%;padding:14px;border-radius:10px;border:1px solid rgba(45,212,255,0.4);background:rgba(255,255,255,0.03);color:inherit;font-family:'Inter', system-ui, sans-serif;font-size:14px;line-height:1.5;resize:vertical;transition:border 0.2s ease;"></textarea>
        <div style="position:absolute;bottom:10px;right:14px;font-size:12px;color:rgba(230,250,255,0.5);">
            <span id="la-char-count">0</span> characters
        </div>
    </div>
    
    <!-- ANALYSIS CONTROLS - VISIBLE IN ANALYSIS MODE -->
    <div id="la-analysis-controls" style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:20px;">
        <div>
            <label for="la-focus" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                <span style="font-size:16px;">üéØ</span> Focus Area
            </label>
            <select id="la-focus" 
                    style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
                <option value="theme">üé≠ Theme & Meaning</option>
                <option value="character">üë§ Character Analysis</option>
                <option value="style">üñãÔ∏è Writing Style</option>
                <option value="symbolism">üîÆ Symbolism</option>
                <option value="tone">üå´Ô∏è Tone & Mood</option>
                <option value="historical">üìú Historical Context</option>
                <option value="all" selected>‚ú® Complete Analysis</option>
            </select>
        </div>
        
        <div>
            <label for="la-depth" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                <span style="font-size:16px;">üìä</span> Detail Level
            </label>
            <select id="la-depth" 
                    style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
                <option value="quick">‚ö° Quick Notes</option>
                <option value="standard" selected>üìù Standard Analysis</option>
                <option value="detailed">üîç Detailed Essay</option>
            </select>
        </div>
    </div>
    
    <!-- STUDY CONTROLS - HIDDEN BY DEFAULT -->
    <div id="la-study-controls" style="display:none;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:20px;">
        <div>
            <label for="la-study-type" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                <span style="font-size:16px;">üìö</span> Study Tool
            </label>
            <select id="la-study-type" 
                    style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
                <option value="flashcards">üé¥ Flashcards</option>
                <option value="quiz">‚ùì Practice Quiz</option>
                <option value="summary">üìù Study Guide</option>
                <option value="mnemonic">üéØ Memory Aids</option>
                <option value="vocabulary">üìñ Vocabulary List</option>
            </select>
        </div>
        
        <div>
            <label for="la-study-items" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;font-size:14px;">
                <span style="font-size:16px;">üìä</span> Number of Items
            </label>
            <select id="la-study-items" 
                    style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-size:14px;">
                <option value="5">5 items</option>
                <option value="10" selected>10 items</option>
                <option value="15">15 items</option>
                <option value="20">20 items</option>
            </select>
        </div>
    </div>
    
    <!-- ACTION BUTTONS -->
    <div class="actions" style="display:flex;gap:12px;margin-top:20px;">
        <button type="button" onclick="laAnalyze(this)" id="la-main-btn"
                style="flex:2;padding:14px 20px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.5);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600;font-size:15px;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform 0.2s ease;">
            <span style="font-size:18px;">‚ú®</span> <span id="la-btn-text">Generate AI Analysis</span>
        </button>
        
        <button type="button" onclick="laCopy(this)" id="la-copy-btn"
                style="padding:14px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:10px;cursor:pointer;font-weight:500;display:flex;align-items:center;gap:6px;transition:all 0.2s ease;">
            <span style="font-size:16px;">üìã</span> Copy
        </button>
        
        <button type="button" onclick="laExport(this)" id="la-export-btn"
                style="padding:14px 16px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;border-radius:10px;cursor:pointer;display:flex;align-items:center;gap:6px;">
            <span style="font-size:16px;">üì•</span> Export
        </button>
        
        <button type="button" onclick="laReset(this)"
                style="padding:14px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;color:inherit;cursor:pointer;display:flex;align-items:center;gap:6px;">
            <span style="font-size:16px;">üîÑ</span> Clear
        </button>
    </div>
</form>

<!-- RESULTS AREA -->
<div class="results" aria-live="polite" style="margin-top:24px;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">
        <h3 class="small" style="color:var(--accent);font-size:16px;margin:0;display:flex;align-items:center;gap:8px;">
            <span id="la-output-icon" style="font-size:18px;">üìä</span>
            <span id="la-output-title">AI Analysis Results</span>
        </h3>
        <div id="la-stats" style="display:flex;gap:12px;font-size:12px;color:rgba(230,250,255,0.7);">
            <span>Words: <span id="la-wordcount">0</span></span>
            <span>Study time: <span id="la-study-time">0m</span></span>
        </div>
    </div>
    
    <div id="la-output-container" style="padding:16px;border-radius:10px;border:1px solid rgba(45,212,255,0.3);background:linear-gradient(135deg, rgba(20,20,20,0.9), rgba(10,15,20,0.9));min-height:200px;max-height:400px;overflow-y:auto;">
        <div id="la-output" style="color:inherit;font-family:'Inter', system-ui, sans-serif;font-size:14px;line-height:1.6;">
            <div style="text-align:center;padding:40px 20px;color:rgba(230,250,255,0.5);">
                <div style="font-size:48px;margin-bottom:16px;">üìö</div>
                <div style="font-weight:500;margin-bottom:8px;color:var(--accent);">Ready to analyze?</div>
                <div>Enter text above and click "Generate AI Analysis"</div>
                <div style="font-size:12px;margin-top:12px;color:rgba(230,250,255,0.4);">Try an example or paste your own text</div>
            </div>
        </div>
    </div>
    
    <!-- FLASHCARD NAVIGATION (Hidden by default) -->
    <div id="la-flashcard-nav" style="display:none;margin-top:12px;text-align:center;">
        <div style="display:flex;align-items:center;justify-content:center;gap:16px;">
            <button onclick="laPrevCard()" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;">‚óÄ Previous</button>
            <span id="la-card-counter" style="font-size:13px;color:var(--accent);">Card 1 of 10</span>
            <button onclick="laNextCard()" style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;">Next ‚ñ∂</button>
        </div>
        <div style="margin-top:8px;">
            <button onclick="laFlipCard()" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);color:var(--accent);border-radius:6px;cursor:pointer;font-size:12px;">üîÑ Flip Card</button>
            <button onclick="laMarkKnown()" style="padding:6px 12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:6px;cursor:pointer;font-size:12px;margin-left:8px;">‚úÖ Mark as Known</button>
        </div>
    </div>
    
    <!-- QUIZ CONTROLS (Hidden by default) -->
    <div id="la-quiz-controls" style="display:none;margin-top:12px;text-align:center;">
        <div style="display:flex;align-items:center;justify-content:center;gap:16px;">
            <button onclick="laCheckAnswer()" style="padding:10px 20px;background:rgba(45,212,255,0.2);border:1px solid rgba(45,212,255,0.4);color:var(--accent);border-radius:8px;cursor:pointer;font-weight:500;">Check Answer</button>
            <button onclick="laNextQuestion()" style="padding:10px 20px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;font-weight:500;">Next Question ‚Üí</button>
        </div>
        <div id="la-quiz-score" style="margin-top:12px;font-size:13px;color:rgba(230,250,255,0.8);">
            Score: <span id="la-score-value">0</span>/<span id="la-total-questions">0</span>
        </div>
    </div>
    
    <!-- QUICK TIPS -->
    <div id="la-hint" style="margin-top:12px;padding:12px;background:rgba(45,212,255,0.05);border-radius:8px;border-left:3px solid var(--accent);font-size:13px;color:rgba(230,250,255,0.9);">
        <strong style="color:var(--accent);">üí° Pro Tip:</strong> Use "Complete Analysis" first, then switch to study tools for retention.
    </div>
</div>

<!-- PROGRESS TRACKER -->
<div id="la-progress-section" style="display:none;margin-top:20px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.08);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <div style="font-size:13px;color:rgba(230,250,255,0.7);">üìà Study Progress</div>
        <div id="la-progress-percent" style="font-size:13px;color:var(--accent);font-weight:500;">0%</div>
    </div>
    <div style="height:6px;background:rgba(255,255,255,0.1);border-radius:3px;overflow:hidden;">
        <div id="la-progress-bar" style="height:100%;background:linear-gradient(90deg, var(--accent), #39ff14);width:0%;transition:width 0.3s ease;"></div>
    </div>
    <div style="display:flex;justify-content:space-between;margin-top:4px;">
        <div style="font-size:11px;color:rgba(230,250,255,0.5);">Mastered: <span id="la-mastered">0</span> items</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.5);">Total: <span id="la-total-items">0</span> items</div>
    </div>
</div>

<!-- SOCIAL SHARE -->
<div style="margin-top:20px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.08);">
    <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:8px;">üéØ Found this useful? Share with students & writers:</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button onclick="laShare('twitter')" style="padding:8px 14px;background:rgba(29,161,242,0.1);border:1px solid rgba(29,161,242,0.3);color:#1da1f2;border-radius:6px;cursor:pointer;font-size:13px;display:flex;align-items:center;gap:6px;">
            üê¶ Twitter
        </button>
        <button onclick="laShare('reddit')" style="padding:8px 14px;background:rgba(255,69,0,0.1);border:1px solid rgba(255,69,0,0.3);color:#ff4500;border-radius:6px;cursor:pointer;font-size:13px;display:flex;align-items:center;gap:6px;">
            üì± Reddit
        </button>
        <button onclick="laCopyLink()" style="padding:8px 14px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:6px;cursor:pointer;font-size:13px;display:flex;align-items:center;gap:6px;">
            üîó Copy Link
        </button>
    </div>
</div>

<script>
/* literature-analyzer.html
   - Combined literary analysis + study assistant
   - Scoped with la- prefix
*/

let currentMode = 'analyze';
let currentCardIndex = 0;
let flashcards = [];
let quizQuestions = [];
let currentQuestionIndex = 0;
let quizScore = 0;
let masteredItems = 0;
let currentExample = null;

// Example texts database
const laExamples = {
    shakespeare: {
        title: "Hamlet's Soliloquy",
        text: `To be, or not to be, that is the question:
Whether 'tis nobler in the mind to suffer
The slings and arrows of outrageous fortune,
Or to take arms against a sea of troubles
And by opposing end them. To die‚Äîto sleep,
No more; and by a sleep to say we end
The heart-ache and the thousand natural shocks
That flesh is heir to: 'tis a consummation
Devoutly to be wish'd. To die, to sleep;
To sleep, perchance to dream‚Äîay, there's the rub:
For in that sleep of death what dreams may come,
When we have shuffled off this mortal coil,
Must give us pause‚Äîthere's the respect
That makes calamity of so long life.`
    },
    poe: {
        title: "The Raven",
        text: `Once upon a midnight dreary, while I pondered, weak and weary,
Over many a quaint and curious volume of forgotten lore‚Äî
While I nodded, nearly napping, suddenly there came a tapping,
As of some one gently rapping, rapping at my chamber door.
"'Tis some visitor," I muttered, "tapping at my chamber door‚Äî
            Only this and nothing more."

Ah, distinctly I remember it was in the bleak December;
And each separate dying ember wrought its ghost upon the floor.
Eagerly I wished the morrow;‚Äîvainly I had sought to borrow
From my books surcease of sorrow‚Äîsorrow for the lost Lenore‚Äî
For the rare and radiant maiden whom the angels name Lenore‚Äî
            Nameless here for evermore.`
    },
    fitzgerald: {
        title: "The Great Gatsby",
        text: `So we beat on, boats against the current, borne back ceaselessly into the past.
        
Gatsby believed in the green light, the orgastic future that year by year recedes before us. It eluded us then, but that's no matter‚Äîtomorrow we will run faster, stretch out our arms farther... And one fine morning‚Äî

So we beat on, boats against the current, borne back ceaselessly into the past.`
    },
    speech: {
        title: "Martin Luther King Jr.",
        text: `I have a dream that one day this nation will rise up and live out the true meaning of its creed: "We hold these truths to be self-evident, that all men are created equal."

I have a dream that one day on the red hills of Georgia, the sons of former slaves and the sons of former slave owners will be able to sit down together at the table of brotherhood.

I have a dream that my four little children will one day live in a nation where they will not be judged by the color of their skin but by the content of their character.`
    }
};

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    const textarea = document.querySelector('#la-text');
    const charCount = document.querySelector('#la-char-count');
    
    // Character counter
    textarea.addEventListener('input', function() {
        const count = this.value.length;
        charCount.textContent = count.toLocaleString();
        charCount.style.color = count > 50 ? '#39ff14' : 'rgba(230,250,255,0.5)';
    });
    
    // Trigger initial count
    textarea.dispatchEvent(new Event('input'));
    
    // Load saved progress
    const savedProgress = localStorage.getItem('la-progress');
    if (savedProgress) {
        const progress = JSON.parse(savedProgress);
        masteredItems = progress.mastered || 0;
        updateProgress();
    }
    
    console.log('Enhanced Literature Analyzer ready! üìöüß†');
});

// Set mode (Analyze vs Study)
function laSetMode(mode) {
    currentMode = mode;
    
    // Update button states
    document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.style.background = 'rgba(255,255,255,0.05)';
        btn.style.border = '1px solid rgba(255,255,255,0.1)';
        btn.style.color = 'inherit';
    });
    
    const activeBtn = document.querySelector(`[onclick="laSetMode('${mode}')"]`);
    if (activeBtn) {
        activeBtn.style.background = 'rgba(45,212,255,0.2)';
        activeBtn.style.border = '2px solid var(--accent)';
        activeBtn.style.color = 'var(--accent)';
    }
    
    // Show/hide sections
    const examplesSection = document.getElementById('la-examples-section');
    const analysisControls = document.getElementById('la-analysis-controls');
    const studyControls = document.getElementById('la-study-controls');
    const progressSection = document.getElementById('la-progress-section');
    
    if (mode === 'analyze') {
        examplesSection.style.display = 'block';
        analysisControls.style.display = 'grid';
        studyControls.style.display = 'none';
        progressSection.style.display = 'none';
        
        // Update UI text
        document.getElementById('la-text-icon').textContent = '‚úçÔ∏è';
        document.getElementById('la-text-label').textContent = 'Your Literary Passage';
        document.getElementById('la-text-hint').textContent = '(Paste poem, novel excerpt, speech, or any text)';
        document.getElementById('la-btn-text').textContent = 'Generate AI Analysis';
        document.getElementById('la-output-icon').textContent = 'üìä';
        document.getElementById('la-output-title').textContent = 'AI Analysis Results';
        
        // Hide study navigation
        document.getElementById('la-flashcard-nav').style.display = 'none';
        document.getElementById('la-quiz-controls').style.display = 'none';
        
        // Update hint
        document.getElementById('la-hint').innerHTML = 
            '<strong style="color:var(--accent);">üí° Pro Tip:</strong> Use "Complete Analysis" first, then switch to study tools for retention.';
            
    } else {
        examplesSection.style.display = 'none';
        analysisControls.style.display = 'none';
        studyControls.style.display = 'grid';
        progressSection.style.display = 'block';
        
        // Update UI text
        document.getElementById('la-text-icon').textContent = 'üìö';
        document.getElementById('la-text-label').textContent = 'Study Topic';
        document.getElementById('la-text-hint').textContent = '(Enter a topic or paste text to create study materials)';
        document.getElementById('la-btn-text').textContent = 'Generate Study Tools';
        document.getElementById('la-output-icon').textContent = 'üß†';
        document.getElementById('la-output-title').textContent = 'Study Materials';
        
        // Update hint
        document.getElementById('la-hint').innerHTML = 
            '<strong style="color:var(--accent);">üí° Study Tip:</strong> Use flashcards for memorization, quizzes for testing knowledge.';
    }
    
    laShowNotification(`Switched to ${mode === 'analyze' ? 'Text Analysis' : 'Study Tools'} mode`, 'info');
}

// Load example text
function laLoadExample(exampleKey) {
    const example = laExamples[exampleKey];
    if (!example) return;
    
    currentExample = exampleKey;
    const textarea = document.getElementById('la-text');
    const select = document.getElementById('la-focus');
    
    textarea.value = example.text;
    select.value = 'all'; // Set to complete analysis for examples
    
    // Trigger character count update
    textarea.dispatchEvent(new Event('input'));
    
    // Switch to analysis mode if not already
    if (currentMode !== 'analyze') {
        laSetMode('analyze');
    }
    
    // Show notification
    const hint = document.getElementById('la-hint');
    hint.innerHTML = `<strong style="color:var(--accent);">üìñ Example loaded:</strong> ${example.title}. Now click "Generate AI Analysis"!`;
    
    // Auto-scroll to textarea
    textarea.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// Main analyze/generate function
function laAnalyze(btn) {
    const text = document.getElementById('la-text').value.trim();
    
    if (!text) {
        laShowNotification('Please enter or paste some text!', 'warning');
        return;
    }
    
    if (text.length < 20) {
        document.getElementById('la-hint').innerHTML = 
            '<strong style="color:#ffcc00;">üìù</strong> Add more text for better analysis (20+ characters recommended).';
    }
    
    // Show loading state
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<span style="font-size:18px;">‚è≥</span> Processing...';
    btn.disabled = true;
    
    setTimeout(() => {
        let output = '';
        let wordCount = 0;
        let studyTime = 0;
        
        if (currentMode === 'analyze') {
            const focus = document.getElementById('la-focus').value;
            const depth = document.getElementById('la-depth').value;
            
            output = laGenerateAnalysis(text, focus, depth);
            wordCount = output.split(/\s+/).filter(w => w.length > 0).length;
            studyTime = Math.ceil(wordCount / 200); // Reading time
            
            // Hide study navigation
            document.getElementById('la-flashcard-nav').style.display = 'none';
            document.getElementById('la-quiz-controls').style.display = 'none';
            
            // Update hint
            document.getElementById('la-hint').innerHTML = 
                `<strong style="color:#39ff14;">‚úÖ Analysis complete!</strong> ${focus === 'all' ? 'Full breakdown generated.' : 'Focus area analyzed.'}`;
                
        } else {
            const studyType = document.getElementById('la-study-type').value;
            const items = parseInt(document.getElementById('la-study-items').value);
            
            output = laGenerateStudyMaterials(text, studyType, items);
            wordCount = output.text.split(/\s+/).filter(w => w.length > 0).length;
            studyTime = output.studyTime;
            
            // Handle flashcards or quiz
            if (studyType === 'flashcards') {
                flashcards = output.cards || [];
                if (flashcards.length > 0) {
                    output = laRenderFlashcards();
                    document.getElementById('la-flashcard-nav').style.display = 'block';
                }
            } else if (studyType === 'quiz') {
                quizQuestions = output.questions || [];
                currentQuestionIndex = 0;
                quizScore = 0;
                if (quizQuestions.length > 0) {
                    output = laRenderQuiz();
                    document.getElementById('la-quiz-controls').style.display = 'block';
                    document.getElementById('la-total-questions').textContent = quizQuestions.length;
                    document.getElementById('la-score-value').textContent = '0';
                }
            } else {
                output = output.text;
                // Hide navigation
                document.getElementById('la-flashcard-nav').style.display = 'none';
                document.getElementById('la-quiz-controls').style.display = 'none';
            }
            
            // Update progress
            updateProgress();
            
            // Update hint
            const studyNames = {
                'flashcards': 'Flashcards',
                'quiz': 'Practice Quiz',
                'summary': 'Study Guide',
                'mnemonic': 'Memory Aids',
                'vocabulary': 'Vocabulary List'
            };
            document.getElementById('la-hint').innerHTML = 
                `<strong style="color:#39ff14;">‚úÖ Generated!</strong> ${items} ${studyNames[studyType]} created.`;
        }
        
        // Update output
        document.getElementById('la-output').innerHTML = output;
        document.getElementById('la-wordcount').textContent = wordCount.toLocaleString();
        document.getElementById('la-study-time').textContent = studyTime + 'm';
        
        if (currentMode === 'study') {
            document.getElementById('la-total-items').textContent = 
                parseInt(document.getElementById('la-study-items').value);
            document.getElementById('la-mastered').textContent = masteredItems;
        }
        
        // Reset button
        btn.innerHTML = originalHTML;
        btn.disabled = false;
        
        // Show notification
        laShowNotification(
            currentMode === 'analyze' ? 'Analysis generated successfully! üìä' : 'Study materials created! üß†',
            'success'
        );
        
        // Auto-scroll to output
        document.getElementById('la-output-container').scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
        });
        
    }, 800);
}

// Generate literary analysis
function laGenerateAnalysis(text, focus, depth) {
    const lines = text.split('\n').filter(l => l.trim().length > 0);
    const firstLine = lines[0]?.substring(0, 60) + (lines[0]?.length > 60 ? '...' : '');
    
    const detailLevel = depth === 'quick' ? 'brief' : depth === 'detailed' ? 'comprehensive' : 'detailed';
    
    let analysis = `üìñ LITERATURE ANALYSIS\n${'‚ïê'.repeat(40)}\n\n`;
    analysis += `üìù Passage Preview: "${firstLine}"\n\n`;
    
    // Focus-specific analysis
    switch(focus) {
        case 'theme':
            analysis += laGenerateThemeAnalysis(text, detailLevel);
            break;
        case 'character':
            analysis += laGenerateCharacterAnalysis(text, detailLevel);
            break;
        case 'style':
            analysis += laGenerateStyleAnalysis(text, detailLevel);
            break;
        case 'symbolism':
            analysis += laGenerateSymbolismAnalysis(text, detailLevel);
            break;
        case 'tone':
            analysis += laGenerateToneAnalysis(text, detailLevel);
            break;
        case 'historical':
            analysis += laGenerateHistoricalAnalysis(text, detailLevel);
            break;
        case 'all':
            analysis += laGenerateCompleteAnalysis(text, detailLevel);
            break;
    }
    
    // Add AI insights
    analysis += `\n${'‚îÄ'.repeat(40)}\n`;
    analysis += `‚ú® AI INSIGHTS & WRITING TIPS:\n\n`;
    analysis += laGenerateTips(text);
    
    return analysis;
}

// Generate study materials
function laGenerateStudyMaterials(text, studyType, items) {
    switch(studyType) {
        case 'flashcards':
            const cards = laGenerateFlashcards(text, items);
            return {
                text: '',
                cards: cards,
                studyTime: items * 1.5
            };
            
        case 'quiz':
            const questions = laGenerateQuiz(text, items);
            return {
                text: '',
                questions: questions,
                studyTime: items * 2
            };
            
        case 'summary':
            return {
                text: laGenerateSummary(text, items),
                studyTime: Math.ceil(items / 2)
            };
            
        case 'mnemonic':
            return {
                text: laGenerateMnemonics(text, items),
                studyTime: Math.ceil(items * 0.8)
            };
            
        case 'vocabulary':
            return {
                text: laGenerateVocabulary(text, items),
                studyTime: Math.ceil(items * 1)
            };
    }
    
    return { text: '', studyTime: 0 };
}

// Flashcard functions
function laGenerateFlashcards(text, count) {
    const cards = [];
    const words = text.split(/\s+/).filter(w => w.length > 3);
    
    for (let i = 0; i < Math.min(count, words.length); i++) {
        const word = words[i] || `Concept ${i + 1}`;
        cards.push({
            front: `What is the significance of "${word}"?`,
            back: `"${word}" represents... Key themes associated: meaning, symbolism, literary importance.`,
            known: false
        });
    }
    
    // Fill remaining with general concepts
    while (cards.length < count) {
        cards.push({
            front: `Key Theme ${cards.length + 1}`,
            back: `Important literary theme with examples from the text.`,
            known: false
        });
    }
    
    return cards;
}

function laRenderFlashcards() {
    if (flashcards.length === 0) return '<div>No flashcards generated.</div>';
    
    currentCardIndex = 0;
    document.getElementById('la-card-counter').textContent = `Card 1 of ${flashcards.length}`;
    
    return `
        <div id="la-flashcard" style="perspective:1000px;cursor:pointer;" onclick="laFlipCard()">
            <div id="la-flashcard-inner" style="position:relative;width:100%;height:200px;transition:transform 0.8s;transform-style:preserve-3d;">
                <div id="la-flashcard-front" style="position:absolute;width:100%;height:100%;backface-visibility:hidden;background:rgba(45,212,255,0.1);border-radius:10px;padding:20px;display:flex;align-items:center;justify-content:center;text-align:center;font-size:18px;font-weight:600;color:var(--accent);">
                    ${flashcards[0].front}
                </div>
                <div id="la-flashcard-back" style="position:absolute;width:100%;height:100%;backface-visibility:hidden;background:rgba(20,20,20,0.9);border-radius:10px;padding:20px;transform:rotateY(180deg);overflow-y:auto;border:1px solid rgba(45,212,255,0.3);">
                    <div style="font-size:16px;margin-bottom:10px;color:var(--accent);">Answer:</div>
                    <div style="font-size:14px;line-height:1.5;">${flashcards[0].back}</div>
                </div>
            </div>
        </div>
        <div style="text-align:center;margin-top:16px;font-size:12px;color:rgba(230,250,255,0.5);">
            Click card to flip ‚Ä¢ Use navigation below
        </div>
    `;
}

function laFlipCard() {
    if (currentMode !== 'study') return;
    
    const inner = document.getElementById('la-flashcard-inner');
    if (!inner) return;
    
    const currentRotation = inner.style.transform === 'rotateY(180deg)' ? 'rotateY(0deg)' : 'rotateY(180deg)';
    inner.style.transform = currentRotation;
}

function laPrevCard() {
    if (currentCardIndex > 0) {
        currentCardIndex--;
        laUpdateFlashcardDisplay();
    }
}

function laNextCard() {
    if (currentCardIndex < flashcards.length - 1) {
        currentCardIndex++;
        laUpdateFlashcardDisplay();
    }
}

function laMarkKnown() {
    if (flashcards[currentCardIndex]) {
        flashcards[currentCardIndex].known = !flashcards[currentCardIndex].known;
        masteredItems = flashcards.filter(card => card.known).length;
        
        // Visual feedback
        const btn = document.querySelector('[onclick="laMarkKnown()"]');
        if (flashcards[currentCardIndex].known) {
            btn.innerHTML = '‚úÖ Known';
            btn.style.background = 'rgba(57,255,20,0.2)';
            btn.style.color = '#39ff14';
        } else {
            btn.innerHTML = '‚úÖ Mark as Known';
            btn.style.background = 'rgba(57,255,20,0.1)';
            btn.style.color = '#39ff14';
        }
        
        updateProgress();
        saveProgress();
    }
}

function laUpdateFlashcardDisplay() {
    if (!flashcards[currentCardIndex]) return;
    
    const front = document.getElementById('la-flashcard-front');
    const back = document.getElementById('la-flashcard-back');
    const counter = document.getElementById('la-card-counter');
    
    if (front && back && counter) {
        front.innerHTML = flashcards[currentCardIndex].front;
        back.innerHTML = `
            <div style="font-size:16px;margin-bottom:10px;color:var(--accent);">Answer:</div>
            <div style="font-size:14px;line-height:1.5;">${flashcards[currentCardIndex].back}</div>
        `;
        counter.textContent = `Card ${currentCardIndex + 1} of ${flashcards.length}`;
        
        // Reset flip
        const inner = document.getElementById('la-flashcard-inner');
        if (inner) inner.style.transform = 'rotateY(0deg)';
        
        // Update mark button
        const markBtn = document.querySelector('[onclick="laMarkKnown()"]');
        if (markBtn) {
            if (flashcards[currentCardIndex].known) {
                markBtn.innerHTML = '‚úÖ Known';
                markBtn.style.background = 'rgba(57,255,20,0.2)';
            } else {
                markBtn.innerHTML = '‚úÖ Mark as Known';
                markBtn.style.background = 'rgba(57,255,20,0.1)';
            }
        }
    }
}

// Quiz functions
function laGenerateQuiz(text, count) {
    const questions = [];
    const themes = ['Theme', 'Symbolism', 'Character', 'Setting', 'Conflict'];
    
    for (let i = 1; i <= count; i++) {
        const theme = themes[i % themes.length];
        questions.push({
            type: 'multiple-choice',
            question: `Which best describes the ${theme.toLowerCase()} in this text?`,
            options: [
                `Option A: Primary ${theme}`,
                `Option B: Secondary ${theme}`,
                `Option C: Contrasting ${theme}`,
                `Option D: Hidden ${theme}`
            ],
            correct: 0,
            explanation: `The primary ${theme.toLowerCase()} is... because...`
        });
    }
    
    return questions;
}

function laRenderQuiz() {
    if (quizQuestions.length === 0) return '<div>No quiz generated.</div>';
    
    currentQuestionIndex = 0;
    return laRenderQuestion(0);
}

function laRenderQuestion(index) {
    if (!quizQuestions[index]) return '';
    
    const question = quizQuestions[index];
    let html = `<div style="margin-bottom:20px;">`;
    
    html += `<div style="font-size:16px;font-weight:600;margin-bottom:16px;color:var(--accent);">Question ${index + 1}:</div>`;
    html += `<div style="font-size:15px;margin-bottom:20px;line-height:1.5;">${question.question}</div>`;
    
    html += `<div style="display:grid;gap:10px;">`;
    question.options.forEach((option, i) => {
        html += `
            <label style="display:flex;align-items:center;gap:10px;padding:12px;background:rgba(255,255,255,0.05);border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;">
                <input type="radio" name="quiz-answer" value="${i}" style="accent-color:var(--accent);">
                <span>${option}</span>
            </label>
        `;
    });
    html += `</div>`;
    
    html += `
        <div id="quiz-answer" style="display:none;margin-top:20px;padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border-left:3px solid var(--accent);">
            <div style="font-weight:600;color:var(--accent);margin-bottom:8px;">Explanation:</div>
            <div>${question.explanation}</div>
        </div>
    `;
    
    return html;
}

function laCheckAnswer() {
    const question = quizQuestions[currentQuestionIndex];
    if (!question) return;
    
    const selected = document.querySelector('input[name="quiz-answer"]:checked');
    const isCorrect = selected && parseInt(selected.value) === question.correct;
    
    if (isCorrect) {
        quizScore++;
        laShowNotification('Correct! ‚úÖ', 'success');
    } else {
        laShowNotification('Try again! ‚ùå', 'error');
    }
    
    document.getElementById('la-score-value').textContent = quizScore;
    document.getElementById('quiz-answer').style.display = 'block';
}

function laNextQuestion() {
    if (currentQuestionIndex < quizQuestions.length - 1) {
        currentQuestionIndex++;
        document.getElementById('la-output').innerHTML = laRenderQuestion(currentQuestionIndex);
        document.getElementById('quiz-answer').style.display = 'none';
    } else {
        const percentage = Math.round((quizScore / quizQuestions.length) * 100);
        document.getElementById('la-output').innerHTML = `
            <div style="text-align:center;padding:40px 20px;">
                <div style="font-size:48px;margin-bottom:16px;">${percentage >= 80 ? 'üéâ' : percentage >= 60 ? 'üëç' : 'üìö'}</div>
                <div style="font-size:20px;font-weight:600;margin-bottom:12px;color:var(--accent);">Quiz Complete!</div>
                <div style="margin-bottom:16px;">Score: <strong style="color:${percentage >= 80 ? '#39ff14' : percentage >= 60 ? 'var(--accent)' : '#ffcc00'}">${quizScore}/${quizQuestions.length}</strong> (${percentage}%)</div>
                <div style="font-size:14px;color:rgba(230,250,255,0.7);">
                    ${percentage >= 80 ? 'Excellent literary analysis skills!' : 
                      percentage >= 60 ? 'Good understanding! Review the flashcards.' :
                      'Keep studying! Try the flashcards mode.'}
                </div>
            </div>
        `;
        document.getElementById('la-quiz-controls').style.display = 'none';
    }
}

// Study material generators
function laGenerateSummary(text, items) {
    return `
        <div style="margin-bottom:20px;">
            <div style="font-size:16px;font-weight:600;margin-bottom:12px;color:var(--accent);">üìö Study Guide</div>
            <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:16px;">Key points from your text</div>
        </div>
        
        <div style="margin-bottom:16px;">
            <div style="font-weight:600;margin-bottom:8px;color:var(--accent);">üîë Key Themes:</div>
            <ul style="margin:0;padding-left:20px;">
                ${Array.from({length: Math.min(5, items)}, (_, i) => 
                    `<li style="margin-bottom:6px;">Theme ${i + 1}: Important literary element</li>`
                ).join('')}
            </ul>
        </div>
        
        <div style="margin-bottom:16px;">
            <div style="font-weight:600;margin-bottom:8px;color:var(--accent);">‚úçÔ∏è Writing Style:</div>
            <div style="background:rgba(255,255,255,0.03);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);">
                Notable literary devices, tone, and narrative techniques used in the text.
            </div>
        </div>
    `;
}

function laGenerateMnemonics(text, items) {
    return `
        <div style="margin-bottom:20px;">
            <div style="font-size:16px;font-weight:600;margin-bottom:12px;color:var(--accent);">üéØ Memory Aids</div>
            <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:16px;">${items} techniques to remember key concepts</div>
        </div>
        
        <div style="display:grid;gap:12px;">
            ${Array.from({length: Math.min(6, items)}, (_, i) => `
                <div style="background:rgba(255,255,255,0.03);padding:16px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);">
                    <div style="font-weight:600;color:var(--accent);margin-bottom:8px;">Technique ${i + 1}</div>
                    <div style="font-style:italic;color:rgba(230,250,255,0.9);background:rgba(0,0,0,0.2);padding:8px;border-radius:4px;border-left:3px solid var(--accent);">
                        "Memory phrase or acronym here..."
                    </div>
                    <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-top:8px;">
                        Use this to remember: Key concept from the text
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

function laGenerateVocabulary(text, items) {
    const words = text.split(/\s+/)
        .filter(w => w.length > 5)
        .slice(0, Math.min(10, items));
    
    return `
        <div style="margin-bottom:20px;">
            <div style="font-size:16px;font-weight:600;margin-bottom:12px;color:var(--accent);">üìñ Vocabulary List</div>
            <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:16px;">${words.length} key words from the text</div>
        </div>
        
        <div style="display:grid;gap:8px;">
            ${words.map((word, i) => `
                <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid rgba(255,255,255,0.1);">
                    <div>
                        <strong style="color:var(--accent);">${word}</strong>
                        <div style="font-size:12px;color:rgba(230,250,255,0.7);">Definition: Literary term or significant word</div>
                    </div>
                    <button onclick="laCopyWord('${word}')" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);color:var(--accent);border-radius:4px;cursor:pointer;font-size:11px;">Copy</button>
                </div>
            `).join('')}
        </div>
    `;
}

// Analysis generators (original functions)
function laGenerateThemeAnalysis(text, detail) {
    const themes = ['Existential crisis', 'Mortality', 'Choice', 'Suffering', 'Hope'];
    const selected = themes.slice(0, detail === 'brief' ? 2 : 3);
    
    return `üéØ THEME ANALYSIS (${detail.toUpperCase()})\n\n` +
           `‚Ä¢ Primary Themes: ${selected.join(', ')}\n` +
           `‚Ä¢ Moral Questions: ${detail === 'comprehensive' ? 'Exploration of human condition, ethical dilemmas' : 'Human experience'}\n` +
           `‚Ä¢ Philosophical Underpinnings: ${detail === 'brief' ? 'Existential reflection' : 'Examination of life, death, and meaning'}\n\n`;
}

function laGenerateCompleteAnalysis(text, detail) {
    return `‚ú® COMPLETE LITERARY BREAKDOWN\n\n` +
           `üé≠ THEMES\n‚Ä¢ Existential questioning\n‚Ä¢ Life vs. death dilemma\n‚Ä¢ Action vs. inaction\n\n` +
           `üîÆ SYMBOLISM\n‚Ä¢ Sleep = death metaphor\n‚Ä¢ Sea = overwhelming troubles\n‚Ä¢ Arms = resistance\n\n` +
           `üå´Ô∏è TONE & MOOD\n‚Ä¢ Melancholy contemplation\n‚Ä¢ Philosophical weight\n‚Ä¢ Urgent introspection\n\n` +
           `üñãÔ∏è WRITING STYLE\n‚Ä¢ Iambic pentameter (if Shakespeare)\n‚Ä¢ Rhetorical questions\n‚Ä¢ Metaphorical language\n‚Ä¢ Parallel structure\n\n`;
}

function laGenerateTips(text) {
    const tips = [
        "üîç Look for repeated words or phrases‚Äîthey often signal key themes.",
        "üìù Note the speaker's perspective: Is it first-person intimate or third-person omniscient?",
        "üé® Pay attention to color imagery‚Äîcolors often carry symbolic meaning.",
        "‚è≥ Consider the historical context when analyzing older texts.",
        "üí° Compare this passage to others by the same author for deeper insight.",
        "‚ú® Use this analysis as a starting point‚Äîadd your own observations!"
    ];
    
    const randomTips = tips.sort(() => Math.random() - 0.5).slice(0, 3);
    return randomTips.map(tip => `‚Ä¢ ${tip}`).join('\n');
}

// Utility functions
function laCopy(btn) {
    const output = document.getElementById('la-output');
    const text = output.innerText || output.textContent;
    
    if (!text.trim() || text.includes('Ready to analyze?')) {
        laShowNotification('Generate content first!', 'warning');
        return;
    }
    
    navigator.clipboard.writeText(text).then(() => {
        const original = btn.innerHTML;
        btn.innerHTML = '<span style="font-size:16px;">‚úÖ</span> Copied!';
        btn.style.background = 'rgba(57,255,20,0.2)';
        
        setTimeout(() => {
            btn.innerHTML = original;
            btn.style.background = '';
        }, 2000);
        
        laShowNotification('Content copied to clipboard! üìã', 'success');
    });
}

function laExport() {
    const text = document.getElementById('la-text').value || 'Literature Analysis';
    const content = document.getElementById('la-output').innerText || document.getElementById('la-output').textContent;
    
    if (!content || content.includes('Ready to analyze?')) {
        laShowNotification('Generate content first!', 'warning');
        return;
    }
    
    const blob = new Blob([`${text}\n\n${content}`], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${text.substring(0, 20).replace(/\s+/g, '_')}_${currentMode}_${new Date().toISOString().split('T')[0]}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    laShowNotification('Exported as text file! üì•', 'success');
}

function laCopyWord(word) {
    navigator.clipboard.writeText(word).then(() => {
        laShowNotification(`Copied: ${word}`, 'info');
    });
}

function laReset(btn) {
    const card = btn.closest('.card');
    card.querySelector('form').reset();
    
    // Reset to analysis mode
    if (currentMode !== 'analyze') {
        laSetMode('analyze');
    }
    
    // Clear output
    document.getElementById('la-output').innerHTML = `
        <div style="text-align:center;padding:40px 20px;color:rgba(230,250,255,0.5);">
            <div style="font-size:48px;margin-bottom:16px;">üìö</div>
            <div style="font-weight:500;margin-bottom:8px;color:var(--accent);">Ready to analyze?</div>
            <div>Enter text above and click "Generate AI Analysis"</div>
            <div style="font-size:12px;margin-top:12px;color:rgba(230,250,255,0.4);">Try an example or paste your own text</div>
        </div>
    `;
    
    // Reset stats
    document.getElementById('la-char-count').textContent = '0';
    document.getElementById('la-char-count').style.color = 'rgba(230,250,255,0.5)';
    document.getElementById('la-wordcount').textContent = '0';
    document.getElementById('la-study-time').textContent = '0m';
    document.getElementById('la-total-items').textContent = '0';
    document.getElementById('la-mastered').textContent = '0';
    
    // Hide navigation
    document.getElementById('la-flashcard-nav').style.display = 'none';
    document.getElementById('la-quiz-controls').style.display = 'none';
    
    // Reset progress
    masteredItems = 0;
    updateProgress();
    saveProgress();
    
    laShowNotification('Cleared! Ready for new analysis. üìö', 'info');
}

function updateProgress() {
    const totalItems = parseInt(document.getElementById('la-total-items').textContent) || 0;
    const percent = totalItems > 0 ? Math.round((masteredItems / totalItems) * 100) : 0;
    
    document.getElementById('la-progress-percent').textContent = percent + '%';
    document.getElementById('la-progress-bar').style.width = percent + '%';
    document.getElementById('la-mastered').textContent = masteredItems;
}

function saveProgress() {
    const progress = {
        mastered: masteredItems,
        lastUpdated: new Date().toISOString()
    };
    localStorage.setItem('la-progress', JSON.stringify(progress));
}

// Social sharing
function laShare(platform) {
    const url = window.location.href;
    const text = "Check out this amazing AI Literature Analyzer + Study Assistant! üìö‚ú®";
    
    let shareUrl = '';
    switch(platform) {
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
            break;
        case 'reddit':
            shareUrl = `https://reddit.com/submit?url=${encodeURIComponent(url)}&title=${encodeURIComponent(text)}`;
            break;
    }
    
    if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }
}

function laCopyLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        laShowNotification('Link copied! Share with friends. üîó', 'success');
    });
}

// Notification system
function laShowNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 16px;
        background: ${type === 'success' ? 'rgba(57,255,20,0.15)' : 
                     type === 'error' ? 'rgba(255,45,85,0.15)' : 
                     type === 'warning' ? 'rgba(255,204,0,0.15)' : 
                     'rgba(45,212,255,0.15)'};
        border: 1px solid ${type === 'success' ? 'rgba(57,255,20,0.3)' : 
                           type === 'error' ? 'rgba(255,45,85,0.3)' : 
                           type === 'warning' ? 'rgba(255,204,0,0.3)' : 
                           'rgba(45,212,255,0.3)'};
        color: ${type === 'success' ? '#39ff14' : 
                type === 'error' ? '#ff2d55' : 
                type === 'warning' ? '#ffcc00' : 
                'var(--accent)'};
        border-radius: 8px;
        z-index: 10000;
        backdrop-filter: blur(10px);
        font-weight: 500;
        animation: laSlideIn 0.3s ease;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'laSlideOut 0.3s ease';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// Add CSS animations
if (!document.querySelector('#la-styles')) {
    const style = document.createElement('style');
    style.id = 'la-styles';
    style.textContent = `
        @keyframes laSlideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes laSlideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        button:active {
            transform: translateY(0);
        }
        textarea:focus, input:focus, select:focus {
            border-color: var(--accent) !important;
            outline: none;
            box-shadow: 0 0 0 2px rgba(45,212,255,0.1);
        }
        #la-flashcard-inner {
            transition: transform 0.6s !important;
        }
    `;
    document.head.appendChild(style);
}
</script>

<style>
/* Card-specific responsive styles */
#literature-analyzer-title {
    animation: laFadeIn 0.5s ease;
}

@media (max-width: 768px) {
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100%;
        justify-content: center;
    }
    
    .mode-btn {
        font-size: 13px !important;
        padding: 10px !important;
    }
    
    #la-analysis-controls, #la-study-controls {
        grid-template-columns: 1fr !important;
    }
}

@keyframes laFadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
