<!-- cards/most-useful-card-generator.html -->
<h2 id="most-useful-card-generator-title">üöÄ Most Useful Card Generator</h2>

<form aria-describedby="card-generator-desc">
    <p id="card-generator-desc" class="small">
        Create, test, and deploy new cards for "The Most Useful Site in the World" with this all-in-one generator.
        <span style="color:var(--accent)">Everything you need in one place!</span>
    </p>
    
    <!-- PROJECT SETUP -->
    <div class="section" style="margin-bottom:24px;padding:16px;background:rgba(45,212,255,0.05);border-radius:10px;border:1px solid rgba(45,212,255,0.2);">
        <h3 style="color:var(--accent);margin-top:0;margin-bottom:12px;">üìã Project Setup</h3>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:12px;">
            <div>
                <label for="mcg-tool-name" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Tool Name
                </label>
                <input id="mcg-tool-name" type="text" placeholder="e.g., tip-calculator"
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;" />
            </div>
            
            <div>
                <label for="mcg-prefix" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Prefix (2-3 letters)
                </label>
                <input id="mcg-prefix" type="text" placeholder="e.g., tc" maxlength="3"
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;text-align:center;" />
            </div>
        </div>
        
        <div>
            <label for="mcg-description" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Description
            </label>
            <textarea id="mcg-description" rows="2" placeholder="What does this tool do? Why is it useful?"
                      style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;resize:vertical;"></textarea>
        </div>
    </div>
    
    <!-- INPUT DESIGNER -->
    <div class="section" style="margin-bottom:24px;padding:16px;background:rgba(255,255,255,0.03);border-radius:10px;border:1px solid rgba(255,255,255,0.1);">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <h3 style="color:var(--accent);margin:0;">üéõÔ∏è Input Designer</h3>
            <button type="button" onclick="mcgAddInput()"
                    style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">
                + Add Input
            </button>
        </div>
        
        <div id="mcg-inputs-container" style="display:flex;flex-direction:column;gap:12px;">
            <!-- Inputs will be added here -->
            <div class="input-item" style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px dashed rgba(255,255,255,0.1);">
                <div style="color:rgba(230,250,255,0.8);margin-bottom:6px;font-size:13px;">No inputs yet. Click "Add Input" to start.</div>
            </div>
        </div>
        
        <div style="margin-top:12px;font-size:13px;color:rgba(230,250,255,0.6);">
            <div style="display:flex;align-items:center;gap:8px;">
                <div style="width:8px;height:8px;background:var(--accent);border-radius:50%;"></div>
                <span>Inputs are automatically prefixed with your chosen prefix</span>
            </div>
        </div>
    </div>
    
    <!-- CODE GENERATION -->
    <div class="section" style="margin-bottom:24px;padding:16px;background:rgba(57,255,20,0.05);border-radius:10px;border:1px solid rgba(57,255,20,0.2);">
        <h3 style="color:#39ff14;margin-top:0;margin-bottom:12px;">üíª Generated Code</h3>
        
        <div style="margin-bottom:12px;">
            <label for="mcg-filename" style="display:block;margin-bottom:6px;color:#39ff14;font-weight:500;">
                File Name
            </label>
            <input id="mcg-filename" type="text" readonly
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:#39ff14;font-family:monospace;" />
        </div>
        
        <div>
            <label style="display:block;margin-bottom:6px;color:#39ff14;font-weight:500;">
                HTML Code Preview
            </label>
            <textarea id="mcg-html-output" rows="16" readonly
                      style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(57,255,20,0.3);background:rgba(0,0,0,0.3);color:#39ff14;font-family:'Courier New',monospace;font-size:12px;line-height:1.4;resize:vertical;"></textarea>
        </div>
        
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="mcgGenerateCode()"
                    style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(57,255,20,0.1));border:1px solid rgba(57,255,20,0.4);border-radius:8px;color:#39ff14;cursor:pointer;font-weight:600;">
                üîÑ Generate Code
            </button>
            <button type="button" onclick="mcgCopyCode()"
                    style="padding:12px 16px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;">
                üìã Copy Code
            </button>
            <button type="button" onclick="mcgTestCard()"
                    style="padding:12px 16px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);border-radius:8px;color:#ffa500;cursor:pointer;">
                üß™ Test Live
            </button>
        </div>
    </div>
    
    <!-- DEPLOYMENT GUIDANCE -->
    <div class="section" style="margin-bottom:24px;padding:16px;background:rgba(157,78,221,0.05);border-radius:10px;border:1px solid rgba(157,78,221,0.2);">
        <h3 style="color:#9d4edd;margin-top:0;margin-bottom:12px;">üöÄ Deployment Steps</h3>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:12px;">
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <div style="width:24px;height:24px;background:#9d4edd;color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;">1</div>
                    <strong style="color:#9d4edd;">Save File</strong>
                </div>
                <div style="font-size:13px;color:rgba(230,250,255,0.8);">
                    Save generated code as:<br>
                    <code id="mcg-save-path" style="color:#9d4edd;font-family:monospace;">cards/your-tool.html</code>
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <div style="width:24px;height:24px;background:#9d4edd;color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;">2</div>
                    <strong style="color:#9d4edd;">Test Locally</strong>
                </div>
                <div style="font-size:13px;color:rgba(230,250,255,0.8);">
                    Open index.html in browser<br>
                    Ensure card loads correctly
                </div>
            </div>
            
            <div style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <div style="width:24px;height:24px;background:#9d4edd;color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;">3</div>
                    <strong style="color:#9d4edd;">Deploy</strong>
                </div>
                <div style="font-size:13px;color:rgba(230,250,255,0.8);">
                    Push to GitHub<br>
                    Wait for GitHub Pages build
                </div>
            </div>
        </div>
    </div>
    
    <!-- MAIN ACTIONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="mcgCreateCompleteCard()" 
                style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.3), rgba(45,212,255,0.2));border:1px solid rgba(45,212,255,0.6);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600;font-size:16px;">
            üöÄ Create Complete Card
        </button>
        <button type="button" onclick="mcgResetAll()"
                style="padding:14px 20px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:10px;color:#ff4d4d;cursor:pointer;font-weight:600;">
            üîÑ Reset All
        </button>
    </div>
</form>

<!-- PREVIEW AREA -->
<div class="preview" style="margin-top:24px;">
    <h3 class="small" style="color:var(--accent);margin-bottom:12px;display:flex;align-items:center;gap:8px;">
        <span>üëÅÔ∏è Live Preview</span>
        <button type="button" onclick="mcgTogglePreview()" style="padding:4px 8px;background:transparent;border:1px solid var(--accent);border-radius:4px;color:var(--accent);cursor:pointer;font-size:11px;">Toggle</button>
    </h3>
    
    <div id="mcg-preview-container" 
         style="padding:20px;background:rgba(0,0,0,0.3);border-radius:12px;border:2px dashed rgba(45,212,255,0.3);min-height:200px;overflow:auto;">
        <div style="text-align:center;color:rgba(230,250,255,0.5);padding:40px;">
            Card preview will appear here
        </div>
    </div>
</div>

<script>
/* most-useful-card-generator.html
   - Comprehensive card creation tool
   - Scoped with mcg- prefix
*/

let mcgInputs = [];
let mcgTestMode = false;

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    console.log('Card Generator ready');
    
    // Auto-update filename
    const nameInput = document.getElementById('mcg-tool-name');
    const fileInput = document.getElementById('mcg-filename');
    const pathSpan = document.getElementById('mcg-save-path');
    
    nameInput.addEventListener('input', function() {
        const name = this.value.trim().toLowerCase().replace(/\s+/g, '-');
        const filename = name ? `${name}.html` : 'your-tool.html';
        fileInput.value = filename;
        pathSpan.textContent = `cards/${filename}`;
        
        // Auto-generate prefix from name
        if (name) {
            const prefix = name.split('-').map(w => w[0]).join('').toLowerCase();
            document.getElementById('mcg-prefix').value = prefix.substring(0, 3);
        }
    });
    
    // Auto-update prefix
    document.getElementById('mcg-prefix').addEventListener('input', function() {
        const prefix = this.value.trim().toLowerCase();
        if (prefix.length > 3) {
            this.value = prefix.substring(0, 3);
        }
    });
    
    // Add first example input
    mcgAddInput();
});

// Input management
function mcgAddInput() {
    const container = document.getElementById('mcg-inputs-container');
    
    // Remove placeholder if present
    const placeholder = container.querySelector('.input-item');
    if (placeholder && placeholder.innerHTML.includes('No inputs yet')) {
        placeholder.remove();
    }
    
    const inputId = `input-${Date.now()}`;
    const inputItem = document.createElement('div');
    inputItem.className = 'input-item';
    inputItem.id = inputId;
    inputItem.style.cssText = 'padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(255,255,255,0.1);';
    
    inputItem.innerHTML = `
        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
            <div style="font-size:14px;color:var(--accent);font-weight:500;">Input ${mcgInputs.length + 1}</div>
            <button type="button" onclick="mcgRemoveInput('${inputId}')" style="background:transparent;border:none;color:#ff4d4d;cursor:pointer;font-size:12px;">‚úï</button>
        </div>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
            <div>
                <label style="display:block;margin-bottom:4px;color:rgba(230,250,255,0.9);font-size:12px;">Label</label>
                <input type="text" class="input-label" placeholder="e.g., Voltage" 
                       style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;font-size:12px;" />
            </div>
            <div>
                <label style="display:block;margin-bottom:4px;color:rgba(230,250,255,0.9);font-size:12px;">ID</label>
                <input type="text" class="input-id" placeholder="e.g., voltage" 
                       style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;font-size:12px;font-family:monospace;" />
            </div>
        </div>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
            <div>
                <label style="display:block;margin-bottom:4px;color:rgba(230,250,255,0.9);font-size:12px;">Type</label>
                <select class="input-type" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;font-size:12px;">
                    <option value="number">Number</option>
                    <option value="text">Text</option>
                    <option value="select">Dropdown</option>
                    <option value="checkbox">Checkbox</option>
                    <option value="range">Slider</option>
                </select>
            </div>
            <div>
                <label style="display:block;margin-bottom:4px;color:rgba(230,250,255,0.9);font-size:12px;">Placeholder/Options</label>
                <input type="text" class="input-options" placeholder="e.g., 12,24,48" 
                       style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;font-size:12px;" />
            </div>
        </div>
        
        <div style="margin-top:8px;">
            <label style="display:flex;align-items:center;gap:6px;color:rgba(230,250,255,0.9);font-size:12px;cursor:pointer;">
                <input type="checkbox" class="input-required" checked />
                Required field
            </label>
        </div>
    `;
    
    container.appendChild(inputItem);
    mcgInputs.push(inputId);
    
    // Auto-update ID based on label
    const labelInput = inputItem.querySelector('.input-label');
    const idInput = inputItem.querySelector('.input-id');
    
    labelInput.addEventListener('input', function() {
        const prefix = document.getElementById('mcg-prefix').value || 'xx';
        const id = this.value.trim().toLowerCase().replace(/\s+/g, '-');
        if (id) {
            idInput.value = `${prefix}-${id}`;
        }
    });
}

function mcgRemoveInput(id) {
    const inputItem = document.getElementById(id);
    if (inputItem) {
        inputItem.remove();
        mcgInputs = mcgInputs.filter(inputId => inputId !== id);
    }
    
    // Add placeholder if no inputs left
    const container = document.getElementById('mcg-inputs-container');
    if (container.children.length === 0) {
        container.innerHTML = `
            <div class="input-item" style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px dashed rgba(255,255,255,0.1);">
                <div style="color:rgba(230,250,255,0.8);margin-bottom:6px;font-size:13px;">No inputs yet. Click "Add Input" to start.</div>
            </div>
        `;
    }
}

// Code generation
function mcgGenerateCode() {
    const toolName = document.getElementById('mcg-tool-name').value.trim();
    const prefix = document.getElementById('mcg-prefix').value.trim().toLowerCase() || 'xx';
    const description = document.getElementById('mcg-description').value.trim();
    
    if (!toolName) {
        alert('Please enter a tool name first');
        return;
    }
    
    // Collect input data
    const inputs = [];
    document.querySelectorAll('.input-item').forEach(item => {
        if (item.innerHTML.includes('No inputs yet')) return;
        
        const label = item.querySelector('.input-label').value.trim();
        const id = item.querySelector('.input-id').value.trim();
        const type = item.querySelector('.input-type').value;
        const options = item.querySelector('.input-options').value.trim();
        const required = item.querySelector('.input-required').checked;
        
        if (label && id) {
            inputs.push({ label, id, type, options, required });
        }
    });
    
    // Generate title ID
    const titleId = toolName.toLowerCase().replace(/\s+/g, '-') + '-title';
    const displayName = toolName.replace(/-/g, ' ');
    
    // Build HTML
    let html = `<!-- cards/${toolName.toLowerCase().replace(/\s+/g, '-')}.html -->\n`;
    html += `<!-- START DIRECTLY WITH CONTENT - NO WRAPPERS! -->\n\n`;
    html += `<h2 id="${titleId}">${displayName}</h2>\n\n`;
    
    html += `<form aria-describedby="tool-description">\n`;
    html += `    <p id="tool-description" class="small">\n`;
    html += `        ${description || 'A useful tool for calculations.'}\n`;
    html += `        <span style="color:var(--accent)">Powered by The Most Useful Site.</span>\n`;
    html += `    </p>\n\n`;
    
    // Add inputs
    inputs.forEach((input, index) => {
        html += `    <!-- INPUT ${index + 1} -->\n`;
        html += `    <div class="field" style="margin-bottom:16px;">\n`;
        html += `        <label for="${input.id}" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">\n`;
        html += `            ${input.label}${input.required ? ' *' : ''}\n`;
        html += `        </label>\n`;
        
        if (input.type === 'select') {
            const options = input.options.split(',').map(opt => opt.trim()).filter(opt => opt);
            html += `        <select id="${input.id}" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">\n`;
            options.forEach(option => {
                html += `            <option value="${option.toLowerCase().replace(/\s+/g, '-')}">${option}</option>\n`;
            });
            html += `        </select>\n`;
        } else if (input.type === 'range') {
            const [min, max, step] = input.options.split(',').map(val => val.trim());
            html += `        <input id="${input.id}" type="range" min="${min || 0}" max="${max || 100}" step="${step || 1}" \n`;
            html += `               style="width:100%;" \n`;
            html += `               oninput="document.getElementById('${input.id}-value').textContent = this.value" />\n`;
            html += `        <div style="text-align:center;color:var(--accent);margin-top:4px;">\n`;
            html += `            Value: <span id="${input.id}-value">${min || 50}</span>\n`;
            html += `        </div>\n`;
        } else {
            html += `        <input id="${input.id}" type="${input.type}" placeholder="${input.options || 'Enter value'}" \n`;
            if (input.required) html += `               required \n`;
            html += `               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />\n`;
        }
        
        html += `    </div>\n\n`;
    });
    
    // Add actions
    html += `    <!-- ACTIONS -->\n`;
    html += `    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">\n`;
    html += `        <button type="button" onclick="${prefix}Calculate(this)" \n`;
    html += `                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;">\n`;
    html += `            Calculate\n`;
    html += `        </button>\n`;
    html += `        <button type="button" onclick="${prefix}Reset(this)"\n`;
    html += `                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">\n`;
    html += `            Reset\n`;
    html += `        </button>\n`;
    html += `    </div>\n`;
    html += `</form>\n\n`;
    
    // Results area
    html += `<!-- RESULTS -->\n`;
    html += `<div class="results" aria-live="polite" style="margin-top:16px;">\n`;
    html += `    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">Results</h3>\n`;
    html += `    <div id="${prefix}-output" style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);font-family:monospace;white-space:pre-line;">\n`;
    html += `        Results will appear here.\n`;
    html += `    </div>\n`;
    html += `</div>\n\n`;
    
    // JavaScript
    html += `<!-- SCRIPT - MUST BE SCOPED WITH PREFIX -->\n`;
    html += `<script>\n`;
    html += `/* ${toolName.toLowerCase().replace(/\s+/g, '-')}.html\n`;
    html += `   - ${description || 'A useful tool'}\n`;
    html += `   - Scoped with ${prefix.toUpperCase()} prefix\n`;
    html += `*/\n\n`;
    
    html += `function ${prefix}Calculate(btn) {\n`;
    html += `    const card = btn.closest('.card') || document;\n`;
    html += `    const output = card.querySelector('#${prefix}-output');\n`;
    html += `    \n`;
    html += `    try {\n`;
    html += `        // Get input values\n`;
    inputs.forEach(input => {
        html += `        const ${input.id.replace('-', '_')} = card.querySelector('#${input.id}').value;\n`;
    });
    html += `        \n`;
    html += `        // TODO: Add your calculation logic here\n`;
    html += `        let result = "Calculation logic goes here.\\n";\n`;
    html += `        result += "Inputs received:\\n";\n`;
    inputs.forEach(input => {
        html += `        result += "${input.label}: " + ${input.id.replace('-', '_')} + "\\n";\n`;
    });
    html += `        \n`;
    html += `        output.textContent = result;\n`;
    html += `        output.style.color = "#39ff14";\n`;
    html += `    } catch (error) {\n`;
    html += `        output.textContent = "Error: " + error.message;\n`;
    html += `        output.style.color = "#ff2d55";\n`;
    html += `        console.error("${prefix}Calculate error:", error);\n`;
    html += `    }\n`;
    html += `}\n\n`;
    
    html += `function ${prefix}Reset(btn) {\n`;
    html += `    const card = btn.closest('.card') || document;\n`;
    html += `    \n`;
    html += `    // Reset inputs\n`;
    inputs.forEach(input => {
        if (input.type === 'select') {
            html += `    card.querySelector('#${input.id}').selectedIndex = 0;\n`;
        } else {
            html += `    card.querySelector('#${input.id}').value = '';\n`;
        }
    });
    html += `    \n`;
    html += `    // Reset output\n`;
    html += `    card.querySelector('#${prefix}-output').textContent = 'Results will appear here.';\n`;
    html += `    card.querySelector('#${prefix}-output').style.color = '';\n`;
    html += `}\n\n`;
    
    html += `// Initialize if needed\n`;
    html += `if (document.readyState === 'loading') {\n`;
    html += `    document.addEventListener('DOMContentLoaded', function() {\n`;
    html += `        console.log('${displayName} ready');\n`;
    html += `    });\n`;
    html += `} else {\n`;
    html += `    // Run immediately if already loaded\n`;
    html += `    console.log('${displayName} ready');\n`;
    html += `}\n`;
    html += `<\/script>\n\n`;
    
    // Optional styles
    html += `<!-- OPTIONAL STYLE OVERRIDES -->\n`;
    html += `<style>\n`;
    html += `/* Card-specific styles only */\n`;
    html += `#${titleId} {\n`;
    html += `    color: var(--accent);\n`;
    html += `    margin-top: 0;\n`;
    html += `}\n\n`;
    
    html += `@media (max-width: 768px) {\n`;
    html += `    /* Mobile adjustments */\n`;
    html += `    .actions {\n`;
    html += `        flex-direction: column;\n`;
    html += `    }\n`;
    html += `    \n`;
    html += `    .actions button {\n`;
    html += `        width: 100%;\n`;
    html += `    }\n`;
    html += `}\n`;
    html += `</style>\n`;
    
    // Update output
    document.getElementById('mcg-html-output').value = html;
    
    // Update preview
    mcgUpdatePreview(html);
    
    return html;
}

// Preview functions
function mcgUpdatePreview(html) {
    const container = document.getElementById('mcg-preview-container');
    
    // Extract just the content part (between h2 and last style tag)
    const contentMatch = html.match(/<h2[^>]*>[\s\S]*?<\/style>/);
    if (contentMatch) {
        const previewHTML = contentMatch[0];
        
        // Create a sandboxed iframe for preview
        container.innerHTML = `
            <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-bottom:8px;">
                Preview (interactive)
            </div>
            <div id="mcg-live-preview" style="padding:16px;background:rgba(20,20,20,0.8);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
                ${previewHTML}
            </div>
        `;
        
        // Execute scripts in preview
        const previewDiv = container.querySelector('#mcg-live-preview');
        const scripts = previewDiv.querySelectorAll('script');
        scripts.forEach(script => {
            const newScript = document.createElement('script');
            newScript.textContent = script.textContent;
            previewDiv.appendChild(newScript);
        });
    }
}

function mcgTogglePreview() {
    const container = document.getElementById('mcg-preview-container');
    const isHidden = container.style.display === 'none';
    container.style.display = isHidden ? 'block' : 'none';
}

// Utility functions
function mcgCopyCode() {
    const textarea = document.getElementById('mcg-html-output');
    if (!textarea.value.trim()) {
        alert('Generate code first!');
        return;
    }
    
    textarea.select();
    navigator.clipboard.writeText(textarea.value).then(() => {
        // Visual feedback
        const copyBtn = document.querySelector('button[onclick="mcgCopyCode()"]');
        const originalText = copyBtn.textContent;
        copyBtn.textContent = '‚úÖ Copied!';
        copyBtn.style.color = '#39ff14';
        
        setTimeout(() => {
            copyBtn.textContent = originalText;
            copyBtn.style.color = '';
        }, 2000);
    }).catch(err => {
        console.error('Copy failed:', err);
        alert('Copy failed. Please select and copy manually.');
    });
}

function mcgTestCard() {
    const html = document.getElementById('mcg-html-output').value;
    if (!html.trim()) {
        alert('Generate code first!');
        return;
    }
    
    // Open in new tab for testing
    const blob = new Blob([html], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    window.open(url, '_blank');
}

function mcgCreateCompleteCard() {
    mcgGenerateCode();
    mcgCopyCode();
    
    // Show success message
    const toolName = document.getElementById('mcg-tool-name').value || 'your-tool';
    const filename = `${toolName.toLowerCase().replace(/\s+/g, '-')}.html`;
    
    alert(`‚úÖ Card created successfully!\n\nüìÅ Save as: cards/${filename}\nüìã Code copied to clipboard\n\nNext steps:\n1. Save file to /cards/ folder\n2. Test locally\n3. Deploy to GitHub`);
}

function mcgResetAll() {
    if (!confirm('Reset all inputs and generated code?')) return;
    
    // Reset form
    document.getElementById('mcg-tool-name').value = '';
    document.getElementById('mcg-prefix').value = '';
    document.getElementById('mcg-description').value = '';
    document.getElementById('mcg-filename').value = 'your-tool.html';
    document.getElementById('mcg-html-output').value = '';
    document.getElementById('mcg-save-path').textContent = 'cards/your-tool.html';
    
    // Clear inputs
    const container = document.getElementById('mcg-inputs-container');
    container.innerHTML = `
        <div class="input-item" style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px dashed rgba(255,255,255,0.1);">
            <div style="color:rgba(230,250,255,0.8);margin-bottom:6px;font-size:13px;">No inputs yet. Click "Add Input" to start.</div>
        </div>
    `;
    mcgInputs = [];
    
    // Clear preview
    document.getElementById('mcg-preview-container').innerHTML = `
        <div style="text-align:center;color:rgba(230,250,255,0.5);padding:40px;">
            Card preview will appear here
        </div>
    `;
    
    // Reset to first example
    mcgAddInput();
}
</script>

<style>
#most-useful-card-generator-title {
    color: var(--accent);
    margin-top: 0;
    background: linear-gradient(135deg, var(--accent), #39ff14);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

@media (max-width: 768px) {
    .section {
        padding: 12px !important;
    }
    
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100%;
    }
    
    #mcg-inputs-container .input-item > div > div {
        grid-template-columns: 1fr !important;
    }
}
</style>
