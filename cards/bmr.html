<h2 id="bmr-title" style="margin-top:0; color: #2c3e50; border-bottom: 2px solid #e67e22; padding-bottom: 8px;">
  <i class="fas fa-fire"></i> BMR & TDEE Calculator
</h2>

<form aria-describedby="bmr-desc" style="background: #fef9f3; padding: 20px; border-radius: 8px; border: 1px solid #fde3c4;">
  <p id="bmr-desc" class="small" style="margin-bottom: 20px; color: #d35400; font-style: italic; border-left: 3px solid #e67e22; padding-left: 10px;">
    <i class="fas fa-info-circle"></i> Calculate your Basal Metabolic Rate (BMR) and Total Daily Energy Expenditure (TDEE).
    <span id="bmr-importance" style="display: block; margin-top: 5px; color: #e67e22; font-weight: 500; font-style: normal;">
      BMR = calories burned at complete rest. TDEE = BMR × activity level.
    </span>
  </p>

  <div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
    <div class="field">
      <label for="bmr-age" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-birthday-cake"></i> Age
        <span id="age-display" style="float: right; color: #e67e22; font-weight: normal;">30 years</span>
      </label>
      <input id="bmr-age" type="range" min="15" max="80" step="1" value="30" 
             style="width: 100%; margin-bottom: 5px;"
             oninput="updateAgeValue(this.value)" />
      <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
        <span>15</span>
        <span>30</span>
        <span>80</span>
      </div>
      <input id="bmr-age-input" type="number" min="15" max="80" value="30" 
             style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: 1px solid #f0b27a;"
             oninput="updateAgeSlider(this.value)" />
    </div>

    <div class="field">
      <label for="bmr-gender" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-user"></i> Gender
      </label>
      <div style="display: flex; gap: 10px; margin-top: 5px;">
        <button type="button" id="gender-male" class="gender-btn active" onclick="selectGender('male')" 
                style="flex: 1; padding: 12px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
          <i class="fas fa-mars"></i> Male
        </button>
        <button type="button" id="gender-female" class="gender-btn" onclick="selectGender('female')" 
                style="flex: 1; padding: 12px; background: #f8f9fa; color: #2c3e50; border: 1px solid #f0b27a; border-radius: 4px; cursor: pointer; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 8px;">
          <i class="fas fa-venus"></i> Female
        </button>
      </div>
      <input type="hidden" id="bmr-gender" value="male">
    </div>
  </div>

  <div class="row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
    <div class="field">
      <label for="bmr-height" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-ruler-vertical"></i> Height
        <span id="height-display" style="float: right; color: #e67e22; font-weight: normal;">175 cm</span>
      </label>
      <input id="bmr-height" type="range" min="100" max="220" step="1" value="175" 
             style="width: 100%; margin-bottom: 5px;"
             oninput="updateHeightValue(this.value)" />
      <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
        <span>100 cm</span>
        <span>175 cm</span>
        <span>220 cm</span>
      </div>
      <input id="bmr-height-input" type="number" min="100" max="220" step="0.1" value="175" 
             style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: 1px solid #f0b27a;"
             oninput="updateHeightSlider(this.value)" />
    </div>

    <div class="field">
      <label for="bmr-weight" style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
        <i class="fas fa-weight-hanging"></i> Weight
        <span id="weight-display" style="float: right; color: #e67e22; font-weight: normal;">70 kg</span>
      </label>
      <input id="bmr-weight" type="range" min="40" max="150" step="0.5" value="70" 
             style="width: 100%; margin-bottom: 5px;"
             oninput="updateWeightValue(this.value)" />
      <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #7f8c8d;">
        <span>40 kg</span>
        <span>70 kg</span>
        <span>150 kg</span>
      </div>
      <input id="bmr-weight-input" type="number" min="40" max="150" step="0.1" value="70" 
             style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: 1px solid #f0b27a;"
             oninput="updateWeightSlider(this.value)" />
    </div>
  </div>

  <!-- Activity Level -->
  <div class="field" style="margin-bottom: 20px;">
    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">
      <i class="fas fa-running"></i> Activity Level
    </label>
    <select id="bmr-activity" style="width: 100%; padding: 12px; border-radius: 4px; border: 1px solid #f0b27a; background: white; cursor: pointer;"
            onchange="autoCalculate()">
      <option value="1.2">Sedentary (little or no exercise)</option>
      <option value="1.375">Lightly Active (light exercise 1-3 days/week)</option>
      <option value="1.55" selected>Moderately Active (moderate exercise 3-5 days/week)</option>
      <option value="1.725">Very Active (hard exercise 6-7 days/week)</option>
      <option value="1.9">Extra Active (very hard exercise & physical job)</option>
    </select>
    <small id="activity-description" style="display: block; margin-top: 5px; color: #e67e22;">
      Multiplier: 1.55 × BMR = TDEE
    </small>
  </div>

  <div class="actions" style="margin-top: 25px; display: flex; gap: 10px;">
    <button type="button" onclick="bmrCalc(this)" 
            style="flex: 1; padding: 14px; background: linear-gradient(135deg, #e67e22, #d35400); color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 1em;">
      <i class="fas fa-calculator"></i> Calculate BMR & TDEE
    </button>
    <button type="button" class="secondary" onclick="bmrReset(this)" 
            style="flex: 1; padding: 14px; background: #fef9f3; color: #2c3e50; border: 1px solid #f0b27a; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 1em;">
      <i class="fas fa-redo"></i> Reset
    </button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top: 25px; background: #fef9f3; border-radius: 8px; padding: 20px; border: 1px solid #fde3c4;">
  <div style="text-align: center; margin-bottom: 20px;">
    <h3 style="margin: 0 0 10px 0; color: #2c3e50;">
      <i class="fas fa-chart-line"></i> Your Daily Calorie Needs
    </h3>
    <p style="color: #7f8c8d; margin: 0; font-size: 0.95em;">
      Based on Mifflin-St Jeor equation with your activity level
    </p>
  </div>

  <!-- Main Results Grid -->
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
    <!-- BMR Card -->
    <div class="result-card" style="background: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-top: 4px solid #3498db;">
      <div class="label" style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 8px;">
        <i class="fas fa-bed"></i> Basal Metabolic Rate
      </div>
      <div class="value" id="bmr-res" style="font-size: 2em; font-weight: 700; color: #3498db;">–</div>
      <div style="font-size: 0.85em; color: #95a5a6; margin-top: 5px;">
        Calories burned at complete rest
      </div>
    </div>

    <!-- TDEE Card -->
    <div class="result-card" style="background: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-top: 4px solid #e67e22;">
      <div class="label" style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 8px;">
        <i class="fas fa-fire-alt"></i> Total Daily Energy Expenditure
      </div>
      <div class="value" id="tdee-res" style="font-size: 2em; font-weight: 700; color: #e67e22;">–</div>
      <div style="font-size: 0.85em; color: #95a5a6; margin-top: 5px;">
        Maintenance calories with your activity level
      </div>
    </div>

    <!-- Activity Multiplier Card -->
    <div class="result-card" style="background: white; padding: 20px; border-radius: 8px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-top: 4px solid #2ecc71;">
      <div class="label" style="color: #7f8c8d; font-size: 0.9em; margin-bottom: 8px;">
        <i class="fas fa-chart-bar"></i> Activity Multiplier
      </div>
      <div class="value" id="activity-multiplier" style="font-size: 2em; font-weight: 700; color: #2ecc71;">1.55</div>
      <div style="font-size: 0.85em; color: #95a5a6; margin-top: 5px;">
        Based on your selected activity level
      </div>
    </div>
  </div>

  <!-- Calorie Goals for Different Objectives -->
  <div style="margin-top: 30px;">
    <h4 style="margin: 0 0 15px 0; color: #2c3e50; border-bottom: 1px solid #fde3c4; padding-bottom: 8px;">
      <i class="fas fa-bullseye"></i> Calorie Goals for Your Objectives
    </h4>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-top: 15px;">
      <!-- Weight Loss -->
      <div style="background: #e8f6f3; padding: 15px; border-radius: 8px; border-left: 4px solid #27ae60;">
        <div style="font-weight: 600; color: #27ae60; margin-bottom: 8px;">
          <i class="fas fa-arrow-down"></i> Weight Loss
        </div>
        <div style="font-size: 1.5em; font-weight: 700; color: #2c3e50; margin-bottom: 5px;">
          <span id="loss-calories">–</span> kcal/day
        </div>
        <div style="font-size: 0.85em; color: #7f8c8d;">
          TDEE - 500 kcal (≈0.5 kg/week loss)
        </div>
      </div>
      
      <!-- Mild Weight Loss -->
      <div style="background: #e8f4fc; padding: 15px; border-radius: 8px; border-left: 4px solid #3498db;">
        <div style="font-weight: 600; color: #3498db; margin-bottom: 8px;">
          <i class="fas fa-angle-down"></i> Mild Weight Loss
        </div>
        <div style="font-size: 1.5em; font-weight: 700; color: #2c3e50; margin-bottom: 5px;">
          <span id="mild-loss-calories">–</span> kcal/day
        </div>
        <div style="font-size: 0.85em; color: #7f8c8d;">
          TDEE - 250 kcal (≈0.25 kg/week loss)
        </div>
      </div>
      
      <!-- Maintenance -->
      <div style="background: #fef9e7; padding: 15px; border-radius: 8px; border-left: 4px solid #f39c12;">
        <div style="font-weight: 600; color: #f39c12; margin-bottom: 8px;">
          <i class="fas fa-balance-scale"></i> Maintenance
        </div>
        <div style="font-size: 1.5em; font-weight: 700; color: #2c3e50; margin-bottom: 5px;">
          <span id="maintenance-calories">–</span> kcal/day
        </div>
        <div style="font-size: 0.85em; color: #7f8c8d;">
          Same as TDEE (maintain current weight)
        </div>
      </div>
      
      <!-- Weight Gain -->
      <div style="background: #fdedec; padding: 15px; border-radius: 8px; border-left: 4px solid #e74c3c;">
        <div style="font-weight: 600; color: #e74c3c; margin-bottom: 8px;">
          <i class="fas fa-arrow-up"></i> Weight Gain
        </div>
        <div style="font-size: 1.5em; font-weight: 700; color: #2c3e50; margin-bottom: 5px;">
          <span id="gain-calories">–</span> kcal/day
        </div>
        <div style="font-size: 0.85em; color: #7f8c8d;">
          TDEE + 500 kcal (≈0.5 kg/week gain)
        </div>
      </div>
    </div>
  </div>

  <!-- Macronutrient Breakdown -->
  <div id="macros-section" style="display: none; margin-top: 30px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
    <h4 style="margin: 0 0 15px 0; color: #2c3e50;">
      <i class="fas fa-apple-alt"></i> Recommended Macronutrient Breakdown
    </h4>
    
    <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
      <div style="flex: 1;">
        <div style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 5px;">For Weight Loss Goal</div>
        <div id="macro-chart" style="height: 20px; background: linear-gradient(to right, #3498db 30%, #2ecc71 50%, #e67e22 20%); border-radius: 10px;"></div>
      </div>
      <div style="min-width: 150px;">
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <div style="width: 12px; height: 12px; background: #3498db; border-radius: 50%; margin-right: 8px;"></div>
          <span style="font-size: 0.9em;">Protein: <strong id="protein-percent">30%</strong></span>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <div style="width: 12px; height: 12px; background: #2ecc71; border-radius: 50%; margin-right: 8px;"></div>
          <span style="font-size: 0.9em;">Carbs: <strong id="carbs-percent">50%</strong></span>
        </div>
        <div style="display: flex; align-items: center;">
          <div style="width: 12px; height: 12px; background: #e67e22; border-radius: 50%; margin-right: 8px;"></div>
          <span style="font-size: 0.9em;">Fat: <strong id="fat-percent">20%</strong></span>
        </div>
      </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; font-size: 0.9em;">
      <div style="text-align: center;">
        <div style="font-weight: 600; color: #3498db; margin-bottom: 5px;">Protein</div>
        <div id="protein-grams">– g/day</div>
        <div style="color: #7f8c8d; font-size: 0.85em;">Builds & repairs tissue</div>
      </div>
      <div style="text-align: center;">
        <div style="font-weight: 600; color: #2ecc71; margin-bottom: 5px;">Carbohydrates</div>
        <div id="carbs-grams">– g/day</div>
        <div style="color: #7f8c8d; font-size: 0.85em;">Primary energy source</div>
      </div>
      <div style="text-align: center;">
        <div style="font-weight: 600; color: #e67e22; margin-bottom: 5px;">Fat</div>
        <div id="fat-grams">– g/day</div>
        <div style="color: #7f8c8d; font-size: 0.85em;">Hormone production</div>
      </div>
    </div>
  </div>

  <!-- Weekly Weight Projection -->
  <div id="projection-section" style="display: none; margin-top: 30px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
    <h4 style="margin: 0 0 15px 0; color: #2c3e50;">
      <i class="fas fa-chart-line"></i> Weight Change Projection
    </h4>
    <div style="display: flex; justify-content: space-around; text-align: center;">
      <div>
        <div style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 5px;">1 Week</div>
        <div style="font-size: 1.2em; font-weight: 600; color: #e67e22;" id="week1">– kg</div>
      </div>
      <div>
        <div style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 5px;">1 Month</div>
        <div style="font-size: 1.2em; font-weight: 600; color: #e67e22;" id="month1">– kg</div>
      </div>
      <div>
        <div style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 5px;">3 Months</div>
        <div style="font-size: 1.2em; font-weight: 600; color: #e67e22;" id="month3">– kg</div>
      </div>
      <div>
        <div style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 5px;">6 Months</div>
        <div style="font-size: 1.2em; font-weight: 600; color: #e67e22;" id="month6">– kg</div>
      </div>
    </div>
    <p style="margin-top: 10px; font-size: 0.85em; color: #7f8c8d; text-align: center;">
      <i class="fas fa-info-circle"></i> Based on consistent calorie deficit/surplus. Individual results may vary.
    </p>
  </div>
</div>

<details class="small" style="margin-top:20px; background: #fef9f3; padding: 15px; border-radius: 8px; border: 1px solid #fde3c4;">
  <summary style="font-weight: 600; color: #2c3e50; cursor: pointer;">
    <i class="fas fa-info-circle"></i> How It Works & Important Notes
  </summary>
  <div style="margin-top: 15px;">
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
      <div>
        <h4 style="margin-top: 0; color: #e67e22;">Mifflin-St Jeor Equation</h4>
        <p style="margin: 8px 0;">
          <strong>For Men:</strong><br>
          BMR = (10 × weight in kg) + (6.25 × height in cm) - (5 × age) + 5
        </p>
        <p style="margin: 8px 0;">
          <strong>For Women:</strong><br>
          BMR = (10 × weight in kg) + (6.25 × height in cm) - (5 × age) - 161
        </p>
      </div>
      
      <div>
        <h4 style="margin-top: 0; color: #e67e22;">Activity Multipliers</h4>
        <ul style="margin: 8px 0; padding-left: 20px;">
          <li><strong>1.2</strong> - Sedentary (office job, little exercise)</li>
          <li><strong>1.375</strong> - Lightly Active (light exercise 1-3 days/week)</li>
          <li><strong>1.55</strong> - Moderately Active (exercise 3-5 days/week)</li>
          <li><strong>1.725</strong> - Very Active (exercise 6-7 days/week)</li>
          <li><strong>1.9</strong> - Extra Active (athlete, physical job)</li>
        </ul>
      </div>
    </div>
    
    <div style="background: #fff8e1; padding: 15px; border-radius: 6px; border-left: 4px solid #f39c12;">
      <h4 style="margin-top: 0; color: #d35400;">
        <i class="fas fa-exclamation-triangle"></i> Important Considerations
      </h4>
      <ul style="margin: 8px 0; padding-left: 20px;">
        <li>BMR decreases with age (≈1-2% per decade after 20)</li>
        <li>Muscle mass increases BMR (muscle burns more calories than fat)</li>
        <li>These are estimates - individual metabolism varies</li>
        <li>Not suitable for pregnant women or individuals with metabolic disorders</li>
        <li>Always consult with a healthcare professional before making significant dietary changes</li>
      </ul>
    </div>
  </div>
</details>

<script>
// Initialize values
document.addEventListener('DOMContentLoaded', function() {
  updateAgeValue(30);
  updateHeightValue(175);
  updateWeightValue(70);
  
  // Calculate on initial load
  setTimeout(() => bmrCalc(document.querySelector('button')), 100);
});

// Gender selection
function selectGender(gender) {
  document.getElementById('bmr-gender').value = gender;
  
  // Update button styles
  document.querySelectorAll('.gender-btn').forEach(btn => {
    btn.classList.remove('active');
    btn.style.background = '#f8f9fa';
    btn.style.color = '#2c3e50';
    btn.style.border = '1px solid #f0b27a';
  });
  
  const selectedBtn = document.getElementById(`gender-${gender}`);
  selectedBtn.classList.add('active');
  selectedBtn.style.background = '#3498db';
  selectedBtn.style.color = 'white';
  selectedBtn.style.border = 'none';
  
  // Auto-calculate
  autoCalculate();
}

// Update age controls
function updateAgeValue(value) {
  document.getElementById('bmr-age').value = value;
  document.getElementById('bmr-age-input').value = value;
  document.getElementById('age-display').textContent = value + ' years';
  autoCalculate();
}

function updateAgeSlider(value) {
  let numValue = parseInt(value);
  if (isNaN(numValue) || numValue < 15) numValue = 15;
  if (numValue > 80) numValue = 80;
  updateAgeValue(numValue);
}

// Update height controls
function updateHeightValue(value) {
  document.getElementById('bmr-height').value = value;
  document.getElementById('bmr-height-input').value = value;
  document.getElementById('height-display').textContent = value + ' cm';
  autoCalculate();
}

function updateHeightSlider(value) {
  let numValue = parseFloat(value);
  if (isNaN(numValue) || numValue < 100) numValue = 100;
  if (numValue > 220) numValue = 220;
  updateHeightValue(numValue);
}

// Update weight controls
function updateWeightValue(value) {
  document.getElementById('bmr-weight').value = value;
  document.getElementById('bmr-weight-input').value = value;
  document.getElementById('weight-display').textContent = value + ' kg';
  autoCalculate();
}

function updateWeightSlider(value) {
  let numValue = parseFloat(value);
  if (isNaN(numValue) || numValue < 40) numValue = 40;
  if (numValue > 150) numValue = 150;
  updateWeightValue(numValue);
}

// Auto-calculate when values change
function autoCalculate() {
  const age = parseInt(document.getElementById('bmr-age').value);
  const height = parseFloat(document.getElementById('bmr-height').value);
  const weight = parseFloat(document.getElementById('bmr-weight').value);
  
  if (age > 0 && height > 0 && weight > 0) {
    bmrCalc(document.querySelector('button'));
  }
}

// Update activity description
document.getElementById('bmr-activity').addEventListener('change', function() {
  const multiplier = this.value;
  const optionText = this.options[this.selectedIndex].text;
  document.getElementById('activity-description').innerHTML = 
    `<strong>${optionText.split('(')[0].trim()}</strong><br>Multiplier: ${multiplier} × BMR = TDEE`;
});

// Main calculation function
function bmrCalc(btn) {
  const age = parseInt(document.getElementById('bmr-age').value, 10) || 0;
  const gender = document.getElementById('bmr-gender').value;
  const height = parseFloat(document.getElementById('bmr-height').value) || 0;
  const weight = parseFloat(document.getElementById('bmr-weight').value) || 0;
  const activityMultiplier = parseFloat(document.getElementById('bmr-activity').value) || 1.55;

  // Validate inputs
  if (age < 15 || age > 80 || height < 100 || height > 220 || weight < 40 || weight > 150) {
    showError();
    return;
  }

  // Calculate BMR using Mifflin-St Jeor equation
  let bmr = 0;
  if (gender === 'male') {
    bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
  } else {
    bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
  }

  const bmrRounded = Math.round(bmr);
  
  // Calculate TDEE
  const tdee = bmr * activityMultiplier;
  const tdeeRounded = Math.round(tdee);

  // Update main results
  document.getElementById('bmr-res').textContent = bmrRounded.toLocaleString() + " kcal/day";
  document.getElementById('tdee-res').textContent = tdeeRounded.toLocaleString() + " kcal/day";
  document.getElementById('activity-multiplier').textContent = activityMultiplier;

  // Calculate goal calories
  const lossCalories = Math.round(tdee - 500);
  const mildLossCalories = Math.round(tdee - 250);
  const maintenanceCalories = tdeeRounded;
  const gainCalories = Math.round(tdee + 500);

  // Update goal displays
  document.getElementById('loss-calories').textContent = lossCalories.toLocaleString();
  document.getElementById('mild-loss-calories').textContent = mildLossCalories.toLocaleString();
  document.getElementById('maintenance-calories').textContent = maintenanceCalories.toLocaleString();
  document.getElementById('gain-calories').textContent = gainCalories.toLocaleString();

  // Calculate macronutrients for weight loss goal
  calculateMacronutrients(lossCalories);

  // Calculate weight projections
  calculateWeightProjections(weight, lossCalories - tdee);

  // Show additional sections
  document.getElementById('macros-section').style.display = 'block';
  document.getElementById('projection-section').style.display = 'block';
}

// Calculate macronutrient breakdown
function calculateMacronutrients(calories) {
  // Recommended ratios for weight loss
  const proteinRatio = 0.3;   // 30% protein
  const carbsRatio = 0.5;     // 50% carbs
  const fatRatio = 0.2;       // 20% fat

  // Calories per gram: protein=4, carbs=4, fat=9
  const proteinCals = calories * proteinRatio;
  const carbsCals = calories * carbsRatio;
  const fatCals = calories * fatRatio;

  const proteinGrams = Math.round(proteinCals / 4);
  const carbsGrams = Math.round(carbsCals / 4);
  const fatGrams = Math.round(fatCals / 9);

  // Update display
  document.getElementById('protein-percent').textContent = Math.round(proteinRatio * 100) + '%';
  document.getElementById('carbs-percent').textContent = Math.round(carbsRatio * 100) + '%';
  document.getElementById('fat-percent').textContent = Math.round(fatRatio * 100) + '%';

  document.getElementById('protein-grams').textContent = proteinGrams.toLocaleString() + ' g/day';
  document.getElementById('carbs-grams').textContent = carbsGrams.toLocaleString() + ' g/day';
  document.getElementById('fat-grams').textContent = fatGrams.toLocaleString() + ' g/day';

  // Update chart
  document.getElementById('macro-chart').style.background = 
    `linear-gradient(to right, #3498db ${proteinRatio*100}%, #2ecc71 ${carbsRatio*100}%, #e67e22 ${fatRatio*100}%)`;
}

// Calculate weight change projections
function calculateWeightProjections(currentWeight, dailyCalorieDifference) {
  // 1 kg of fat ≈ 7700 calories
  const weeklyChange = (dailyCalorieDifference * 7) / 7700;
  
  document.getElementById('week1').textContent = (currentWeight + weeklyChange).toFixed(1) + ' kg';
  document.getElementById('month1').textContent = (currentWeight + (weeklyChange * 4)).toFixed(1) + ' kg';
  document.getElementById('month3').textContent = (currentWeight + (weeklyChange * 12)).toFixed(1) + ' kg';
  document.getElementById('month6').textContent = (currentWeight + (weeklyChange * 26)).toFixed(1) + ' kg';
}

// Show error state
function showError() {
  document.getElementById('bmr-res').textContent = "Invalid input";
  document.getElementById('bmr-res').style.color = "#e74c3c";
  document.getElementById('tdee-res').textContent = "–";
  document.getElementById('macros-section').style.display = 'none';
  document.getElementById('projection-section').style.display = 'none';
}

// Reset function
function bmrReset(btn) {
  // Reset gender
  selectGender('male');
  
  // Reset values
  updateAgeValue(30);
  updateHeightValue(175);
  updateWeightValue(70);
  
  // Reset activity level
  document.getElementById('bmr-activity').selectedIndex = 2;
  
  // Recalculate
  bmrCalc(btn);
}
</script>

<!-- Add Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">