<h2 id="macros-title" style="margin-top:0;">Macros Calculator</h2>

<form aria-describedby="macros-desc">
  <p id="macros-desc" class="small">Split your daily calories into protein, carbs, and fats based on chosen ratios.</p>

  <div class="field">
    <label for="macros-calories">Daily calories</label>
    <input id="macros-calories" type="number" min="500" step="50" value="2000" />
  </div>

  <div class="row">
    <div class="field">
      <label for="macros-protein">Protein (%)</label>
      <input id="macros-protein" type="number" min="0" max="100" value="30" />
    </div>
    <div class="field">
      <label for="macros-carbs">Carbs (%)</label>
      <input id="macros-carbs" type="number" min="0" max="100" value="40" />
    </div>
    <div class="field">
      <label for="macros-fat">Fat (%)</label>
      <input id="macros-fat" type="number" min="0" max="100" value="30" />
    </div>
  </div>

  <div class="actions">
    <button type="button" onclick="macrosCalc(this)">Calculate</button>
    <button type="button" class="secondary" onclick="macrosReset(this)">Reset</button>
  </div>
</form>

<div class="results" aria-live="polite">
  <div class="result">
    <div class="label">Protein</div>
    <div class="value" id="macros-protein-res">–</div>
  </div>
  <div class="result">
    <div class="label">Carbs</div>
    <div class="value" id="macros-carbs-res">–</div>
  </div>
  <div class="result">
    <div class="label">Fat</div>
    <div class="value" id="macros-fat-res">–</div>
  </div>
</div>

<details class="small" style="margin-top:12px;">
  <summary>How it works</summary>
  <p>
    Protein = 4 kcal/g, Carbs = 4 kcal/g, Fat = 9 kcal/g.  
    Calories × percentage ÷ kcal per gram = grams.
  </p>
</details>

<script>
function macrosCalc(btn) {
  const card = btn.closest('.card');
  const calories = parseFloat(card.querySelector('#macros-calories').value) || 0;
  const pPct = parseFloat(card.querySelector('#macros-protein').value) || 0;
  const cPct = parseFloat(card.querySelector('#macros-carbs').value) || 0;
  const fPct = parseFloat(card.querySelector('#macros-fat').value) || 0;

  const totalPct = pPct + cPct + fPct;
  if (totalPct !== 100) {
    card.querySelector('#macros-protein-res').textContent = "Adjust % to total 100";
    card.querySelector('#macros-carbs-res').textContent = "–";
    card.querySelector('#macros-fat-res').textContent = "–";
    return;
  }

  const proteinGrams = (calories * (pPct/100)) / 4;
  const carbsGrams   = (calories * (cPct/100)) / 4;
  const fatGrams     = (calories * (fPct/100)) / 9;

  card.querySelector('#macros-protein-res').textContent = proteinGrams.toFixed(0) + " g";
  card.querySelector('#macros-carbs-res').textContent   = carbsGrams.toFixed(0) + " g";
  card.querySelector('#macros-fat-res').textContent     = fatGrams.toFixed(0) + " g";
}

function macrosReset(btn) {
  const card = btn.closest('.card');
  card.querySelector('form').reset();
  card.querySelector('#macros-protein-res').textContent = '–';
  card.querySelector('#macros-carbs-res').textContent   = '–';
  card.querySelector('#macros-fat-res').textContent     = '–';
}
</script>
