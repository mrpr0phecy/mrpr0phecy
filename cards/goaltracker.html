<!-- cards/goal-tracker.html -->

<h2 id="goal-tracker-title">Goal Tracker ğŸ¯</h2>

<form aria-describedby="goal-tracker-desc">
  <p id="goal-tracker-desc" class="small">Set, track, and achieve your goals with progress monitoring, milestones, and motivational reminders.</p>

  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
    <div>
      <label for="gt-goal" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Goal Title</label>
      <input id="gt-goal" type="text" placeholder="e.g. Learn Spanish, Save Â£5000" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gt-category" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Category</label>
      <select id="gt-category" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="fitness">ğŸ’ª Fitness</option>
        <option value="learning">ğŸ“š Learning</option>
        <option value="financial">ğŸ’° Financial</option>
        <option value="career">ğŸ’¼ Career</option>
        <option value="personal">ğŸŒŸ Personal</option>
        <option value="health">ğŸŒ¿ Health</option>
        <option value="creative">ğŸ¨ Creative</option>
        <option value="social">ğŸ‘¥ Social</option>
      </select>
    </div>
    
    <div>
      <label for="gt-target-date" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Target Date</label>
      <input id="gt-target-date" type="date" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gt-priority" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Priority</label>
      <select id="gt-priority" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="low">ğŸ”µ Low</option>
        <option value="medium" selected>ğŸŸ¡ Medium</option>
        <option value="high">ğŸ”´ High</option>
        <option value="urgent">âš¡ Urgent</option>
      </select>
    </div>
  </div>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
    <div>
      <label for="gt-current" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Current Progress</label>
      <input id="gt-current" type="number" min="0" placeholder="0" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div>
      <label for="gt-target" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Target Value</label>
      <input id="gt-target" type="number" min="1" placeholder="100" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
  </div>

  <div style="margin-bottom:16px;">
    <label for="gt-notes" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Notes / Milestones</label>
    <textarea id="gt-notes" rows="3" placeholder="Add specific milestones, steps, or motivation..." 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;resize:vertical;"></textarea>
  </div>

  <div style="margin-top:20px;display:flex;gap:10px;">
    <button type="button" onclick="gtAddGoal(this)" 
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      ğŸ¯ Add Goal
    </button>
    <button type="button" onclick="gtReset(this)"
            style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
      Reset Form
    </button>
    <button type="button" onclick="gtQuickTemplate(this)"
            style="padding:12px 16px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);border-radius:8px;color:#9d4edd;cursor:pointer;">
      Quick Template
    </button>
  </div>
</form>

<div aria-live="polite" style="margin-top:20px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:8px;">Active Goals <span id="gt-stats" style="color:rgba(230,250,255,0.7);font-size:12px;font-weight:normal;"></span></h3>
  <div id="gt-goals-list" style="max-height:400px;overflow-y:auto;padding-right:8px;">
    <!-- Goals will appear here -->
    <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
      No goals set yet. Add your first goal above!
    </div>
  </div>
</div>

<div style="margin-top:20px;padding:16px;background:rgba(45,212,255,0.05);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
    <h4 style="color:var(--accent);margin-top:0;margin-bottom:0;">ğŸ“Š Progress Dashboard</h4>
    <button onclick="gtToggleCompleted()" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;font-size:12px;">
      Show Completed
    </button>
  </div>
  
  <div id="gt-dashboard" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:12px;">
    <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;text-align:center;">
      <div style="color:var(--accent);font-size:24px;font-weight:600;" id="gt-total-goals">0</div>
      <div style="color:rgba(230,250,255,0.7);font-size:12px;">Total Goals</div>
    </div>
    <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;text-align:center;">
      <div style="color:#39ff14;font-size:24px;font-weight:600;" id="gt-completed-goals">0</div>
      <div style="color:rgba(230,250,255,0.7);font-size:12px;">Completed</div>
    </div>
    <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;text-align:center;">
      <div style="color:#ffcc00;font-size:24px;font-weight:600;" id="gt-in-progress">0</div>
      <div style="color:rgba(230,250,255,0.7);font-size:12px;">In Progress</div>
    </div>
    <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;text-align:center;">
      <div style="color:#ff6b9d;font-size:24px;font-weight:600;" id="gt-avg-progress">0%</div>
      <div style="color:rgba(230,250,255,0.7);font-size:12px;">Avg Progress</div>
    </div>
  </div>
</div>

<div id="gt-motivation" style="margin-top:16px;padding:12px 16px;background:rgba(57,255,20,0.1);border-radius:8px;border:1px solid rgba(57,255,20,0.3);display:none;">
  <div style="color:#39ff14;font-weight:600;margin-bottom:4px;">ğŸŒŸ Motivation:</div>
  <div id="gt-motivation-text" style="font-size:14px;color:rgba(230,250,255,0.9);"></div>
</div>

<script>
/* goal-tracker.html
   - Goal tracking and progress monitoring tool
   - Scoped with gt- prefix
*/

// Category configurations
const goalCategories = {
  'fitness': { 
    emoji: 'ğŸ’ª', 
    color: '#2dd4ff',
    unit: 'workouts/kg/miles'
  },
  'learning': { 
    emoji: 'ğŸ“š', 
    color: '#9d4edd',
    unit: 'hours/chapters/courses'
  },
  'financial': { 
    emoji: 'ğŸ’°', 
    color: '#39ff14',
    unit: 'Â£/$/â‚¬'
  },
  'career': { 
    emoji: 'ğŸ’¼', 
    color: '#ffcc00',
    unit: 'projects/skills'
  },
  'personal': { 
    emoji: 'ğŸŒŸ', 
    color: '#ff6b9d',
    unit: 'days/habits'
  },
  'health': { 
    emoji: 'ğŸŒ¿', 
    color: '#00ff99',
    unit: 'days/measurements'
  },
  'creative': { 
    emoji: 'ğŸ¨', 
    color: '#ff9500',
    unit: 'pieces/projects'
  },
  'social': { 
    emoji: 'ğŸ‘¥', 
    color: '#8e44ad',
    unit: 'events/connections'
  }
};

// Priority configurations
const goalPriorities = {
  'low': { emoji: 'ğŸ”µ', color: '#2dd4ff', label: 'Low' },
  'medium': { emoji: 'ğŸŸ¡', color: '#ffcc00', label: 'Medium' },
  'high': { emoji: 'ğŸ”´', color: '#ff6b9d', label: 'High' },
  'urgent': { emoji: 'âš¡', color: '#ff2d55', label: 'Urgent' }
};

// Quick templates for common goals
const goalTemplates = {
  'fitness': {
    goal: 'Lose 10kg',
    current: '0',
    target: '10',
    notes: 'Weekly: Gym 3x, 10k steps daily\nMonthly: -2.5kg target\nTrack: Weight, measurements, progress photos'
  },
  'learning': {
    goal: 'Complete Online Course',
    current: '0',
    target: '100',
    notes: 'Study 1 hour daily\nComplete all assignments\nBuild final project\nGet certification'
  },
  'financial': {
    goal: 'Save Â£5000',
    current: '0',
    target: '5000',
    notes: 'Monthly: Save Â£416\nCut: Dining out, subscriptions\nTrack: Budget weekly\nReward: Small treat at milestones'
  },
  'career': {
    goal: 'Learn New Skill',
    current: '0',
    target: '100',
    notes: 'Daily practice\nBuild portfolio\nNetwork online\nAttend 2 industry events'
  }
};

// Motivational messages
const motivationMessages = [
  "ğŸ¯ The journey of a thousand miles begins with a single step. Keep going!",
  "ğŸŒŸ Progress is progress, no matter how small. Celebrate every achievement!",
  "ğŸ’ª Consistency beats intensity. Showing up every day is what creates real change.",
  "ğŸ“Š You're closer than you were yesterday. Look how far you've come!",
  "ğŸ”¥ Small steps, big dreams. Each day you're building your future self.",
  "âœ¨ Don't watch the clock; do what it does. Keep moving forward!",
  "ğŸš€ The only limit is the one you set for yourself. You've got this!",
  "ğŸŒˆ Every expert was once a beginner. Keep learning and growing!",
  "âš¡ Your future self is thanking you for the work you're doing today.",
  "ğŸ–ï¸ Discipline is choosing between what you want now and what you want most."
];

let goals = [];
const STORAGE_KEY = 'goal-tracker-goals';
let showCompleted = false;

// Load saved goals
function gtLoad() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      goals = JSON.parse(saved);
      gtRender();
      gtUpdateStats();
    }
  } catch (e) {
    console.error('Failed to load goals:', e);
  }
}

// Save goals
function gtSave() {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(goals));
  } catch (e) {
    console.error('Failed to save goals:', e);
  }
}

function gtAddGoal(btn) {
  const card = btn.closest('.card') || document;
  const title = card.querySelector('#gt-goal').value.trim();
  const category = card.querySelector('#gt-category').value;
  const targetDate = card.querySelector('#gt-target-date').value;
  const priority = card.querySelector('#gt-priority').value;
  const current = parseFloat(card.querySelector('#gt-current').value) || 0;
  const target = parseFloat(card.querySelector('#gt-target').value) || 1;
  const notes = card.querySelector('#gt-notes').value.trim();

  if (!title) {
    gtShowMessage(card, 'Please enter a goal title', '#ff4d4d');
    return;
  }

  if (target <= 0) {
    gtShowMessage(card, 'Target must be greater than 0', '#ff4d4d');
    return;
  }

  const goalId = Date.now();
  const progress = Math.min(100, Math.max(0, (current / target) * 100));
  const status = progress >= 100 ? 'completed' : 'active';
  
  goals.push({ 
    id: goalId,
    title, 
    category,
    targetDate,
    priority,
    current,
    target,
    notes,
    progress,
    status,
    created: new Date().toISOString(),
    lastUpdated: new Date().toISOString()
  });
  
  gtRender();
  gtSave();
  gtUpdateStats();
  
  // Reset form
  card.querySelector('#gt-goal').value = '';
  card.querySelector('#gt-current').value = '';
  card.querySelector('#gt-target').value = '';
  card.querySelector('#gt-notes').value = '';
  card.querySelector('#gt-goal').focus();
  
  gtShowMessage(card, `âœ… Goal "${title}" added!`, '#39ff14');
  gtShowMotivation();
}

function gtRender() {
  const card = document.currentScript?.closest('.card') || document;
  const list = card.querySelector('#gt-goals-list');
  
  const activeGoals = goals.filter(g => showCompleted || g.status !== 'completed');
  
  if (activeGoals.length === 0) {
    const message = showCompleted && goals.length === 0 
      ? 'No goals yet. Add your first goal above!' 
      : showCompleted 
        ? 'No completed goals yet' 
        : 'No active goals. Add your first goal above!';
    
    list.innerHTML = `
      <div style="padding:30px;text-align:center;color:rgba(230,250,255,0.5);font-style:italic;">
        ${message}
      </div>
    `;
    return;
  }
  
  let html = '';
  activeGoals.forEach(goal => {
    const category = goalCategories[goal.category] || goalCategories['personal'];
    const priority = goalPriorities[goal.priority] || goalPriorities['medium'];
    const daysLeft = goal.targetDate ? gtCalculateDaysLeft(goal.targetDate) : null;
    const progressPercent = Math.min(100, Math.max(0, goal.progress));
    
    html += `
      <div class="goal-item" data-id="${goal.id}" 
           style="background:rgba(255,255,255,0.03);border-left:3px solid ${category.color};margin-bottom:12px;padding:12px;border-radius:8px;">
        <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;">
          <div style="flex:1;">
            <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
              <span style="font-size:18px;">${category.emoji}</span>
              <div style="font-weight:600;color:var(--accent);font-size:16px;">${goal.title}</div>
              <span style="color:${priority.color};background:${priority.color}20;padding:2px 8px;border-radius:12px;font-size:11px;">
                ${priority.emoji} ${priority.label}
              </span>
              ${goal.status === 'completed' ? `
                <span style="color:#39ff14;background:rgba(57,255,20,0.1);padding:2px 8px;border-radius:12px;font-size:11px;">
                  âœ“ Completed
                </span>
              ` : ''}
            </div>
            <div style="display:flex;gap:12px;margin-top:4px;font-size:13px;">
              <span style="color:rgba(230,250,255,0.8);">Progress: ${goal.current}/${goal.target} ${category.unit || ''}</span>
              ${goal.targetDate ? `
                <span style="color:rgba(230,250,255,0.8);">
                  ${daysLeft > 0 ? `Due in ${daysLeft} days` : daysLeft === 0 ? 'Due today!' : `Overdue by ${-daysLeft} days`}
                </span>
              ` : ''}
              <span style="color:rgba(230,250,255,0.6);">Created: ${new Date(goal.created).toLocaleDateString()}</span>
            </div>
          </div>
          <div style="display:flex;gap:4px;">
            <button onclick="gtUpdateProgress('${goal.id}')" style="background:transparent;border:none;color:var(--accent);cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">ğŸ“ˆ Update</button>
            <button onclick="gtEditGoal('${goal.id}')" style="background:transparent;border:none;color:#ffcc00;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">âœï¸ Edit</button>
            <button onclick="gtDeleteGoal('${goal.id}')" style="background:transparent;border:none;color:#ff4d4d;cursor:pointer;padding:4px 8px;border-radius:4px;font-size:12px;">ğŸ—‘ï¸ Delete</button>
          </div>
        </div>
        
        <!-- Progress Bar -->
        <div style="margin-bottom:10px;">
          <div style="display:flex;justify-content:space-between;margin-bottom:4px;font-size:12px;">
            <span style="color:${category.color};">${progressPercent.toFixed(1)}%</span>
            <span style="color:rgba(230,250,255,0.7);">${goal.status === 'completed' ? 'ğŸ‰ Goal Achieved!' : 'In Progress'}</span>
          </div>
          <div style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;">
            <div style="height:100%;width:${progressPercent}%;background:linear-gradient(90deg, ${category.color}, ${priority.color});border-radius:4px;transition:width 0.3s;"></div>
          </div>
        </div>
        
        <!-- Notes -->
        ${goal.notes ? `
          <div style="margin-top:10px;padding:8px 12px;background:rgba(255,255,255,0.05);border-radius:6px;">
            <div style="color:rgba(230,250,255,0.8);font-size:12px;">ğŸ“ ${goal.notes}</div>
          </div>
        ` : ''}
      </div>
    `;
  });
  
  list.innerHTML = html;
}

function gtUpdateStats() {
  const totalGoals = goals.length;
  const completedGoals = goals.filter(g => g.status === 'completed').length;
  const inProgressGoals = goals.filter(g => g.status === 'active').length;
  
  // Calculate average progress (excluding completed goals)
  const activeGoals = goals.filter(g => g.status === 'active');
  const avgProgress = activeGoals.length > 0 
    ? Math.round(activeGoals.reduce((sum, g) => sum + g.progress, 0) / activeGoals.length) 
    : 0;
  
  // Update stats display
  document.getElementById('gt-total-goals').textContent = totalGoals;
  document.getElementById('gt-completed-goals').textContent = completedGoals;
  document.getElementById('gt-in-progress').textContent = inProgressGoals;
  document.getElementById('gt-avg-progress').textContent = `${avgProgress}%`;
  
  // Update stats in header
  const statsEl = document.getElementById('gt-stats');
  if (statsEl) {
    statsEl.textContent = `(${inProgressGoals} active, ${completedGoals} completed)`;
  }
}

function gtUpdateProgress(goalId) {
  const goal = goals.find(g => g.id == goalId);
  if (!goal) return;
  
  const newProgress = prompt(`Update progress for "${goal.title}":\nCurrent: ${goal.current}/${goal.target}\nEnter new current value:`, goal.current);
  
  if (newProgress === null) return;
  
  const newCurrent = parseFloat(newProgress);
  if (isNaN(newCurrent)) {
    gtShowMessage(null, 'Please enter a valid number', '#ff4d4d');
    return;
  }
  
  goal.current = newCurrent;
  goal.progress = Math.min(100, (newCurrent / goal.target) * 100);
  goal.status = goal.progress >= 100 ? 'completed' : 'active';
  goal.lastUpdated = new Date().toISOString();
  
  gtRender();
  gtSave();
  gtUpdateStats();
  gtShowMotivation();
  
  const card = document.currentScript?.closest('.card') || document;
  gtShowMessage(card, `âœ… Progress updated to ${newCurrent}/${goal.target}`, '#39ff14');
}

function gtEditGoal(goalId) {
  const goal = goals.find(g => g.id == goalId);
  if (!goal) return;
  
  const card = document.currentScript?.closest('.card') || document;
  card.querySelector('#gt-goal').value = goal.title;
  card.querySelector('#gt-category').value = goal.category;
  card.querySelector('#gt-target-date').value = goal.targetDate;
  card.querySelector('#gt-priority').value = goal.priority;
  card.querySelector('#gt-current').value = goal.current;
  card.querySelector('#gt-target').value = goal.target;
  card.querySelector('#gt-notes').value = goal.notes;
  
  // Change button to update
  const addBtn = card.querySelector('button[onclick="gtAddGoal(this)"]');
  addBtn.textContent = 'ğŸ’¾ Update Goal';
  addBtn.setAttribute('onclick', `gtSaveGoal('${goalId}')`);
  
  card.querySelector('#gt-goal').focus();
}

function gtSaveGoal(goalId) {
  const card = document.currentScript?.closest('.card') || document;
  const title = card.querySelector('#gt-goal').value.trim();
  const category = card.querySelector('#gt-category').value;
  const targetDate = card.querySelector('#gt-target-date').value;
  const priority = card.querySelector('#gt-priority').value;
  const current = parseFloat(card.querySelector('#gt-current').value) || 0;
  const target = parseFloat(card.querySelector('#gt-target').value) || 1;
  const notes = card.querySelector('#gt-notes').value.trim();
  
  const goalIndex = goals.findIndex(g => g.id == goalId);
  if (goalIndex === -1) return;
  
  const progress = Math.min(100, Math.max(0, (current / target) * 100));
  const status = progress >= 100 ? 'completed' : 'active';
  
  goals[goalIndex] = {
    ...goals[goalIndex],
    title,
    category,
    targetDate,
    priority,
    current,
    target,
    notes,
    progress,
    status,
    lastUpdated: new Date().toISOString()
  };
  
  gtRender();
  gtSave();
  gtUpdateStats();
  
  // Reset button and form
  const addBtn = card.querySelector('button[onclick^="gtSaveGoal"]');
  addBtn.textContent = 'ğŸ¯ Add Goal';
  addBtn.setAttribute('onclick', 'gtAddGoal(this)');
  
  card.querySelector('#gt-goal').value = '';
  card.querySelector('#gt-current').value = '';
  card.querySelector('#gt-target').value = '';
  card.querySelector('#gt-notes').value = '';
  
  gtShowMessage(card, `âœ… Goal "${title}" updated!`, '#39ff14');
}

function gtDeleteGoal(goalId) {
  if (!confirm('Are you sure you want to delete this goal?')) return;
  
  goals = goals.filter(g => g.id != goalId);
  gtRender();
  gtSave();
  gtUpdateStats();
  
  const card = document.currentScript?.closest('.card') || document;
  gtShowMessage(card, 'âœ… Goal deleted', '#39ff14');
}

function gtReset(btn) {
  const card = btn.closest('.card') || document;
  card.querySelector('#gt-goal').value = '';
  card.querySelector('#gt-category').value = 'fitness';
  card.querySelector('#gt-target-date').value = '';
  card.querySelector('#gt-priority').value = 'medium';
  card.querySelector('#gt-current').value = '';
  card.querySelector('#gt-target').value = '';
  card.querySelector('#gt-notes').value = '';
  
  // Make sure button is in add mode
  const addBtn = card.querySelector('button[onclick^="gtAddGoal"], button[onclick^="gtSaveGoal"]');
  if (addBtn) {
    addBtn.textContent = 'ğŸ¯ Add Goal';
    addBtn.setAttribute('onclick', 'gtAddGoal(this)');
  }
  
  card.querySelector('#gt-goal').focus();
}

function gtQuickTemplate(btn) {
  const card = btn.closest('.card') || document;
  const category = card.querySelector('#gt-category').value;
  const template = goalTemplates[category];
  
  if (template) {
    card.querySelector('#gt-goal').value = template.goal;
    card.querySelector('#gt-current').value = template.current;
    card.querySelector('#gt-target').value = template.target;
    card.querySelector('#gt-notes').value = template.notes;
    
    // Set target date to 3 months from now
    const futureDate = new Date();
    futureDate.setMonth(futureDate.getMonth() + 3);
    card.querySelector('#gt-target-date').value = futureDate.toISOString().split('T')[0];
    
    gtShowMessage(card, `âœ… Loaded ${category} template`, '#9d4edd');
  } else {
    gtShowMessage(card, 'No template available for this category', '#ff4d4d');
  }
}

function gtToggleCompleted() {
  showCompleted = !showCompleted;
  const btn = document.querySelector('button[onclick="gtToggleCompleted()"]');
  btn.textContent = showCompleted ? 'Hide Completed' : 'Show Completed';
  gtRender();
}

function gtCalculateDaysLeft(targetDate) {
  const today = new Date();
  const target = new Date(targetDate);
  const diffTime = target - today;
  return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
}

function gtShowMotivation() {
  // Only show motivation if there are active goals
  const activeGoals = goals.filter(g => g.status === 'active');
  if (activeGoals.length === 0) return;
  
  const motivationEl = document.getElementById('gt-motivation');
  const textEl = document.getElementById('gt-motivation-text');
  
  if (motivationEl && textEl) {
    const randomMessage = motivationMessages[Math.floor(Math.random() * motivationMessages.length)];
    textEl.textContent = randomMessage;
    motivationEl.style.display = 'block';
    
    // Hide after 10 seconds
    setTimeout(() => {
      motivationEl.style.display = 'none';
    }, 10000);
  }
}

function gtShowMessage(card, message, color = '#2dd4ff') {
  // Create a temporary message div
  const messageDiv = document.createElement('div');
  messageDiv.textContent = message;
  messageDiv.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(20,20,20,0.95);
    color: ${color};
    padding: 12px 16px;
    border-radius: 8px;
    border: 1px solid ${color}40;
    z-index: 10000;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  `;
  
  document.body.appendChild(messageDiv);
  
  setTimeout(() => {
    messageDiv.style.opacity = '0';
    messageDiv.style.transform = 'translateX(20px)';
    setTimeout(() => {
      if (messageDiv.parentNode) {
        document.body.removeChild(messageDiv);
      }
    }, 300);
  }, 2000);
}

// Load saved goals on startup
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
      gtLoad();
      gtShowMotivation();
    }, 100);
  });
} else {
  setTimeout(() => {
    gtLoad();
    gtShowMotivation();
  }, 100);
}
</script>

<style>
#goal-tracker-title {
  color: var(--accent);
  margin-top: 0;
  border-bottom: 1px solid rgba(45,212,255,0.2);
  padding-bottom: 10px;
  margin-bottom: 16px;
}

.goal-item {
  transition: all 0.2s ease;
}

.goal-item:hover {
  background: rgba(45,212,255,0.05) !important;
  transform: translateX(2px);
}

#gt-goals-list::-webkit-scrollbar {
  width: 6px;
}

#gt-goals-list::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#gt-goals-list::-webkit-scrollbar-thumb {
  background: rgba(45,212,255,0.3);
  border-radius: 3px;
}

@media (max-width: 768px) {
  div[style*="grid-template-columns:repeat(auto-fit"] {
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }
  
  div[style*="grid-template-columns:1fr 1fr"] {
    grid-template-columns: 1fr !important;
  }
  
  .actions {
    flex-direction: column !important;
  }
  
  .actions button {
    width: 100% !important;
    margin-bottom: 8px;
  }
  
  .goal-item > div:first-child {
    flex-direction: column !important;
    gap: 8px;
  }
  
  .goal-item > div:first-child > div:last-child {
    align-self: flex-end;
  }
  
  #gt-dashboard {
    grid-template-columns: 1fr 1fr !important;
  }
}
</style>
