<h2 id="credit-card-payoff-title" style="margin-top:0;color:var(--accent);position:relative;">
  ğŸ’³ Credit Card Payoff Calculator
  <span style="position:absolute;right:0;top:0;font-size:0.7rem;color:var(--accent);font-weight:normal;">
    Financial Tool
  </span>
</h2>

<form aria-describedby="credit-card-payoff-desc">
  <p id="credit-card-payoff-desc" class="small" style="margin-bottom:20px;color:rgba(230,250,255,0.9);">
    Calculate how long it will take to pay off your credit card and save money with different payoff strategies.
  </p>

  <!-- Main Inputs with Visual Indicators -->
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:20px;">
    <div class="field" style="position:relative;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <label for="cc-balance" style="color:var(--accent);font-weight:500;">ğŸ¦ Current Balance</label>
        <span id="cc-balance-slider-val" style="font-size:0.9rem;color:#39ff14;">$3,000</span>
      </div>
      <input id="cc-balance" type="range" min="100" max="50000" step="100" value="3000" 
             style="width:100%;margin-bottom:8px;accent-color:var(--accent);" />
      <input id="cc-balance-input" type="number" min="100" max="100000" value="3000" 
             style="width:100%;padding:12px;border-radius:8px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:1rem;" />
      <div class="small" style="margin-top:4px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
        <span>$100</span>
        <span>$50,000</span>
      </div>
    </div>

    <div class="field" style="position:relative;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <label for="cc-rate" style="color:var(--accent);font-weight:500;">ğŸ“ˆ Interest Rate (APR)</label>
        <span id="cc-rate-slider-val" style="font-size:0.9rem;color:#ffcc00;">18%</span>
      </div>
      <input id="cc-rate" type="range" min="0" max="40" step="0.5" value="18" 
             style="width:100%;margin-bottom:8px;accent-color:#ffcc00;" />
      <input id="cc-rate-input" type="number" min="0" max="50" step="0.1" value="18" 
             style="width:100%;padding:12px;border-radius:8px;border:2px solid rgba(255,204,0,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:1rem;" />
      <div class="small" style="margin-top:4px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
        <span>0%</span>
        <span>40%</span>
      </div>
    </div>

    <div class="field" style="position:relative;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <label for="cc-payment" style="color:var(--accent);font-weight:500;">ğŸ’° Monthly Payment</label>
        <span id="cc-payment-slider-val" style="font-size:0.9rem;color:#39ff14;">$150</span>
      </div>
      <input id="cc-payment" type="range" min="10" max="2000" step="10" value="150" 
             style="width:100%;margin-bottom:8px;accent-color:#39ff14;" />
      <input id="cc-payment-input" type="number" min="10" max="5000" step="10" value="150" 
             style="width:100%;padding:12px;border-radius:8px;border:2px solid rgba(57,255,20,0.3);background:rgba(20,20,20,0.8);color:inherit;font-size:1rem;" />
      <div class="small" style="margin-top:4px;color:rgba(230,250,255,0.7);display:flex;justify-content:space-between;">
        <span>$10</span>
        <span>$2,000</span>
      </div>
    </div>
  </div>

  <!-- Strategy Selector -->
  <div style="margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <label style="color:var(--accent);font-weight:500;">ğŸ¯ Payoff Strategy</label>
      <span id="cc-strategy-indicator" style="font-size:0.85rem;color:#9d4edd;font-weight:500;">Standard Payoff</span>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:8px;">
      <button type="button" onclick="ccSetStrategy('standard')" 
              style="padding:10px;border-radius:8px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8));border:2px solid var(--accent);color:var(--accent);cursor:pointer;font-weight:500;">
        ğŸ’³ Standard
      </button>
      <button type="button" onclick="ccSetStrategy('snowball')"
              style="padding:10px;border-radius:8px;background:rgba(20,20,20,0.8);border:2px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;">
        â„ï¸ Snowball
      </button>
      <button type="button" onclick="ccSetStrategy('avalanche')"
              style="padding:10px;border-radius:8px;background:rgba(20,20,20,0.8);border:2px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;">
        ğŸ”ï¸ Avalanche
      </button>
      <button type="button" onclick="ccSetStrategy('extra')"
              style="padding:10px;border-radius:8px;background:rgba(20,20,20,0.8);border:2px solid rgba(255,255,255,0.1);color:inherit;cursor:pointer;">
        âš¡ Extra Payment
      </button>
    </div>
  </div>

  <!-- Extra Payment Controls (Hidden by Default) -->
  <div id="cc-extra-payment-section" style="display:none;margin-bottom:20px;padding:16px;background:rgba(20,20,20,0.8);border-radius:8px;border:2px solid rgba(45,212,255,0.2);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <span style="color:var(--accent);font-weight:500;">ğŸ’ Extra Payment Strategy</span>
      <button onclick="ccApplyExtraPayment()" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:2px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;">
        Apply
      </button>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));gap:12px;">
      <div>
        <label for="cc-extra-amount" style="display:block;margin-bottom:6px;color:rgba(230,250,255,0.8);font-size:0.9rem;">Extra Amount</label>
        <input id="cc-extra-amount" type="number" min="0" value="50" 
               style="width:100%;padding:8px;border-radius:6px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;" />
      </div>
      <div>
        <label for="cc-extra-start" style="display:block;margin-bottom:6px;color:rgba(230,250,255,0.8);font-size:0.9rem;">Start Month</label>
        <input id="cc-extra-start" type="number" min="1" value="1" 
               style="width:100%;padding:8px;border-radius:6px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;" />
      </div>
      <div>
        <label for="cc-extra-months" style="display:block;margin-bottom:6px;color:rgba(230,250,255,0.8);font-size:0.9rem;">For Months</label>
        <input id="cc-extra-months" type="number" min="1" value="12" 
               style="width:100%;padding:8px;border-radius:6px;border:2px solid rgba(45,212,255,0.3);background:rgba(20,20,20,0.8);color:inherit;" />
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));gap:10px;margin-top:20px;">
    <button type="button" onclick="ccCalculate()" id="cc-calculate-btn"
            style="padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8));border:2px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;transition:all 0.2s;">
      ğŸ§® Calculate
    </button>
    <button type="button" onclick="ccOptimizePayment()" id="cc-optimize-btn"
            style="padding:14px;background:rgba(57,255,20,0.1);border:2px solid rgba(57,255,20,0.3);color:#39ff14;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ’¡ Optimize
    </button>
    <button type="button" onclick="ccReset()" id="cc-reset-btn"
            style="padding:14px;background:rgba(255,77,77,0.1);border:2px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;transition:all 0.2s;">
      ğŸ”„ Reset
    </button>
  </div>
</form>

<!-- Results Display -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <!-- Primary Results Card -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.07), rgba(20,20,20,0.9));border-radius:8px;padding:20px;border:2px solid rgba(45,212,255,0.2);margin-bottom:16px;box-shadow:0 8px 32px rgba(0,0,0,0.4);">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“Š Payoff Summary</h3>
      <button onclick="ccCopyResults()" style="padding:6px 12px;background:rgba(45,212,255,0.1);border:2px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:0.9rem;">
        ğŸ“‹ Copy
      </button>
    </div>
    
    <!-- Key Metrics -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:16px;margin-bottom:20px;">
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">â±ï¸ Time to Payoff</div>
        <div id="cc-months" style="font-size:1.8rem;font-weight:700;color:#39ff14;">â€“</div>
        <div id="cc-years" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;"></div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’° Total Interest</div>
        <div id="cc-total-interest" style="font-size:1.8rem;font-weight:700;color:#ff2d55;">â€“</div>
        <div id="cc-interest-percent" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;"></div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ¦ Total Payment</div>
        <div id="cc-total-payment" style="font-size:1.8rem;font-weight:700;color:#ffcc00;">â€“</div>
        <div id="cc-total-savings" style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;"></div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(0,0,0,0.4);border-radius:8px;border:1px solid rgba(45,212,255,0.1);">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">ğŸ’¸ Interest Saved</div>
        <div id="cc-interest-saved" style="font-size:1.4rem;font-weight:700;color:#9d4edd;">â€“</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">vs Minimum Payment</div>
      </div>
    </div>
    
    <!-- Progress Visualization -->
    <div style="margin-bottom:20px;">
      <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
        <span style="color:var(--accent);font-weight:500;">ğŸ“ˆ Payoff Progress</span>
        <span id="cc-progress-text" style="font-size:0.9rem;color:rgba(230,250,255,0.7);">No data</span>
      </div>
      <div style="height:12px;background:rgba(255,255,255,0.1);border-radius:6px;overflow:hidden;margin-bottom:8px;">
        <div id="cc-progress-bar" style="height:100%;background:linear-gradient(90deg, #2dd4ff, #39ff14);width:0%;transition:width 1s ease;"></div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:0.8rem;color:rgba(230,250,255,0.6);">
        <span>Month 0</span>
        <span id="cc-progress-end">Month 0</span>
      </div>
    </div>
    
    <!-- Detailed Breakdown -->
    <div id="cc-details" style="color:rgba(230,250,255,0.9);font-size:0.95rem;line-height:1.5;padding:12px;background:rgba(0,0,0,0.3);border-radius:6px;border:1px solid rgba(45,212,255,0.1);">
      Enter your credit card details to see payoff calculations.
    </div>
  </div>

  <!-- Financial Tips -->
  <div style="background:rgba(20,20,20,0.9);border-radius:8px;padding:20px;border:2px solid rgba(45,212,255,0.2);box-shadow:0 4px 20px rgba(0,0,0,0.3);">
    <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;font-size:1.1rem;">ğŸ’¡ Financial Tips</h3>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:16px;">
      <div style="padding:12px;background:rgba(45,212,255,0.05);border-radius:6px;border:1px solid rgba(45,212,255,0.1);">
        <div style="color:#39ff14;font-weight:600;margin-bottom:4px;">ğŸ¯ Pay More Than Minimum</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Even $20 extra per month can save thousands in interest</div>
      </div>
      <div style="padding:12px;background:rgba(255,204,0,0.05);border-radius:6px;border:1px solid rgba(255,204,0,0.1);">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:4px;">âš¡ Consider Balance Transfer</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">0% APR cards can help pay down principal faster</div>
      </div>
      <div style="padding:12px;background:rgba(157,78,221,0.05);border-radius:6px;border:1px solid rgba(157,78,221,0.1);">
        <div style="color:#9d4edd;font-weight:600;margin-bottom:4px;">âš ï¸ Avoid New Purchases</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.9);">Stop using the card while paying it off</div>
      </div>
    </div>
    
    <!-- Warning Message -->
    <div style="padding:12px;background:rgba(60,0,0,0.6);border-radius:6px;border:2px solid rgba(255,77,77,0.3);">
      <div style="color:#ff6b6b;font-weight:600;margin-bottom:4px;">âš ï¸ Important Disclaimer</div>
      <div style="font-size:0.9rem;color:rgba(255,200,200,0.9);">
        This calculator provides estimates only. For personalized financial advice, consult with a certified financial advisor. 
        Actual results may vary based on your specific credit card terms and conditions.
      </div>
    </div>
  </div>
</div>

<script>
/* credit-card-payoff.html
   - Fully functional credit card payoff calculator
   - Scoped with cc- prefix
   - Accurate compound interest calculations
*/

// Global configuration
let ccCurrentStrategy = 'standard';
let ccExtraPayment = { amount: 50, start: 1, months: 12 };
let ccCalculationCache = {};

// Initialize the calculator
function ccInit() {
    // Set up input synchronization
    ccSyncInputs();
    
    // Set default strategy
    ccSetStrategy('standard');
    
    // Auto-calculate when inputs change
    ['#cc-balance-input', '#cc-rate-input', '#cc-payment-input'].forEach(selector => {
        const input = document.querySelector(selector);
        if (input) {
            input.addEventListener('input', () => {
                setTimeout(() => ccCalculate(), 500);
            });
        }
    });
    
    // Initial calculation
    setTimeout(() => ccCalculate(), 300);
}

// Synchronize sliders with number inputs
function ccSyncInputs() {
    // Balance sync
    const balanceSlider = document.querySelector('#cc-balance');
    const balanceInput = document.querySelector('#cc-balance-input');
    const balanceDisplay = document.querySelector('#cc-balance-slider-val');
    
    if (balanceSlider && balanceInput && balanceDisplay) {
        balanceSlider.addEventListener('input', function() {
            const value = parseInt(this.value);
            balanceInput.value = value;
            balanceDisplay.textContent = '$' + value.toLocaleString();
        });
        
        balanceInput.addEventListener('input', function() {
            const value = Math.min(100000, Math.max(100, parseInt(this.value) || 100));
            balanceSlider.value = value;
            balanceDisplay.textContent = '$' + value.toLocaleString();
        });
        
        // Initialize display
        balanceDisplay.textContent = '$' + balanceInput.value.toLocaleString();
    }
    
    // Rate sync
    const rateSlider = document.querySelector('#cc-rate');
    const rateInput = document.querySelector('#cc-rate-input');
    const rateDisplay = document.querySelector('#cc-rate-slider-val');
    
    if (rateSlider && rateInput && rateDisplay) {
        rateSlider.addEventListener('input', function() {
            const value = parseFloat(this.value);
            rateInput.value = value;
            rateDisplay.textContent = value + '%';
        });
        
        rateInput.addEventListener('input', function() {
            const value = Math.min(50, Math.max(0, parseFloat(this.value) || 0));
            rateSlider.value = value;
            rateDisplay.textContent = value + '%';
        });
        
        // Initialize display
        rateDisplay.textContent = rateInput.value + '%';
    }
    
    // Payment sync
    const paymentSlider = document.querySelector('#cc-payment');
    const paymentInput = document.querySelector('#cc-payment-input');
    const paymentDisplay = document.querySelector('#cc-payment-slider-val');
    
    if (paymentSlider && paymentInput && paymentDisplay) {
        paymentSlider.addEventListener('input', function() {
            const value = parseInt(this.value);
            paymentInput.value = value;
            paymentDisplay.textContent = '$' + value.toLocaleString();
        });
        
        paymentInput.addEventListener('input', function() {
            const value = Math.min(5000, Math.max(10, parseInt(this.value) || 10));
            paymentSlider.value = value;
            paymentDisplay.textContent = '$' + value.toLocaleString();
        });
        
        // Initialize display
        paymentDisplay.textContent = '$' + paymentInput.value.toLocaleString();
    }
}

// Set payoff strategy
function ccSetStrategy(strategy) {
    ccCurrentStrategy = strategy;
    
    // Update strategy buttons
    document.querySelectorAll('[onclick*="ccSetStrategy"]').forEach(btn => {
        btn.style.background = 'rgba(20,20,20,0.8)';
        btn.style.border = '2px solid rgba(255,255,255,0.1)';
        btn.style.color = 'inherit';
    });
    
    const activeBtn = document.querySelector(`[onclick="ccSetStrategy('${strategy}')"]`);
    if (activeBtn) {
        activeBtn.style.background = 'linear-gradient(135deg, rgba(45,212,255,0.2), rgba(20,20,20,0.8))';
        activeBtn.style.border = '2px solid var(--accent)';
        activeBtn.style.color = 'var(--accent)';
    }
    
    // Update strategy indicator
    const strategyNames = {
        'standard': 'Standard Payoff',
        'snowball': 'Snowball Method', 
        'avalanche': 'Avalanche Method',
        'extra': 'Extra Payment'
    };
    
    const indicator = document.querySelector('#cc-strategy-indicator');
    if (indicator) {
        indicator.textContent = strategyNames[strategy] || 'Custom Strategy';
    }
    
    // Show/hide extra payment section
    const extraSection = document.querySelector('#cc-extra-payment-section');
    if (extraSection) {
        extraSection.style.display = strategy === 'extra' ? 'block' : 'none';
    }
    
    // Auto-calculate
    setTimeout(() => ccCalculate(), 100);
}

// Apply extra payment configuration
function ccApplyExtraPayment() {
    const extraAmountInput = document.querySelector('#cc-extra-amount');
    const extraStartInput = document.querySelector('#cc-extra-start');
    const extraMonthsInput = document.querySelector('#cc-extra-months');
    
    if (extraAmountInput && extraStartInput && extraMonthsInput) {
        ccExtraPayment.amount = parseFloat(extraAmountInput.value) || 50;
        ccExtraPayment.start = parseInt(extraStartInput.value) || 1;
        ccExtraPayment.months = parseInt(extraMonthsInput.value) || 12;
    }
    
    // Visual feedback
    const btn = document.querySelector('[onclick="ccApplyExtraPayment()"]');
    if (btn) {
        btn.textContent = 'âœ… Applied';
        btn.style.background = 'rgba(57,255,20,0.1)';
        btn.style.borderColor = 'rgba(57,255,20,0.3)';
        btn.style.color = '#39ff14';
        
        setTimeout(() => {
            btn.textContent = 'Apply';
            btn.style.background = 'rgba(45,212,255,0.1)';
            btn.style.borderColor = 'rgba(45,212,255,0.3)';
            btn.style.color = 'var(--accent)';
        }, 1500);
    }
    
    // Auto-calculate
    setTimeout(() => ccCalculate(), 200);
}

// Main calculation function
function ccCalculate() {
    const balanceInput = document.querySelector('#cc-balance-input');
    const rateInput = document.querySelector('#cc-rate-input');
    const paymentInput = document.querySelector('#cc-payment-input');
    const calculateBtn = document.querySelector('#cc-calculate-btn');
    
    if (!balanceInput || !rateInput || !paymentInput) return;
    
    const balance = parseFloat(balanceInput.value) || 0;
    const annualRate = parseFloat(rateInput.value) / 100 || 0;
    const payment = parseFloat(paymentInput.value) || 0;
    
    // Validate inputs
    if (balance <= 0 || payment <= 0) {
        ccShowError('Please enter valid balance and payment amounts');
        return;
    }
    
    // Visual feedback
    if (calculateBtn) {
        calculateBtn.innerHTML = 'â³ Calculating...';
        calculateBtn.disabled = true;
    }
    
    // Calculate payoff using amortization formula
    setTimeout(() => {
        let result;
        const cacheKey = `${balance}_${annualRate}_${payment}_${ccCurrentStrategy}`;
        
        // Check cache for same calculation
        if (ccCalculationCache[cacheKey]) {
            result = ccCalculationCache[cacheKey];
        } else {
            result = ccCalculatePayoff(balance, annualRate, payment);
            ccCalculationCache[cacheKey] = result;
        }
        
        // Display results
        ccDisplayResults(result, balance, payment, annualRate);
        
        // Reset button
        if (calculateBtn) {
            calculateBtn.innerHTML = 'âœ… Calculated';
            setTimeout(() => {
                calculateBtn.innerHTML = 'ğŸ§® Calculate';
                calculateBtn.disabled = false;
            }, 1000);
        }
    }, 300);
}

// Calculate payoff using accurate amortization
function ccCalculatePayoff(balance, annualRate, payment) {
    const monthlyRate = annualRate / 12;
    let remainingBalance = balance;
    let totalInterest = 0;
    let months = 0;
    const maxMonths = 600; // 50 years max
    
    // Check if payment covers interest
    if (payment <= remainingBalance * monthlyRate) {
        return {
            months: Infinity,
            totalInterest: Infinity,
            totalPayment: Infinity,
            error: 'Payment too low'
        };
    }
    
    // Calculate using amortization formula
    while (remainingBalance > 0.01 && months < maxMonths) {
        const interest = remainingBalance * monthlyRate;
        totalInterest += interest;
        
        // Apply payment after interest
        remainingBalance = remainingBalance + interest - payment;
        
        // Ensure we don't overpay
        if (remainingBalance < 0) {
            totalInterest -= (remainingBalance * -1); // Adjust interest for overpayment
            remainingBalance = 0;
        }
        
        months++;
    }
    
    return {
        months: months,
        totalInterest: totalInterest,
        totalPayment: balance + totalInterest,
        error: null
    };
}

// Display calculation results
function ccDisplayResults(result, balance, payment, annualRate) {
    const monthsEl = document.querySelector('#cc-months');
    const yearsEl = document.querySelector('#cc-years');
    const interestEl = document.querySelector('#cc-total-interest');
    const interestPercentEl = document.querySelector('#cc-interest-percent');
    const totalPaymentEl = document.querySelector('#cc-total-payment');
    const totalSavingsEl = document.querySelector('#cc-total-savings');
    const interestSavedEl = document.querySelector('#cc-interest-saved');
    const progressBar = document.querySelector('#cc-progress-bar');
    const progressText = document.querySelector('#cc-progress-text');
    const progressEnd = document.querySelector('#cc-progress-end');
    const detailsEl = document.querySelector('#cc-details');
    
    if (result.error) {
        // Show error message
        if (monthsEl) monthsEl.textContent = "Payment too low";
        if (yearsEl) yearsEl.textContent = "";
        if (interestEl) interestEl.textContent = "â€“";
        if (totalPaymentEl) totalPaymentEl.textContent = "â€“";
        if (interestSavedEl) interestSavedEl.textContent = "â€“";
        if (progressBar) progressBar.style.width = "0%";
        if (progressText) progressText.textContent = "Payment insufficient";
        if (progressEnd) progressEnd.textContent = "Infinite";
        
        if (detailsEl) {
            const minPayment = (balance * annualRate / 12).toFixed(2);
            detailsEl.innerHTML = `
                <strong>âš ï¸ Insufficient Payment</strong><br><br>
                Your monthly payment is less than the monthly interest.<br>
                You need to pay at least <strong>$${minPayment}</strong> just to cover interest.<br>
                To actually pay down the balance, you need to pay more than this amount.
            `;
        }
        return;
    }
    
    // Format results
    const years = result.months / 12;
    const interestPercent = (result.totalInterest / balance * 100).toFixed(1);
    
    // Calculate minimum payment scenario for comparison
    const minPayment = Math.max(10, balance * 0.02);
    const minResult = ccCalculatePayoff(balance, annualRate, minPayment);
    const interestSaved = minResult.totalInterest - result.totalInterest;
    
    // Update displays
    if (monthsEl) monthsEl.textContent = `${result.months} months`;
    if (yearsEl) yearsEl.textContent = years >= 1 ? `(${years.toFixed(1)} years)` : "";
    if (interestEl) interestEl.textContent = `$${result.totalInterest.toFixed(2)}`;
    if (interestPercentEl) interestPercentEl.textContent = `${interestPercent}% of balance`;
    if (totalPaymentEl) totalPaymentEl.textContent = `$${(balance + result.totalInterest).toFixed(2)}`;
    if (totalSavingsEl) totalSavingsEl.textContent = `$${balance.toLocaleString()} principal + interest`;
    if (interestSavedEl) interestSavedEl.textContent = `$${interestSaved.toFixed(2)}`;
    
    // Update progress visualization
    if (progressBar) {
        const progressPercent = Math.min(100, 50); // Simplified progress
        progressBar.style.width = progressPercent + "%";
    }
    if (progressText) progressText.textContent = `Month ${Math.floor(result.months / 2)} of ${result.months}`;
    if (progressEnd) progressEnd.textContent = `Month ${result.months}`;
    
    // Generate detailed breakdown
    if (detailsEl) {
        let details = `<strong>ğŸ“… Payoff Timeline:</strong><br>`;
        if (years >= 5) {
            details += `This will take <strong>${years.toFixed(1)} years</strong> to pay off.<br>`;
        } else if (years >= 1) {
            details += `This will take <strong>${years.toFixed(1)} years (${result.months} months)</strong> to pay off.<br>`;
        } else {
            details += `This will take <strong>${result.months} months</strong> to pay off.<br>`;
        }
        
        details += `<br><strong>ğŸ’° Payment Breakdown:</strong><br>`;
        details += `â€¢ Monthly payment: <strong>$${payment.toFixed(2)}</strong><br>`;
        details += `â€¢ Total interest paid: <strong>$${result.totalInterest.toFixed(2)}</strong><br>`;
        details += `â€¢ Total amount paid: <strong>$${(balance + result.totalInterest).toFixed(2)}</strong><br>`;
        details += `â€¢ Interest saved vs minimum payment: <strong>$${interestSaved.toFixed(2)}</strong><br><br>`;
        
        details += `<strong>ğŸ¯ Tips to Pay Off Faster:</strong><br>`;
        if (payment < balance * 0.05) {
            details += `â€¢ Increase payment to 5% of balance (<strong>$${(balance * 0.05).toFixed(2)}</strong>)<br>`;
        }
        if (annualRate > 0.15) {
            details += `â€¢ Consider a balance transfer to lower rate<br>`;
        }
        if (result.months > 24) {
            const extra = Math.ceil(payment * 0.1);
            details += `â€¢ Add <strong>$${extra}</strong> extra per month to cut payoff time<br>`;
        }
        
        detailsEl.innerHTML = details;
    }
}

// Show error message
function ccShowError(message) {
    const detailsEl = document.querySelector('#cc-details');
    if (detailsEl) {
        detailsEl.innerHTML = `<strong style="color:#ff4d4d;">âš ï¸ Error:</strong> ${message}`;
    }
}

// Optimize payment for 3-year payoff
function ccOptimizePayment() {
    const balanceInput = document.querySelector('#cc-balance-input');
    const rateInput = document.querySelector('#cc-rate-input');
    const paymentInput = document.querySelector('#cc-payment-input');
    const paymentSlider = document.querySelector('#cc-payment');
    const paymentDisplay = document.querySelector('#cc-payment-slider-val');
    const optimizeBtn = document.querySelector('#cc-optimize-btn');
    
    if (!balanceInput || !rateInput || !paymentInput) return;
    
    const balance = parseFloat(balanceInput.value) || 3000;
    const annualRate = parseFloat(rateInput.value) / 100 || 0;
    
    // Calculate payment for 36-month payoff using amortization formula
    const monthlyRate = annualRate / 12;
    const months = 36; // 3 years
    
    // Amortization formula: P = [r * PV] / [1 - (1 + r)^-n]
    let optimizedPayment;
    if (monthlyRate === 0) {
        optimizedPayment = balance / months;
    } else {
        optimizedPayment = (monthlyRate * balance) / (1 - Math.pow(1 + monthlyRate, -months));
    }
    
    const roundedPayment = Math.ceil(optimizedPayment / 10) * 10; // Round up to nearest $10
    
    paymentInput.value = roundedPayment;
    if (paymentSlider) paymentSlider.value = roundedPayment;
    if (paymentDisplay) paymentDisplay.textContent = '$' + roundedPayment.toLocaleString();
    
    // Visual feedback
    if (optimizeBtn) {
        optimizeBtn.innerHTML = 'âœ… Optimized';
        setTimeout(() => {
            optimizeBtn.innerHTML = 'ğŸ’¡ Optimize';
        }, 1500);
    }
    
    // Auto-calculate
    setTimeout(() => ccCalculate(), 200);
}

// Copy results to clipboard
function ccCopyResults() {
    const months = document.querySelector('#cc-months')?.textContent || 'N/A';
    const interest = document.querySelector('#cc-total-interest')?.textContent || 'N/A';
    const total = document.querySelector('#cc-total-payment')?.textContent || 'N/A';
    
    const text = `ğŸ’³ Credit Card Payoff Results:\nTime to Payoff: ${months}\nTotal Interest: ${interest}\nTotal Payment: ${total}`;
    
    navigator.clipboard?.writeText(text).then(() => {
        const btn = document.querySelector('[onclick="ccCopyResults()"]');
        if (btn) {
            btn.innerHTML = 'âœ… Copied!';
            setTimeout(() => {
                btn.innerHTML = 'ğŸ“‹ Copy';
            }, 2000);
        }
    });
}

// Reset calculator to defaults
function ccReset() {
    // Reset form inputs
    const balanceInput = document.querySelector('#cc-balance-input');
    const balanceSlider = document.querySelector('#cc-balance');
    const balanceDisplay = document.querySelector('#cc-balance-slider-val');
    
    const rateInput = document.querySelector('#cc-rate-input');
    const rateSlider = document.querySelector('#cc-rate');
    const rateDisplay = document.querySelector('#cc-rate-slider-val');
    
    const paymentInput = document.querySelector('#cc-payment-input');
    const paymentSlider = document.querySelector('#cc-payment');
    const paymentDisplay = document.querySelector('#cc-payment-slider-val');
    
    if (balanceInput) balanceInput.value = 3000;
    if (balanceSlider) balanceSlider.value = 3000;
    if (balanceDisplay) balanceDisplay.textContent = '$3,000';
    
    if (rateInput) rateInput.value = 18;
    if (rateSlider) rateSlider.value = 18;
    if (rateDisplay) rateDisplay.textContent = '18%';
    
    if (paymentInput) paymentInput.value = 150;
    if (paymentSlider) paymentSlider.value = 150;
    if (paymentDisplay) paymentDisplay.textContent = '$150';
    
    // Reset extra payments
    const extraAmount = document.querySelector('#cc-extra-amount');
    const extraStart = document.querySelector('#cc-extra-start');
    const extraMonths = document.querySelector('#cc-extra-months');
    
    if (extraAmount) extraAmount.value = 50;
    if (extraStart) extraStart.value = 1;
    if (extraMonths) extraMonths.value = 12;
    
    // Reset strategy
    ccSetStrategy('standard');
    
    // Reset results
    const monthsEl = document.querySelector('#cc-months');
    const yearsEl = document.querySelector('#cc-years');
    const interestEl = document.querySelector('#cc-total-interest');
    const interestPercentEl = document.querySelector('#cc-interest-percent');
    const totalPaymentEl = document.querySelector('#cc-total-payment');
    const totalSavingsEl = document.querySelector('#cc-total-savings');
    const interestSavedEl = document.querySelector('#cc-interest-saved');
    const progressBar = document.querySelector('#cc-progress-bar');
    const progressText = document.querySelector('#cc-progress-text');
    const progressEnd = document.querySelector('#cc-progress-end');
    const detailsEl = document.querySelector('#cc-details');
    
    if (monthsEl) monthsEl.textContent = 'â€“';
    if (yearsEl) yearsEl.textContent = '';
    if (interestEl) interestEl.textContent = 'â€“';
    if (interestPercentEl) interestPercentEl.textContent = '';
    if (totalPaymentEl) totalPaymentEl.textContent = 'â€“';
    if (totalSavingsEl) totalSavingsEl.textContent = '';
    if (interestSavedEl) interestSavedEl.textContent = 'â€“';
    if (progressBar) progressBar.style.width = '0%';
    if (progressText) progressText.textContent = 'No data';
    if (progressEnd) progressEnd.textContent = 'Month 0';
    if (detailsEl) detailsEl.innerHTML = 'Enter your credit card details to see payoff calculations.';
    
    // Visual feedback
    const resetBtn = document.querySelector('#cc-reset-btn');
    if (resetBtn) {
        resetBtn.innerHTML = 'âœ… Reset Complete';
        setTimeout(() => {
            resetBtn.innerHTML = 'ğŸ”„ Reset';
        }, 1000);
    }
    
    // Clear cache
    ccCalculationCache = {};
}

// Initialize on page load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', ccInit);
} else {
    ccInit();
}
</script>
