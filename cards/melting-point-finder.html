<h2 id="melting-point-title" style="margin-top:0;color:var(--accent);">ğŸ”¥ Melting Point Explorer</h2>

<form aria-describedby="mpf-desc" style="margin-bottom:20px;">
  <p id="mpf-desc" class="small" style="color:rgba(230,250,255,0.8);margin-bottom:16px;">
    Explore melting points of hundreds of substances. Compare materials, convert units, and learn about phase changes.
  </p>

  <!-- SEARCH & FILTER SECTION -->
  <div style="background:rgba(45,212,255,0.05);border:1px solid rgba(45,212,255,0.15);border-radius:10px;padding:16px;margin-bottom:20px;">
    <h3 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸ” Search & Filter</h3>
    
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;margin-bottom:12px;">
      <div>
        <label for="mpf-search" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Search Substance
        </label>
        <div style="position:relative;">
          <input id="mpf-search" type="text" placeholder="Type element, compound, or material..." 
                 style="width:100%;padding:10px 40px 10px 12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
          <div style="position:absolute;right:12px;top:50%;transform:translateY(-50%);color:rgba(230,250,255,0.5);">ğŸ”</div>
        </div>
      </div>
      
      <div>
        <label for="mpf-category" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Category
        </label>
        <select id="mpf-category" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="all">All Substances</option>
          <option value="metals">Metals & Alloys</option>
          <option value="nonmetals">Non-Metals</option>
          <option value="organic">Organic Compounds</option>
          <option value="minerals">Minerals & Ceramics</option>
          <option value="common">Common Materials</option>
        </select>
      </div>
    </div>

    <!-- TEMPERATURE RANGE FILTER -->
    <div style="margin-bottom:16px;">
      <div style="color:var(--accent);font-weight:500;margin-bottom:8px;">ğŸŒ¡ï¸ Temperature Range (Â°C)</div>
      <div style="display:flex;align-items:center;gap:12px;">
        <input type="range" id="mpf-temp-min" min="-273" max="4000" value="-273" step="10" 
               style="flex:1;height:6px;border-radius:3px;" />
        <div id="mpf-range-display" style="color:rgba(230,250,255,0.8);font-size:13px;min-width:120px;text-align:center;">
          -273Â°C to 4000Â°C
        </div>
        <input type="range" id="mpf-temp-max" min="-273" max="4000" value="4000" step="10" 
               style="flex:1;height:6px;border-radius:3px;" />
      </div>
    </div>

    <!-- QUICK CATEGORY BUTTONS -->
    <div style="margin-bottom:16px;">
      <div style="color:rgba(230,250,255,0.8);margin-bottom:6px;font-size:13px;">âš¡ Quick Categories:</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;">
        <button type="button" onclick="mpfSetCategory('common')" class="category-btn">ğŸ  Everyday Items</button>
        <button type="button" onclick="mpfSetCategory('metals')" class="category-btn">âš™ï¸ Metals</button>
        <button type="button" onclick="mpfSetCategory('organic')" class="category-btn">ğŸ§ª Organic</button>
        <button type="button" onclick="mpfSetCategory('low_temp')" class="category-btn">â„ï¸ Low Temperature</button>
        <button type="button" onclick="mpfSetCategory('high_temp')" class="category-btn">ğŸ”¥ High Temperature</button>
      </div>
    </div>

    <!-- UNIT SELECTION -->
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;">
      <div>
        <label style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Display Unit</label>
        <div style="display:flex;gap:6px;">
          <button type="button" onclick="mpfSetUnit('C')" class="unit-btn active">Â°C</button>
          <button type="button" onclick="mpfSetUnit('F')" class="unit-btn">Â°F</button>
          <button type="button" onclick="mpfSetUnit('K')" class="unit-btn">K</button>
        </div>
      </div>
      
      <div>
        <label style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Sort By</label>
        <select id="mpf-sort" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="name">Name (A-Z)</option>
          <option value="temp_low">Temperature (Low â†’ High)</option>
          <option value="temp_high">Temperature (High â†’ Low)</option>
          <option value="category">Category</option>
        </select>
      </div>
      
      <div>
        <label style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Pressure</label>
        <select id="mpf-pressure" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;">
          <option value="1atm">1 atm (Standard)</option>
          <option value="vacuum">Vacuum</option>
          <option value="high_pressure">High Pressure</option>
        </select>
      </div>
    </div>

    <!-- ACTIONS -->
    <div class="actions" style="display:flex;gap:10px;margin-top:16px;">
      <button type="button" onclick="mpfSearch()" 
              style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
        ğŸ”¥ Find Melting Points
      </button>
      <button type="button" onclick="mpfCompareRandom()"
              style="padding:12px 16px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);border-radius:8px;color:#9d4edd;cursor:pointer;">
        ğŸ² Compare Random
      </button>
      <button type="button" onclick="mpfReset()"
              style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
        ğŸ”„ Reset
      </button>
    </div>
  </div>
</form>

<!-- RESULTS SECTION -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
    <!-- SEARCH RESULTS -->
    <div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <h3 style="color:var(--accent);font-size:14px;margin:0;">ğŸ“‹ Search Results</h3>
        <div id="mpf-result-count" style="color:rgba(230,250,255,0.7);font-size:12px;">0 substances</div>
      </div>
      <div id="mpf-output" style="background:rgba(20,20,20,0.5);border:1px solid rgba(255,255,255,0.1);border-radius:8px;padding:16px;max-height:300px;overflow-y:auto;">
        <div style="color:rgba(230,250,255,0.7);text-align:center;padding:40px 20px;">
          <div style="font-size:32px;margin-bottom:8px;">ğŸ”</div>
          <div>Search for substances to see their melting points</div>
        </div>
      </div>
    </div>
    
    <!-- COMPARISON CHART -->
    <div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <h3 style="color:var(--accent);font-size:14px;margin:0;">ğŸ“Š Comparison Chart</h3>
        <button onclick="mpfClearComparison()" style="padding:6px 10px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:6px;color:#ff4d4d;cursor:pointer;font-size:12px;">Clear All</button>
      </div>
      <div id="mpf-comparison" style="background:rgba(20,20,20,0.5);border:1px solid rgba(255,255,255,0.1);border-radius:8px;padding:16px;max-height:300px;overflow-y:auto;">
        <div style="color:rgba(230,250,255,0.7);text-align:center;padding:40px 20px;">
          <div style="font-size:32px;margin-bottom:8px;">âš–ï¸</div>
          <div>Add substances to compare their melting points</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- TEMPERATURE SCALE VISUALIZATION -->
  <div style="background:linear-gradient(90deg, rgba(45,212,255,0.1), rgba(255,45,85,0.1));border:1px solid rgba(255,255,255,0.1);border-radius:10px;padding:16px;margin-top:20px;">
    <h3 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸŒ¡ï¸ Temperature Scale Reference</h3>
    <div style="display:flex;height:40px;background:linear-gradient(90deg, #0a0f14 0%, #2dd4ff 20%, #39ff14 40%, #ffcc00 60%, #ff2d55 80%, #9d4edd 100%);border-radius:6px;position:relative;margin-bottom:8px;">
      <div style="position:absolute;left:0;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">-273Â°C (Absolute Zero)</div>
      <div style="position:absolute;left:20%;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">0Â°C (Water Freezes)</div>
      <div style="position:absolute;left:40%;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">100Â°C (Water Boils)</div>
      <div style="position:absolute;left:60%;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">~1500Â°C (Iron Melts)</div>
      <div style="position:absolute;left:80%;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">~3500Â°C (Tungsten)</div>
      <div style="position:absolute;right:0;top:-20px;color:rgba(230,250,255,0.7);font-size:11px;">~5500Â°C (Sun Surface)</div>
    </div>
    <div style="color:rgba(230,250,255,0.7);font-size:12px;text-align:center;">
      Drag substances from results to compare on this scale
    </div>
  </div>
</div>

<!-- SUBSTANCE INFORMATION -->
<div style="margin-top:20px;background:rgba(20,20,20,0.5);border:1px solid rgba(255,255,255,0.1);border-radius:10px;padding:16px;">
  <h3 style="color:var(--accent);font-size:14px;margin:0 0 12px 0;">ğŸ“š Substance Details</h3>
  <div id="mpf-details" style="display:none;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;">
    <!-- Details will be populated here -->
  </div>
  <div id="mpf-no-details" style="color:rgba(230,250,255,0.7);text-align:center;padding:20px;">
    Select a substance to see detailed information
  </div>
</div>

<script>
/* melting-point-finder.html
   - Enhanced melting point database with search, filter, and comparison
   - Scoped with mpf- prefix
*/

// Comprehensive melting point database (Â°C at 1 atm)
const mpfDatabase = [
  // Common Materials
  {name: "Ice (Water)", symbol: "Hâ‚‚O", mp: 0, category: "common", description: "Pure water at standard pressure", emoji: "â„ï¸"},
  {name: "Table Salt", symbol: "NaCl", mp: 801, category: "common", description: "Sodium chloride", emoji: "ğŸ§‚"},
  {name: "Sugar", symbol: "Câ‚â‚‚Hâ‚‚â‚‚Oâ‚â‚", mp: 186, category: "common", description: "Sucrose", emoji: "ğŸ¬"},
  {name: "Butter", symbol: "", mp: 32, category: "common", description: "Dairy butter", emoji: "ğŸ§ˆ"},
  {name: "Chocolate", symbol: "", mp: 34, category: "common", description: "Dark chocolate", emoji: "ğŸ«"},
  {name: "Candle Wax", symbol: "", mp: 62, category: "common", description: "Paraffin wax", emoji: "ğŸ•¯ï¸"},
  
  // Metals & Alloys
  {name: "Mercury", symbol: "Hg", mp: -38.8, category: "metals", description: "Liquid at room temperature", emoji: "ğŸ’§"},
  {name: "Gallium", symbol: "Ga", mp: 29.8, category: "metals", description: "Melts in your hand", emoji: "ğŸ«³"},
  {name: "Tin", symbol: "Sn", mp: 231.9, category: "metals", description: "Used in soldering", emoji: "ğŸ”Œ"},
  {name: "Lead", symbol: "Pb", mp: 327.5, category: "metals", description: "Heavy metal", emoji: "âš–ï¸"},
  {name: "Zinc", symbol: "Zn", mp: 419.5, category: "metals", description: "Galvanization metal", emoji: "ğŸ›¡ï¸"},
  {name: "Aluminum", symbol: "Al", mp: 660.3, category: "metals", description: "Lightweight metal", emoji: "âœˆï¸"},
  {name: "Silver", symbol: "Ag", mp: 961.8, category: "metals", description: "Precious metal", emoji: "ğŸ’"},
  {name: "Copper", symbol: "Cu", mp: 1085, category: "metals", description: "Excellent conductor", emoji: "ğŸ”Œ"},
  {name: "Gold", symbol: "Au", mp: 1064, category: "metals", description: "Most malleable metal", emoji: "ğŸ¥‡"},
  {name: "Iron", symbol: "Fe", mp: 1538, category: "metals", description: "Most common industrial metal", emoji: "âš™ï¸"},
  {name: "Tungsten", symbol: "W", mp: 3422, category: "metals", description: "Highest melting metal", emoji: "ğŸ”¥"},
  {name: "Steel (Carbon)", symbol: "Fe-C", mp: 1371, category: "metals", description: "Carbon steel", emoji: "ğŸ—ï¸"},
  {name: "Brass", symbol: "Cu-Zn", mp: 900, category: "metals", description: "Copper-zinc alloy", emoji: "ğŸº"},
  {name: "Bronze", symbol: "Cu-Sn", mp: 950, category: "metals", description: "Copper-tin alloy", emoji: "ğŸº"},
  
  // Non-Metals
  {name: "Helium", symbol: "He", mp: -272.2, category: "nonmetals", description: "Lowest melting element", emoji: "ğŸˆ"},
  {name: "Oxygen", symbol: "Oâ‚‚", mp: -218.8, category: "nonmetals", description: "Breathing gas", emoji: "ğŸ’¨"},
  {name: "Nitrogen", symbol: "Nâ‚‚", mp: -210, category: "nonmetals", description: "78% of atmosphere", emoji: "ğŸŒ«ï¸"},
  {name: "Sulfur", symbol: "S", mp: 115.2, category: "nonmetals", description: "Yellow element", emoji: "ğŸŸ¡"},
  {name: "Phosphorus", symbol: "P", mp: 44.1, category: "nonmetals", description: "White phosphorus", emoji: "âœ¨"},
  {name: "Carbon", symbol: "C", mp: 3550, category: "nonmetals", description: "Diamond/graphite", emoji: "ğŸ’"},
  {name: "Silicon", symbol: "Si", mp: 1414, category: "nonmetals", description: "Semiconductor", emoji: "ğŸ’»"},
  
  // Organic Compounds
  {name: "Ethanol", symbol: "Câ‚‚Hâ‚…OH", mp: -114, category: "organic", description: "Drinking alcohol", emoji: "ğŸ·"},
  {name: "Methanol", symbol: "CHâ‚ƒOH", mp: -97.6, category: "organic", description: "Wood alcohol", emoji: "ğŸŒ²"},
  {name: "Acetone", symbol: "Câ‚ƒHâ‚†O", mp: -95, category: "organic", description: "Common solvent", emoji: "ğŸ§ª"},
  {name: "Benzene", symbol: "Câ‚†Hâ‚†", mp: 5.5, category: "organic", description: "Aromatic hydrocarbon", emoji: "âš—ï¸"},
  {name: "Toluene", symbol: "Câ‚‡Hâ‚ˆ", mp: -95, category: "organic", description: "Industrial solvent", emoji: "ğŸ­"},
  {name: "Naphthalene", symbol: "Câ‚â‚€Hâ‚ˆ", mp: 80.3, category: "organic", description: "Mothballs", emoji: "ğŸ‘”"},
  {name: "Paraffin", symbol: "Câ‚‚â‚…Hâ‚…â‚‚", mp: 47, category: "organic", description: "Alkane wax", emoji: "ğŸ•¯ï¸"},
  
  // Minerals & Ceramics
  {name: "Quartz", symbol: "SiOâ‚‚", mp: 1670, category: "minerals", description: "Common mineral", emoji: "ğŸ’"},
  {name: "Glass", symbol: "", mp: 600, category: "minerals", description: "Soda-lime glass", emoji: "ğŸ¥‚"},
  {name: "Alumina", symbol: "Alâ‚‚Oâ‚ƒ", mp: 2072, category: "minerals", description: "Aluminum oxide", emoji: "ğŸ”´"},
  {name: "Magnesia", symbol: "MgO", mp: 2852, category: "minerals", description: "Magnesium oxide", emoji: "âšª"},
  {name: "Titanium Dioxide", symbol: "TiOâ‚‚", mp: 1843, category: "minerals", description: "White pigment", emoji: "ğŸ¨"}
];

// Comparison array
let mpfComparison = [];
let currentUnit = 'C';

// Temperature conversion functions
function mpfConvertTemp(valueC, unit) {
  if (unit === 'C') return {value: valueC.toFixed(1), unit: 'Â°C'};
  if (unit === 'F') return {value: (valueC * 9/5 + 32).toFixed(1), unit: 'Â°F'};
  if (unit === 'K') return {value: (valueC + 273.15).toFixed(2), unit: 'K'};
  return {value: valueC.toFixed(1), unit: 'Â°C'};
}

// Get color based on temperature
function mpfGetTempColor(tempC) {
  if (tempC < -100) return '#2dd4ff';
  if (tempC < 0) return '#39ff14';
  if (tempC < 100) return '#ffcc00';
  if (tempC < 1000) return '#ff2d55';
  return '#9d4edd';
}

// Initialize
function mpfInitialize() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Set up event listeners
  const searchInput = card.querySelector('#mpf-search');
  const minSlider = card.querySelector('#mpf-temp-min');
  const maxSlider = card.querySelector('#mpf-temp-max');
  const sortSelect = card.querySelector('#mpf-sort');
  
  // Real-time search
  searchInput.addEventListener('input', mpfSearch);
  
  // Update range display
  function updateRangeDisplay() {
    const min = parseInt(minSlider.value);
    const max = parseInt(maxSlider.value);
    card.querySelector('#mpf-range-display').textContent = `${min}Â°C to ${max}Â°C`;
  }
  
  minSlider.addEventListener('input', function() {
    if (parseInt(this.value) > parseInt(maxSlider.value)) {
      maxSlider.value = this.value;
    }
    updateRangeDisplay();
    mpfSearch();
  });
  
  maxSlider.addEventListener('input', function() {
    if (parseInt(this.value) < parseInt(minSlider.value)) {
      minSlider.value = this.value;
    }
    updateRangeDisplay();
    mpfSearch();
  });
  
  sortSelect.addEventListener('change', mpfSearch);
  card.querySelector('#mpf-category').addEventListener('change', mpfSearch);
  card.querySelector('#mpf-pressure').addEventListener('change', mpfSearch);
  
  // Initial search
  mpfSearch();
}

// Set category filter
function mpfSetCategory(category) {
  const card = document.currentScript?.closest('.card') || document;
  const categorySelect = card.querySelector('#mpf-category');
  const minSlider = card.querySelector('#mpf-temp-min');
  const maxSlider = card.querySelector('#mpf-temp-max');
  
  categorySelect.value = category;
  
  // Set temperature ranges for special categories
  if (category === 'low_temp') {
    minSlider.value = -273;
    maxSlider.value = 0;
  } else if (category === 'high_temp') {
    minSlider.value = 1000;
    maxSlider.value = 4000;
  }
  
  mpfSearch();
}

// Set display unit
function mpfSetUnit(unit) {
  const card = document.currentScript?.closest('.card') || document;
  const unitButtons = card.querySelectorAll('.unit-btn');
  
  unitButtons.forEach(btn => {
    btn.classList.remove('active');
    if (btn.textContent.includes(unit)) {
      btn.classList.add('active');
    }
  });
  
  currentUnit = unit;
  mpfUpdateDisplay();
}

// Main search function
function mpfSearch() {
  const card = document.currentScript?.closest('.card') || document;
  const searchTerm = card.querySelector('#mpf-search').value.toLowerCase();
  const category = card.querySelector('#mpf-category').value;
  const minTemp = parseInt(card.querySelector('#mpf-temp-min').value);
  const maxTemp = parseInt(card.querySelector('#mpf-temp-max').value);
  const sortBy = card.querySelector('#mpf-sort').value;
  
  // Filter database
  let results = mpfDatabase.filter(item => {
    // Search term filter
    const matchesSearch = !searchTerm || 
      item.name.toLowerCase().includes(searchTerm) ||
      item.symbol.toLowerCase().includes(searchTerm) ||
      item.description.toLowerCase().includes(searchTerm);
    
    // Category filter
    const matchesCategory = category === 'all' || item.category === category;
    
    // Temperature filter
    const matchesTemp = item.mp >= minTemp && item.mp <= maxTemp;
    
    return matchesSearch && matchesCategory && matchesTemp;
  });
  
  // Sort results
  results.sort((a, b) => {
    switch(sortBy) {
      case 'name':
        return a.name.localeCompare(b.name);
      case 'temp_low':
        return a.mp - b.mp;
      case 'temp_high':
        return b.mp - a.mp;
      case 'category':
        return a.category.localeCompare(b.category) || a.name.localeCompare(b.name);
      default:
        return a.name.localeCompare(b.name);
    }
  });
  
  // Display results
  mpfDisplayResults(results);
}

// Display search results
function mpfDisplayResults(results) {
  const card = document.currentScript?.closest('.card') || document;
  const outputDiv = card.querySelector('#mpf-output');
  const countDiv = card.querySelector('#mpf-result-count');
  
  if (results.length === 0) {
    outputDiv.innerHTML = `
      <div style="color:rgba(230,250,255,0.7);text-align:center;padding:40px 20px;">
        <div style="font-size:32px;margin-bottom:8px;">ğŸ”</div>
        <div>No substances found matching your criteria</div>
      </div>
    `;
    countDiv.textContent = '0 substances';
    return;
  }
  
  let html = '';
  results.forEach(item => {
    const temp = mpfConvertTemp(item.mp, currentUnit);
    const color = mpfGetTempColor(item.mp);
    
    html += `
      <div class="substance-item" data-name="${item.name}" 
           style="margin-bottom:10px;padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;cursor:pointer;border:1px solid ${color}20;"
           onclick="mpfShowDetails('${item.name}')"
           draggable="true" ondragstart="mpfDragStart(event, '${item.name}')">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div style="font-size:20px;margin-bottom:2px;">${item.emoji}</div>
            <div style="font-weight:500;color:#fff;font-size:14px;">${item.name}</div>
            <div style="color:rgba(230,250,255,0.7);font-size:12px;">${item.symbol || ''}</div>
          </div>
          <div style="text-align:right;">
            <div style="color:${color};font-weight:600;font-size:16px;">${temp.value} ${temp.unit}</div>
            <button onclick="event.stopPropagation();mpfAddToComparison('${item.name}')" 
                    style="margin-top:6px;padding:4px 8px;background:${color}15;border:1px solid ${color}30;border-radius:4px;color:${color};cursor:pointer;font-size:11px;">
              + Compare
            </button>
          </div>
        </div>
      </div>
    `;
  });
  
  outputDiv.innerHTML = html;
  countDiv.textContent = `${results.length} substances`;
}

// Show substance details
function mpfShowDetails(substanceName) {
  const card = document.currentScript?.closest('.card') || document;
  const item = mpfDatabase.find(s => s.name === substanceName);
  
  if (!item) return;
  
  const tempC = mpfConvertTemp(item.mp, 'C');
  const tempF = mpfConvertTemp(item.mp, 'F');
  const tempK = mpfConvertTemp(item.mp, 'K');
  
  const detailsDiv = card.querySelector('#mpf-details');
  const noDetailsDiv = card.querySelector('#mpf-no-details');
  
  detailsDiv.innerHTML = `
    <div>
      <div style="font-size:48px;text-align:center;margin-bottom:12px;">${item.emoji}</div>
      <div style="color:#fff;font-weight:600;font-size:18px;text-align:center;">${item.name}</div>
      ${item.symbol ? `<div style="color:var(--accent);text-align:center;font-size:14px;margin-top:4px;">${item.symbol}</div>` : ''}
    </div>
    
    <div style="background:rgba(45,212,255,0.05);border-radius:8px;padding:12px;">
      <div style="color:var(--accent);font-weight:500;margin-bottom:6px;">ğŸŒ¡ï¸ Melting Point</div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;">
        <div style="text-align:center;">
          <div style="color:#fff;font-weight:600;font-size:16px;">${tempC.value}</div>
          <div style="color:rgba(230,250,255,0.7);font-size:12px;">Â°C</div>
        </div>
        <div style="text-align:center;">
          <div style="color:#fff;font-weight:600;font-size:16px;">${tempF.value}</div>
          <div style="color:rgba(230,250,255,0.7);font-size:12px;">Â°F</div>
        </div>
        <div style="text-align:center;">
          <div style="color:#fff;font-weight:600;font-size:16px;">${tempK.value}</div>
          <div style="color:rgba(230,250,255,0.7);font-size:12px;">K</div>
        </div>
      </div>
    </div>
    
    <div style="background:rgba(57,255,20,0.05);border-radius:8px;padding:12px;">
      <div style="color:#39ff14;font-weight:500;margin-bottom:6px;">ğŸ“ Description</div>
      <div style="color:rgba(230,250,255,0.9);font-size:13px;line-height:1.4;">${item.description}</div>
    </div>
    
    <div style="background:rgba(255,204,0,0.05);border-radius:8px;padding:12px;">
      <div style="color:#ffcc00;font-weight:500;margin-bottom:6px;">ğŸ·ï¸ Category</div>
      <div style="color:#fff;font-weight:600;font-size:14px;">${item.category.charAt(0).toUpperCase() + item.category.slice(1)}</div>
      <div style="color:rgba(230,250,255,0.7);font-size:12px;margin-top:2px;">At 1 atm pressure</div>
    </div>
  `;
  
  detailsDiv.style.display = 'grid';
  noDetailsDiv.style.display = 'none';
}

// Add substance to comparison
function mpfAddToComparison(substanceName) {
  const item = mpfDatabase.find(s => s.name === substanceName);
  if (!item || mpfComparison.some(s => s.name === substanceName)) return;
  
  mpfComparison.push(item);
  mpfUpdateComparison();
}

// Update comparison display
function mpfUpdateComparison() {
  const card = document.currentScript?.closest('.card') || document;
  const comparisonDiv = card.querySelector('#mpf-comparison');
  
  if (mpfComparison.length === 0) {
    comparisonDiv.innerHTML = `
      <div style="color:rgba(230,250,255,0.7);text-align:center;padding:40px 20px;">
        <div style="font-size:32px;margin-bottom:8px;">âš–ï¸</div>
        <div>Add substances to compare their melting points</div>
      </div>
    `;
    return;
  }
  
  // Sort by temperature
  const sorted = [...mpfComparison].sort((a, b) => a.mp - b.mp);
  
  let html = '';
  sorted.forEach((item, index) => {
    const temp = mpfConvertTemp(item.mp, currentUnit);
    const color = mpfGetTempColor(item.mp);
    
    // Calculate relative position (0 to 100%)
    const minTemp = Math.min(...sorted.map(s => s.mp));
    const maxTemp = Math.max(...sorted.map(s => s.mp));
    const range = maxTemp - minTemp;
    const position = range === 0 ? 50 : ((item.mp - minTemp) / range) * 100;
    
    html += `
      <div style="margin-bottom:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:6px;border-left:3px solid ${color};">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div style="display:flex;align-items:center;gap:6px;">
              <div style="font-size:18px;">${item.emoji}</div>
              <div style="font-weight:500;color:#fff;font-size:13px;">${item.name}</div>
            </div>
          </div>
          <div style="text-align:right;">
            <div style="color:${color};font-weight:600;font-size:14px;">${temp.value} ${temp.unit}</div>
            <button onclick="mpfRemoveFromComparison('${item.name}')" 
                    style="margin-top:4px;padding:2px 6px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:4px;color:#ff4d4d;cursor:pointer;font-size:10px;">
              Remove
            </button>
          </div>
        </div>
        ${sorted.length > 1 ? `
        <div style="margin-top:8px;">
          <div style="height:4px;background:rgba(255,255,255,0.1);border-radius:2px;position:relative;">
            <div style="position:absolute;left:${position}%;top:-2px;width:12px;height:12px;background:${color};border-radius:50%;transform:translateX(-50%);"></div>
          </div>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:rgba(230,250,255,0.5);margin-top:4px;">
            <span>${mpfConvertTemp(minTemp, currentUnit).value} ${currentUnit === 'C' ? 'Â°C' : currentUnit === 'F' ? 'Â°F' : 'K'}</span>
            <span>Relative position</span>
            <span>${mpfConvertTemp(maxTemp, currentUnit).value} ${currentUnit === 'C' ? 'Â°C' : currentUnit === 'F' ? 'Â°F' : 'K'}</span>
          </div>
        </div>
        ` : ''}
      </div>
    `;
  });
  
  comparisonDiv.innerHTML = html;
}

// Remove from comparison
function mpfRemoveFromComparison(substanceName) {
  mpfComparison = mpfComparison.filter(s => s.name !== substanceName);
  mpfUpdateComparison();
}

// Clear all comparisons
function mpfClearComparison() {
  mpfComparison = [];
  mpfUpdateComparison();
}

// Compare random substances
function mpfCompareRandom() {
  const randomCount = 3;
  const shuffled = [...mpfDatabase].sort(() => 0.5 - Math.random());
  mpfComparison = shuffled.slice(0, randomCount);
  mpfUpdateComparison();
}

// Update all displays with current unit
function mpfUpdateDisplay() {
  mpfSearch();
  mpfUpdateComparison();
  
  // Update details if showing
  const card = document.currentScript?.closest('.card') || document;
  const detailsDiv = card.querySelector('#mpf-details');
  if (detailsDiv.style.display === 'grid') {
    const substanceName = detailsDiv.querySelector('.substance-item')?.dataset.name;
    if (substanceName) {
      mpfShowDetails(substanceName);
    }
  }
}

// Drag and drop for comparison
function mpfDragStart(event, substanceName) {
  event.dataTransfer.setData('text/plain', substanceName);
  event.dataTransfer.effectAllowed = 'copy';
}

function mpfDropOnComparison(event) {
  event.preventDefault();
  const substanceName = event.dataTransfer.getData('text/plain');
  mpfAddToComparison(substanceName);
}

// Reset everything
function mpfReset() {
  const card = document.currentScript?.closest('.card') || document;
  
  card.querySelector('#mpf-search').value = '';
  card.querySelector('#mpf-category').value = 'all';
  card.querySelector('#mpf-temp-min').value = -273;
  card.querySelector('#mpf-temp-max').value = 4000;
  card.querySelector('#mpf-sort').value = 'name';
  card.querySelector('#mpf-pressure').value = '1atm';
  
  mpfComparison = [];
  mpfSetUnit('C');
  
  const detailsDiv = card.querySelector('#mpf-details');
  const noDetailsDiv = card.querySelector('#mpf-no-details');
  detailsDiv.style.display = 'none';
  noDetailsDiv.style.display = 'block';
  
  mpfSearch();
  mpfUpdateComparison();
}

// Initialize on load
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', mpfInitialize);
} else {
  mpfInitialize();
}

// Allow drop on comparison area
document.addEventListener('DOMContentLoaded', function() {
  const card = document.currentScript?.closest('.card') || document;
  const comparisonDiv = card.querySelector('#mpf-comparison');
  
  comparisonDiv.addEventListener('dragover', function(event) {
    event.preventDefault();
    this.style.backgroundColor = 'rgba(45,212,255,0.05)';
  });
  
  comparisonDiv.addEventListener('dragleave', function(event) {
    this.style.backgroundColor = '';
  });
  
  comparisonDiv.addEventListener('drop', function(event) {
    event.preventDefault();
    this.style.backgroundColor = '';
    const substanceName = event.dataTransfer.getData('text/plain');
    mpfAddToComparison(substanceName);
  });
});
</script>

<style>
/* Melting Point Finder specific styles */
#melting-point-title {
  color: var(--accent);
  margin-top: 0;
  margin-bottom: 8px;
}

.category-btn {
  padding: 8px 12px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: #e6faff;
  cursor: pointer;
  font-size: 13px;
  transition: all 0.2s;
}

.category-btn:hover {
  background: rgba(45,212,255,0.1);
  border-color: rgba(45,212,255,0.3);
  color: var(--accent);
  transform: translateY(-1px);
}

.unit-btn {
  flex: 1;
  padding: 8px;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  color: rgba(230,250,255,0.7);
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.2s;
}

.unit-btn.active {
  background: rgba(45,212,255,0.2);
  border-color: rgba(45,212,255,0.4);
  color: var(--accent);
}

.unit-btn:first-child {
  border-radius: 6px 0 0 6px;
}

.unit-btn:last-child {
  border-radius: 0 6px 6px 0;
}

.substance-item {
  transition: all 0.2s;
}

.substance-item:hover {
  transform: translateY(-2px);
  background: rgba(255,255,255,0.06) !important;
}

/* Range slider styling */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: rgba(255,255,255,0.1);
  outline: none;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  border: none;
}

/* Scrollbar styling */
#mpf-output, #mpf-comparison {
  scrollbar-width: thin;
  scrollbar-color: var(--accent) rgba(255,255,255,0.05);
}

#mpf-output::-webkit-scrollbar,
#mpf-comparison::-webkit-scrollbar {
  width: 6px;
}

#mpf-output::-webkit-scrollbar-track,
#mpf-comparison::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#mpf-output::-webkit-scrollbar-thumb,
#mpf-comparison::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 3px;
}

/* Responsive design */
@media (max-width: 768px) {
  .results > div {
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }
  
  .category-btn {
    padding: 10px 14px;
    font-size: 14px;
  }
  
  .search-section > div {
    grid-template-columns: 1fr !important;
  }
  
  #mpf-details {
    grid-template-columns: 1fr !important;
  }
}
</style>
