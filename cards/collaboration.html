<!-- cards/team-productivity-hub.html -->
<div class="card-content">
<h2 id="productivity-title" style="margin-top:0;color:var(--accent);position:relative;">
  ğŸ¤– AI Team Productivity Hub
  <span style="position:absolute;right:0;top:0;font-size:0.7rem;color:rgba(45,212,255,0.7);font-weight:normal;">
    Collaboration & AI
  </span>
</h2>

<form aria-describedby="productivity-desc" style="margin-bottom:20px;">
  <p id="productivity-desc" class="small" style="color:rgba(230,250,255,0.8);margin-bottom:16px;">
    AI-powered team management with workload balancing, predictive analytics, and automated optimization.
    <span style="color:var(--accent);display:block;margin-top:4px;">
      âš¡ Smart suggestions â€¢ ğŸ¯ Predictive deadlines â€¢ ğŸ“Š Real-time analytics
    </span>
  </p>

  <!-- Smart Task Input -->
  <div style="background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:12px;padding:20px;border:1px solid rgba(45,212,255,0.1);margin-bottom:16px;">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
      <div class="field">
        <label for="team-member" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          ğŸ‘¤ Team Member
        </label>
        <div style="position:relative;">
          <input id="team-member" type="text" placeholder="Start typing name..." 
                 style="width:100%;padding:10px 10px 10px 36px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;"
                 oninput="tpSuggestMembers()" />
          <span style="position:absolute;left:10px;top:10px;">ğŸ”</span>
          <div id="member-suggestions" style="display:none;position:absolute;top:100%;left:0;right:0;background:rgba(0,0,0,0.9);border:1px solid rgba(45,212,255,0.3);border-radius:8px;z-index:100;max-height:200px;overflow-y:auto;margin-top:2px;"></div>
        </div>
      </div>
      <div class="field">
        <label for="task-description" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          ğŸ“‹ Task Description
        </label>
        <input id="task-description" type="text" placeholder="What needs to be done?" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
      </div>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:12px;">
      <div class="field">
        <label for="task-priority" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          ğŸ¯ Priority Score
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input type="range" id="task-priority" min="1" max="10" value="5" 
                 style="flex:1;height:8px;border-radius:4px;background:rgba(45,212,255,0.1);outline:none;"
                 oninput="tpUpdatePriorityDisplay(this.value)">
          <span id="priority-display" style="min-width:60px;text-align:center;padding:4px 8px;border-radius:6px;background:rgba(255,165,0,0.2);color:#ffa500;font-size:12px;font-weight:600;">
            Medium (5)
          </span>
        </div>
        <div style="display:flex;justify-content:space-between;margin-top:6px;font-size:0.75rem;color:rgba(230,250,255,0.7);">
          <span>Low</span>
          <span>Critical</span>
        </div>
      </div>
      
      <div class="field">
        <label for="task-deadline" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          ğŸ“… Deadline
        </label>
        <input id="task-deadline" type="date" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
      </div>
      
      <div class="field">
        <label for="task-status" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          ğŸ“Š Status
        </label>
        <select id="task-status" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
          <option value="backlog">ğŸ“¥ Backlog</option>
          <option value="todo" selected>â³ To Do</option>
          <option value="inprogress">ğŸš§ In Progress</option>
          <option value="review">ğŸ‘€ Review</option>
          <option value="done">âœ… Done</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="actions" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));gap:10px;">
    <button type="button" onclick="tpAddTask()" 
            style="padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
      â• Add Task
    </button>
    <button type="button" onclick="tpGenerateReport()"
            style="padding:12px;background:rgba(255,204,0,0.1);border:1px solid rgba(255,204,0,0.3);color:#ffcc00;border-radius:8px;cursor:pointer;">
      ğŸ“Š Analytics
    </button>
    <button type="button" onclick="tpResetBoard()"
            style="padding:12px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;">
      ğŸ”„ Reset
    </button>
  </div>
</form>

<!-- Results Section -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <!-- Team Analytics -->
  <div id="analytics-section" style="display:none;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(45,212,255,0.02));border-radius:8px;padding:24px;border:1px solid rgba(45,212,255,0.1);margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
      <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“Š Team Performance Analytics</h3>
    </div>
    
    <!-- Key Metrics -->
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:16px;margin-bottom:24px;">
      <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">Total Tasks</div>
        <div id="metric-total" style="font-size:1.8rem;font-weight:700;color:#39ff14;">0</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">All tasks</div>
      </div>
      
      <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">In Progress</div>
        <div id="metric-inprogress" style="font-size:1.8rem;font-weight:700;color:#2dd4ff;">0</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Active tasks</div>
      </div>
      
      <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">Completed</div>
        <div id="metric-done" style="font-size:1.8rem;font-weight:700;color:#ffcc00;">0</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Done tasks</div>
      </div>
      
      <div style="text-align:center;padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;">
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:8px;">Team Members</div>
        <div id="metric-members" style="font-size:1.8rem;font-weight:700;color:#9d4edd;">0</div>
        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-top:4px;">Active team</div>
      </div>
    </div>
  </div>

  <!-- Task List -->
  <div style="background:rgba(0,0,0,0.1);border-radius:8px;padding:24px;border:1px solid rgba(255,255,255,0.05);margin-bottom:20px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
      <h3 style="color:var(--accent);margin:0;font-size:1.1rem;">ğŸ“‹ Task Board</h3>
      <div style="display:flex;gap:8px;align-items:center;">
        <span id="task-count" style="font-size:12px;color:rgba(230,250,255,0.7);">0 tasks</span>
        <div style="display:flex;gap:6px;">
          <button onclick="tpFilterTasks('all')" id="filter-all" style="padding:6px 12px;background:var(--accent);color:#000;border:none;border-radius:6px;cursor:pointer;font-size:11px;font-weight:600;">
            All
          </button>
          <button onclick="tpFilterTasks('active')" id="filter-active" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;cursor:pointer;font-size:11px;">
            Active
          </button>
          <button onclick="tpFilterTasks('done')" id="filter-done" style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;cursor:pointer;font-size:11px;">
            Done
          </button>
        </div>
      </div>
    </div>
    
    <!-- Task List Container -->
    <div id="task-list-container" style="min-height:100px;">
      <!-- Tasks will appear here -->
    </div>
  </div>
</div>

<script>
// Team Productivity Hub - Complete Fixed Version

// Data storage
let tpTasks = [];
let tpTeamMembers = [];
let tpCurrentFilter = 'all';

// Priority labels
const priorityLabels = {
    1: { label: 'Trivial', color: '#2dd4ff' },
    2: { label: 'Very Low', color: '#2dd4ff' },
    3: { label: 'Low', color: '#2dd4ff' },
    4: { label: 'Low-Medium', color: '#ffcc00' },
    5: { label: 'Medium', color: '#ffcc00' },
    6: { label: 'Medium-High', color: '#ffa500' },
    7: { label: 'High', color: '#ffa500' },
    8: { label: 'Very High', color: '#ff2d55' },
    9: { label: 'Critical', color: '#ff2d55' },
    10: { label: 'Emergency', color: '#ff0066' }
};

// Initialize
function tpInitialize() {
    console.log('Initializing Team Productivity Hub...');
    
    // Load saved data
    tpLoadData();
    
    // Set default deadline to tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('task-deadline').valueAsDate = tomorrow;
    
    // Initialize UI
    tpUpdatePriorityDisplay(5);
    
    // Load sample team members if none exist
    if (tpTeamMembers.length === 0) {
        tpTeamMembers = [
            { name: 'Alex Chen', role: 'Frontend Dev' },
            { name: 'Sam Rivera', role: 'Backend Dev' },
            { name: 'Jordan Taylor', role: 'UX Designer' },
            { name: 'Casey Smith', role: 'QA Engineer' },
            { name: 'Morgan Lee', role: 'Project Manager' }
        ];
    }
    
    // Load sample tasks if none exist
    if (tpTasks.length === 0) {
        tpAddSampleTasks();
    }
    
    // Render everything
    tpRenderTasks();
    tpUpdateAnalytics();
    
    // Set up event listeners
    tpSetupEventListeners();
    
    console.log('Team Productivity Hub ready with', tpTasks.length, 'tasks');
}

// Load data from localStorage
function tpLoadData() {
    try {
        const savedTasks = localStorage.getItem('tp-tasks');
        const savedMembers = localStorage.getItem('tp-members');
        
        if (savedTasks) tpTasks = JSON.parse(savedTasks);
        if (savedMembers) tpTeamMembers = JSON.parse(savedMembers);
    } catch (e) {
        console.error('Failed to load data:', e);
        tpTasks = [];
        tpTeamMembers = [];
    }
}

// Save data to localStorage
function tpSaveData() {
    try {
        localStorage.setItem('tp-tasks', JSON.stringify(tpTasks));
        localStorage.setItem('tp-members', JSON.stringify(tpTeamMembers));
    } catch (e) {
        console.error('Failed to save data:', e);
    }
}

// Add sample tasks for demonstration
function tpAddSampleTasks() {
    const sampleTasks = [
        {
            id: Date.now() + 1,
            member: 'Alex Chen',
            task: 'Redesign dashboard UI',
            priority: 8,
            deadline: new Date(Date.now() + 5 * 86400000).toISOString().split('T')[0],
            status: 'inprogress',
            createdAt: new Date(Date.now() - 2 * 86400000).toISOString()
        },
        {
            id: Date.now() + 2,
            member: 'Sam Rivera',
            task: 'Fix authentication bug',
            priority: 9,
            deadline: new Date(Date.now() + 1 * 86400000).toISOString().split('T')[0],
            status: 'todo',
            createdAt: new Date(Date.now() - 1 * 86400000).toISOString()
        },
        {
            id: Date.now() + 3,
            member: 'Jordan Taylor',
            task: 'User research for new feature',
            priority: 6,
            deadline: new Date(Date.now() + 7 * 86400000).toISOString().split('T')[0],
            status: 'inprogress',
            createdAt: new Date(Date.now() - 3 * 86400000).toISOString()
        },
        {
            id: Date.now() + 4,
            member: 'Casey Smith',
            task: 'Test payment integration',
            priority: 7,
            deadline: new Date(Date.now() + 3 * 86400000).toISOString().split('T')[0],
            status: 'review',
            createdAt: new Date(Date.now() - 4 * 86400000).toISOString()
        },
        {
            id: Date.now() + 5,
            member: 'Morgan Lee',
            task: 'Plan Q4 roadmap',
            priority: 6,
            deadline: new Date(Date.now() + 14 * 86400000).toISOString().split('T')[0],
            status: 'todo',
            createdAt: new Date(Date.now() - 1 * 86400000).toISOString()
        }
    ];
    
    tpTasks.push(...sampleTasks);
    tpSaveData();
}

// Set up event listeners
function tpSetupEventListeners() {
    // Enter key to add task
    document.getElementById('task-description').addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            tpAddTask();
        }
    });
    
    // Enter key in team member field
    document.getElementById('team-member').addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            document.getElementById('task-description').focus();
        }
    });
}

// Update priority display
function tpUpdatePriorityDisplay(value) {
    const display = document.getElementById('priority-display');
    const priority = priorityLabels[value] || priorityLabels[5];
    display.textContent = `${priority.label} (${value})`;
    display.style.background = `${priority.color}20`;
    display.style.color = priority.color;
}

// Suggest members based on input
function tpSuggestMembers() {
    const input = document.getElementById('team-member').value.toLowerCase();
    const suggestions = document.getElementById('member-suggestions');
    
    if (input.length < 1) {
        suggestions.style.display = 'none';
        return;
    }
    
    const matchingMembers = tpTeamMembers.filter(m => 
        m.name.toLowerCase().includes(input)
    ).slice(0, 5);
    
    if (matchingMembers.length === 0) {
        suggestions.style.display = 'none';
        return;
    }
    
    let html = '';
    matchingMembers.forEach(member => {
        html += `
            <div onclick="tpSelectMember('${member.name}')" style="
                padding: 8px 12px;
                cursor: pointer;
                transition: background 0.2s;
                color: rgba(230,250,255,0.9);
            " onmouseover="this.style.background='rgba(45,212,255,0.1)'" 
               onmouseout="this.style.background='transparent'">
                ${member.name} <span style="color:rgba(230,250,255,0.5);font-size:0.8rem;">(${member.role})</span>
            </div>
        `;
    });
    
    suggestions.innerHTML = html;
    suggestions.style.display = 'block';
}

function tpSelectMember(name) {
    document.getElementById('team-member').value = name;
    document.getElementById('member-suggestions').style.display = 'none';
}

// Add new task
function tpAddTask() {
    const member = document.getElementById('team-member').value.trim();
    const task = document.getElementById('task-description').value.trim();
    const priority = parseInt(document.getElementById('task-priority').value);
    const deadline = document.getElementById('task-deadline').value;
    const status = document.getElementById('task-status').value;
    
    if (!member || !task) {
        // Visual feedback for empty fields
        if (!member) {
            const memberInput = document.getElementById('team-member');
            memberInput.style.borderColor = '#ff2d55';
            setTimeout(() => memberInput.style.borderColor = '', 1000);
        }
        if (!task) {
            const taskInput = document.getElementById('task-description');
            taskInput.style.borderColor = '#ff2d55';
            setTimeout(() => taskInput.style.borderColor = '', 1000);
        }
        return;
    }
    
    // Add member to team if new
    if (!tpTeamMembers.some(m => m.name === member)) {
        tpTeamMembers.push({
            name: member,
            role: 'Team Member'
        });
    }
    
    const newTask = {
        id: Date.now() + Math.random().toString(36).substr(2, 9),
        member,
        task,
        priority,
        deadline,
        status,
        createdAt: new Date().toISOString(),
        completedAt: status === 'done' ? new Date().toISOString() : null
    };
    
    tpTasks.unshift(newTask);
    tpSaveData();
    tpRenderTasks();
    tpUpdateAnalytics();
    
    // Reset form
    document.getElementById('team-member').value = '';
    document.getElementById('task-description').value = '';
    document.getElementById('task-priority').value = 5;
    tpUpdatePriorityDisplay(5);
    document.getElementById('task-status').value = 'todo';
    
    // Set deadline to tomorrow
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('task-deadline').valueAsDate = tomorrow;
    
    document.getElementById('team-member').focus();
}

// Render tasks
function tpRenderTasks() {
    const container = document.getElementById('task-list-container');
    
    // Filter tasks
    let filteredTasks = tpTasks;
    if (tpCurrentFilter === 'active') {
        filteredTasks = tpTasks.filter(t => t.status !== 'done');
    } else if (tpCurrentFilter === 'done') {
        filteredTasks = tpTasks.filter(t => t.status === 'done');
    }
    
    if (filteredTasks.length === 0) {
        container.innerHTML = `
            <div style="text-align:center;padding:40px;color:rgba(230,250,255,0.5);">
                No tasks found. Add your first task above!
            </div>
        `;
        document.getElementById('task-count').textContent = '0 tasks';
        return;
    }
    
    let html = '';
    filteredTasks.forEach(task => {
        const priority = priorityLabels[task.priority] || priorityLabels[5];
        const priorityColor = priority.color;
        
        // Deadline status
        let deadlineClass = '';
        let deadlineText = task.deadline ? new Date(task.deadline).toLocaleDateString() : 'No deadline';
        
        if (task.deadline && task.status !== 'done') {
            const deadlineDate = new Date(task.deadline);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            deadlineDate.setHours(0, 0, 0, 0);
            const diffDays = Math.floor((deadlineDate - today) / (1000 * 60 * 60 * 24));
            
            if (diffDays < 0) {
                deadlineClass = 'color:#ff2d55;font-weight:600;';
                deadlineText = `âš ï¸ Overdue: ${deadlineText}`;
            } else if (diffDays === 0) {
                deadlineClass = 'color:#ffcc00;font-weight:600;';
                deadlineText = `âš ï¸ Today: ${deadlineText}`;
            } else if (diffDays <= 2) {
                deadlineClass = 'color:#ffa500;';
                deadlineText = `âš ï¸ ${diffDays}d: ${deadlineText}`;
            }
        }
        
        // Status icon
        const statusIcons = {
            backlog: 'ğŸ“¥',
            todo: 'â³',
            inprogress: 'ğŸš§',
            review: 'ğŸ‘€',
            done: 'âœ…'
        };
        
        html += `
            <div class="task-item" data-id="${task.id}" style="
                background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
                border: 1px solid rgba(255,255,255,0.1);
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 12px;
                transition: all 0.2s;
            ">
                <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;">
                    <div>
                        <strong style="color:var(--accent);font-size:1rem;">${task.member}</strong>
                        <div style="
                            background: ${priorityColor}20;
                            border-radius: 4px;
                            padding: 2px 8px;
                            font-size: 11px;
                            color: ${priorityColor};
                            margin-top: 4px;
                            display: inline-block;
                        ">
                            ${priority.label} (${task.priority})
                        </div>
                    </div>
                    <div style="display:flex;gap:8px;">
                        <select onchange="tpUpdateTaskStatus('${task.id}', this.value)" style="
                            padding: 4px 8px;
                            border-radius: 6px;
                            border: 1px solid rgba(45,212,255,0.3);
                            background: rgba(45,212,255,0.05);
                            color: inherit;
                            font-size: 12px;
                        ">
                            <option value="backlog" ${task.status === 'backlog' ? 'selected' : ''}>ğŸ“¥ Backlog</option>
                            <option value="todo" ${task.status === 'todo' ? 'selected' : ''}>â³ To Do</option>
                            <option value="inprogress" ${task.status === 'inprogress' ? 'selected' : ''}>ğŸš§ In Progress</option>
                            <option value="review" ${task.status === 'review' ? 'selected' : ''}>ğŸ‘€ Review</option>
                            <option value="done" ${task.status === 'done' ? 'selected' : ''}>âœ… Done</option>
                        </select>
                        <button onclick="tpDeleteTask('${task.id}')" style="
                            background: transparent;
                            border: none;
                            color: rgba(255,77,77,0.7);
                            cursor: pointer;
                            font-size: 14px;
                            padding: 4px;
                            border-radius: 4px;
                        " title="Delete task">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                </div>
                
                <div style="margin-bottom:12px;color:rgba(230,250,255,0.9);font-size:0.95rem;">
                    ${statusIcons[task.status] || 'ğŸ“'} ${task.task}
                </div>
                
                <div style="display:flex;justify-content:space-between;align-items:center;font-size:0.85rem;">
                    <div>
                        <span style="${deadlineClass}">ğŸ“… ${deadlineText}</span>
                    </div>
                    <div style="color:rgba(230,250,255,0.5);">
                        ${new Date(task.createdAt).toLocaleDateString()}
                    </div>
                </div>
            </div>
        `;
    });
    
    container.innerHTML = html;
    document.getElementById('task-count').textContent = `${filteredTasks.length} task${filteredTasks.length !== 1 ? 's' : ''}`;
}

// Update task status
function tpUpdateTaskStatus(taskId, newStatus) {
    const task = tpTasks.find(t => t.id === taskId);
    if (task) {
        task.status = newStatus;
        if (newStatus === 'done' && !task.completedAt) {
            task.completedAt = new Date().toISOString();
        }
        tpSaveData();
        tpRenderTasks();
        tpUpdateAnalytics();
    }
}

// Delete task
function tpDeleteTask(taskId) {
    if (confirm('Delete this task?')) {
        tpTasks = tpTasks.filter(t => t.id !== taskId);
        tpSaveData();
        tpRenderTasks();
        tpUpdateAnalytics();
    }
}

// Filter tasks
function tpFilterTasks(filter) {
    tpCurrentFilter = filter;
    
    // Update filter buttons
    ['all', 'active', 'done'].forEach(f => {
        const btn = document.getElementById(`filter-${f}`);
        if (btn) {
            if (f === filter) {
                btn.style.background = 'var(--accent)';
                btn.style.color = '#000';
                btn.style.fontWeight = '600';
            } else {
                btn.style.background = 'rgba(255,255,255,0.05)';
                btn.style.color = 'inherit';
                btn.style.fontWeight = 'normal';
            }
        }
    });
    
    tpRenderTasks();
}

// Generate analytics report
function tpGenerateReport() {
    const analyticsSection = document.getElementById('analytics-section');
    analyticsSection.style.display = 'block';
    tpUpdateAnalytics();
    
    // Smooth scroll to analytics
    analyticsSection.scrollIntoView({ 
        behavior: 'smooth', 
        block: 'nearest' 
    });
}

// Update analytics
function tpUpdateAnalytics() {
    const totalTasks = tpTasks.length;
    const inprogressTasks = tpTasks.filter(t => t.status === 'inprogress').length;
    const doneTasks = tpTasks.filter(t => t.status === 'done').length;
    
    // Get unique team members
    const uniqueMembers = [...new Set(tpTasks.map(t => t.member))];
    
    // Update metrics
    document.getElementById('metric-total').textContent = totalTasks;
    document.getElementById('metric-inprogress').textContent = inprogressTasks;
    document.getElementById('metric-done').textContent = doneTasks;
    document.getElementById('metric-members').textContent = uniqueMembers.length;
}

// Reset board
function tpResetBoard() {
    if (confirm('Reset all data? This will clear all tasks and cannot be undone.')) {
        tpTasks = [];
        tpSaveData();
        tpRenderTasks();
        tpUpdateAnalytics();
        
        // Hide analytics
        document.getElementById('analytics-section').style.display = 'none';
    }
}

// Initialize on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', tpInitialize);
} else {
    tpInitialize();
}
</script>

<style>
.task-item:hover {
    border-color: rgba(45,212,255,0.3) !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Scrollbar styling */
#member-suggestions::-webkit-scrollbar {
    width: 6px;
}

#member-suggestions::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.05);
    border-radius: 3px;
}

#member-suggestions::-webkit-scrollbar-thumb {
    background: rgba(45,212,255,0.3);
    border-radius: 3px;
}

#member-suggestions::-webkit-scrollbar-thumb:hover {
    background: rgba(45,212,255,0.5);
}

/* Responsive design */
@media (max-width: 768px) {
    #productivity-title {
        font-size: 1.2rem;
    }
    
    .field {
        grid-column: span 2 !important;
    }
    
    .actions {
        grid-template-columns: 1fr !important;
    }
    
    .task-item {
        padding: 12px !important;
    }
}
</style>
</div>
