<h2 id="email-templates-title" style="margin-top:0;color:var(--accent);border-bottom:2px solid var(--accent);padding-bottom:10px;">
  ğŸ“§ Professional Email & Communication Generator
</h2>

<div class="tool-description" style="
  background:linear-gradient(135deg, rgba(45,212,255,0.08), rgba(45,212,255,0.04));
  border-left:4px solid var(--accent);
  padding:16px;
  border-radius:0 12px 12px 0;
  margin-bottom:20px;
">
  <p style="margin:0;display:flex;align-items:flex-start;gap:12px;">
    <span style="font-size:1.8em;flex-shrink:0;">ğŸ’¼</span>
    <span style="line-height:1.6;">
      Generate perfectly crafted professional emails, LinkedIn messages, and business communications.
      <strong style="color:var(--accent);">Includes tone analysis, etiquette tips, and productivity features.</strong>
    </span>
  </p>
</div>

<!-- COMMUNICATION TYPE SELECTOR -->
<div class="comms-selector" style="margin-bottom:24px;">
  <div style="color:var(--accent);font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;">
    <span style="font-size:1.3em;">ğŸ“</span> Select Communication Type
  </div>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:12px;">
    <button class="comms-btn active" data-type="email" onclick="selectCommsType('email', this)" style="
      padding:16px 12px;background:rgba(45,212,255,0.15);border:2px solid var(--accent);border-radius:10px;color:var(--accent);cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.8em;margin-bottom:8px;">ğŸ“§</div>
      <div style="font-weight:600;">Email</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">Professional emails</div>
    </button>
    
    <button class="comms-btn" data-type="linkedin" onclick="selectCommsType('linkedin', this)" style="
      padding:16px 12px;background:rgba(0,119,181,0.1);border:1px solid rgba(0,119,181,0.3);border-radius:10px;color:#0077b5;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.8em;margin-bottom:8px;">ğŸ’¼</div>
      <div style="font-weight:600;">LinkedIn</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">Connection messages</div>
    </button>
    
    <button class="comms-btn" data-type="followup" onclick="selectCommsType('followup', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.8em;margin-bottom:8px;">ğŸ”</div>
      <div style="font-weight:600;">Follow-up</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">Reminders</div>
    </button>
    
    <button class="comms-btn" data-type="thankyou" onclick="selectCommsType('thankyou', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.8em;margin-bottom:8px;">ğŸ™</div>
      <div style="font-weight:600;">Thank You</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">Gratitude notes</div>
    </button>
    
    <button class="comms-btn" data-type="apology" onclick="selectCommsType('apology', this)" style="
      padding:16px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;transition:all 0.2s;text-align:center;
    ">
      <div style="font-size:1.8em;margin-bottom:8px;">ğŸ¤</div>
      <div style="font-weight:600;">Apology</div>
      <div style="font-size:0.85em;opacity:0.8;margin-top:4px;">Professional apologies</div>
    </button>
  </div>
</div>

<!-- INPUT SECTION -->
<div class="input-section" style="
  background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px;
  padding:24px;
  margin-bottom:24px;
">
  <h3 style="margin-top:0;color:var(--accent);margin-bottom:20px;">âœï¸ Message Details</h3>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;margin-bottom:20px;">
    <div>
      <label for="et-recipient" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
        <span style="color:var(--accent);">â†’</span> Recipient
      </label>
      <input id="et-recipient" type="text" placeholder="e.g., Hiring Manager, Client Name, Colleague"
             style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
      <div style="font-size:0.85em;color:rgba(230,250,255,0.6);margin-top:6px;">
        Use formal titles for professional communications
      </div>
    </div>
    
    <div>
      <label for="et-relationship" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
        <span style="color:var(--accent);">â†”</span> Relationship
      </label>
      <select id="et-relationship" style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
        <option value="new">New Contact</option>
        <option value="client">Existing Client</option>
        <option value="colleague">Colleague</option>
        <option value="manager">Manager/Supervisor</option>
        <option value="vendor">Vendor/Supplier</option>
        <option value="recruiter">Recruiter</option>
      </select>
    </div>
    
    <div>
      <label for="et-tone" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
        <span style="color:var(--accent);">ğŸ­</span> Tone & Formality
      </label>
      <div style="display:flex;gap:8px;">
        <button class="tone-btn active" data-tone="formal" onclick="selectTone('formal', this)" style="
          flex:1;padding:10px;background:rgba(45,212,255,0.2);border:2px solid var(--accent);border-radius:8px;color:var(--accent);cursor:pointer;
        ">Formal</button>
        <button class="tone-btn" data-tone="professional" onclick="selectTone('professional', this)" style="
          flex:1;padding:10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;cursor:pointer;
        ">Professional</button>
        <button class="tone-btn" data-tone="friendly" onclick="selectTone('friendly', this)" style="
          flex:1;padding:10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;cursor:pointer;
        ">Friendly</button>
      </div>
    </div>
  </div>
  
  <div style="margin-bottom:20px;">
    <label for="et-purpose" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
      <span style="color:var(--accent);">ğŸ¯</span> Purpose & Context
    </label>
    <textarea id="et-purpose" rows="3" 
              style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;"
              placeholder="What is the main goal of this communication? Be specific about what you need or want to achieve."></textarea>
  </div>
  
  <div style="margin-bottom:20px;">
    <label for="et-details" style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-weight:500;">
      <span style="color:var(--accent);">ğŸ“‹</span> Key Details (Dates, Numbers, Specifics)
    </label>
    <textarea id="et-details" rows="4" 
              style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;"
              placeholder="Include specific information like dates, times, project names, numbers, or any important context. Each detail on a new line:"></textarea>
  </div>
  
  <div style="
    background:rgba(45,212,255,0.05);border:1px solid rgba(45,212,255,0.2);border-radius:10px;
    padding:16px;margin-top:20px;
  ">
    <div style="color:var(--accent);font-weight:600;margin-bottom:8px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">ğŸ’¡</span> Quick Tips
    </div>
    <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
      â€¢ Be specific about your ask â€¢ Include clear next steps â€¢ Keep it concise (50-150 words) â€¢ 
      Proofread before sending â€¢ Use professional email signatures
    </div>
  </div>
</div>

<!-- GENERATE BUTTON -->
<div style="margin-bottom:24px;">
  <button onclick="generateCommunication()" style="
    width:100%;
    padding:18px;
    background:linear-gradient(90deg, var(--accent), #0077cc);
    border:none;
    border-radius:12px;
    color:white;
    font-weight:700;
    font-size:1.1em;
    cursor:pointer;
    transition:all 0.3s;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
  " onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
    <span style="font-size:1.3em;">âœ¨</span>
    Generate Professional Communication
    <span style="font-size:1.3em;">ğŸ“§</span>
  </button>
</div>

<!-- RESULTS SECTION -->
<div id="results-section" style="
  background:linear-gradient(135deg, rgba(57,255,20,0.05), rgba(45,212,255,0.05));
  border:2px solid rgba(57,255,20,0.2);
  border-radius:16px;
  padding:24px;
  display:none;
">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
    <h3 style="margin:0;color:#39ff14;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.3em;">ğŸ“„</span> Generated Communication
    </h3>
    <div style="font-size:0.9em;color:rgba(230,250,255,0.7);background:rgba(0,0,0,0.3);padding:6px 12px;border-radius:20px;">
      <span id="current-comms-type">Professional Email</span>
    </div>
  </div>

  <!-- TONE ANALYSIS -->
  <div style="
    background:rgba(45,212,255,0.08);border-radius:12px;padding:16px;margin-bottom:20px;
    display:none;" id="tone-analysis">
    <div style="color:var(--accent);font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">ğŸ­</span> Tone Analysis
    </div>
    <div style="display:flex;gap:16px;flex-wrap:wrap;">
      <div style="flex:1;min-width:150px;">
        <div style="font-size:0.9em;color:rgba(230,250,255,0.7);margin-bottom:4px;">Professionalism</div>
        <div style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;">
          <div id="tone-professional" style="height:100%;background:#39ff14;width:90%;"></div>
        </div>
      </div>
      <div style="flex:1;min-width:150px;">
        <div style="font-size:0.9em;color:rgba(230,250,255,0.7);margin-bottom:4px;">Clarity</div>
        <div style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;">
          <div id="tone-clarity" style="height:100%;background:#2dd4ff;width:85%;"></div>
        </div>
      </div>
      <div style="flex:1;min-width:150px;">
        <div style="font-size:0.9em;color:rgba(230,250,255,0.7);margin-bottom:4px;">Persuasiveness</div>
        <div style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;">
          <div id="tone-persuasive" style="height:100%;background:#ffcc00;width:75%;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- GENERATED MESSAGE -->
  <div style="margin-bottom:24px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">ğŸ“</span> Ready-to-Use Message
    </div>
    
    <div style="position:relative;">
      <textarea id="et-output" rows="12" 
                style="width:100%;padding:20px;border-radius:12px;border:2px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;font-family:'Segoe UI', system-ui, sans-serif;line-height:1.6;resize:vertical;"
                placeholder="Your generated message will appear here..."></textarea>
      
      <div style="position:absolute;top:16px;right:16px;display:flex;gap:8px;">
        <button onclick="copyToClipboard()" style="
          background:rgba(45,212,255,0.2);border:1px solid var(--accent);color:var(--accent);
          padding:8px 16px;border-radius:6px;cursor:pointer;font-size:0.9em;font-weight:600;
        " title="Copy to clipboard">
          ğŸ“‹ Copy
        </button>
        <button onclick="clearMessage()" style="
          background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);color:inherit;
          padding:8px 16px;border-radius:6px;cursor:pointer;font-size:0.9em;font-weight:600;
        " title="Clear message">
          ğŸ—‘ï¸ Clear
        </button>
      </div>
    </div>
    
    <div style="display:flex;justify-content:space-between;margin-top:12px;font-size:0.9em;">
      <div style="color:rgba(230,250,255,0.7);">
        Words: <span id="et-wordcount" style="color:#39ff14;font-weight:600;">0</span> | 
        Characters: <span id="et-charcount" style="color:#2dd4ff;font-weight:600;">0</span>
      </div>
      <div style="color:rgba(230,250,255,0.7);" id="read-time">
        Reading time: 0 min
      </div>
    </div>
  </div>

  <!-- EMAIL ETIQUETTE TIPS -->
  <div style="
    background:linear-gradient(135deg, rgba(255,204,0,0.08), rgba(255,204,0,0.04));
    border:1px solid rgba(255,204,0,0.2);
    border-radius:12px;
    padding:20px;
    margin-bottom:24px;
  ">
    <div style="color:#ffcc00;font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">ğŸ’¡</span> Professional Etiquette Tips
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:16px;">
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:6px;font-size:0.95em;">ğŸ“‹ Subject Line</div>
        <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
          Keep it clear and specific. Include key words and urgency indicators.
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:6px;font-size:0.95em;">â° Timing</div>
        <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
          Send during business hours. Consider time zones for international recipients.
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:6px;font-size:0.95em;">ğŸ“ Attachments</div>
        <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
          Mention attachments in body. Keep file sizes reasonable. Use descriptive filenames.
        </div>
      </div>
      
      <div style="padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;">
        <div style="color:#ffcc00;font-weight:600;margin-bottom:6px;font-size:0.95em;">ğŸ” Follow-up</div>
        <div style="font-size:0.9em;color:rgba(230,250,255,0.8);line-height:1.5;">
          Wait 2-3 business days before following up. Reference previous email in subject.
        </div>
      </div>
    </div>
  </div>

  <!-- EMAIL SIGNATURE GENERATOR -->
  <div style="margin-bottom:24px;">
    <div style="color:var(--accent);font-weight:600;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:1.2em;">âœï¸</span> Professional Signature Generator
    </div>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:20px;">
      <div>
        <label style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-size:0.9em;">
          Your Name
        </label>
        <input id="sig-name" type="text" placeholder="Jane Smith" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
      </div>
      
      <div>
        <label style="display:block;margin-bottom:8px;color:rgba(230,250,255,0.9);font-size:0.9em;">
          Title
        </label>
        <input id="sig-title" type="text" placeholder="Senior Project Manager" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
      </div>
      
      <div>
        <button onclick="generateSignature()" style="
          width:100%;padding:12px;background:rgba(45,212,255,0.15);border:1px solid var(--accent);
          border-radius:8px;color:var(--accent);font-weight:600;cursor:pointer;margin-top:24px;
        ">
          Generate Signature
        </button>
      </div>
    </div>
    
    <div id="signature-output" style="
      background:rgba(0,0,0,0.2);border-radius:10px;padding:20px;margin-top:16px;
      display:none;font-family:'Segoe UI', system-ui, sans-serif;line-height:1.6;
    ">
      <!-- Signature will be generated here -->
    </div>
  </div>

  <!-- ACTION BUTTONS -->
  <div style="display:flex;gap:12px;flex-wrap:wrap;">
    <button onclick="exportCommunication()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(57,255,20,0.15);border:1px solid #39ff14;border-radius:10px;color:#39ff14;font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      ğŸ“„ Export as Text
    </button>
    
    <button onclick="scheduleReminder()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(255,204,0,0.15);border:1px solid #ffcc00;border-radius:10px;color:#ffcc00;font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      â° Schedule Follow-up
    </button>
    
    <button onclick="resetGenerator()" style="
      flex:1;min-width:150px;padding:14px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);border-radius:10px;color:inherit;font-weight:600;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
      ğŸ”„ Start New
    </button>
  </div>
</div>

<!-- TEMPLATE LIBRARY -->
<div style="
  background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px;
  padding:24px;
  margin-top:24px;
">
  <div style="color:var(--accent);font-weight:600;margin-bottom:20px;display:flex;align-items:center;gap:8px;">
    <span style="font-size:1.3em;">ğŸ“š</span> Common Business Communication Templates
  </div>
  
  <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:16px;">
    <button onclick="loadTemplate('meeting')" style="
      padding:16px;text-align:left;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);
      border-radius:10px;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(0,0,0,0.2)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
      <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Meeting Request</div>
      <div style="font-size:0.9em;color:rgba(230,250,255,0.7);line-height:1.5;">
        Professional request for a meeting with agenda and timing options
      </div>
    </button>
    
    <button onclick="loadTemplate('status')" style="
      padding:16px;text-align:left;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);
      border-radius:10px;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(0,0,0,0.2)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
      <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Project Update</div>
      <div style="font-size:0.9em;color:rgba(230,250,255,0.7);line-height:1.5;">
        Clear status report with progress, blockers, and next steps
      </div>
    </button>
    
    <button onclick="loadTemplate('intro')" style="
      padding:16px;text-align:left;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);
      border-radius:10px;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(0,0,0,0.2)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
      <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Networking Intro</div>
      <div style="font-size:0.9em;color:rgba(230,250,255,0.7);line-height:1.5;">
        Professional introduction with value proposition and clear ask
      </div>
    </button>
    
    <button onclick="loadTemplate('feedback')" style="
      padding:16px;text-align:left;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.1);
      border-radius:10px;cursor:pointer;transition:all 0.2s;
    " onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 6px 20px rgba(0,0,0,0.2)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
      <div style="color:var(--accent);font-weight:600;margin-bottom:8px;">Feedback Request</div>
      <div style="font-size:0.9em;color:rgba(230,250,255,0.7);line-height:1.5;">
        Professional request for feedback with specific questions
      </div>
    </button>
  </div>
</div>

<script>
// Professional Communication Generator

let currentCommsType = 'email';
let currentTone = 'formal';

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  addEventListeners();
  updateCommsTypeDisplay();
});

function addEventListeners() {
  // Add input listeners for real-time updates
  const inputs = ['et-recipient', 'et-purpose', 'et-details'];
  inputs.forEach(id => {
    document.getElementById(id).addEventListener('input', updateCounts);
  });
}

function selectCommsType(type, button) {
  currentCommsType = type;
  
  // Update button styles
  document.querySelectorAll('.comms-btn').forEach(btn => {
    btn.classList.remove('active');
    btn.style.background = 'rgba(255,255,255,0.05)';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
    
    const btnType = btn.dataset.type;
    if (btnType === 'email') btn.style.color = 'var(--accent)';
    if (btnType === 'linkedin') btn.style.color = '#0077b5';
    if (btnType === 'followup') btn.style.color = 'inherit';
    if (btnType === 'thankyou') btn.style.color = 'inherit';
    if (btnType === 'apology') btn.style.color = 'inherit';
  });
  
  button.classList.add('active');
  
  // Set specific styling based on type
  switch(type) {
    case 'email':
      button.style.background = 'rgba(45,212,255,0.15)';
      button.style.border = '2px solid var(--accent)';
      button.style.color = 'var(--accent)';
      break;
    case 'linkedin':
      button.style.background = 'rgba(0,119,181,0.2)';
      button.style.border = '2px solid #0077b5';
      button.style.color = '#0077b5';
      break;
    default:
      button.style.background = 'rgba(45,212,255,0.15)';
      button.style.border = '2px solid var(--accent)';
      button.style.color = 'var(--accent)';
  }
  
  updateCommsTypeDisplay();
}

function selectTone(tone, button) {
  currentTone = tone;
  
  // Update button styles
  document.querySelectorAll('.tone-btn').forEach(btn => {
    btn.classList.remove('active');
    btn.style.background = 'rgba(255,255,255,0.05)';
    btn.style.border = '1px solid rgba(255,255,255,0.1)';
    btn.style.color = 'inherit';
  });
  
  button.classList.add('active');
  button.style.background = 'rgba(45,212,255,0.2)';
  button.style.border = '2px solid var(--accent)';
  button.style.color = 'var(--accent)';
}

function updateCommsTypeDisplay() {
  const typeNames = {
    'email': 'Professional Email',
    'linkedin': 'LinkedIn Message',
    'followup': 'Follow-up Email',
    'thankyou': 'Thank You Note',
    'apology': 'Professional Apology'
  };
  
  document.getElementById('current-comms-type').textContent = 
    typeNames[currentCommsType] || 'Professional Communication';
}

function generateCommunication() {
  const recipient = document.getElementById('et-recipient').value.trim();
  const relationship = document.getElementById('et-relationship').value;
  const purpose = document.getElementById('et-purpose').value.trim();
  const details = document.getElementById('et-details').value.trim();
  
  if (!recipient || !purpose) {
    alert('Please fill in recipient and purpose fields');
    return;
  }
  
  // Generate the message based on type and tone
  let message = '';
  const detailsArray = details.split('\n').filter(d => d.trim());
  
  switch(currentCommsType) {
    case 'email':
      message = generateEmail(recipient, relationship, purpose, detailsArray);
      break;
    case 'linkedin':
      message = generateLinkedIn(recipient, relationship, purpose, detailsArray);
      break;
    case 'followup':
      message = generateFollowUp(recipient, relationship, purpose, detailsArray);
      break;
    case 'thankyou':
      message = generateThankYou(recipient, relationship, purpose, detailsArray);
      break;
    case 'apology':
      message = generateApology(recipient, relationship, purpose, detailsArray);
      break;
  }
  
  // Display the message
  const output = document.getElementById('et-output');
  output.value = message;
  
  // Update counts
  updateCounts();
  
  // Show results section
  const resultsSection = document.getElementById('results-section');
  resultsSection.style.display = 'block';
  resultsSection.style.opacity = '0';
  resultsSection.style.transform = 'translateY(10px)';
  
  setTimeout(() => {
    resultsSection.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
    resultsSection.style.opacity = '1';
    resultsSection.style.transform = 'translateY(0)';
    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 10);
  
  // Show tone analysis
  document.getElementById('tone-analysis').style.display = 'block';
}

function generateEmail(recipient, relationship, purpose, details) {
  const greetings = {
    formal: 'Dear',
    professional: 'Hello',
    friendly: 'Hi'
  };
  
  const closings = {
    formal: 'Sincerely',
    professional: 'Best regards',
    friendly: 'Best'
  };
  
  const greeting = `${greetings[currentTone] || 'Hello'} ${recipient},`;
  const closing = `${closings[currentTone] || 'Best regards'},\n[Your Name]\n[Your Title]\n[Your Company]\n[Your Contact Information]`;
  
  let body = '';
  
  // Opening based on relationship
  if (relationship === 'new') {
    body += `I hope this message finds you well. `;
  } else if (relationship === 'client') {
    body += `I hope you're having a productive week. `;
  } else {
    body += `I hope you're doing well. `;
  }
  
  // Main purpose
  body += `I'm writing to ${purpose.toLowerCase()}.\n\n`;
  
  // Add details if provided
  if (details.length > 0) {
    body += `Here are the key details:\n`;
    details.forEach(detail => {
      body += `â€¢ ${detail}\n`;
    });
    body += `\n`;
  }
  
  // Closing based on purpose
  if (purpose.toLowerCase().includes('meeting') || purpose.toLowerCase().includes('connect')) {
    body += `Please let me know what time works best for you, and I'll make sure to accommodate your schedule.\n\n`;
    body += `I look forward to hearing from you.\n\n`;
  } else if (purpose.toLowerCase().includes('follow') || purpose.toLowerCase().includes('update')) {
    body += `Could you please provide an update when you have a moment?\n\n`;
    body += `Thank you for your attention to this matter.\n\n`;
  } else if (purpose.toLowerCase().includes('request') || purpose.toLowerCase().includes('ask')) {
    body += `I would greatly appreciate your assistance with this.\n\n`;
    body += `Please let me know if you need any additional information from my side.\n\n`;
  } else {
    body += `Please don't hesitate to reach out if you have any questions.\n\n`;
    body += `Looking forward to your response.\n\n`;
  }
  
  // Generate subject line
  const subject = generateSubjectLine(purpose, relationship);
  
  return `Subject: ${subject}\n\n${greeting}\n\n${body}${closing}`;
}

function generateLinkedIn(recipient, relationship, purpose, details) {
  let message = '';
  
  if (relationship === 'new') {
    message += `Hi ${recipient},\n\n`;
    message += `I came across your profile and was impressed by your experience in [their field/company]. `;
    message += `I'm reaching out because ${purpose.toLowerCase()}.\n\n`;
  } else {
    message += `Hi ${recipient},\n\n`;
    message += `Hope you're doing well! `;
    message += `I wanted to connect regarding ${purpose.toLowerCase()}.\n\n`;
  }
  
  if (details.length > 0) {
    message += `A few quick details:\n`;
    details.forEach(detail => {
      message += `â€¢ ${detail}\n`;
    });
    message += `\n`;
  }
  
  message += `Would you be open to connecting and potentially [specific ask, e.g., having a brief chat, sharing insights]?\n\n`;
  message += `Looking forward to hearing from you.\n\n`;
  message += `Best regards,\n[Your Name]\n[Your Position]\n[LinkedIn Profile URL]`;
  
  return message;
}

function generateFollowUp(recipient, relationship, purpose, details) {
  const timeFrames = ['a few days', 'last week', 'recently', 'earlier'];
  const timeFrame = timeFrames[Math.floor(Math.random() * timeFrames.length)];
  
  let message = `Subject: Following up: ${purpose}\n\n`;
  message += `Hi ${recipient},\n\n`;
  message += `I hope this message finds you well. `;
  message += `I wanted to follow up regarding our ${timeFrame} conversation about ${purpose.toLowerCase()}.\n\n`;
  
  if (details.length > 0) {
    message += `To recap our discussion:\n`;
    details.forEach(detail => {
      message += `â€¢ ${detail}\n`;
    });
    message += `\n`;
  }
  
  message += `I understand you're likely busy, but I wanted to check if there are any updates or if you need any additional information from me.\n\n`;
  message += `Please let me know when would be a convenient time to discuss this further.\n\n`;
  message += `Best regards,\n[Your Name]`;
  
  return message;
}

function generateThankYou(recipient, relationship, purpose, details) {
  let message = `Subject: Thank you - ${purpose}\n\n`;
  message += `Dear ${recipient},\n\n`;
  message += `I wanted to express my sincere gratitude for ${purpose.toLowerCase()}.\n\n`;
  
  if (details.length > 0) {
    message += `Specifically, I really appreciated:\n`;
    details.forEach(detail => {
      message += `â€¢ ${detail}\n`;
    });
    message += `\n`;
  }
  
  message += `Your [support/guidance/assistance] means a great deal and [specific impact, e.g., made a significant difference in the project's success, helped me better understand...].\n\n`;
  message += `Thank you again for your time and consideration.\n\n`;
  message += `Warm regards,\n[Your Name]`;
  
  return message;
}

function generateApology(recipient, relationship, purpose, details) {
  let message = `Subject: Apology - ${purpose}\n\n`;
  message += `Dear ${recipient},\n\n`;
  message += `I am writing to sincerely apologize for ${purpose.toLowerCase()}.\n\n`;
  
  if (details.length > 0) {
    message += `I understand that:\n`;
    details.forEach(detail => {
      message += `â€¢ ${detail}\n`;
    });
    message += `\n`;
  }
  
  message += `Please know that this does not reflect my usual standards, and I take full responsibility for [the issue/mistake]. `;
  message += `I have [specific action taken to prevent recurrence, e.g., implemented additional checks, revised procedures] to ensure this doesn't happen again.\n\n`;
  message += `I value our [relationship/partnership] and hope we can move forward from this. `;
  message += `Please let me know if there's anything specific I can do to make this right.\n\n`;
  message += `Sincerely,\n[Your Name]`;
  
  return message;
}

function generateSubjectLine(purpose, relationship) {
  const purposeWords = purpose.toLowerCase().split(' ');
  const keyWords = purposeWords.slice(0, Math.min(4, purposeWords.length)).join(' ');
  
  const prefixes = {
    'new': 'Introduction: ',
    'client': 'Regarding our project: ',
    'colleague': 'Update: ',
    'manager': 'Request: ',
    'vendor': 'Inquiry: ',
    'recruiter': 'Opportunity: '
  };
  
  const prefix = prefixes[relationship] || '';
  
  // Capitalize first letter of each word for professional look
  const formattedPurpose = keyWords.split(' ')
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
  
  return prefix + formattedPurpose;
}

function updateCounts() {
  const text = document.getElementById('et-output').value;
  const words = text.trim().split(/\s+/).filter(word => word.length > 0).length;
  const chars = text.length;
  
  document.getElementById('et-wordcount').textContent = words;
  document.getElementById('et-charcount').textContent = chars;
  
  // Calculate reading time (average 200 words per minute)
  const readingMinutes = Math.ceil(words / 200);
  document.getElementById('read-time').textContent = 
    `Reading time: ${readingMinutes} min${readingMinutes !== 1 ? 's' : ''}`;
}

function copyToClipboard() {
  const text = document.getElementById('et-output').value;
  if (!text.trim()) {
    alert('No message to copy');
    return;
  }
  
  navigator.clipboard.writeText(text).then(() => {
    const button = event.target;
    const original = button.innerHTML;
    button.innerHTML = 'âœ… Copied!';
    setTimeout(() => {
      button.innerHTML = original;
    }, 2000);
  });
}

function clearMessage() {
  document.getElementById('et-output').value = '';
  updateCounts();
}

function generateSignature() {
  const name = document.getElementById('sig-name').value.trim();
  const title = document.getElementById('sig-title').value.trim();
  
  if (!name) {
    alert('Please enter your name');
    return;
  }
  
  const signature = `
${name}
${title ? title + '\n' : ''}${title ? '[Your Company]\n' : ''}
ğŸ“§ [your.email@example.com]
ğŸ“± [Your Phone Number]
ğŸ“ [Your Location]

[LinkedIn Profile URL]
[Company Website]`;
  
  const output = document.getElementById('signature-output');
  output.textContent = signature;
  output.style.display = 'block';
}

function exportCommunication() {
  const text = document.getElementById('et-output').value;
  if (!text.trim()) {
    alert('No message to export');
    return;
  }
  
  const blob = new Blob([text], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const date = new Date().toISOString().split('T')[0];
  
  a.href = url;
  a.download = `Communication_${currentCommsType}_${date}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

function scheduleReminder() {
  const days = prompt('How many days from now should I remind you to follow up?', '3');
  if (days && !isNaN(days) && parseInt(days) > 0) {
    const reminderDate = new Date();
    reminderDate.setDate(reminderDate.getDate() + parseInt(days));
    
    alert(`âœ… Reminder set for ${reminderDate.toLocaleDateString()}!\n\nI'll remind you to follow up on this communication.`);
    
    // In a real implementation, you'd use localStorage or a backend service
    localStorage.setItem('communication_reminder', JSON.stringify({
      date: reminderDate.toISOString(),
      type: currentCommsType,
      recipient: document.getElementById('et-recipient').value
    }));
  }
}

function resetGenerator() {
  document.getElementById('et-recipient').value = '';
  document.getElementById('et-purpose').value = '';
  document.getElementById('et-details').value = '';
  document.getElementById('et-output').value = '';
  document.getElementById('signature-output').style.display = 'none';
  document.getElementById('results-section').style.display = 'none';
  updateCounts();
}

function loadTemplate(template) {
  const templates = {
    'meeting': {
      recipient: 'Meeting Organizer',
      purpose: 'schedule a meeting to discuss project milestones and next steps',
      details: 'Need to align on Q3 deliverables\nReview budget allocation\nDiscuss team resources'
    },
    'status': {
      recipient: 'Project Stakeholders',
      purpose: 'provide a status update on the current project phase',
      details: 'Phase 1 completed on schedule\nCurrent blockers: resource allocation\nNext milestone: June 15'
    },
    'intro': {
      recipient: 'Potential Connection',
      purpose: 'introduce myself and explore potential collaboration opportunities',
      details: 'Mutual connection: Jane Smith\nShared interest: AI in healthcare\nPotential synergy: data analysis'
    },
    'feedback': {
      recipient: 'Team Member',
      purpose: 'request feedback on the recent project presentation',
      details: 'Specific areas: clarity of content\nPresentation delivery\nSlide design effectiveness'
    }
  };
  
  if (templates[template]) {
    const t = templates[template];
    document.getElementById('et-recipient').value = t.recipient;
    document.getElementById('et-purpose').value = t.purpose;
    document.getElementById('et-details').value = t.details;
    
    // Auto-select email type and formal tone for templates
    selectCommsType('email', document.querySelector('[data-type="email"]'));
    selectTone('professional', document.querySelector('[data-tone="professional"]'));
  }
}

// Add hover effects
document.addEventListener('mouseover', function(e) {
  if (e.target.classList.contains('comms-btn') && !e.target.classList.contains('active')) {
    e.target.style.transform = 'translateY(-4px)';
    e.target.style.boxShadow = '0 8px 25px rgba(45,212,255,0.15)';
  }
  
  if (e.target.closest('[onclick^="loadTemplate"]')) {
    e.target.closest('[onclick^="loadTemplate"]').style.transform = 'translateY(-4px)';
    e.target.closest('[onclick^="loadTemplate"]').style.boxShadow = '0 8px 25px rgba(0,0,0,0.2)';
  }
});

document.addEventListener('mouseout', function(e) {
  if (e.target.classList.contains('comms-btn') && !e.target.classList.contains('active')) {
    e.target.style.transform = 'translateY(0)';
    e.target.style.boxShadow = 'none';
  }
  
  if (e.target.closest('[onclick^="loadTemplate"]')) {
    e.target.closest('[onclick^="loadTemplate"]').style.transform = 'translateY(0)';
    e.target.closest('[onclick^="loadTemplate"]').style.boxShadow = 'none';
  }
});

</script>

<style>
/* Professional styling */
.comms-btn, .tone-btn {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.comms-btn:hover, .tone-btn:hover {
  transform: translateY(-4px) !important;
  box-shadow: 0 8px 25px rgba(45,212,255,0.2) !important;
}

input, select, textarea {
  transition: all 0.2s ease;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--accent) !important;
  box-shadow: 0 0 0 2px rgba(45,212,255,0.2);
}

/* Smooth animations */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

#results-section {
  animation: fadeIn 0.5s ease-out;
}

/* Responsive design */
@media (max-width: 768px) {
  .comms-selector > div {
    grid-template-columns: repeat(2, 1fr) !important;
  }
  
  .input-section > div > div {
    grid-template-columns: 1fr !important;
  }
  
  .tone-btn {
    padding: 8px 4px !important;
    font-size: 0.9em;
  }
}

/* Print styles */
@media print {
  .comms-selector, button {
    display: none !important;
  }
  
  #results-section {
    display: block !important;
    border: none !important;
    padding: 0 !important;
  }
  
  #et-output {
    border: 1px solid #000 !important;
    background: white !important;
    color: black !important;
  }
}
</style>
