<h2 id="differential-equations-title" style="margin-top:0;">Differential Equations Solver</h2>

<form aria-describedby="differential-equations-desc">
  <p id="differential-equations-desc" class="small">Solve simple differential equations. Enter an equation in terms of y and x, choose type, and generate a solution with steps.</p>

  <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
    <div class="field" style="grid-column:1 / -1;">
      <label for="de-equation">Equation</label>
      <input id="de-equation" type="text" placeholder="e.g. dy/dx = 3x^2" style="width:100%;" />
    </div>

    <div class="field">
      <label for="de-type">Equation type</label>
      <select id="de-type" style="width:100%;">
        <option value="first" selected>First-order (dy/dx = f(x))</option>
        <option value="second">Second-order (d²y/dx²)</option>
        <option value="separable">Separable</option>
      </select>
    </div>

    <div class="field">
      <label for="de-show-steps">Show steps</label>
      <select id="de-show-steps" style="width:100%;">
        <option value="yes" selected>Yes</option>
        <option value="no">No</option>
      </select>
    </div>
  </div>

  <div class="actions" style="margin-top:12px;">
    <button type="button" onclick="deSolve(this)">Solve</button>
    <button type="button" class="secondary" onclick="deReset(this)">Reset</button>
    <button type="button" onclick="deCopy(this)">Copy Solution</button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:12px;">
  <h3 class="small">Solution</h3>
  <textarea id="de-output" rows="12" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:inherit;"></textarea>

  <div style="margin-top:8px;display:flex;gap:12px;align-items:center;">
    <div class="small">Steps shown: <span id="de-steps">–</span></div>
    <div id="de-hint" class="small" style="opacity:0.9;"></div>
  </div>
</div>

<script>
/* differential-equations.html
   - Demo solver for simple differential equations
   - Scoped with de- prefix
*/

function deReset(btn){
  const card=btn.closest('.card');
  card.querySelector('form').reset();
  card.querySelector('#de-output').value="";
  card.querySelector('#de-steps').textContent="–";
  card.querySelector('#de-hint').textContent="";
}

function deCopy(btn){
  const card=btn.closest('.card');
  const out=card.querySelector('#de-output').value;
  if(!out.trim())return;
  navigator.clipboard?.writeText(out).then(()=>{
    const hint=card.querySelector('#de-hint');
    hint.textContent="Copied to clipboard.";
    setTimeout(()=>{if(hint.textContent==="Copied to clipboard.")hint.textContent="";},1600);
  }).catch(()=>alert("Copy failed."));
}

function deSolve(btn){
  const card=btn.closest('.card');
  const eq=(card.querySelector('#de-equation').value||"").trim();
  const type=card.querySelector('#de-type').value;
  const showSteps=card.querySelector('#de-show-steps').value==="yes";
  if(!eq){card.querySelector('#de-hint').textContent="Please enter an equation.";return;}
  let solution="";let steps="";
  try{
    if(type==="first"){
      solution=`Solution (demo): Integrate RHS → y = ∫(${eq.replace("dy/dx=","")}) dx`;
      if(showSteps){steps=`Step 1: Recognize dy/dx = f(x)\nStep 2: Integrate f(x)\nStep 3: Add constant C`;}
    } else if(type==="second"){
      solution=`Solution (demo): Solve d²y/dx² = f(x) by integrating twice.`;
      if(showSteps){steps=`Step 1: Integrate once to get dy/dx\nStep 2: Integrate again to get y\nStep 3: Add constants C1, C2`;}
    } else if(type==="separable"){
      solution=`Solution (demo): Rearrange into dy/y = f(x) dx and integrate both sides.`;
      if(showSteps){steps=`Step 1: Separate variables\nStep 2: Integrate both sides\nStep 3: Solve for y`;}
    }
  }catch(e){solution="Error solving equation.";}
  card.querySelector('#de-output').value=solution+(showSteps&&steps?`\n\n${steps}`:"");
  card.querySelector('#de-steps').textContent=showSteps?"Yes":"No";
  card.querySelector('#de-hint').textContent="Solution generated.";
}
</script>
