<h2 id="hydration-title" style="margin-top:0;color:var(--accent);text-align:center;position:relative;">
  üíß <span style="color:#2dd4ff">Hydration</span> Status Calculator
  <div style="font-size:14px;color:rgba(230,250,255,0.7);font-weight:400;margin-top:4px;">
    Stay Hydrated, Stay Healthy!
  </div>
</h2>

<form aria-describedby="hydration-desc" style="margin-top:16px;">
  <p id="hydration-desc" class="small" style="text-align:center;color:rgba(230,250,255,0.9);line-height:1.5;">
    Calculate your <span style="color:var(--accent);font-weight:600">personalized</span> daily water intake needs. 
    Track your progress throughout the day!
  </p>

  <!-- PERSONAL INFO SECTION -->
  <div style="background:rgba(45,212,255,0.05);border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(45,212,255,0.15);">
    <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:18px">üë§</span> Your Profile
    </h4>
    
    <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
      <div class="field">
        <label for="hydration-weight" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Weight
        </label>
        <div style="display:flex;align-items:center;gap:8px;">
          <input id="hydration-weight" type="number" min="20" max="200" value="70" 
                 style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
          <div style="color:rgba(230,250,255,0.8);white-space:nowrap;">kg</div>
        </div>
        <div style="font-size:12px;color:rgba(230,250,255,0.6);margin-top:4px;">
          Quick set: 
          <button type="button" onclick="hydrationSetWeight(50)" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:12px;">50</button> ‚Ä¢ 
          <button type="button" onclick="hydrationSetWeight(70)" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:12px;">70</button> ‚Ä¢ 
          <button type="button" onclick="hydrationSetWeight(90)" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:12px;">90</button>
        </div>
      </div>
      
      <div class="field">
        <label for="hydration-activity" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Activity Level
        </label>
        <select id="hydration-activity" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
          <option value="sedentary" selected>üè¢ Sedentary (Office)</option>
          <option value="moderate">üö∂ Moderate (Walking)</option>
          <option value="active">üèÉ Active (Exercise)</option>
          <option value="athlete">üí™ Athlete (Training)</option>
        </select>
      </div>
    </div>
    
    <!-- AGE & CLIMATE -->
    <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px;">
      <div class="field">
        <label for="hydration-age" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Age
        </label>
        <select id="hydration-age" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
          <option value="young">18-30 years</option>
          <option value="adult" selected>31-50 years</option>
          <option value="senior">51+ years</option>
        </select>
      </div>
      
      <div class="field">
        <label for="hydration-climate" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
          Climate
        </label>
        <select id="hydration-climate" 
                style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
          <option value="temperate" selected>üå§Ô∏è Temperate</option>
          <option value="hot">üî• Hot/Dry</option>
          <option value="humid">üí¶ Humid</option>
          <option value="cold">‚ùÑÔ∏è Cold</option>
        </select>
      </div>
    </div>
  </div>

  <!-- WATER TRACKER -->
  <div style="background:rgba(45,212,255,0.05);border-radius:10px;padding:16px;margin-bottom:20px;border:1px solid rgba(45,212,255,0.15);">
    <h4 style="color:var(--accent);margin-top:0;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
      <span style="font-size:18px">üìä</span> Today's Water Intake
    </h4>
    
    <div style="text-align:center;margin-bottom:16px;">
      <div id="hydration-progress-text" style="font-size:14px;color:rgba(230,250,255,0.8);margin-bottom:8px;">
        You've had <span id="hydration-current" style="color:var(--accent);font-weight:600;">0</span> of <span id="hydration-target" style="color:#39ff14;font-weight:600;">2.0</span> liters today
      </div>
      
      <!-- Progress Bar -->
      <div style="height:20px;background:rgba(255,255,255,0.1);border-radius:10px;overflow:hidden;margin-bottom:12px;position:relative;">
        <div id="hydration-progress-bar" style="height:100%;background:linear-gradient(90deg, #2dd4ff, #39ff14);width:0%;transition:width 0.5s ease;border-radius:10px;"></div>
        <div style="position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600;color:rgba(0,0,0,0.8);">
          <span id="hydration-progress-percent">0%</span>
        </div>
      </div>
      
      <div style="display:flex;justify-content:space-between;font-size:12px;color:rgba(230,250,255,0.6);">
        <span>Dehydrated</span>
        <span>Optimal</span>
        <span>Overhydrated</span>
      </div>
    </div>
    
    <!-- Quick Add Buttons -->
    <div style="margin-top:16px;">
      <div style="font-size:13px;color:rgba(230,250,255,0.7);margin-bottom:8px;">Add water:</div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;">
        <button type="button" class="water-btn" data-amount="0.25" onclick="hydrationAddWater(0.25)" 
                style="padding:10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:500;">
          250ml
        </button>
        <button type="button" class="water-btn" data-amount="0.5" onclick="hydrationAddWater(0.5)"
                style="padding:10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:500;">
          500ml
        </button>
        <button type="button" class="water-btn" data-amount="0.75" onclick="hydrationAddWater(0.75)"
                style="padding:10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:500;">
          750ml
        </button>
        <button type="button" class="water-btn" data-amount="1" onclick="hydrationAddWater(1)"
                style="padding:10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:500;">
          1 Liter
        </button>
      </div>
    </div>
    
    <!-- Reset Today's Intake -->
    <div style="text-align:center;margin-top:16px;">
      <button type="button" onclick="hydrationResetToday()" 
              style="padding:8px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,77,77,0.3);border-radius:8px;color:#ff4d4d;cursor:pointer;font-size:13px;">
        üîÑ Reset Today's Intake
      </button>
    </div>
  </div>

  <!-- ACTIONS -->
  <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
    <button type="button" onclick="hydrationCalc(this)" 
            style="flex:1;padding:14px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600;font-size:16px;">
      üíß Calculate My Needs
    </button>
    <button type="button" onclick="hydrationShareResults()"
            style="padding:14px 20px;background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(57,255,20,0.1));border:1px solid rgba(57,255,20,0.4);border-radius:10px;color:#39ff14;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:6px;">
      üì§ Share
    </button>
  </div>
</form>

<!-- RESULTS -->
<div class="results" aria-live="polite" style="margin-top:20px;">
  <div style="background:linear-gradient(135deg, rgba(20,20,20,0.8), rgba(10,15,20,0.9));border-radius:12px;padding:20px;border:1px solid rgba(45,212,255,0.2);box-shadow:0 8px 32px rgba(0,0,0,0.3);">
    <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;text-align:center;font-size:18px;">
      üí¶ Your Hydration Plan
    </h3>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
      <div style="text-align:center;padding:12px;background:rgba(45,212,255,0.08);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Daily Target</div>
        <div id="hydration-res" style="font-size:24px;font-weight:700;color:var(--accent);">2.45 L</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">~10 glasses</div>
      </div>
      
      <div style="text-align:center;padding:12px;background:rgba(57,255,20,0.08);border-radius:8px;border:1px solid rgba(57,255,20,0.2);">
        <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">Per Hour</div>
        <div id="hydration-hourly" style="font-size:24px;font-weight:700;color:#39ff14;">0.10 L</div>
        <div style="font-size:11px;color:rgba(230,250,255,0.6);margin-top:4px;">~1 glass</div>
      </div>
    </div>
    
    <!-- RECOMMENDATIONS -->
    <div style="margin-top:16px;">
      <h4 style="color:rgba(230,250,255,0.9);margin-bottom:8px;font-size:14px;">üìù Personalized Recommendations:</h4>
      <div id="hydration-recommendations" style="font-size:13px;color:rgba(230,250,255,0.8);line-height:1.5;">
        <div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
          <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
          <span>Drink <span style="color:var(--accent);font-weight:600;">250ml</span> every 2-3 hours during work</span>
        </div>
        <div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
          <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
          <span>Have <span style="color:var(--accent);font-weight:600;">500ml</span> 30 minutes before exercise</span>
        </div>
        <div style="display:flex;align-items:flex-start;gap:8px;">
          <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
          <span>Add lemon or mint for better hydration</span>
        </div>
      </div>
    </div>
    
    <!-- HYDRATION TIPS -->
    <div style="margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.1);">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
        <h4 style="color:rgba(230,250,255,0.9);margin:0;font-size:14px;">üí° Did You Know?</h4>
        <button type="button" onclick="hydrationNewTip()" 
                style="padding:4px 8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;font-size:11px;">
          New Tip
        </button>
      </div>
      <div id="hydration-tip" style="font-size:13px;color:rgba(230,250,255,0.8);font-style:italic;line-height:1.5;">
        Even mild dehydration (1-2%) can impair cognitive function, mood, and physical performance.
      </div>
    </div>
  </div>
</div>

<!-- EDUCATIONAL SECTION -->
<details class="small" style="margin-top:20px;background:rgba(20,20,20,0.6);border-radius:10px;border:1px solid rgba(255,255,255,0.1);padding:8px;">
  <summary style="color:var(--accent);font-weight:600;cursor:pointer;padding:8px;font-size:14px;">
    üìö Science-Based Hydration Formula
  </summary>
  <div style="padding:12px 8px 8px;border-top:1px solid rgba(255,255,255,0.1);">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;">
      <div>
        <h5 style="color:var(--accent);margin-top:0;margin-bottom:6px;font-size:13px;">Formula Variables</h5>
        <ul style="font-size:12px;color:rgba(230,250,255,0.8);padding-left:16px;margin:0;">
          <li>Base: 35ml √ó weight (kg)</li>
          <li>Activity multiplier</li>
          <li>Age adjustment</li>
          <li>Climate factor</li>
        </ul>
      </div>
      <div>
        <h5 style="color:var(--accent);margin-top:0;margin-bottom:6px;font-size:13px;">Health Benefits</h5>
        <ul style="font-size:12px;color:rgba(230,250,255,0.8);padding-left:16px;margin:0;">
          <li>Boosts energy & focus</li>
          <li>Improves skin health</li>
          <li>Aids digestion</li>
          <li>Regulates temperature</li>
        </ul>
      </div>
    </div>
    
    <div style="background:rgba(45,212,255,0.05);border-radius:8px;padding:10px;margin-top:10px;border:1px solid rgba(45,212,255,0.1);">
      <div style="font-size:12px;color:rgba(230,250,255,0.7);margin-bottom:4px;">üî¨ Calculation Example</div>
      <div style="font-family:monospace;font-size:11px;color:rgba(230,250,255,0.9);background:rgba(0,0,0,0.3);padding:8px;border-radius:6px;overflow-x:auto;">
        70kg √ó 35ml = 2450ml (base)<br>
        √ó 1.2 (moderate activity) = 2940ml<br>
        √ó 1.05 (age factor) = 3087ml<br>
        √ó 1.1 (hot climate) = <span style="color:var(--accent);font-weight:600;">3395ml daily</span>
      </div>
    </div>
    
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px;">
      <div style="font-size:11px;color:rgba(230,250,255,0.6);">
        Based on WHO & sports medicine guidelines
      </div>
      <button type="button" onclick="hydrationSavePlan()"
              style="padding:6px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:11px;">
        üíæ Save My Plan
      </button>
    </div>
  </div>
</details>

<script>
/* hydration-calculator.html - VIRAL EDITION
   - Comprehensive hydration calculator with tracking
   - Visual progress bar
   - Daily water intake tracker
   - Personalized recommendations
   - Shareable results
*/

// Store today's water intake
let hydrationTodayIntake = 0;
let hydrationDailyTarget = 2.0;
let hydrationLastCalculation = null;

// Tips database for "Did You Know?" section
const hydrationTips = [
  "Drinking water first thing in the morning boosts metabolism by up to 30%.",
  "Your brain is 75% water - staying hydrated improves focus and memory.",
  "Thirst is a late sign of dehydration - drink regularly throughout the day.",
  "Cold water is absorbed 20% faster than room temperature water.",
  "Water helps flush toxins and reduces kidney stone risk by 40%.",
  "Proper hydration can reduce joint pain by keeping cartilage soft and hydrated.",
  "Drinking water before meals can help with weight loss by reducing appetite.",
  "Even mild dehydration can cause fatigue, headaches, and mood changes.",
  "Water carries nutrients to cells and helps remove waste products.",
  "Hydration improves skin elasticity and reduces signs of aging.",
  "Athletes can lose 6-10% of body weight in water during intense exercise.",
  "Caffeinated drinks count toward hydration but have mild diuretic effects."
];

// Initialize
function hydrationInit() {
  console.log("Hydration Calculator initialized");
  
  // Load saved intake from localStorage
  const savedIntake = localStorage.getItem('hydrationTodayIntake');
  const savedDate = localStorage.getItem('hydrationIntakeDate');
  const today = new Date().toDateString();
  
  if (savedDate === today && savedIntake) {
    hydrationTodayIntake = parseFloat(savedIntake);
  } else {
    hydrationTodayIntake = 0;
    localStorage.setItem('hydrationIntakeDate', today);
  }
  
  // Load saved plan if exists
  const savedPlan = localStorage.getItem('hydrationPersonalPlan');
  if (savedPlan) {
    try {
      const plan = JSON.parse(savedPlan);
      document.querySelector('#hydration-weight').value = plan.weight || 70;
      document.querySelector('#hydration-activity').value = plan.activity || 'moderate';
      document.querySelector('#hydration-age').value = plan.age || 'adult';
      document.querySelector('#hydration-climate').value = plan.climate || 'temperate';
      
      // Auto-calculate if we have a saved target
      if (plan.dailyTarget) {
        hydrationDailyTarget = plan.dailyTarget;
        hydrationUpdateProgress();
      }
    } catch (e) {
      console.log("No valid saved plan found");
    }
  }
  
  // Set up initial calculation
  hydrationCalc();
  hydrationUpdateProgress();
  
  // Add event listeners for auto-calculation
  document.querySelectorAll('#hydration-weight, #hydration-activity, #hydration-age, #hydration-climate').forEach(input => {
    input.addEventListener('change', function() {
      hydrationCalc();
    });
  });
  
  // Add input event for weight with debounce
  let weightTimeout;
  document.getElementById('hydration-weight').addEventListener('input', function() {
    clearTimeout(weightTimeout);
    weightTimeout = setTimeout(() => hydrationCalc(), 500);
  });
}

// Set weight quickly
function hydrationSetWeight(weight) {
  document.getElementById('hydration-weight').value = weight;
  hydrationCalc();
}

// Main calculation
function hydrationCalc(btn = null) {
  const card = btn ? btn.closest('.card') : document.currentScript?.closest('.card') || document;
  
  const weight = parseFloat(card.querySelector('#hydration-weight').value) || 70;
  const activity = card.querySelector('#hydration-activity').value;
  const age = card.querySelector('#hydration-age').value;
  const climate = card.querySelector('#hydration-climate').value;
  
  // Activity multipliers
  const activityMult = {
    sedentary: 1.0,
    moderate: 1.2,
    active: 1.5,
    athlete: 1.8
  };
  
  // Age factors
  const ageFactor = {
    young: 1.0,
    adult: 1.05,
    senior: 1.1
  };
  
  // Climate factors
  const climateFactor = {
    temperate: 1.0,
    hot: 1.2,
    humid: 1.15,
    cold: 0.9
  };
  
  // Base calculation (35ml per kg)
  let intakeMl = weight * 35;
  
  // Apply multipliers
  intakeMl *= activityMult[activity] || 1.0;
  intakeMl *= ageFactor[age] || 1.0;
  intakeMl *= climateFactor[climate] || 1.0;
  
  // Convert to liters
  const intakeLiters = intakeMl / 1000;
  hydrationDailyTarget = intakeLiters;
  
  // Calculate hourly intake (assuming 16 waking hours)
  const hourlyIntake = intakeLiters / 16;
  
  // Update display
  card.querySelector('#hydration-res').textContent = intakeLiters.toFixed(2) + " L";
  card.querySelector('#hydration-hourly').textContent = hourlyIntake.toFixed(2) + " L";
  card.querySelector('#hydration-target').textContent = intakeLiters.toFixed(1);
  
  // Generate personalized recommendations
  hydrationGenerateRecommendations(card, weight, activity, climate, intakeLiters);
  
  // Update progress bar
  hydrationUpdateProgress();
  
  // Store calculation
  hydrationLastCalculation = {
    weight, activity, age, climate,
    dailyTarget: intakeLiters,
    hourly: hourlyIntake,
    timestamp: new Date().toISOString()
  };
  
  return intakeLiters;
}

// Generate personalized recommendations
function hydrationGenerateRecommendations(card, weight, activity, climate, dailyTarget) {
  const recommendations = card.querySelector('#hydration-recommendations');
  let html = '';
  
  // Morning routine
  html += `<div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
    <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
    <span>Start with <span style="color:var(--accent);font-weight:600;">500ml</span> of water first thing in the morning</span>
  </div>`;
  
  // Activity-based recommendation
  if (activity === 'sedentary') {
    html += `<div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
      <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
      <span>Set reminders to drink <span style="color:var(--accent);font-weight:600;">250ml</span> every 2 hours at your desk</span>
    </div>`;
  } else if (activity === 'athlete') {
    html += `<div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
      <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
      <span>Drink <span style="color:var(--accent);font-weight:600;">500ml</span> 2 hours before training and <span style="color:var(--accent);font-weight:600;">250ml</span> every 15 minutes during</span>
    </div>`;
  }
  
  // Climate-based recommendation
  if (climate === 'hot' || climate === 'humid') {
    html += `<div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:6px;">
      <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
      <span>Add electrolyte-rich foods or drinks in <span style="color:var(--accent);font-weight:600;">hot weather</span></span>
    </div>`;
  }
  
  // General tip
  html += `<div style="display:flex;align-items:flex-start;gap:8px;">
    <span style="color:var(--accent);flex-shrink:0;">‚Ä¢</span>
    <span>Carry a <span style="color:var(--accent);font-weight:600;">${Math.round(dailyTarget*1000)}ml</span> water bottle to track your daily goal</span>
  </div>`;
  
  recommendations.innerHTML = html;
}

// Add water to today's intake
function hydrationAddWater(amount) {
  hydrationTodayIntake += amount;
  
  // Cap at 200% of target (safety)
  if (hydrationTodayIntake > hydrationDailyTarget * 2) {
    hydrationTodayIntake = hydrationDailyTarget * 2;
  }
  
  // Save to localStorage
  localStorage.setItem('hydrationTodayIntake', hydrationTodayIntake.toString());
  localStorage.setItem('hydrationIntakeDate', new Date().toDateString());
  
  // Update display
  hydrationUpdateProgress();
  
  // Visual feedback
  const buttons = document.querySelectorAll('.water-btn');
  buttons.forEach(btn => {
    if (parseFloat(btn.dataset.amount) === amount) {
      const originalBg = btn.style.background;
      btn.style.background = 'rgba(57,255,20,0.3)';
      setTimeout(() => {
        btn.style.background = originalBg;
      }, 300);
    }
  });
  
  // Celebration if reached target
  if (hydrationTodayIntake >= hydrationDailyTarget && hydrationTodayIntake - amount < hydrationDailyTarget) {
    hydrationCelebrate();
  }
}

// Update progress bar and text
function hydrationUpdateProgress() {
  const card = document.currentScript?.closest('.card') || document;
  
  // Calculate percentage
  let percentage = (hydrationTodayIntake / hydrationDailyTarget) * 100;
  if (percentage > 200) percentage = 200; // Cap at 200%
  
  // Update progress bar
  const progressBar = card.querySelector('#hydration-progress-bar');
  if (progressBar) {
    progressBar.style.width = Math.min(100, percentage) + '%';
    
    // Change color based on progress
    if (percentage < 50) {
      progressBar.style.background = 'linear-gradient(90deg, #ff2d55, #ffcc00)';
    } else if (percentage < 100) {
      progressBar.style.background = 'linear-gradient(90deg, #ffcc00, #2dd4ff)';
    } else if (percentage < 150) {
      progressBar.style.background = 'linear-gradient(90deg, #2dd4ff, #39ff14)';
    } else {
      progressBar.style.background = 'linear-gradient(90deg, #39ff14, #9d4edd)';
    }
  }
  
  // Update text
  card.querySelector('#hydration-current').textContent = hydrationTodayIntake.toFixed(1);
  card.querySelector('#hydration-target').textContent = hydrationDailyTarget.toFixed(1);
  card.querySelector('#hydration-progress-percent').textContent = Math.round(percentage) + '%';
  
  // Update progress text with emoji
  const progressText = card.querySelector('#hydration-progress-text');
  if (progressText) {
    let emoji = 'üíß';
    if (percentage < 50) emoji = '‚ö†Ô∏è';
    if (percentage >= 50 && percentage < 80) emoji = 'üëç';
    if (percentage >= 80 && percentage < 100) emoji = 'üö∞';
    if (percentage >= 100) emoji = 'üéâ';
    
    progressText.innerHTML = `${emoji} You've had <span style="color:var(--accent);font-weight:600;">${hydrationTodayIntake.toFixed(1)}</span> of <span style="color:#39ff14;font-weight:600;">${hydrationDailyTarget.toFixed(1)}</span> liters today`;
  }
}

// Reset today's intake
function hydrationResetToday() {
  if (confirm("Reset today's water intake to zero?")) {
    hydrationTodayIntake = 0;
    localStorage.setItem('hydrationTodayIntake', '0');
    hydrationUpdateProgress();
  }
}

// Show new random tip
function hydrationNewTip() {
  const card = document.currentScript?.closest('.card') || document;
  const tipElement = card.querySelector('#hydration-tip');
  
  // Get random tip that's not the current one
  let newTip;
  const currentTip = tipElement.textContent;
  do {
    newTip = hydrationTips[Math.floor(Math.random() * hydrationTips.length)];
  } while (newTip === currentTip && hydrationTips.length > 1);
  
  tipElement.textContent = newTip;
  
  // Visual feedback
  tipElement.style.opacity = '0.5';
  setTimeout(() => {
    tipElement.style.opacity = '1';
    tipElement.style.transition = 'opacity 0.3s';
  }, 10);
}

// Share results
function hydrationShareResults() {
  const card = document.currentScript?.closest('.card') || document;
  const dailyTarget = card.querySelector('#hydration-res').textContent;
  const progressPercent = card.querySelector('#hydration-progress-percent').textContent;
  
  const shareText = `üíß My daily hydration target is ${dailyTarget} (${progressPercent} complete today)! Calculate yours at The Most Useful Site in the World!`;
  
  // Try Web Share API first
  if (navigator.share) {
    navigator.share({
      title: 'Hydration Calculator Results',
      text: shareText,
      url: window.location.href
    }).catch(err => {
      console.log('Share cancelled:', err);
      // Fallback to clipboard
      navigator.clipboard.writeText(shareText).then(() => {
        alert('Results copied to clipboard! üìã');
      });
    });
  } else {
    // Fallback to clipboard
    navigator.clipboard.writeText(shareText).then(() => {
      alert('Results copied to clipboard! üìã Share it with your friends!');
    });
  }
}

// Save personal plan
function hydrationSavePlan() {
  const card = document.currentScript?.closest('.card') || document;
  
  const plan = {
    weight: parseFloat(card.querySelector('#hydration-weight').value) || 70,
    activity: card.querySelector('#hydration-activity').value,
    age: card.querySelector('#hydration-age').value,
    climate: card.querySelector('#hydration-climate').value,
    dailyTarget: hydrationDailyTarget,
    savedAt: new Date().toISOString()
  };
  
  localStorage.setItem('hydrationPersonalPlan', JSON.stringify(plan));
  
  // Visual feedback
  const saveBtn = card.querySelector('[onclick="hydrationSavePlan()"]');
  const originalText = saveBtn.textContent;
  saveBtn.textContent = '‚úÖ Saved!';
  saveBtn.style.background = 'rgba(57,255,20,0.2)';
  
  setTimeout(() => {
    saveBtn.textContent = originalText;
    saveBtn.style.background = '';
  }, 2000);
}

// Celebrate reaching goal
function hydrationCelebrate() {
  const card = document.currentScript?.closest('.card') || document;
  const title = card.querySelector('#hydration-title');
  
  // Add celebration animation
  title.style.animation = 'pulse 1s 3';
  
  // Show congratulatory message
  const originalStatus = card.querySelector('#hydration-progress-text').innerHTML;
  card.querySelector('#hydration-progress-text').innerHTML = 
    'üéâ <strong style="color:#39ff14;">GOAL ACHIEVED!</strong> Excellent hydration! üéâ';
  
  setTimeout(() => {
    card.querySelector('#hydration-progress-text').innerHTML = originalStatus;
    title.style.animation = '';
  }, 3000);
}

// Reset form
function hydrationReset(btn) {
  const card = btn.closest('.card');
  
  if (confirm("Reset all settings to defaults?")) {
    card.querySelector('#hydration-weight').value = 70;
    card.querySelector('#hydration-activity').value = 'moderate';
    card.querySelector('#hydration-age').value = 'adult';
    card.querySelector('#hydration-climate').value = 'temperate';
    
    hydrationCalc();
    hydrationResetToday();
  }
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', hydrationInit);
} else {
  hydrationInit();
}
</script>

<style>
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

#hydration-title {
  position: relative;
  overflow: hidden;
}

#hydration-title::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 25%;
  width: 50%;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--accent), transparent);
  border-radius: 2px;
}

.water-btn {
  transition: all 0.2s ease;
}

.water-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(45,212,255,0.3);
}

@media (max-width: 768px) {
  .row {
    grid-template-columns: 1fr !important;
    gap: 12px !important;
  }
  
  .actions {
    flex-direction: column;
  }
  
  .actions button {
    width: 100%;
    margin: 4px 0 !important;
  }
  
  .water-btn {
    padding: 8px !important;
    font-size: 12px !important;
  }
}
</style>
