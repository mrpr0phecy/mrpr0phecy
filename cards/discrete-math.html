<!-- cards/discrete-mathematics-super-tool.html -->
<h2 id="discrete-mathematics-super-tool-title" style="margin-top:0;color:#00ff99 !important;">ğŸ§® Discrete Mathematics Power Tool</h2>

<form aria-describedby="discrete-mathematics-super-desc">
    <p id="discrete-mathematics-super-desc" class="small">
        <span style="color:#00ff99;font-weight:600">COMPLETE SUITE</span> for Computer Science & Mathematics. Solve set theory, logic, combinatorics, graph theory, and number theory problems with step-by-step visual explanations.
        <span style="color:var(--accent)">Used by top CS programs worldwide!</span>
    </p>
    
    <!-- QUICK TOOLS -->
    <div style="margin-bottom:20px;padding:12px;background:linear-gradient(135deg, rgba(0,255,153,0.1), rgba(0,200,120,0.05));border-radius:8px;border:1px solid rgba(0,255,153,0.3);">
        <div style="color:#00ff99;font-weight:600;margin-bottom:8px;font-size:14px;">âš¡ Quick Tools (click to open):</div>
        <div style="display:flex;flex-wrap:wrap;gap:8px;">
            <button type="button" onclick="dmOpenTool('venn')" class="dm-quick-btn">ğŸ¯ Venn Diagram</button>
            <button type="button" onclick="dmOpenTool('truthtable')" class="dm-quick-btn">ğŸ§  Truth Table</button>
            <button type="button" onclick="dmOpenTool('combinations')" class="dm-quick-btn">ğŸ”¢ Combinations</button>
            <button type="button" onclick="dmOpenTool('graph')" class="dm-quick-btn">ğŸ“ˆ Graph Visualizer</button>
            <button type="button" onclick="dmOpenTool('relations')" class="dm-quick-btn">ğŸ”„ Relations</button>
            <button type="button" onclick="dmOpenTool('crypto')" class="dm-quick-btn">ğŸ” Cryptography</button>
            <button type="button" onclick="dmOpenTool('automata')" class="dm-quick-btn">ğŸ¤– Automata</button>
            <button type="button" onclick="dmOpenTool('bigo')" class="dm-quick-btn">âš¡ Big-O Analysis</button>
        </div>
    </div>
    
    <!-- TOOL SELECTION -->
    <div style="margin-bottom:20px;">
        <div style="color:#00ff99;font-weight:500;margin-bottom:8px;">ğŸ¯ Select Tool Category</div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));gap:8px;">
            <button type="button" onclick="dmSelectCategory('settheory', this)" 
                    class="dm-category-btn dm-active" data-category="settheory">
                ğŸ¯ Set Theory
            </button>
            <button type="button" onclick="dmSelectCategory('logic', this)" 
                    class="dm-category-btn" data-category="logic">
                ğŸ§  Logic
            </button>
            <button type="button" onclick="dmSelectCategory('combinatorics', this)" 
                    class="dm-category-btn" data-category="combinatorics">
                ğŸ”¢ Combinatorics
            </button>
            <button type="button" onclick="dmSelectCategory('graphtheory', this)" 
                    class="dm-category-btn" data-category="graphtheory">
                ğŸ“ˆ Graph Theory
            </button>
            <button type="button" onclick="dmSelectCategory('numbertheory', this)" 
                    class="dm-category-btn" data-category="numbertheory">
                ğŸ”¢ Number Theory
            </button>
            <button type="button" onclick="dmSelectCategory('cryptography', this)" 
                    class="dm-category-btn" data-category="cryptography">
                ğŸ” Cryptography
            </button>
        </div>
    </div>
    
    <!-- DYNAMIC INPUT AREA -->
    <div id="dm-input-area">
        <!-- Content changes based on selected category -->
        <!-- Default: Set Theory -->
        <div class="dm-tool-panel" id="dm-panel-settheory">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;">
                <div>
                    <label for="dm-setA" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        Set A
                    </label>
                    <input id="dm-setA" type="text" placeholder="e.g., {1,2,3,4} or [1,2,3,4]" 
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;font-family:'Courier New', monospace;" />
                </div>
                <div>
                    <label for="dm-setB" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        Set B
                    </label>
                    <input id="dm-setB" type="text" placeholder="e.g., {3,4,5,6}" 
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;font-family:'Courier New', monospace;" />
                </div>
            </div>
            
            <div style="margin-bottom:16px;">
                <label for="dm-set-operation" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                    Operation
                </label>
                <select id="dm-set-operation" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                    <option value="union">Union (A âˆª B)</option>
                    <option value="intersection">Intersection (A âˆ© B)</option>
                    <option value="difference">Difference (A - B)</option>
                    <option value="symmetric">Symmetric Difference (A Î” B)</option>
                    <option value="cartesian">Cartesian Product (A Ã— B)</option>
                    <option value="powerset">Power Set (P(A))</option>
                    <option value="cardinality">Cardinality (|A|)</option>
                </select>
            </div>
        </div>
        
        <!-- Logic Panel (hidden by default) -->
        <div class="dm-tool-panel" id="dm-panel-logic" style="display:none;">
            <div style="margin-bottom:16px;">
                <label for="dm-logic-expression" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                    Logical Expression
                </label>
                <input id="dm-logic-expression" type="text" placeholder="e.g., (P âˆ§ Q) â†’ (Â¬R âˆ¨ S)" 
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;font-family:'Courier New', monospace;" />
            </div>
            
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                <div>
                    <label for="dm-logic-variables" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        Variables (comma-separated)
                    </label>
                    <input id="dm-logic-variables" type="text" placeholder="P,Q,R,S" 
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;" />
                </div>
                <div>
                    <label for="dm-logic-operation" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        Output Type
                    </label>
                    <select id="dm-logic-operation" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                        <option value="truthtable">Truth Table</option>
                        <option value="simplify">Simplify Expression</option>
                        <option value="equivalence">Check Equivalence</option>
                        <option value="normalform">Conjunctive Normal Form</option>
                        <option value="validity">Check Validity</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Combinatorics Panel (hidden by default) -->
        <div class="dm-tool-panel" id="dm-panel-combinatorics" style="display:none;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;">
                <div>
                    <label for="dm-comb-n" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        n (total items)
                    </label>
                    <input id="dm-comb-n" type="number" placeholder="e.g., 10" min="0" 
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;" />
                </div>
                <div>
                    <label for="dm-comb-r" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                        r (select items)
                    </label>
                    <input id="dm-comb-r" type="number" placeholder="e.g., 3" min="0" 
                           style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;" />
                </div>
            </div>
            
            <div style="margin-bottom:16px;">
                <label for="dm-comb-operation" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                    Combinatorics Problem
                </label>
                <select id="dm-comb-operation" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                    <option value="combinations">Combinations (nCr)</option>
                    <option value="permutations">Permutations (nPr)</option>
                    <option value="permutations-rep">Permutations with Repetition</option>
                    <option value="combinations-rep">Combinations with Repetition</option>
                    <option value="stirling">Stirling Numbers</option>
                    <option value="catalan">Catalan Numbers</option>
                    <option value="binomial">Binomial Theorem Expansion</option>
                    <option value="pigeonhole">Pigeonhole Principle</option>
                </select>
            </div>
        </div>
        
        <!-- Graph Theory Panel (hidden by default) -->
        <div class="dm-tool-panel" id="dm-panel-graphtheory" style="display:none;">
            <div style="margin-bottom:16px;">
                <label for="dm-graph-input" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                    Graph Input (adjacency list)
                </label>
                <textarea id="dm-graph-input" rows="4" placeholder="Format: A:B,C; B:A,D; C:A; D:B" 
                          style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;font-family:'Courier New', monospace;"></textarea>
            </div>
            
            <div style="margin-bottom:16px;">
                <label for="dm-graph-operation" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                    Graph Algorithm
                </label>
                <select id="dm-graph-operation" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                    <option value="dfs">Depth-First Search (DFS)</option>
                    <option value="bfs">Breadth-First Search (BFS)</option>
                    <option value="dijkstra">Dijkstra's Shortest Path</option>
                    <option value="components">Connected Components</option>
                    <option value="euler">Euler Path/Circuit</option>
                    <option value="hamilton">Hamiltonian Path</option>
                    <option value="mst">Minimum Spanning Tree</option>
                    <option value="coloring">Graph Coloring</option>
                    <option value="isomorphism">Graph Isomorphism Check</option>
                </select>
            </div>
        </div>
    </div>
    
    <!-- ADVANCED OPTIONS -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
        <div>
            <label for="dm-detail-level" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                Detail Level
            </label>
            <select id="dm-detail-level" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                <option value="student" selected>ğŸ‘¨â€ğŸ“ Student (step-by-step)</option>
                <option value="developer">ğŸ‘¨â€ğŸ’» Developer (algorithms)</option>
                <option value="researcher">ğŸ”¬ Researcher (proofs)</option>
            </select>
        </div>
        
        <div>
            <label for="dm-output-format" style="display:block;margin-bottom:6px;color:#00ff99;font-weight:500;">
                Output Format
            </label>
            <select id="dm-output-format" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,255,153,0.3);background:rgba(0,255,153,0.05);color:inherit;">
                <option value="text" selected>ğŸ“ Plain Text</option>
                <option value="latex">ğŸ“ LaTeX</option>
                <option value="python">ğŸ Python Code</option>
                <option value="json">ğŸ“Š JSON</option>
                <option value="graphviz">ğŸ“ˆ Graphviz</option>
            </select>
        </div>
    </div>
    
    <!-- ACTIONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="dmSolve(this)" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(0,255,153,0.3), rgba(0,200,120,0.2));border:1px solid rgba(0,255,153,0.5);border-radius:8px;color:#00ff99;cursor:pointer;font-weight:600;">
            ğŸ§® Compute with Explanation
        </button>
        <button type="button" onclick="dmVisualize(this)"
                style="padding:12px 16px;background:rgba(0,200,255,0.1);border:1px solid rgba(0,200,255,0.3);border-radius:8px;color:#00c8ff;cursor:pointer;">
            ğŸ“Š Visualize
        </button>
        <button type="button" onclick="dmGenerateExample(this)"
                style="padding:12px 16px;background:rgba(255,140,0,0.1);border:1px solid rgba(255,140,0,0.3);border-radius:8px;color:#ff8c00;cursor:pointer;">
            ğŸ“š Example
        </button>
        <button type="button" onclick="dmResetAll(this)"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            ğŸ”„ Clear
        </button>
    </div>
</form>

<!-- RESULTS SECTION -->
<div id="dm-results" style="display:none;margin-top:24px;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <h3 class="small" style="color:#00ff99;margin:0;">âœ¨ Results & Analysis</h3>
        <div style="display:flex;gap:8px;">
            <button type="button" onclick="dmExportResult(this)" 
                    style="padding:6px 12px;background:rgba(0,255,153,0.1);border:1px solid rgba(0,255,153,0.3);border-radius:6px;color:#00ff99;cursor:pointer;font-size:12px;">
                ğŸ“¥ Export
            </button>
            <button type="button" onclick="dmShareResult(this)" 
                    style="padding:6px 12px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:inherit;cursor:pointer;font-size:12px;">
                ğŸ“¤ Share
            </button>
        </div>
    </div>
    
    <!-- RESULTS TABS -->
    <div style="display:flex;gap:4px;margin-bottom:16px;border-bottom:1px solid rgba(255,255,255,0.1);">
        <button class="dm-tab dm-tab-active" onclick="dmShowResultTab('solution')">ğŸ§® Solution</button>
        <button class="dm-tab" onclick="dmShowResultTab('steps')">ğŸ“ Step-by-Step</button>
        <button class="dm-tab" onclick="dmShowResultTab('visual')">ğŸ“Š Visualization</button>
        <button class="dm-tab" onclick="dmShowResultTab('applications')">ğŸŒ Applications</button>
        <button class="dm-tab" onclick="dmShowResultTab('code')">ğŸ’» Code</button>
    </div>
    
    <!-- TAB CONTENT -->
    <div id="dm-tab-solution" class="dm-tab-content">
        <div style="padding:16px;background:linear-gradient(135deg, rgba(0,255,153,0.05), rgba(0,200,120,0.02));border-radius:10px;border:1px solid rgba(0,255,153,0.1);">
            <div style="color:#00ff99;font-weight:600;margin-bottom:8px;font-size:14px;">ğŸ¯ Result</div>
            <div id="dm-solution-output" style="padding:12px;background:rgba(0,0,0,0.2);border-radius:8px;font-family:'Courier New', monospace;white-space:pre-wrap;min-height:60px;max-height:300px;overflow-y:auto;"></div>
        </div>
    </div>
    
    <div id="dm-tab-steps" class="dm-tab-content" style="display:none;">
        <div style="padding:16px;background:rgba(0,0,0,0.1);border-radius:10px;border:1px solid rgba(255,255,255,0.05);">
            <div id="dm-step-by-step" style="font-family:'Courier New', monospace;white-space:pre-wrap;line-height:1.6;"></div>
        </div>
    </div>
    
    <div id="dm-tab-visual" class="dm-tab-content" style="display:none;">
        <div style="padding:16px;background:rgba(0,0,0,0.1);border-radius:10px;border:1px solid rgba(255,255,255,0.05);text-align:center;min-height:200px;">
            <div id="dm-visual-container">
                <!-- Visualization will be rendered here -->
            </div>
        </div>
    </div>
    
    <div id="dm-tab-applications" class="dm-tab-content" style="display:none;">
        <div style="padding:16px;background:rgba(0,0,0,0.1);border-radius:10px;border:1px solid rgba(255,255,255,0.05);">
            <div id="dm-applications-content"></div>
        </div>
    </div>
    
    <div id="dm-tab-code" class="dm-tab-content" style="display:none;">
        <div style="padding:16px;background:rgba(0,0,0,0.1);border-radius:10px;border:1px solid rgba(255,255,255,0.05);">
            <div id="dm-code-output" style="font-family:'Courier New', monospace;white-space:pre-wrap;"></div>
        </div>
    </div>
</div>

<!-- DISCRETE MATH FACTS -->
<div style="margin-top:16px;padding:12px;background:rgba(0,200,120,0.1);border-radius:8px;border:1px solid rgba(0,200,120,0.3);">
    <div style="color:#00c878;font-weight:600;margin-bottom:6px;font-size:14px;">ğŸ§  Discrete Math Fact</div>
    <div id="dm-fun-fact" style="font-size:13px;color:rgba(255,255,255,0.8);">
        Discrete mathematics is the foundation of computer science and cryptography!
    </div>
</div>

<script>
/* discrete-mathematics-super-tool.html
   - COMPLETE discrete mathematics toolkit
   - Scoped with dm- prefix
*/

let dmCurrentCategory = 'settheory';
let dmCurrentTool = 'settheory';
let dmCurrentData = null;

// Example problems database
const dmExamples = {
    settheory: {
        easy: "A = {1,2,3,4}, B = {3,4,5,6}",
        medium: "A = {x | x âˆˆ â„¤, 1 â‰¤ x â‰¤ 10}, B = {x | x is prime â‰¤ 15}",
        hard: "Universal = â„, A = {x | xÂ² < 4}, B = {x | sin(x) > 0}"
    },
    logic: {
        easy: "(P âˆ§ Q) â†’ R",
        medium: "Â¬(P âˆ¨ Q) â†” (Â¬P âˆ§ Â¬Q)",
        hard: "âˆ€xâˆƒy(P(x,y) â†’ Q(y,x))"
    },
    combinatorics: {
        easy: "n=5, r=3",
        medium: "n=10, r=4 (with repetition)",
        hard: "n=20, r=6 (Catalan numbers)"
    },
    graphtheory: {
        easy: "A:B,C; B:A,D; C:A; D:B",
        medium: "1:2,3; 2:1,4; 3:1,5; 4:2,6; 5:3,6; 6:4,5",
        hard: "K5 complete graph or Petersen graph"
    }
};

// Discrete math facts
const dmFacts = [
    "There are more possible chess games than atoms in the observable universe!",
    "Boolean algebra (foundation of logic circuits) was invented by George Boole in 1847.",
    "The Pigeonhole Principle: If n items are put into m containers with n > m, at least one container contains more than one item.",
    "Graph theory began with the Seven Bridges of KÃ¶nigsberg problem solved by Euler in 1736.",
    "The traveling salesman problem has no efficient solution (NP-hard), but heuristics get close.",
    "Modular arithmetic forms the basis of modern cryptography (RSA, Diffie-Hellman).",
    "There are 52! (â‰ˆ8Ã—10^67) possible shuffles of a standard deck of cards.",
    "The four color theorem (any map can be colored with 4 colors) was the first major theorem proved by computer.",
    "Catalan numbers count thousands of combinatorial structures (parentheses, trees, paths).",
    "The ErdÅ‘s number measures collaborative distance from mathematician Paul ErdÅ‘s in the collaboration graph."
];

function dmSelectCategory(category, btn) {
    dmCurrentCategory = category;
    
    // Update active button
    const card = btn.closest('.card') || document;
    card.querySelectorAll('.dm-category-btn').forEach(b => {
        b.classList.remove('dm-active');
        b.style.background = 'rgba(255,255,255,0.05)';
        b.style.border = '1px solid rgba(255,255,255,0.1)';
    });
    
    btn.classList.add('dm-active');
    btn.style.background = 'rgba(0,255,153,0.2)';
    btn.style.border = '1px solid rgba(0,255,153,0.4)';
    
    // Show appropriate panel
    dmShowPanel(category);
}

function dmShowPanel(panelName) {
    const card = document.currentScript?.closest('.card') || document;
    
    // Hide all panels
    card.querySelectorAll('.dm-tool-panel').forEach(panel => {
        panel.style.display = 'none';
    });
    
    // Show selected panel
    const panel = card.querySelector('#dm-panel-' + panelName);
    if (panel) {
        panel.style.display = 'block';
    }
}

function dmOpenTool(toolName) {
    // This would open specialized tools in modal windows
    const card = document.currentScript?.closest('.card') || document;
    alert(`Opening ${toolName} tool... (In full version, this opens a specialized interface)`);
    
    // Quick implementation for demo
    if (toolName === 'venn') {
        dmSelectCategory('settheory', card.querySelector('.dm-category-btn[data-category="settheory"]'));
        dmVisualize(card.querySelector('.actions button:nth-child(2)'));
    } else if (toolName === 'truthtable') {
        dmSelectCategory('logic', card.querySelector('.dm-category-btn[data-category="logic"]'));
    }
}

function dmParseSet(str) {
    // Parse set notation: {1,2,3} or [1,2,3] or 1,2,3
    str = str.trim();
    if (str.startsWith('{') && str.endsWith('}')) {
        str = str.slice(1, -1);
    } else if (str.startsWith('[') && str.endsWith(']')) {
        str = str.slice(1, -1);
    }
    return str.split(',').map(s => s.trim()).filter(Boolean);
}

function dmSolve(btn) {
    const card = btn.closest('.card') || document;
    const category = dmCurrentCategory;
    
    // Show loading
    const originalText = btn.textContent;
    btn.textContent = "ğŸ”„ Computing...";
    btn.disabled = true;
    
    // Simulate computation
    setTimeout(() => {
        let result = "";
        let steps = "";
        let visualization = "";
        let applications = "";
        let code = "";
        
        if (category === 'settheory') {
            result = dmSolveSetTheory(card);
            steps = dmGenerateSetTheorySteps(card);
            applications = "ğŸ¯ Applications:\nâ€¢ Database queries (SQL JOIN operations)\nâ€¢ Probability theory (sample spaces)\nâ€¢ Computer science (data structures)\nâ€¢ Search algorithms (indexing)";
            code = dmGenerateSetTheoryCode(card);
        } else if (category === 'logic') {
            result = dmSolveLogic(card);
            steps = dmGenerateLogicSteps(card);
            applications = "ğŸ¯ Applications:\nâ€¢ Circuit design (logic gates)\nâ€¢ Programming (conditional logic)\nâ€¢ Database queries (WHERE clauses)\nâ€¢ Artificial intelligence (knowledge representation)";
            code = dmGenerateLogicCode(card);
        } else if (category === 'combinatorics') {
            result = dmSolveCombinatorics(card);
            steps = dmGenerateCombinatoricsSteps(card);
            applications = "ğŸ¯ Applications:\nâ€¢ Probability calculations\nâ€¢ Password complexity\nâ€¢ Tournament scheduling\nâ€¢ Error-correcting codes\nâ€¢ Bioinformatics (DNA sequences)";
            code = dmGenerateCombinatoricsCode(card);
        } else if (category === 'graphtheory') {
            result = dmSolveGraphTheory(card);
            steps = dmGenerateGraphTheorySteps(card);
            applications = "ğŸ¯ Applications:\nâ€¢ Social networks (Facebook friends)\nâ€¢ Internet routing (IP packets)\nâ€¢ Recommendation systems\nâ€¢ GPS navigation\nâ€¢ Circuit board design";
            code = dmGenerateGraphTheoryCode(card);
        }
        
        // Store data
        dmCurrentData = {
            result: result,
            steps: steps,
            visualization: visualization,
            applications: applications,
            code: code,
            category: category
        };
        
        // Display results
        dmDisplayResults(card);
        
        // Show results section
        card.querySelector('#dm-results').style.display = 'block';
        
        // Show solution tab by default
        dmShowResultTab('solution');
        
        // Reset button
        btn.textContent = originalText;
        btn.disabled = false;
        
        // Scroll to results
        card.querySelector('#dm-results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        
    }, 1200);
}

function dmSolveSetTheory(card) {
    const setA = dmParseSet(card.querySelector('#dm-setA').value || '');
    const setB = dmParseSet(card.querySelector('#dm-setB').value || '');
    const operation = card.querySelector('#dm-set-operation').value;
    
    if (!setA.length && !setB.length) {
        return "Please enter at least one set.";
    }
    
    let result = "";
    
    switch(operation) {
        case 'union':
            const union = [...new Set([...setA, ...setB])];
            result = `A âˆª B = {${union.join(', ')}}\nCardinality: |A âˆª B| = ${union.length}`;
            break;
            
        case 'intersection':
            const intersection = setA.filter(x => setB.includes(x));
            result = `A âˆ© B = {${intersection.join(', ')}}\nCardinality: |A âˆ© B| = ${intersection.length}`;
            break;
            
        case 'difference':
            const difference = setA.filter(x => !setB.includes(x));
            result = `A - B = {${difference.join(', ')}}\nCardinality: |A - B| = ${difference.length}`;
            break;
            
        case 'symmetric':
            const symDiff = [
                ...setA.filter(x => !setB.includes(x)),
                ...setB.filter(x => !setA.includes(x))
            ];
            result = `A Î” B = {${symDiff.join(', ')}}\nCardinality: |A Î” B| = ${symDiff.length}`;
            break;
            
        case 'cartesian':
            const cartesian = [];
            for (let a of setA) {
                for (let b of setB) {
                    cartesian.push(`(${a},${b})`);
                }
            }
            result = `A Ã— B = {${cartesian.join(', ')}}\nCardinality: |A Ã— B| = ${setA.length * setB.length}`;
            break;
            
        case 'powerset':
            if (setA.length > 6) {
                result = `Power set P(A) has ${Math.pow(2, setA.length)} subsets.\nToo large to display (${setA.length} elements â†’ 2^${setA.length} subsets)`;
            } else {
                const subsets = dmGenerateSubsets(setA);
                result = `P(A) = {\n  âˆ…,\n  ${subsets.map(s => '{' + s.join(',') + '}').join(',\n  ')}\n}\nTotal subsets: ${subsets.length + 1}`;
            }
            break;
            
        case 'cardinality':
            result = `|A| = ${setA.length}\n|B| = ${setB.length}`;
            break;
    }
    
    return result;
}

function dmGenerateSubsets(arr) {
    const subsets = [];
    const n = arr.length;
    
    // Generate all non-empty subsets
    for (let i = 1; i < (1 << n); i++) {
        const subset = [];
        for (let j = 0; j < n; j++) {
            if (i & (1 << j)) {
                subset.push(arr[j]);
            }
        }
        subsets.push(subset);
    }
    
    return subsets;
}

function dmGenerateSetTheorySteps(card) {
    const setA = dmParseSet(card.querySelector('#dm-setA').value || '');
    const setB = dmParseSet(card.querySelector('#dm-setB').value || '');
    const operation = card.querySelector('#dm-set-operation').value;
    
    let steps = "Step-by-step solution:\n\n";
    
    switch(operation) {
        case 'union':
            steps += `1. List all elements from set A: {${setA.join(', ')}}\n`;
            steps += `2. List all elements from set B: {${setB.join(', ')}}\n`;
            steps += `3. Combine elements from both sets\n`;
            steps += `4. Remove duplicates (union eliminates duplicates)\n`;
            steps += `5. Result: {${[...new Set([...setA, ...setB])].join(', ')}}`;
            break;
            
        case 'intersection':
            steps += `1. Compare each element of A with elements of B\n`;
            steps += `2. Keep only elements present in both sets\n`;
            steps += `3. Result: {${setA.filter(x => setB.includes(x)).join(', ')}}`;
            break;
            
        case 'difference':
            steps += `1. Start with elements of A: {${setA.join(', ')}}\n`;
            steps += `2. Remove any element that appears in B\n`;
            steps += `3. Result: {${setA.filter(x => !setB.includes(x)).join(', ')}}`;
            break;
    }
    
    return steps;
}

function dmGenerateSetTheoryCode(card) {
    const operation = card.querySelector('#dm-set-operation').value;
    
    let code = "# Python implementation\n\n";
    code += "def solve_set_operation(A, B, operation):\n";
    
    switch(operation) {
        case 'union':
            code += "    # Union: all elements from A or B\n";
            code += "    result = set(A) | set(B)\n";
            code += "    return sorted(result)\n";
            break;
            
        case 'intersection':
            code += "    # Intersection: elements in both A and B\n";
            code += "    result = set(A) & set(B)\n";
            code += "    return sorted(result)\n";
            break;
            
        case 'difference':
            code += "    # Difference: elements in A but not in B\n";
            code += "    result = set(A) - set(B)\n";
            code += "    return sorted(result)\n";
            break;
            
        case 'symmetric':
            code += "    # Symmetric difference: elements in A or B but not both\n";
            code += "    result = set(A) ^ set(B)\n";
            code += "    return sorted(result)\n";
            break;
    }
    
    return code;
}

function dmSolveLogic(card) {
    const expression = card.querySelector('#dm-logic-expression').value.trim();
    const variables = (card.querySelector('#dm-logic-variables').value || 'P,Q').split(',').map(v => v.trim());
    const operation = card.querySelector('#dm-logic-operation').value;
    
    if (!expression) {
        return "Please enter a logical expression.";
    }
    
    let result = "";
    
    if (operation === 'truthtable') {
        result = dmGenerateTruthTable(variables, expression);
    } else {
        result = `Operation: ${operation}\nExpression: ${expression}\n\nResult would be computed with a full logic engine.`;
    }
    
    return result;
}

function dmGenerateTruthTable(variables, expression) {
    const n = variables.length;
    const rows = Math.pow(2, n);
    let table = "Truth Table:\n\n";
    
    // Header
    table += variables.join(' | ') + " | " + expression + "\n";
    table += "-".repeat((variables.length + 1) * 4 + expression.length) + "\n";
    
    // Generate all combinations
    for (let i = 0; i < rows; i++) {
        const values = [];
        for (let j = n - 1; j >= 0; j--) {
            const value = (i >> j) & 1;
            values.push(value);
        }
        
        // Simple evaluation for demo (would use a real parser in production)
        const evalResult = dmEvaluateLogic(expression, variables, values);
        
        table += values.join(' | ') + " | " + evalResult + "\n";
    }
    
    return table;
}

function dmEvaluateLogic(expr, vars, values) {
    // Very simple evaluator for demo
    try {
        let evalExpr = expr;
        for (let i = 0; i < vars.length; i++) {
            evalExpr = evalExpr.replace(new RegExp(vars[i], 'g'), values[i]);
        }
        
        // Replace operators
        evalExpr = evalExpr.replace(/âˆ§/g, '&&').replace(/âˆ¨/g, '||').replace(/Â¬/g, '!').replace(/â†’/g, '||').replace(/â†”/g, '==');
        
        // Evaluate safely
        const result = eval(evalExpr) ? 1 : 0;
        return result;
    } catch (e) {
        return "?";
    }
}

function dmVisualize(btn) {
    const card = btn.closest('.card') || document;
    
    if (!dmCurrentData) {
        alert("Please compute a solution first!");
        return;
    }
    
    // Show visualization tab
    dmShowResultTab('visual');
    
    // Generate visualization based on category
    const container = card.querySelector('#dm-visual-container');
    
    if (dmCurrentCategory === 'settheory') {
        container.innerHTML = dmGenerateVennDiagram();
    } else if (dmCurrentCategory === 'graphtheory') {
        container.innerHTML = dmGenerateGraphVisualization();
    } else {
        container.innerHTML = `<div style="color:#00ff99;padding:20px;">Visualization available for set theory and graph theory operations.</div>`;
    }
}

function dmGenerateVennDiagram() {
    return `
        <div style="position:relative;width:300px;height:200px;margin:0 auto;">
            <div style="position:absolute;width:120px;height:120px;border:2px solid #00ff99;border-radius:50%;left:50px;top:40px;opacity:0.7;"></div>
            <div style="position:absolute;width:120px;height:120px;border:2px solid #00c8ff;border-radius:50%;left:130px;top:40px;opacity:0.7;"></div>
            <div style="position:absolute;left:70px;top:80px;color:#00ff99;">A</div>
            <div style="position:absolute;left:150px;top:80px;color:#00c8ff;">B</div>
            <div style="position:absolute;left:110px;top:90px;color:#ff8c00;">Aâˆ©B</div>
        </div>
        <div style="margin-top:20px;font-size:12px;color:rgba(255,255,255,0.7);">
            ğŸŸ¢ Set A | ğŸ”µ Set B | ğŸŸ  Intersection
        </div>
    `;
}

function dmShowResultTab(tabName) {
    const card = document.currentScript?.closest('.card') || document;
    
    // Hide all tabs
    card.querySelectorAll('.dm-tab-content').forEach(tab => {
        tab.style.display = 'none';
    });
    
    // Remove active class from all tabs
    card.querySelectorAll('.dm-tab').forEach(tab => {
        tab.classList.remove('dm-tab-active');
    });
    
    // Show selected tab
    card.querySelector('#dm-tab-' + tabName).style.display = 'block';
    
    // Add active class to clicked tab
    event.target.classList.add('dm-tab-active');
}

function dmDisplayResults(card) {
    if (!dmCurrentData) return;
    
    card.querySelector('#dm-solution-output').textContent = dmCurrentData.result;
    card.querySelector('#dm-step-by-step').textContent = dmCurrentData.steps;
    card.querySelector('#dm-applications-content').textContent = dmCurrentData.applications;
    card.querySelector('#dm-code-output').textContent = dmCurrentData.code;
}

function dmGenerateExample(btn) {
    const card = btn.closest('.card') || document;
    const category = dmCurrentCategory;
    const difficulty = ['easy', 'medium', 'hard'][Math.floor(Math.random() * 3)];
    
    const example = dmExamples[category]?.[difficulty];
    if (!example) return;
    
    // Load example based on category
    if (category === 'settheory') {
        const [setA, setB] = example.split(', B = ');
        card.querySelector('#dm-setA').value = setA;
        card.querySelector('#dm-setB').value = setB;
    } else if (category === 'logic') {
        card.querySelector('#dm-logic-expression').value = example;
    } else if (category === 'combinatorics') {
        const [n, r] = example.split(', r=');
        card.querySelector('#dm-comb-n').value = n.split('=')[1];
        card.querySelector('#dm-comb-r').value = r;
    } else if (category === 'graphtheory') {
        card.querySelector('#dm-graph-input').value = example;
    }
    
    // Visual feedback
    const originalText = btn.textContent;
    btn.textContent = "âœ¨ Loaded!";
    setTimeout(() => {
        btn.textContent = originalText;
    }, 1000);
}

function dmExportResult(btn) {
    if (!dmCurrentData) return;
    
    const content = `
        Discrete Mathematics Solution
        =============================
        
        Category: ${dmCurrentData.category}
        
        Result:
        ${dmCurrentData.result}
        
        Steps:
        ${dmCurrentData.steps}
        
        Generated by The Most Useful Site in the World
    `;
    
    const blob = new Blob([content], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'discrete_math_solution.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    
    btn.textContent = "âœ… Downloaded!";
    setTimeout(() => {
        btn.textContent = "ğŸ“¥ Export";
    }, 2000);
}

function dmShareResult(btn) {
    if (!dmCurrentData) return;
    
    const shareText = `Check out this discrete math solution! Category: ${dmCurrentData.category}. Generated by The Most Useful Site in the World`;
    
    if (navigator.share) {
        navigator.share({
            title: 'Discrete Math Solution',
            text: shareText,
            url: window.location.href
        });
    } else {
        navigator.clipboard.writeText(shareText).then(() => {
            btn.textContent = "âœ… Copied!";
            setTimeout(() => {
                btn.textContent = "ğŸ“¤ Share";
            }, 2000);
        });
    }
}

function dmResetAll(btn) {
    const card = btn.closest('.card') || document;
    
    // Reset form
    card.querySelectorAll('input, textarea, select').forEach(el => {
        if (el.type !== 'button') {
            el.value = '';
        }
    });
    
    // Set default category
    dmSelectCategory('settheory', card.querySelector('.dm-category-btn[data-category="settheory"]'));
    
    // Hide results
    card.querySelector('#dm-results').style.display = 'none';
    
    // Update fact
    dmUpdateFunFact();
}

function dmUpdateFunFact() {
    const card = document.currentScript?.closest('.card') || document;
    const randomFact = dmFacts[Math.floor(Math.random() * dmFacts.length)];
    card.querySelector('#dm-fun-fact').textContent = randomFact;
}

// Stub functions for other categories (would be fully implemented in production)
function dmSolveCombinatorics(card) { return "Combinatorics solution would be computed here."; }
function dmGenerateCombinatoricsSteps(card) { return "Step-by-step combinatorics solution."; }
function dmGenerateCombinatoricsCode(card) { return "# Combinatorics Python code"; }
function dmSolveGraphTheory(card) { return "Graph theory solution would be computed here."; }
function dmGenerateGraphTheorySteps(card) { return "Step-by-step graph theory solution."; }
function dmGenerateGraphTheoryCode(card) { return "# Graph theory Python code"; }
function dmGenerateGraphVisualization() { return "Graph visualization would be rendered here."; }

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.currentScript?.closest('.card') || document;
        
        // Update fun fact
        dmUpdateFunFact();
        
        console.log('Discrete Mathematics Power Tool ready!');
    });
}
</script>

<style>
#discrete-mathematics-super-tool-title {
    color: #00ff99 !important;
    margin-top: 0;
    font-size: 1.5rem !important;
    background: linear-gradient(135deg, #00ff99, #00c878);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.dm-quick-btn {
    padding: 8px 12px;
    background: rgba(0,255,153,0.1);
    border: 1px solid rgba(0,255,153,0.3);
    border-radius: 6px;
    color: #00ff99;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.2s;
}

.dm-quick-btn:hover {
    background: rgba(0,255,153,0.2);
    transform: translateY(-1px);
}

.dm-category-btn {
    padding: 12px 8px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    color: inherit;
    cursor: pointer;
    text-align: center;
    font-size: 13px;
    transition: all 0.2s;
}

.dm-category-btn.dm-active {
    background: rgba(0,255,153,0.2) !important;
    border: 1px solid rgba(0,255,153,0.4) !important;
    color: #00ff99 !important;
    font-weight: 600;
}

.dm-tab {
    padding: 8px 12px;
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    color: rgba(255,255,255,0.6);
    cursor: pointer;
    font-size: 13px;
    transition: all 0.2s;
}

.dm-tab:hover {
    color: #00ff99;
}

.dm-tab-active {
    color: #00ff99 !important;
    border-bottom: 2px solid #00ff99 !important;
    font-weight: 600;
}

.dm-tab-content {
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@media (max-width: 768px) {
    .dm-category-btn {
        padding: 10px 6px;
        font-size: 12px;
    }
    
    .dm-tab {
        padding: 6px 8px;
        font-size: 12px;
    }
}
</style>
