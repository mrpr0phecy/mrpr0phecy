<!-- cards/energy-usage-calculator.html -->
<h2 id="energy-usage-calculator-title">‚ö° Energy Consumption Calculator</h2>

<form aria-describedby="energy-description">
    <p id="energy-description" class="small" style="color:rgba(230,250,255,0.9);margin-bottom:20px;">
        Calculate electricity costs, carbon footprint, and savings potential for any appliance.
        <span style="color:var(--accent);font-weight:500;">Track your energy usage and find ways to save money!</span>
    </p>
    
    <!-- Appliance Selection -->
    <div style="margin-bottom:24px;">
        <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üè† Select Appliance</h3>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px;">
            <div>
                <label for="eu-appliance-name" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                    üì∫ Appliance Name
                </label>
                <div style="display:flex;gap:10px;">
                    <input id="eu-appliance-name" type="text" placeholder="Enter appliance name" 
                           style="flex:1;padding:14px;border-radius:10px;border:2px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;" />
                    <select id="eu-appliance-preset" style="padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;cursor:pointer;min-width:140px;">
                        <option value="custom">Custom</option>
                        <option value="refrigerator">Refrigerator</option>
                        <option value="tv">TV</option>
                        <option value="washing-machine">Washing Machine</option>
                        <option value="ac">Air Conditioner</option>
                        <option value="heater">Space Heater</option>
                        <option value="computer">Computer</option>
                        <option value="lights">LED Lights</option>
                        <option value="oven">Electric Oven</option>
                    </select>
                </div>
            </div>
            
            <div>
                <label for="eu-power-rating" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                    ‚ö° Power Rating
                </label>
                <div style="position:relative;">
                    <input id="eu-power-rating" type="range" min="10" max="5000" step="10" value="1000" 
                           style="width:100%;margin-bottom:8px;" />
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div id="eu-power-value" style="color:#fff;font-weight:600;font-size:1.1rem;">1000</div>
                        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">watts</div>
                    </div>
                </div>
                <div style="margin-top:8px;display:flex;gap:6px;justify-content:space-between;">
                    <button type="button" onclick="euSetPower(100)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">100W</button>
                    <button type="button" onclick="euSetPower(500)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">500W</button>
                    <button type="button" onclick="euSetPower(1000)" style="padding:4px 8px;background:rgba(45,212,255,0.2);border:1px solid var(--accent);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">1000W</button>
                    <button type="button" onclick="euSetPower(2000)" style="padding:4px 8px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.2);border-radius:4px;color:var(--accent);cursor:pointer;font-size:0.8rem;">2000W</button>
                </div>
            </div>
        </div>
        
        <!-- Usage Pattern -->
        <div style="margin-bottom:20px;">
            <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">‚è±Ô∏è Usage Pattern</h3>
            
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:16px;">
                <div>
                    <label for="eu-daily-hours" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                        üìÖ Daily Usage
                    </label>
                    <div style="position:relative;">
                        <input id="eu-daily-hours" type="range" min="0.1" max="24" step="0.1" value="2" 
                               style="width:100%;margin-bottom:8px;" />
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div id="eu-hours-value" style="color:#fff;font-weight:600;font-size:1.1rem;">2.0</div>
                            <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">hours/day</div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label for="eu-days-week" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                        üìÜ Days per Week
                    </label>
                    <div style="position:relative;">
                        <input id="eu-days-week" type="range" min="1" max="7" step="1" value="7" 
                               style="width:100%;margin-bottom:8px;" />
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div id="eu-days-value" style="color:#fff;font-weight:600;font-size:1.1rem;">7</div>
                            <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">days/week</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Energy Costs -->
        <div style="margin-bottom:20px;">
            <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üí∞ Energy Costs</h3>
            
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
                <div>
                    <label for="eu-electricity-price" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                        ‚ö° Electricity Price
                    </label>
                    <div style="position:relative;">
                        <input id="eu-electricity-price" type="range" min="0.05" max="0.50" step="0.01" value="0.30" 
                               style="width:100%;margin-bottom:8px;" />
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div id="eu-price-value" style="color:#fff;font-weight:600;font-size:1.1rem;">0.30</div>
                            <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">¬£/kWh</div>
                        </div>
                    </div>
                    <div style="margin-top:8px;display:flex;gap:6px;justify-content:space-between;">
                        <button type="button" onclick="euSetPrice(0.15)" style="padding:4px 8px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:4px;color:#39ff14;cursor:pointer;font-size:0.8rem;">¬£0.15</button>
                        <button type="button" onclick="euSetPrice(0.30)" style="padding:4px 8px;background:rgba(57,255,20,0.2);border:1px solid #39ff14;border-radius:4px;color:#39ff14;cursor:pointer;font-size:0.8rem;">¬£0.30</button>
                        <button type="button" onclick="euSetPrice(0.45)" style="padding:4px 8px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.2);border-radius:4px;color:#39ff14;cursor:pointer;font-size:0.8rem;">¬£0.45</button>
                    </div>
                </div>
                
                <div>
                    <label for="eu-currency" style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                        üí± Currency
                    </label>
                    <select id="eu-currency" style="width:100%;padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:inherit;cursor:pointer;">
                        <option value="GBP">British Pound (¬£)</option>
                        <option value="USD">US Dollar ($)</option>
                        <option value="EUR">Euro (‚Ç¨)</option>
                        <option value="CAD">Canadian Dollar (C$)</option>
                        <option value="AUD">Australian Dollar (A$)</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Action Buttons -->
    <div class="actions" style="display:flex;gap:12px;">
        <button type="button" onclick="euCalculate()" 
                style="flex:1;padding:16px;background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(45,212,255,0.2));border:2px solid rgba(57,255,20,0.4);border-radius:12px;color:#39ff14;cursor:pointer;font-weight:600;font-size:1.1rem;display:flex;align-items:center;justify-content:center;gap:10px;">
            ‚ö° Calculate Energy Usage
        </button>
        <button type="button" onclick="euCompareEfficiency()"
                style="padding:16px 24px;background:rgba(255,204,0,0.1);border:2px solid rgba(255,204,0,0.3);border-radius:12px;color:#ffcc00;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;">
            üìä Compare
        </button>
        <button type="button" onclick="euReset()"
                style="padding:16px 24px;background:rgba(255,77,77,0.1);border:2px solid rgba(255,77,77,0.3);border-radius:12px;color:#ff4d4d;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;">
            üîÑ Reset
        </button>
    </div>
</form>

<!-- Results Display -->
<div class="results" aria-live="polite" style="margin-top:24px;">
    <!-- Summary Card -->
    <div style="margin-bottom:24px;">
        <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üìä Energy Usage Summary</h3>
        
        <div style="
            padding:24px;
            background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));
            border:2px solid rgba(45,212,255,0.15);
            border-radius:12px;
            display:grid;
            grid-template-columns:repeat(2,1fr);
            gap:20px;
        ">
            <!-- Left Column -->
            <div>
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
                    <div style="
                        width:60px;
                        height:60px;
                        background:rgba(45,212,255,0.1);
                        border:2px solid var(--accent);
                        border-radius:12px;
                        display:flex;
                        align-items:center;
                        justify-content:center;
                        font-size:1.5rem;
                    " id="eu-appliance-icon">‚ö°</div>
                    <div>
                        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Appliance</div>
                        <div id="eu-appliance-title" style="font-size:1.3rem;color:#fff;font-weight:600;">-</div>
                    </div>
                </div>
                
                <div style="
                    padding:16px;
                    background:rgba(0,0,0,0.2);
                    border-radius:10px;
                    border-left:4px solid var(--accent);
                ">
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:4px;">Total Energy Consumption</div>
                    <div id="eu-total-kwh" style="font-size:1.8rem;color:var(--accent);font-weight:800;">-</div>
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.6);">kilowatt-hours</div>
                </div>
            </div>
            
            <!-- Right Column -->
            <div>
                <div style="margin-bottom:16px;">
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);margin-bottom:4px;">Estimated Cost</div>
                    <div id="eu-total-cost" style="font-size:2.2rem;color:#39ff14;font-weight:800;">-</div>
                </div>
                
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">
                    <div style="padding:12px;background:rgba(45,212,255,0.1);border-radius:8px;">
                        <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">Daily</div>
                        <div id="eu-daily-cost" style="font-size:1.1rem;color:var(--accent);font-weight:600;">-</div>
                    </div>
                    <div style="padding:12px;background:rgba(57,255,20,0.1);border-radius:8px;">
                        <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">Monthly</div>
                        <div id="eu-monthly-cost" style="font-size:1.1rem;color:#39ff14;font-weight:600;">-</div>
                    </div>
                    <div style="padding:12px;background:rgba(255,204,0,0.1);border-radius:8px;">
                        <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">Yearly</div>
                        <div id="eu-yearly-cost" style="font-size:1.1rem;color:#ffcc00;font-weight:600;">-</div>
                    </div>
                    <div style="padding:12px;background:rgba(157,78,221,0.1);border-radius:8px;">
                        <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">CO‚ÇÇ Emissions</div>
                        <div id="eu-carbon" style="font-size:1.1rem;color:#9d4edd;font-weight:600;">-</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Detailed Breakdown -->
    <div style="margin-bottom:24px;">
        <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üìà Detailed Breakdown</h3>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;">
            <!-- Power Consumption Timeline -->
            <div style="
                padding:20px;
                background:rgba(0,0,0,0.2);
                border-radius:12px;
                border:1px solid rgba(255,255,255,0.05);
            ">
                <div style="font-weight:600;color:var(--accent);margin-bottom:16px;">‚ö° Power Consumption Timeline</div>
                <div id="eu-power-timeline" style="
                    height:150px;
                    display:flex;
                    align-items:end;
                    gap:8px;
                    padding:20px 0;
                ">
                    <!-- Timeline bars will be generated by JS -->
                    <div style="text-align:center;color:rgba(230,250,255,0.5);flex:1;">
                        Calculate to see timeline
                    </div>
                </div>
            </div>
            
            <!-- Cost Distribution -->
            <div style="
                padding:20px;
                background:rgba(0,0,0,0.2);
                border-radius:12px;
                border:1px solid rgba(255,255,255,0.05);
            ">
                <div style="font-weight:600;color:var(--accent);margin-bottom:16px;">üí∞ Cost Distribution</div>
                <div id="eu-cost-distribution" style="
                    height:150px;
                    display:flex;
                    align-items:center;
                    justify-content:center;
                    position:relative;
                ">
                    <div style="text-align:center;color:rgba(230,250,255,0.5);">
                        Calculate to see distribution
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Energy Saving Tips -->
    <div id="eu-tips-container" style="display:none;">
        <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üí° Energy Saving Tips</h3>
        
        <div style="
            padding:20px;
            background:linear-gradient(135deg, rgba(57,255,20,0.05), rgba(45,212,255,0.05));
            border-radius:12px;
            border:1px solid rgba(57,255,20,0.2);
        ">
            <div id="eu-energy-tips" style="line-height:1.6;"></div>
            
            <div style="margin-top:16px;display:flex;gap:12px;">
                <button onclick="euCalculateSavings()" style="
                    padding:10px 20px;
                    background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(57,255,20,0.1));
                    border:2px solid rgba(57,255,20,0.4);
                    border-radius:8px;
                    color:#39ff14;
                    cursor:pointer;
                    font-weight:600;
                ">
                    üí∞ Calculate Potential Savings
                </button>
            </div>
        </div>
    </div>
    
    <!-- Savings Calculator -->
    <div id="eu-savings-container" style="display:none;margin-top:20px;">
        <h3 style="color:var(--accent);margin:0 0 12px 0;font-size:1rem;">üí∞ Potential Savings Calculator</h3>
        
        <div style="
            padding:20px;
            background:rgba(0,0,0,0.2);
            border-radius:12px;
            border:1px solid rgba(255,255,255,0.05);
        ">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                <div>
                    <label style="display:block;margin-bottom:8px;color:var(--accent);font-weight:500;">
                        üéØ Target Reduction
                    </label>
                    <div style="position:relative;">
                        <input id="eu-reduction-target" type="range" min="10" max="90" step="5" value="30" 
                               style="width:100%;margin-bottom:8px;" />
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div id="eu-reduction-value" style="color:#fff;font-weight:600;font-size:1.1rem;">30</div>
                            <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">% reduction</div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <div style="padding:16px;background:rgba(57,255,20,0.1);border-radius:10px;text-align:center;">
                        <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Potential Yearly Savings</div>
                        <div id="eu-potential-savings" style="font-size:1.8rem;color:#39ff14;font-weight:800;">-</div>
                    </div>
                </div>
            </div>
            
            <div id="eu-savings-tips" style="line-height:1.6;"></div>
        </div>
    </div>
</div>

<script>
/* energy-usage-calculator.html
   - Advanced energy usage calculator with savings analysis
   - Prefix: eu
*/

// Appliance presets with power ratings and icons
const euAppliancePresets = {
    'refrigerator': { power: 150, icon: '‚ùÑÔ∏è', tips: 'Keep temperature at 4-5¬∞C. Avoid placing near heat sources. Defrost regularly.' },
    'tv': { power: 100, icon: 'üì∫', tips: 'Use energy-saving mode. Turn off completely when not in use. Reduce brightness.' },
    'washing-machine': { power: 500, icon: 'üëï', tips: 'Use cold water settings. Run full loads only. Air dry when possible.' },
    'ac': { power: 1500, icon: 'üå¨Ô∏è', tips: 'Set thermostat to 24-26¬∞C. Clean filters monthly. Use fans with AC.' },
    'heater': { power: 1500, icon: 'üî•', tips: 'Use programmable thermostat. Insulate rooms properly. Layer clothing instead.' },
    'computer': { power: 200, icon: 'üíª', tips: 'Enable sleep mode. Turn off monitors when not in use. Use laptops over desktops.' },
    'lights': { power: 10, icon: 'üí°', tips: 'Switch to LED bulbs. Use natural light when possible. Install motion sensors.' },
    'oven': { power: 2400, icon: 'üç≥', tips: 'Use microwave for small meals. Keep oven door closed while cooking. Preheat efficiently.' }
};

// Initialize range sliders
function euInitializeSliders() {
    const powerSlider = document.getElementById('eu-power-rating');
    const hoursSlider = document.getElementById('eu-daily-hours');
    const daysSlider = document.getElementById('eu-days-week');
    const priceSlider = document.getElementById('eu-electricity-price');
    
    const powerValue = document.getElementById('eu-power-value');
    const hoursValue = document.getElementById('eu-hours-value');
    const daysValue = document.getElementById('eu-days-value');
    const priceValue = document.getElementById('eu-price-value');
    
    // Power rating slider
    powerSlider.addEventListener('input', function() {
        powerValue.textContent = this.value;
    });
    
    // Daily hours slider
    hoursSlider.addEventListener('input', function() {
        hoursValue.textContent = parseFloat(this.value).toFixed(1);
    });
    
    // Days per week slider
    daysSlider.addEventListener('input', function() {
        daysValue.textContent = this.value;
    });
    
    // Price slider
    priceSlider.addEventListener('input', function() {
        priceValue.textContent = parseFloat(this.value).toFixed(2);
    });
    
    // Appliance preset selector
    document.getElementById('eu-appliance-preset').addEventListener('change', function() {
        const preset = this.value;
        const applianceName = document.getElementById('eu-appliance-name');
        
        if (preset !== 'custom') {
            const applianceData = euAppliancePresets[preset];
            if (applianceData) {
                applianceName.value = this.options[this.selectedIndex].text;
                euSetPower(applianceData.power);
                document.getElementById('eu-appliance-icon').textContent = applianceData.icon;
            }
        }
    });
    
    // Trigger initial updates
    powerSlider.dispatchEvent(new Event('input'));
    hoursSlider.dispatchEvent(new Event('input'));
    daysSlider.dispatchEvent(new Event('input'));
    priceSlider.dispatchEvent(new Event('input'));
}

function euSetPower(watts) {
    const slider = document.getElementById('eu-power-rating');
    slider.value = watts;
    slider.dispatchEvent(new Event('input'));
}

function euSetPrice(price) {
    const slider = document.getElementById('eu-electricity-price');
    slider.value = price;
    slider.dispatchEvent(new Event('input'));
}

function euCalculate() {
    // Gather inputs
    const applianceName = document.getElementById('eu-appliance-name').value || "Appliance";
    const powerWatts = parseFloat(document.getElementById('eu-power-rating').value);
    const dailyHours = parseFloat(document.getElementById('eu-daily-hours').value);
    const daysPerWeek = parseFloat(document.getElementById('eu-days-week').value);
    const pricePerKwh = parseFloat(document.getElementById('eu-electricity-price').value);
    const currency = document.getElementById('eu-currency').value;
    
    // Get currency symbol
    const currencySymbols = {
        'GBP': '¬£',
        'USD': '$',
        'EUR': '‚Ç¨',
        'CAD': 'C$',
        'AUD': 'A$'
    };
    const currencySymbol = currencySymbols[currency] || '¬£';
    
    // Calculate energy consumption
    const wattsToKw = powerWatts / 1000;
    const dailyKwh = wattsToKw * dailyHours;
    const weeklyKwh = dailyKwh * daysPerWeek;
    const monthlyKwh = weeklyKwh * 4.33; // Average weeks per month
    const yearlyKwh = weeklyKwh * 52.14; // Average weeks per year
    
    // Calculate costs
    const dailyCost = dailyKwh * pricePerKwh;
    const weeklyCost = weeklyKwh * pricePerKwh;
    const monthlyCost = monthlyKwh * pricePerKwh;
    const yearlyCost = yearlyKwh * pricePerKwh;
    
    // Calculate CO‚ÇÇ emissions (UK average: 0.233 kg CO‚ÇÇ per kWh)
    const co2PerKwh = 0.233; // kg CO‚ÇÇ per kWh
    const yearlyCo2 = yearlyKwh * co2PerKwh;
    
    // Update summary display
    document.getElementById('eu-appliance-title').textContent = applianceName;
    document.getElementById('eu-total-kwh').textContent = yearlyKwh.toFixed(1) + ' kWh';
    document.getElementById('eu-total-cost').textContent = currencySymbol + yearlyCost.toFixed(2);
    document.getElementById('eu-daily-cost').textContent = currencySymbol + dailyCost.toFixed(2);
    document.getElementById('eu-monthly-cost').textContent = currencySymbol + monthlyCost.toFixed(2);
    document.getElementById('eu-yearly-cost').textContent = currencySymbol + yearlyCost.toFixed(2);
    document.getElementById('eu-carbon').textContent = yearlyCo2.toFixed(1) + ' kg';
    
    // Update timeline visualization
    euUpdateTimelineVisualization(dailyHours, powerWatts);
    
    // Update cost distribution
    euUpdateCostDistribution(dailyCost, weeklyCost, monthlyCost, yearlyCost, currencySymbol);
    
    // Show energy saving tips
    euShowEnergyTips(powerWatts, yearlyCost, currencySymbol);
    
    // Show savings container
    document.getElementById('eu-savings-container').style.display = 'block';
    euCalculateSavings();
    
    // Animation
    const summary = document.querySelector('#eu-total-cost');
    summary.style.animation = 'euPulse 0.5s ease';
    setTimeout(() => {
        summary.style.animation = '';
    }, 500);
}

function euUpdateTimelineVisualization(dailyHours, powerWatts) {
    const timeline = document.getElementById('eu-power-timeline');
    timeline.innerHTML = '';
    
    // Create 24-hour timeline
    for (let hour = 0; hour < 24; hour++) {
        const hourDiv = document.createElement('div');
        hourDiv.style.cssText = `
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: end;
            gap: 4px;
        `;
        
        // Determine if appliance is on during this hour
        const isActive = hour < dailyHours;
        const barHeight = isActive ? Math.min(100, powerWatts / 50) + '%' : '5%';
        const barColor = isActive ? 'var(--accent)' : 'rgba(255,255,255,0.1)';
        
        hourDiv.innerHTML = `
            <div style="
                width: 100%;
                height: ${barHeight};
                background: ${barColor};
                border-radius: 4px 4px 0 0;
                transition: height 0.3s ease;
            "></div>
            <div style="font-size: 0.7rem; color: rgba(230,250,255,0.6);">${hour}</div>
        `;
        
        timeline.appendChild(hourDiv);
    }
}

function euUpdateCostDistribution(dailyCost, weeklyCost, monthlyCost, yearlyCost, currencySymbol) {
    const distribution = document.getElementById('eu-cost-distribution');
    distribution.innerHTML = '';
    
    const costs = [
        { label: 'Daily', value: dailyCost, color: 'var(--accent)' },
        { label: 'Weekly', value: weeklyCost, color: '#39ff14' },
        { label: 'Monthly', value: monthlyCost, color: '#ffcc00' },
        { label: 'Yearly', value: yearlyCost, color: '#9d4edd' }
    ];
    
    const maxCost = Math.max(...costs.map(c => c.value));
    
    costs.forEach(cost => {
        const costDiv = document.createElement('div');
        costDiv.style.cssText = `
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: end;
            gap: 8px;
            padding: 0 10px;
        `;
        
        const height = maxCost > 0 ? (cost.value / maxCost * 100) + '%' : '0%';
        
        costDiv.innerHTML = `
            <div style="
                width: 30px;
                height: ${height};
                background: ${cost.color};
                border-radius: 6px 6px 0 0;
                position: relative;
            ">
                <div style="
                    position: absolute;
                    top: -25px;
                    left: 50%;
                    transform: translateX(-50%);
                    font-size: 0.8rem;
                    color: ${cost.color};
                    font-weight: 600;
                    white-space: nowrap;
                ">${currencySymbol}${cost.value.toFixed(2)}</div>
            </div>
            <div style="font-size: 0.8rem; color: rgba(230,250,255,0.8);">${cost.label}</div>
        `;
        
        distribution.appendChild(costDiv);
    });
}

function euShowEnergyTips(powerWatts, yearlyCost, currencySymbol) {
    const tipsContainer = document.getElementById('eu-tips-container');
    const tipsDiv = document.getElementById('eu-energy-tips');
    
    // Get tips based on appliance type
    const presetSelect = document.getElementById('eu-appliance-preset');
    const preset = presetSelect.value;
    
    let tips = '<div style="font-weight:600;color:var(--accent);margin-bottom:12px;">üí° How to Save Energy:</div>';
    tips += '<ul style="margin:0;padding-left:20px;">';
    
    // General tips
    tips += '<li>Consider upgrading to energy-efficient models</li>';
    tips += '<li>Use timers or smart plugs to control usage</li>';
    tips += `<li>Reducing usage by 30% could save ${currencySymbol}${(yearlyCost * 0.3).toFixed(2)} yearly</li>`;
    
    // Specific tips based on appliance
    if (preset !== 'custom' && euAppliancePresets[preset]) {
        tips += `<li>${euAppliancePresets[preset].tips}</li>`;
    }
    
    tips += '</ul>';
    
    tipsDiv.innerHTML = tips;
    tipsContainer.style.display = 'block';
}

function euCalculateSavings() {
    const reductionTarget = parseFloat(document.getElementById('eu-reduction-target').value);
    const yearlyCostText = document.getElementById('eu-yearly-cost').textContent;
    
    // Extract numeric value from cost text
    const yearlyCost = parseFloat(yearlyCostText.replace(/[^0-9.]/g, ''));
    
    if (isNaN(yearlyCost)) return;
    
    const potentialSavings = yearlyCost * (reductionTarget / 100);
    const currencySymbol = yearlyCostText.match(/[¬£$\u20AC]/)?.[0] || '¬£';
    
    document.getElementById('eu-potential-savings').textContent = 
        currencySymbol + potentialSavings.toFixed(2);
    
    document.getElementById('eu-reduction-value').textContent = reductionTarget;
    
    // Update savings tips
    const savingsTips = document.getElementById('eu-savings-tips');
    savingsTips.innerHTML = `
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
            <div style="
                width: 40px;
                height: 40px;
                background: rgba(57,255,20,0.2);
                border: 2px solid #39ff14;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
            ">üí∞</div>
            <div>
                <div style="font-weight:600;color:#39ff14;">Potential Savings</div>
                <div>Reducing usage by ${reductionTarget}% could save you ${currencySymbol}${potentialSavings.toFixed(2)} per year!</div>
            </div>
        </div>
        
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:16px;">
            <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;">
                <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">Monthly Savings</div>
                <div style="color:#39ff14;font-weight:600;">${currencySymbol}${(potentialSavings / 12).toFixed(2)}</div>
            </div>
            <div style="padding:12px;background:rgba(57,255,20,0.05);border-radius:8px;">
                <div style="font-size:0.8rem;color:rgba(230,250,255,0.7);">CO‚ÇÇ Reduction</div>
                <div style="color:#39ff14;font-weight:600;">${(potentialSavings * 0.233).toFixed(1)} kg</div>
            </div>
        </div>
    `;
}

function euCompareEfficiency() {
    const currentPower = parseFloat(document.getElementById('eu-power-rating').value);
    const yearlyCostText = document.getElementById('eu-yearly-cost').textContent;
    const currencySymbol = yearlyCostText.match(/[¬£$\u20AC]/)?.[0] || '¬£';
    
    if (!yearlyCostText.includes('¬£') && !yearlyCostText.includes('$')) {
        alert('Please calculate current usage first.');
        return;
    }
    
    // Show comparison modal
    const comparisonHTML = `
        <div style="padding:20px;">
            <h3 style="color:var(--accent);margin:0 0 16px 0;">üîç Efficiency Comparison</h3>
            <div style="
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 16px;
                margin-bottom: 20px;
            ">
                <div style="
                    padding: 16px;
                    background: rgba(45,212,255,0.1);
                    border: 2px solid var(--accent);
                    border-radius: 10px;
                    text-align: center;
                ">
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Current</div>
                    <div style="font-size:1.5rem;color:var(--accent);font-weight:600;">${currentPower}W</div>
                </div>
                
                <div style="
                    padding: 16px;
                    background: rgba(57,255,20,0.1);
                    border: 2px solid #39ff14;
                    border-radius: 10px;
                    text-align: center;
                ">
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Efficient</div>
                    <div style="font-size:1.5rem;color:#39ff14;font-weight:600;">${Math.round(currentPower * 0.7)}W</div>
                </div>
                
                <div style="
                    padding: 16px;
                    background: rgba(157,78,221,0.1);
                    border: 2px solid #9d4edd;
                    border-radius: 10px;
                    text-align: center;
                ">
                    <div style="font-size:0.9rem;color:rgba(230,250,255,0.7);">Premium</div>
                    <div style="font-size:1.5rem;color:#9d4edd;font-weight:600;">${Math.round(currentPower * 0.5)}W</div>
                </div>
            </div>
            
            <div style="color:rgba(230,250,255,0.8);line-height:1.6;">
                <p>Upgrading to a more efficient model could reduce your energy consumption significantly:</p>
                <ul style="padding-left:20px;">
                    <li><strong>Efficient model (30% less power):</strong> Save ${currencySymbol}${(parseFloat(yearlyCostText.replace(/[^0-9.]/g, '')) * 0.3).toFixed(2)}/year</li>
                    <li><strong>Premium model (50% less power):</strong> Save ${currencySymbol}${(parseFloat(yearlyCostText.replace(/[^0-9.]/g, '')) * 0.5).toFixed(2)}/year</li>
                </ul>
            </div>
        </div>
    `;
    
    // Create modal
    const modal = document.createElement('div');
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.85);
        z-index: 10000;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
    `;
    
    modal.innerHTML = `
        <div style="
            width: 90%;
            max-width: 500px;
            background: var(--panel);
            border-radius: 16px;
            border: 2px solid var(--accent);
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        ">
            ${comparisonHTML}
            <div style="
                padding: 20px;
                border-top: 1px solid rgba(255,255,255,0.1);
                display: flex;
                justify-content: center;
            ">
                <button onclick="this.closest('div[style*=\\'position: fixed\\']').remove()" style="
                    padding: 12px 32px;
                    background: rgba(255,77,77,0.1);
                    border: 2px solid rgba(255,77,77,0.3);
                    border-radius: 10px;
                    color: #ff4d4d;
                    cursor: pointer;
                    font-weight: 600;
                ">
                    Close
                </button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
}

function euReset() {
    // Reset form
    document.getElementById('eu-appliance-name').value = '';
    document.getElementById('eu-appliance-preset').value = 'custom';
    
    // Reset sliders to defaults
    euSetPower(1000);
    document.getElementById('eu-daily-hours').value = 2;
    document.getElementById('eu-daily-hours').dispatchEvent(new Event('input'));
    document.getElementById('eu-days-week').value = 7;
    document.getElementById('eu-days-week').dispatchEvent(new Event('input'));
    euSetPrice(0.30);
    
    // Reset results
    document.getElementById('eu-appliance-title').textContent = '-';
    document.getElementById('eu-total-kwh').textContent = '-';
    document.getElementById('eu-total-cost').textContent = '-';
    document.getElementById('eu-daily-cost').textContent = '-';
    document.getElementById('eu-monthly-cost').textContent = '-';
    document.getElementById('eu-yearly-cost').textContent = '-';
    document.getElementById('eu-carbon').textContent = '-';
    
    // Reset visualizations
    document.getElementById('eu-power-timeline').innerHTML = '<div style="text-align:center;color:rgba(230,250,255,0.5);flex:1;">Calculate to see timeline</div>';
    document.getElementById('eu-cost-distribution').innerHTML = '<div style="text-align:center;color:rgba(230,250,255,0.5);">Calculate to see distribution</div>';
    
    // Hide tips and savings
    document.getElementById('eu-tips-container').style.display = 'none';
    document.getElementById('eu-savings-container').style.display = 'none';
    
    // Reset appliance icon
    document.getElementById('eu-appliance-icon').textContent = '‚ö°';
}

// Add keyboard shortcut (Enter to calculate)
document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.target.matches('textarea, input[type="text"]')) {
        e.preventDefault();
        euCalculate();
    }
});

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        euInitializeSliders();
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes euPulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            
            input[type="range"] {
                -webkit-appearance: none;
                appearance: none;
                height: 8px;
                background: rgba(255,255,255,0.1);
                border-radius: 4px;
                outline: none;
            }
            
            input[type="range"]::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                background: var(--accent);
                cursor: pointer;
                border: 2px solid rgba(255,255,255,0.3);
                box-shadow: 0 0 10px rgba(45,212,255,0.5);
            }
        `;
        document.head.appendChild(style);
        
        // Set default appliance icon
        document.getElementById('eu-appliance-icon').textContent = '‚ö°';
        
        console.log('Energy Usage Calculator ready');
    });
}
</script>

<style>
#energy-usage-calculator-title {
    color: var(--accent);
    margin-top: 0;
    text-align: center;
    position: relative;
    padding-bottom: 12px;
}

#energy-usage-calculator-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 25%;
    width: 50%;
    height: 2px;
    background: linear-gradient(90deg, transparent, #39ff14, var(--accent), #ffcc00, transparent);
    border-radius: 2px;
}

button {
    transition: all 0.2s ease;
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

#eu-appliance-icon {
    transition: all 0.3s ease;
}

@media (max-width: 768px) {
    .results > div > div {
        grid-template-columns: 1fr !important;
    }
    
    #eu-power-timeline {
        overflow-x: auto;
    }
    
    #eu-power-timeline > div {
        min-width: 30px;
    }
}
</style>
