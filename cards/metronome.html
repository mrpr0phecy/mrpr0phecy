<h2 id="metronome-title" style="margin-top:0;">Metronome (General Advice)</h2>

<form aria-describedby="metronome-desc">
  <p id="metronome-desc" class="small">
    Practice rhythm with a metronome. ⚠️ Educational only — always verify timing with a professional device or teacher.
  </p>

  <div class="row" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
    <div class="field">
      <label for="metro-bpm">Tempo (BPM)</label>
      <input id="metro-bpm" type="number" placeholder="e.g. 120" style="width:100%;" />
    </div>

    <div class="field">
      <label for="metro-time">Time Signature</label>
      <select id="metro-time" style="width:100%;">
        <option value="4/4" selected>4/4</option>
        <option value="3/4">3/4</option>
        <option value="6/8">6/8</option>
      </select>
    </div>

    <div class="field">
      <label for="metro-show-facts">Show Metronome Facts</label>
      <select id="metro-show-facts" style="width:100%;">
        <option value="yes" selected>Yes</option>
        <option value="no">No</option>
      </select>
    </div>
  </div>

  <div class="actions" style="margin-top:12px;">
    <button type="button" onclick="metroStart(this)">Start</button>
    <button type="button" class="secondary" onclick="metroStop(this)">Stop</button>
    <button type="button" onclick="metroCopy(this)">Copy Info</button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:12px;">
  <h3 class="small">Metronome Output & Facts</h3>
  <textarea id="metro-output" rows="6" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:inherit;"></textarea>

  <div id="metro-facts-container" style="margin-top:16px;display:none;">
    <ul style="list-style:disc;padding-left:20px;font-size:0.95rem;line-height:1.5;">
      <li>A metronome provides a steady beat to practice timing.</li>
      <li>BPM = beats per minute; higher BPM = faster tempo.</li>
      <li>Common time signatures: 4/4 (pop/rock), 3/4 (waltz), 6/8 (folk).</li>
      <li>⚠️ Always confirm tempo accuracy with a professional metronome or teacher.</li>
    </ul>
  </div>

  <div style="margin-top:8px;">
    <div id="metro-hint" class="small" style="opacity:0.9;"></div>
  </div>
</div>

<script>
/* metronome.html
   - Educational metronome card
   - Scoped with metro- prefix
*/

let metroInterval=null;

function metroStart(btn){
  const card=btn.closest('.card')||document;
  const bpm=parseFloat(card.querySelector('#metro-bpm').value);
  const time=card.querySelector('#metro-time').value;
  const showFacts=card.querySelector('#metro-show-facts').value==="yes";
  if(bpm>0){
    const interval=60000/bpm;
    metroStop(btn);
    metroInterval=setInterval(()=>{
      console.log("Tick"); // placeholder for beat sound
    },interval);
    card.querySelector('#metro-output').value=`Metronome started at ${bpm} BPM (${time}).\n⚠️ Verify with professional device.`;
    card.querySelector('#metro-hint').textContent="Metronome running.";
    card.querySelector('#metro-facts-container').style.display=showFacts?"block":"none";
  } else {
    card.querySelector('#metro-output').value="Please enter a valid BPM.";
  }
}

function metroStop(btn){
  clearInterval(metroInterval);
  metroInterval=null;
  const card=btn.closest('.card')||document;
  card.querySelector('#metro-hint').textContent="Metronome stopped.";
}

function metroCopy(btn){
  const card=btn.closest('.card')||document;
  const out=card.querySelector('#metro-output').value;
  if(!out.trim())return;
  navigator.clipboard?.writeText(out).then(()=>{
    const h=card.querySelector('#metro-hint');
    h.textContent="Copied.";
    setTimeout(()=>{if(h.textContent==="Copied.")h.textContent="";},1600);
  });
}
