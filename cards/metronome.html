<h2 id="metro-title" style="margin-top:0;color:var(--accent);">üéµ Professional Metronome</h2>

<form aria-describedby="metro-desc">
  <p id="metro-desc" class="small" style="color:var(--muted);margin-bottom:16px;">
    Precise audible & visual metronome with subdivisions, tap tempo, and tempo presets.
    <span style="color:#ffcc00;font-weight:500;">‚ö†Ô∏è Enable sound in your browser</span>
  </p>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px;">
    <div>
      <label for="metro-bpm" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">BPM (20-300)</label>
      <input id="metro-bpm" type="number" value="120" min="20" max="300" 
             style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;text-align:center;" />
    </div>

    <div>
      <label for="metro-timesig" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Time Signature</label>
      <select id="metro-timesig" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
        <option value="4,4" selected>4/4 (Common Time)</option>
        <option value="3,4">3/4 (Waltz)</option>
        <option value="6,8">6/8</option>
        <option value="2,4">2/4</option>
        <option value="5,4">5/4</option>
        <option value="7,8">7/8</option>
        <option value="12,8">12/8</option>
      </select>
    </div>

    <div>
      <label for="metro-subdivision" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Subdivision</label>
      <select id="metro-subdivision" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
        <option value="1">Quarter Notes</option>
        <option value="2">Eighth Notes</option>
        <option value="3">Triplets</option>
        <option value="4">Sixteenth Notes</option>
        <option value="6">Sextuplets</option>
      </select>
    </div>

    <div>
      <label for="metro-sound" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">Sound Type</label>
      <select id="metro-sound" 
              style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;cursor:pointer;">
        <option value="click">Click</option>
        <option value="beep">Beep</option>
        <option value="wood">Wood Block</option>
        <option value="bell">Bell</option>
        <option value="none">Silent (Visual Only)</option>
      </select>
    </div>
  </div>

  <div style="margin-bottom:20px;">
    <label for="metro-volume" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
      Volume: <span id="metro-volume-value">80</span>%
    </label>
    <input type="range" id="metro-volume" min="0" max="100" value="80" 
           style="width:100%;height:8px;background:rgba(45,212,255,0.2);border-radius:4px;cursor:pointer;" />
  </div>

  <div style="display:flex;gap:10px;margin-top:20px;">
    <button type="button" onclick="metroStart(this)" id="metro-start-btn"
            style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(57,255,20,0.2), rgba(57,255,20,0.1));border:1px solid rgba(57,255,20,0.4);color:#39ff14;border-radius:8px;cursor:pointer;font-weight:600;">
      ‚ñ∂Ô∏è Start
    </button>
    <button type="button" onclick="metroStop(this)" id="metro-stop-btn" disabled
            style="padding:12px 16px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;">
      ‚èπÔ∏è Stop
    </button>
    <button type="button" onclick="metroTap(this)"
            style="padding:12px 16px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);color:#ffa500;border-radius:8px;cursor:pointer;">
      üëÜ Tap Tempo
    </button>
  </div>
</form>

<div aria-live="polite" style="margin-top:20px;">
  <h3 class="small" style="color:var(--accent);margin-bottom:12px;">Metronome Display</h3>
  
  <div id="metro-display" style="background:rgba(0,0,0,0.2);border-radius:12px;padding:20px;margin-bottom:16px;text-align:center;position:relative;overflow:hidden;border:1px solid rgba(45,212,255,0.1);">
    <div style="font-size:64px;font-weight:bold;color:var(--accent);" id="metro-bpm-display">120</div>
    <div style="font-size:14px;color:var(--muted);margin-top:8px;" id="metro-tempo-name">Allegro</div>
    
    <div id="metro-beat-visualizer" style="display:flex;justify-content:center;gap:12px;margin:24px 0;height:80px;align-items:center;">
      <!-- Beat circles will be generated here -->
    </div>
    
    <div style="font-size:13px;color:var(--muted);font-family:monospace;" id="metro-beat-count">
      Beat: 0 | Bar: 0
    </div>
  </div>

  <div style="margin-top:20px;">
    <h4 class="small" style="color:var(--accent);margin-bottom:8px;">üéØ Tempo Presets</h4>
    <div style="display:flex;flex-wrap:wrap;gap:8px;">
      <button onclick="metroSetTempo(40)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">40 Largo</button>
      <button onclick="metroSetTempo(60)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">60 Adagio</button>
      <button onclick="metroSetTempo(72)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">72 Andante</button>
      <button onclick="metroSetTempo(90)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">90 Moderato</button>
      <button onclick="metroSetTempo(120)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">120 Allegro</button>
      <button onclick="metroSetTempo(160)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">160 Vivace</button>
      <button onclick="metroSetTempo(180)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">180 Presto</button>
    </div>
  </div>

  <div id="metro-hint" class="small" style="color:#ffcc00;margin-top:16px;text-align:center;min-height:20px;padding:8px;background:rgba(255,204,0,0.05);border-radius:8px;"></div>
</div>

<script>
/* metronome.html
   - Professional metronome with audio and visual feedback
   - Scoped with metro- prefix
   - Theme-aware styling
   - localStorage persistence
*/

(function() {
  'use strict';
  
  const card = document.currentScript?.closest('.card') || document;
  
  // State variables
  let metroActive = false;
  let metroAudioContext = null;
  let metroOscillator = null;
  let metroGainNode = null;
  let metroNextBeatTime = 0;
  let metroBeatInterval = 0;
  let metroBeatCount = 0;
  let metroBarCount = 0;
  let metroBeatsPerBar = 4;
  let metroCurrentBPM = 120;
  let metroTapTimes = [];
  let metroAnimationFrame = null;
  let metroBeatCircles = [];
  let metroTapTimeout = null;
  
  // Initialize function
  function metroInit() {
    console.log('Metronome initializing...');
    
    // Load saved settings
    const savedSettings = localStorage.getItem('metro-settings');
    if (savedSettings) {
      try {
        const settings = JSON.parse(savedSettings);
        if (settings.bpm) {
          card.querySelector('#metro-bpm').value = settings.bpm;
          metroCurrentBPM = settings.bpm;
        }
        if (settings.timesig) card.querySelector('#metro-timesig').value = settings.timesig;
        if (settings.subdivision) card.querySelector('#metro-subdivision').value = settings.subdivision;
        if (settings.sound) card.querySelector('#metro-sound').value = settings.sound;
        if (settings.volume) {
          card.querySelector('#metro-volume').value = settings.volume;
          card.querySelector('#metro-volume-value').textContent = settings.volume;
        }
      } catch (e) {
        console.log('Could not load saved settings:', e);
      }
    }
    
    // Setup event listeners
    metroSetupEventListeners();
    
    // Create beat visualizer
    metroCreateBeatVisualizer();
    
    // Update tempo name
    metroUpdateTempoName();
    
    // Update display
    card.querySelector('#metro-bpm-display').textContent = metroCurrentBPM;
    
    // Show initial hint
    metroShowHint('üéµ Ready to start metronome', 'info');
    
    // Auto-start if previously running (optional)
    const wasRunning = localStorage.getItem('metro-running') === 'true';
    if (wasRunning) {
      setTimeout(() => metroStart(), 500);
    }
  }
  
  // Setup event listeners
  function metroSetupEventListeners() {
    // BPM input
    card.querySelector('#metro-bpm').addEventListener('input', function() {
      const bpm = Math.max(20, Math.min(300, parseInt(this.value) || 120));
      this.value = bpm;
      metroCurrentBPM = bpm;
      card.querySelector('#metro-bpm-display').textContent = bpm;
      metroUpdateTempoName();
      metroSaveSettings();
      
      if (metroActive) {
        metroStop();
        metroStart();
      }
    });
    
    // Volume slider
    card.querySelector('#metro-volume').addEventListener('input', function() {
      const volume = this.value;
      card.querySelector('#metro-volume-value').textContent = volume;
      
      if (metroGainNode) {
        metroGainNode.gain.value = volume / 100;
      }
      
      metroSaveSettings();
    });
    
    // Time signature
    card.querySelector('#metro-timesig').addEventListener('change', function() {
      const parts = this.value.split(',');
      metroBeatsPerBar = parseInt(parts[0]);
      metroCreateBeatVisualizer();
      metroSaveSettings();
      
      if (metroActive) {
        metroStop();
        metroStart();
      }
    });
    
    // Subdivision
    card.querySelector('#metro-subdivision').addEventListener('change', function() {
      metroSaveSettings();
      
      if (metroActive) {
        metroStop();
        metroStart();
      }
    });
    
    // Sound type
    card.querySelector('#metro-sound').addEventListener('change', function() {
      metroSaveSettings();
      
      if (metroActive) {
        metroStop();
        metroStart();
      }
    });
  }
  
  // Create beat visualizer circles
  function metroCreateBeatVisualizer() {
    const visualizer = card.querySelector('#metro-beat-visualizer');
    visualizer.innerHTML = '';
    metroBeatCircles = [];
    
    // Create circles for each beat
    for (let i = 0; i < metroBeatsPerBar; i++) {
      const circle = document.createElement('div');
      circle.className = 'metro-beat-circle';
      circle.style.width = '50px';
      circle.style.height = '50px';
      circle.style.borderRadius = '50%';
      circle.style.background = 'rgba(255,255,255,0.05)';
      circle.style.border = '2px solid rgba(45,212,255,0.2)';
      circle.style.transition = 'all 0.1s ease';
      
      if (i === 0) {
        circle.style.background = 'var(--accent)';
        circle.style.opacity = '0.5';
      }
      
      visualizer.appendChild(circle);
      metroBeatCircles.push(circle);
    }
  }
  
  // Update tempo name based on BPM
  function metroUpdateTempoName() {
    const bpm = metroCurrentBPM;
    let tempoName = '';
    
    if (bpm < 40) tempoName = 'Grave (Very Slow)';
    else if (bpm < 60) tempoName = 'Largo (Broad)';
    else if (bpm < 72) tempoName = 'Adagio (Slow)';
    else if (bpm < 96) tempoName = 'Andante (Walking)';
    else if (bpm < 108) tempoName = 'Moderato (Moderate)';
    else if (bpm < 120) tempoName = 'Allegretto (Moderately Fast)';
    else if (bpm < 156) tempoName = 'Allegro (Fast)';
    else if (bpm < 176) tempoName = 'Vivace (Lively)';
    else if (bpm < 200) tempoName = 'Presto (Very Fast)';
    else tempoName = 'Prestissimo (Extremely Fast)';
    
    card.querySelector('#metro-tempo-name').textContent = tempoName;
  }
  
  // Initialize audio context
  function metroInitAudioContext() {
    if (metroAudioContext) return;
    
    try {
      metroAudioContext = new (window.AudioContext || window.webkitAudioContext)();
      metroShowHint('‚úÖ Audio initialized', 'success');
      return true;
    } catch (error) {
      console.error('Audio context failed:', error);
      metroShowHint('‚ö†Ô∏è Audio not supported - Visual only mode', 'warning');
      return false;
    }
  }
  
  // Start metronome
  function metroStart(btn) {
    if (metroActive) return;
    
    // Initialize audio context if needed
    const soundType = card.querySelector('#metro-sound').value;
    if (soundType !== 'none') {
      if (!metroInitAudioContext()) {
        // If audio fails, switch to visual mode
        card.querySelector('#metro-sound').value = 'none';
        metroShowHint('üîá Switched to visual mode', 'warning');
      }
    }
    
    metroActive = true;
    metroBeatCount = 0;
    metroBarCount = 0;
    
    // Calculate beat interval
    metroBeatInterval = (60 / metroCurrentBPM) * 1000;
    
    // Reset visualizer
    metroBeatCircles.forEach((circle, index) => {
      circle.style.background = 'rgba(255,255,255,0.05)';
      circle.style.border = '2px solid rgba(45,212,255,0.2)';
      circle.style.transform = 'scale(1)';
      circle.style.boxShadow = 'none';
      
      if (index === 0) {
        circle.style.background = 'var(--accent)';
        circle.style.opacity = '0.5';
      }
    });
    
    // Update UI
    card.querySelector('#metro-start-btn').textContent = '‚è∏Ô∏è Pause';
    card.querySelector('#metro-start-btn').style.background = 'linear-gradient(135deg, rgba(255,165,0,0.2), rgba(255,165,0,0.1))';
    card.querySelector('#metro-start-btn').style.borderColor = 'rgba(255,165,0,0.4)';
    card.querySelector('#metro-start-btn').style.color = '#ffa500';
    card.querySelector('#metro-stop-btn').disabled = false;
    
    // Start beat loop
    metroNextBeatTime = performance.now();
    metroScheduleBeat();
    
    metroShowHint('‚ñ∂Ô∏è Metronome started', 'success');
    localStorage.setItem('metro-running', 'true');
  }
  
  // Schedule next beat
  function metroScheduleBeat() {
    if (!metroActive) return;
    
    const now = performance.now();
    
    // Schedule beats if we're behind
    while (metroNextBeatTime < now + 100) {
      const beatTime = metroNextBeatTime;
      
      setTimeout(() => {
        if (metroActive) {
          metroPlayBeat();
          metroUpdateBeatDisplay();
        }
      }, Math.max(0, beatTime - now));
      
      metroNextBeatTime += metroBeatInterval;
    }
    
    // Continue scheduling
    metroAnimationFrame = requestAnimationFrame(metroScheduleBeat);
  }
  
  // Play beat sound
  function metroPlayBeat() {
    const soundType = card.querySelector('#metro-sound').value;
    if (soundType === 'none' || !metroAudioContext) return;
    
    try {
      metroOscillator = metroAudioContext.createOscillator();
      metroGainNode = metroAudioContext.createGain();
      
      // Configure sound
      let frequency = 800;
      let type = 'sine';
      
      switch(soundType) {
        case 'click':
          frequency = metroBeatCount === 0 ? 1200 : 800;
          type = 'square';
          break;
        case 'beep':
          frequency = metroBeatCount === 0 ? 1000 : 600;
          type = 'sine';
          break;
        case 'wood':
          frequency = metroBeatCount === 0 ? 400 : 300;
          type = 'sawtooth';
          break;
        case 'bell':
          frequency = metroBeatCount === 0 ? 2000 : 1500;
          type = 'sine';
          break;
      }
      
      // Configure oscillator
      metroOscillator.type = type;
      metroOscillator.frequency.setValueAtTime(frequency, metroAudioContext.currentTime);
      
      // Configure volume envelope
      const volume = card.querySelector('#metro-volume').value / 100;
      metroGainNode.gain.setValueAtTime(0.001, metroAudioContext.currentTime);
      metroGainNode.gain.exponentialRampToValueAtTime(volume * 0.3, metroAudioContext.currentTime + 0.001);
      metroGainNode.gain.exponentialRampToValueAtTime(0.001, metroAudioContext.currentTime + 0.05);
      
      // Connect and play
      metroOscillator.connect(metroGainNode);
      metroGainNode.connect(metroAudioContext.destination);
      
      metroOscillator.start();
      metroOscillator.stop(metroAudioContext.currentTime + 0.1);
      
    } catch (error) {
      console.warn('Audio play failed:', error);
      // Silently fail - visual only
    }
  }
  
  // Update beat display
  function metroUpdateBeatDisplay() {
    // Update counters
    metroBeatCount = (metroBeatCount % metroBeatsPerBar) + 1;
    if (metroBeatCount === 1) {
      metroBarCount++;
    }
    
    // Update text display
    card.querySelector('#metro-beat-count').textContent = 
      `Beat: ${metroBeatCount} | Bar: ${metroBarCount}`;
    
    // Update visualizer
    metroBeatCircles.forEach((circle, index) => {
      circle.style.background = 'rgba(255,255,255,0.05)';
      circle.style.border = '2px solid rgba(45,212,255,0.2)';
      circle.style.transform = 'scale(1)';
      circle.style.boxShadow = 'none';
      circle.style.opacity = '1';
      
      if (index === metroBeatCount - 1) {
        // Active beat
        circle.style.background = 'var(--accent)';
        circle.style.transform = 'scale(1.2)';
        circle.style.boxShadow = '0 0 20px rgba(45,212,255,0.5)';
        
        if (metroBeatCount === 1) {
          // First beat (accent)
          circle.style.opacity = '1';
        }
      } else if (index === 0) {
        // First beat (always highlighted)
        circle.style.background = 'var(--accent)';
        circle.style.opacity = '0.5';
      }
    });
    
    // Flash effect
    const display = card.querySelector('#metro-display');
    display.style.animation = 'none';
    setTimeout(() => {
      display.style.animation = 'metroFlash 0.15s ease';
    }, 10);
  }
  
  // Stop metronome
  function metroStop(btn) {
    if (!metroActive) return;
    
    metroActive = false;
    
    // Stop audio
    if (metroOscillator) {
      try {
        metroOscillator.stop();
      } catch (e) {}
    }
    
    // Stop animation frame
    if (metroAnimationFrame) {
      cancelAnimationFrame(metroAnimationFrame);
      metroAnimationFrame = null;
    }
    
    // Reset UI
    card.querySelector('#metro-start-btn').textContent = '‚ñ∂Ô∏è Start';
    card.querySelector('#metro-start-btn').style.background = 'linear-gradient(135deg, rgba(57,255,20,0.2), rgba(57,255,20,0.1))';
    card.querySelector('#metro-start-btn').style.borderColor = 'rgba(57,255,20,0.4)';
    card.querySelector('#metro-start-btn').style.color = '#39ff14';
    card.querySelector('#metro-stop-btn').disabled = true;
    
    // Reset visualizer
    metroBeatCircles.forEach((circle, index) => {
      circle.style.background = 'rgba(255,255,255,0.05)';
      circle.style.border = '2px solid rgba(45,212,255,0.2)';
      circle.style.transform = 'scale(1)';
      circle.style.boxShadow = 'none';
      circle.style.opacity = '1';
      
      if (index === 0) {
        circle.style.background = 'var(--accent)';
        circle.style.opacity = '0.5';
      }
    });
    
    metroShowHint('‚èπÔ∏è Metronome stopped', 'info');
    localStorage.setItem('metro-running', 'false');
  }
  
  // Tap tempo function
  function metroTap(btn) {
    const tapBtn = card.querySelector('#metro-tap-btn');
    const now = Date.now();
    
    // Visual feedback
    tapBtn.style.animation = 'none';
    setTimeout(() => {
      tapBtn.style.animation = 'metroTapPulse 0.3s ease';
    }, 10);
    
    // Add tap time
    metroTapTimes.push(now);
    
    // Keep only last 5 taps
    if (metroTapTimes.length > 5) {
      metroTapTimes.shift();
    }
    
    // Calculate BPM if we have at least 2 taps
    if (metroTapTimes.length >= 2) {
      const intervals = [];
      for (let i = 1; i < metroTapTimes.length; i++) {
        intervals.push(metroTapTimes[i] - metroTapTimes[i - 1]);
      }
      
      const avgInterval = intervals.reduce((a, b) => a + b) / intervals.length;
      let calculatedBPM = Math.round(60000 / avgInterval);
      
      // Limit to reasonable range
      calculatedBPM = Math.max(20, Math.min(300, calculatedBPM));
      
      // Update BPM
      metroCurrentBPM = calculatedBPM;
      card.querySelector('#metro-bpm').value = calculatedBPM;
      card.querySelector('#metro-bpm-display').textContent = calculatedBPM;
      metroUpdateTempoName();
      metroSaveSettings();
      
      // Restart if running
      if (metroActive) {
        metroStop();
        metroStart();
      }
      
      metroShowHint(`üéØ Tempo set to ${calculatedBPM} BPM`, 'success');
    } else {
      metroShowHint(`üëÜ Tap ${5 - metroTapTimes.length + 1} more times...`, 'info');
    }
    
    // Clear old taps
    clearTimeout(metroTapTimeout);
    metroTapTimeout = setTimeout(() => {
      metroTapTimes = [];
    }, 3000);
  }
  
  // Set tempo from preset
  function metroSetTempo(bpm) {
    metroCurrentBPM = bpm;
    card.querySelector('#metro-bpm').value = bpm;
    card.querySelector('#metro-bpm-display').textContent = bpm;
    metroUpdateTempoName();
    metroSaveSettings();
    
    if (metroActive) {
      metroStop();
      metroStart();
    }
    
    metroShowHint(`üéØ Tempo set to ${bpm} BPM`, 'success');
  }
  
  // Save settings to localStorage
  function metroSaveSettings() {
    const settings = {
      bpm: metroCurrentBPM,
      timesig: card.querySelector('#metro-timesig').value,
      subdivision: card.querySelector('#metro-subdivision').value,
      sound: card.querySelector('#metro-sound').value,
      volume: card.querySelector('#metro-volume').value,
      lastUpdated: new Date().toISOString()
    };
    
    localStorage.setItem('metro-settings', JSON.stringify(settings));
  }
  
  // Show hint message
  function metroShowHint(message, type = 'info') {
    const hint = card.querySelector('#metro-hint');
    hint.textContent = message;
    hint.style.color = type === 'error' ? '#ff4d4d' : 
                       type === 'warning' ? '#ffcc00' : 
                       type === 'success' ? '#39ff14' : 
                       '#2dd4ff';
    
    // Auto-clear after delay
    clearTimeout(hint.timeout);
    hint.timeout = setTimeout(() => {
      if (hint.textContent === message) {
        hint.textContent = '';
      }
    }, 3000);
  }
  
  // Expose functions globally (with prefix)
  window.metroStart = metroStart;
  window.metroStop = metroStop;
  window.metroTap = metroTap;
  window.metroSetTempo = metroSetTempo;
  
  // Initialize when ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', metroInit);
  } else {
    metroInit();
  }
  
})();
</script>

<style>
/* Metronome-specific styles */
#metro-title {
  color: var(--accent);
  margin-top: 0;
}

/* Animations */
@keyframes metroFlash {
  0% { opacity: 1; }
  50% { opacity: 0.8; }
  100% { opacity: 1; }
}

@keyframes metroTapPulse {
  0% { transform: scale(1); }
  50% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

/* Responsive design */
@media (max-width: 768px) {
  #metro-bpm-display {
    font-size: 48px !important;
  }
  
  .metro-beat-circle {
    width: 40px !important;
    height: 40px !important;
  }
  
  div[style*="grid-template-columns:1fr 1fr"] {
    grid-template-columns: 1fr !important;
    gap: 16px !important;
  }
  
  #metro-beat-visualizer {
    gap: 8px !important;
    height: 60px !important;
  }
}

@media (max-width: 480px) {
  #metro-bpm-display {
    font-size: 36px !important;
  }
  
  .metro-beat-circle {
    width: 32px !important;
    height: 32px !important;
  }
  
  .actions {
    flex-direction: column !important;
  }
  
  .actions button {
    width: 100% !important;
    margin-bottom: 8px;
  }
}

/* Custom scrollbar for audio context warning */
#metro-hint::-webkit-scrollbar {
  width: 6px;
}

#metro-hint::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.05);
  border-radius: 3px;
}

#metro-hint::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 3px;
}
</style>
