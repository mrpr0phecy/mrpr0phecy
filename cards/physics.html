<h2 id="physics-calculator-title">üî¨ Physics Toolkit</h2>

<form aria-describedby="physics-calculator-desc">
    <p id="physics-calculator-desc" class="small">
        Calculate common physics formulas: motion, forces, energy, and more.
        <span style="color:var(--accent)">Select a formula to begin.</span>
    </p>
    
    <!-- FORMULA SELECTION -->
    <div class="field" style="margin-bottom:16px;">
        <label for="pc-formula" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Select Formula
        </label>
        <select id="pc-formula" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
            <option value="velocity">Velocity (v = d/t)</option>
            <option value="acceleration">Acceleration (a = Œîv/Œît)</option>
            <option value="force">Force (F = ma)</option>
            <option value="kinetic">Kinetic Energy (KE = ¬Ωmv¬≤)</option>
            <option value="potential">Potential Energy (PE = mgh)</option>
            <option value="power">Power (P = W/t)</option>
            <option value="momentum">Momentum (p = mv)</option>
            <option value="work">Work (W = Fd)</option>
            <option value="ohms">Ohm's Law (V = IR)</option>
            <option value="gravity">Gravity (F = Gm‚ÇÅm‚ÇÇ/r¬≤)</option>
        </select>
    </div>
    
    <!-- DYNAMIC INPUT FIELDS -->
    <div id="pc-inputs" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px;">
        <!-- Inputs will be generated here based on formula selection -->
        <div>
            <label for="pc-input1" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Distance (m)
            </label>
            <input id="pc-input1" type="number" placeholder="Enter value" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
        </div>
        <div>
            <label for="pc-input2" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Time (s)
            </label>
            <input id="pc-input2" type="number" placeholder="Enter value" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
        </div>
    </div>
    
    <!-- CONSTANTS (for gravity formula) -->
    <div id="pc-constants" style="display:none;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:20px;">
        <div>
            <label for="pc-const1" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                G (N‚ãÖm¬≤/kg¬≤)
            </label>
            <input id="pc-const1" type="number" value="6.67430e-11" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;" />
        </div>
        <div>
            <label for="pc-const2" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                m‚ÇÅ (kg)
            </label>
            <input id="pc-const2" type="number" value="5.972e24" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;" />
        </div>
        <div>
            <label for="pc-const3" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                m‚ÇÇ (kg)
            </label>
            <input id="pc-const3" type="number" value="1000" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;font-family:monospace;" />
        </div>
    </div>
    
    <!-- ACTIONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="pcCalculate()" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
            Calculate
        </button>
        <button type="button" onclick="pcReset()"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Reset
        </button>
        <button type="button" onclick="pcSwapUnits()"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Swap
        </button>
    </div>
</form>

<!-- RESULTS -->
<div class="results" aria-live="polite" style="margin-top:16px;">
    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üìä Results</h3>
    <div id="pc-output" style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);font-family:monospace;white-space:pre-line;min-height:80px;">
Select a formula and enter values to calculate.
    </div>
</div>

<!-- UNIT CONVERSION -->
<div style="margin-top:20px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.1);">
    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üîÑ Unit Converter</h3>
    <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:end;">
        <div>
            <input id="pc-unit-value" type="number" placeholder="Value" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
        </div>
        <div style="text-align:center;padding-bottom:8px;">
            <button type="button" onclick="pcConvertUnits()" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:20px;">‚áÑ</button>
        </div>
        <div>
            <input id="pc-unit-result" type="text" readonly
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:#39ff14;" />
        </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px;">
        <select id="pc-unit-from" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
            <option value="meter">Meter (m)</option>
            <option value="kilometer">Kilometer (km)</option>
            <option value="mile">Mile (mi)</option>
            <option value="foot">Foot (ft)</option>
        </select>
        <select id="pc-unit-to" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
            <option value="meter">Meter (m)</option>
            <option value="kilometer">Kilometer (km)</option>
            <option value="mile" selected>Mile (mi)</option>
            <option value="foot">Foot (ft)</option>
        </select>
    </div>
</div>

<script>
/* physics-calculator.html
   - Comprehensive physics calculator
   - Scoped with pc- prefix
*/

// Formula configurations
const pcFormulas = {
    velocity: {
        name: "Velocity",
        formula: "v = d/t",
        inputs: [
            { id: "pc-input1", label: "Distance (m)", placeholder: "e.g., 100" },
            { id: "pc-input2", label: "Time (s)", placeholder: "e.g., 10" }
        ],
        calculate: (d, t) => d / t,
        unit: "m/s",
        description: "Velocity = Distance / Time"
    },
    acceleration: {
        name: "Acceleration",
        formula: "a = Œîv/Œît",
        inputs: [
            { id: "pc-input1", label: "Œî Velocity (m/s)", placeholder: "e.g., 20" },
            { id: "pc-input2", label: "Œî Time (s)", placeholder: "e.g., 5" }
        ],
        calculate: (dv, dt) => dv / dt,
        unit: "m/s¬≤",
        description: "Acceleration = Change in Velocity / Change in Time"
    },
    force: {
        name: "Force",
        formula: "F = ma",
        inputs: [
            { id: "pc-input1", label: "Mass (kg)", placeholder: "e.g., 5" },
            { id: "pc-input2", label: "Acceleration (m/s¬≤)", placeholder: "e.g., 9.8" }
        ],
        calculate: (m, a) => m * a,
        unit: "N",
        description: "Force = Mass √ó Acceleration"
    },
    kinetic: {
        name: "Kinetic Energy",
        formula: "KE = ¬Ωmv¬≤",
        inputs: [
            { id: "pc-input1", label: "Mass (kg)", placeholder: "e.g., 10" },
            { id: "pc-input2", label: "Velocity (m/s)", placeholder: "e.g., 5" }
        ],
        calculate: (m, v) => 0.5 * m * v * v,
        unit: "J",
        description: "Kinetic Energy = ¬Ω √ó Mass √ó Velocity¬≤"
    },
    potential: {
        name: "Potential Energy",
        formula: "PE = mgh",
        inputs: [
            { id: "pc-input1", label: "Mass (kg)", placeholder: "e.g., 5" },
            { id: "pc-input2", label: "Height (m)", placeholder: "e.g., 10" }
        ],
        calculate: (m, h) => m * 9.8 * h,
        unit: "J",
        description: "Potential Energy = Mass √ó Gravity √ó Height (g ‚âà 9.8 m/s¬≤)"
    },
    power: {
        name: "Power",
        formula: "P = W/t",
        inputs: [
            { id: "pc-input1", label: "Work (J)", placeholder: "e.g., 1000" },
            { id: "pc-input2", label: "Time (s)", placeholder: "e.g., 10" }
        ],
        calculate: (w, t) => w / t,
        unit: "W",
        description: "Power = Work / Time"
    },
    momentum: {
        name: "Momentum",
        formula: "p = mv",
        inputs: [
            { id: "pc-input1", label: "Mass (kg)", placeholder: "e.g., 2" },
            { id: "pc-input2", label: "Velocity (m/s)", placeholder: "e.g., 10" }
        ],
        calculate: (m, v) => m * v,
        unit: "kg‚ãÖm/s",
        description: "Momentum = Mass √ó Velocity"
    },
    work: {
        name: "Work",
        formula: "W = Fd",
        inputs: [
            { id: "pc-input1", label: "Force (N)", placeholder: "e.g., 50" },
            { id: "pc-input2", label: "Distance (m)", placeholder: "e.g., 10" }
        ],
        calculate: (f, d) => f * d,
        unit: "J",
        description: "Work = Force √ó Distance"
    },
    ohms: {
        name: "Ohm's Law",
        formula: "V = IR",
        inputs: [
            { id: "pc-input1", label: "Current (A)", placeholder: "e.g., 2" },
            { id: "pc-input2", label: "Resistance (Œ©)", placeholder: "e.g., 10" }
        ],
        calculate: (i, r) => i * r,
        unit: "V",
        description: "Voltage = Current √ó Resistance"
    },
    gravity: {
        name: "Gravitational Force",
        formula: "F = Gm‚ÇÅm‚ÇÇ/r¬≤",
        inputs: [
            { id: "pc-input1", label: "Distance (m)", placeholder: "e.g., 6371000" },
            { id: "pc-input2", label: "", placeholder: "" }
        ],
        calculate: (r, g, m1, m2) => g * m1 * m2 / (r * r),
        unit: "N",
        description: "Gravitational Force = G √ó m‚ÇÅ √ó m‚ÇÇ / r¬≤"
    }
};

// Unit conversion factors (relative to meters)
const pcUnitFactors = {
    meter: 1,
    kilometer: 1000,
    mile: 1609.34,
    foot: 0.3048
};

let currentFormula = 'velocity';

// Update input fields based on selected formula
function pcUpdateInputs() {
    const card = document.currentScript?.closest('.card') || document;
    const formulaSelect = card.querySelector('#pc-formula');
    const inputsContainer = card.querySelector('#pc-inputs');
    const constantsContainer = card.querySelector('#pc-constants');
    
    currentFormula = formulaSelect.value;
    const formula = pcFormulas[currentFormula];
    
    // Clear existing inputs
    inputsContainer.innerHTML = '';
    
    // Create new input fields
    formula.inputs.forEach((input, index) => {
        if (input.label) { // Skip empty labels (for gravity)
            const div = document.createElement('div');
            div.innerHTML = `
                <label for="${input.id}" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    ${input.label}
                </label>
                <input id="${input.id}" type="number" placeholder="${input.placeholder}" step="any"
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
            `;
            inputsContainer.appendChild(div);
        }
    });
    
    // Show/hide constants for gravity formula
    if (currentFormula === 'gravity') {
        constantsContainer.style.display = 'grid';
        // Update description
        const desc = card.querySelector('#physics-calculator-desc');
        desc.innerHTML = `Calculate gravitational force between two masses. <span style="color:var(--accent)">G = 6.67430√ó10‚Åª¬π¬π N‚ãÖm¬≤/kg¬≤</span>`;
    } else {
        constantsContainer.style.display = 'none';
        // Reset description
        const desc = card.querySelector('#physics-calculator-desc');
        desc.innerHTML = `Calculate common physics formulas: motion, forces, energy, and more. <span style="color:var(--accent)">Select a formula to begin.</span>`;
    }
    
    // Clear results
    card.querySelector('#pc-output').textContent = 'Enter values and click Calculate.';
}

// Main calculation function
function pcCalculate() {
    const card = document.currentScript?.closest('.card') || document;
    const formula = pcFormulas[currentFormula];
    
    try {
        let result;
        let calculationText = '';
        
        if (currentFormula === 'gravity') {
            // Gravity requires constants
            const r = parseFloat(card.querySelector('#pc-input1').value);
            const G = parseFloat(card.querySelector('#pc-const1').value);
            const m1 = parseFloat(card.querySelector('#pc-const2').value);
            const m2 = parseFloat(card.querySelector('#pc-const3').value);
            
            if (!r || r <= 0) {
                throw new Error('Please enter a valid distance > 0');
            }
            
            result = formula.calculate(r, G, m1, m2);
            
            calculationText = `Gravitational Force Calculation:\n`;
            calculationText += `Distance (r): ${r.toExponential(2)} m\n`;
            calculationText += `Gravitational constant (G): ${G.toExponential(2)} N‚ãÖm¬≤/kg¬≤\n`;
            calculationText += `Mass 1 (m‚ÇÅ): ${m1.toExponential(2)} kg\n`;
            calculationText += `Mass 2 (m‚ÇÇ): ${m2.toExponential(2)} kg\n`;
            calculationText += `\n${formula.formula}\n`;
            calculationText += `F = (${G.toExponential(2)} √ó ${m1.toExponential(2)} √ó ${m2.toExponential(2)}) / (${r}¬≤)\n`;
            calculationText += `F = ${result.toExponential(4)} ${formula.unit}`;
            
        } else {
            // Regular formulas
            const input1 = parseFloat(card.querySelector('#pc-input1').value);
            const input2 = parseFloat(card.querySelector('#pc-input2').value);
            
            if (isNaN(input1) || isNaN(input2)) {
                throw new Error('Please enter valid numbers in both fields');
            }
            
            result = formula.calculate(input1, input2);
            
            calculationText = `${formula.name} Calculation:\n`;
            calculationText += `${formula.description}\n`;
            calculationText += `\n${formula.formula}\n`;
            
            if (currentFormula === 'kinetic') {
                calculationText += `KE = ¬Ω √ó ${input1} √ó (${input2})¬≤\n`;
                calculationText += `KE = ¬Ω √ó ${input1} √ó ${(input2 * input2).toFixed(2)}\n`;
            } else if (currentFormula === 'potential') {
                calculationText += `PE = ${input1} √ó 9.8 √ó ${input2}\n`;
            } else {
                calculationText += `${formula.formula.split('=')[1].trim().replace('m', input1).replace('a', input2).replace('v', input2).replace('d', input1).replace('t', input2)}\n`;
            }
            
            calculationText += `\nResult: ${result.toFixed(4)} ${formula.unit}`;
            
            // Add scientific notation for very large/small numbers
            if (Math.abs(result) > 10000 || (Math.abs(result) < 0.001 && result !== 0)) {
                calculationText += `\nScientific: ${result.toExponential(4)} ${formula.unit}`;
            }
        }
        
        card.querySelector('#pc-output').textContent = calculationText;
        
    } catch (error) {
        card.querySelector('#pc-output').textContent = `Error: ${error.message}`;
    }
}

// Reset all inputs
function pcReset() {
    const card = document.currentScript?.closest('.card') || document;
    
    // Reset formula inputs
    card.querySelector('#pc-input1').value = '';
    card.querySelector('#pc-input2').value = '';
    
    // Reset constants to defaults
    card.querySelector('#pc-const1').value = '6.67430e-11';
    card.querySelector('#pc-const2').value = '5.972e24';
    card.querySelector('#pc-const3').value = '1000';
    
    // Reset unit converter
    card.querySelector('#pc-unit-value').value = '';
    card.querySelector('#pc-unit-result').value = '';
    
    // Reset output
    card.querySelector('#pc-output').textContent = 'Select a formula and enter values to calculate.';
    
    // Reset to first formula
    card.querySelector('#pc-formula').value = 'velocity';
    pcUpdateInputs();
}

// Swap input values
function pcSwapUnits() {
    const card = document.currentScript?.closest('.card') || document;
    const input1 = card.querySelector('#pc-input1');
    const input2 = card.querySelector('#pc-input2');
    
    const temp = input1.value;
    input1.value = input2.value;
    input2.value = temp;
    
    // Recalculate if both have values
    if (input1.value && input2.value) {
        pcCalculate();
    }
}

// Unit conversion function
function pcConvertUnits() {
    const card = document.currentScript?.closest('.card') || document;
    const value = parseFloat(card.querySelector('#pc-unit-value').value);
    const fromUnit = card.querySelector('#pc-unit-from').value;
    const toUnit = card.querySelector('#pc-unit-to').value;
    
    if (isNaN(value)) {
        card.querySelector('#pc-unit-result').value = 'Enter a number';
        return;
    }
    
    // Convert to meters first, then to target unit
    const valueInMeters = value * pcUnitFactors[fromUnit];
    const result = valueInMeters / pcUnitFactors[toUnit];
    
    card.querySelector('#pc-unit-result').value = result.toExponential(6);
}

// Swap unit conversion direction
function pcSwapUnitConversion() {
    const card = document.currentScript?.closest('.card') || document;
    const fromSelect = card.querySelector('#pc-unit-from');
    const toSelect = card.querySelector('#pc-unit-to');
    
    const temp = fromSelect.value;
    fromSelect.value = toSelect.value;
    toSelect.value = temp;
    
    // Recalculate if there's a value
    const value = card.querySelector('#pc-unit-value').value;
    if (value) {
        pcConvertUnits();
    }
}

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.currentScript?.closest('.card') || document;
        
        // Set up formula selection
        const formulaSelect = card.querySelector('#pc-formula');
        formulaSelect.addEventListener('change', pcUpdateInputs);
        
        // Set up unit conversion
        const unitValue = card.querySelector('#pc-unit-value');
        const unitFrom = card.querySelector('#pc-unit-from');
        const unitTo = card.querySelector('#pc-unit-to');
        
        unitValue.addEventListener('input', pcConvertUnits);
        unitFrom.addEventListener('change', pcConvertUnits);
        unitTo.addEventListener('change', pcConvertUnits);
        
        // Set up swap button for unit conversion
        card.querySelector('button[onclick="pcConvertUnits()"]').parentNode
            .querySelector('button').onclick = pcSwapUnitConversion;
        
        // Initial setup
        pcUpdateInputs();
        
        console.log('Physics Calculator ready');
        
        // Auto-calculate when inputs change
        card.querySelector('#pc-inputs').addEventListener('input', function() {
            const input1 = card.querySelector('#pc-input1').value;
            const input2 = card.querySelector('#pc-input2').value;
            if (input1 && input2) {
                setTimeout(pcCalculate, 300); // Small delay for better UX
            }
        });
    });
} else {
    // Run immediately if already loaded
    const card = document.currentScript?.closest('.card') || document;
    if (card) {
        const formulaSelect = card.querySelector('#pc-formula');
        if (formulaSelect) {
            formulaSelect.addEventListener('change', pcUpdateInputs);
            pcUpdateInputs();
        }
    }
}
</script>

<style>
#physics-calculator-title {
    color: var(--accent);
    margin-top: 0;
    background: linear-gradient(135deg, var(--accent), #9d4edd);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Style for the formula select */
#pc-formula {
    background: linear-gradient(135deg, rgba(45,212,255,0.1), rgba(157,78,221,0.1)) !important;
    border-color: rgba(45,212,255,0.4) !important;
}

/* Highlight for scientific notation */
#pc-output {
    line-height: 1.5;
}

#pc-output::before {
    content: "üß™ ";
    color: var(--accent);
}

@media (max-width: 768px) {
    #pc-inputs,
    #pc-constants {
        grid-template-columns: 1fr !important;
        gap: 16px !important;
    }
    
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100% !important;
        margin: 4px 0 !important;
    }
}

/* Animation for results */
@keyframes pcFadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

#pc-output {
    animation: pcFadeIn 0.3s ease-out;
}
</style>
