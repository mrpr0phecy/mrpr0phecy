# üìñ **COMPLETE MANUAL: The Most Useful Site in the World**

## üìã **Table of Contents**
1. [üéØ **Project Vision & Philosophy**](#vision)
2. [üèóÔ∏è **File Structure**](#structure)
3. [üìÑ **Index.html: The Master Template**](#index)
4. [üÉè **Card Creation Guide**](#cards)
5. [üé® **Theming System**](#theming)a
6. [‚öôÔ∏è **JavaScript Architecture**](#javascript)
7. [üì± **Responsive Design**](#responsive)
8. [üîß **Development Workflow**](#workflow)
9. [üìö **Example Cards**](#examples)
10. [üöÄ **Deployment Checklist**](#deployment)

---

## 1. üéØ **PROJECT VISION & PHILOSYPHY** {#vision}

### **Core Principles**
- **Primary Utility**: Every tool must solve a real problem first
- **Mythic Experience**: The site should feel alive, popular, and memorable
- **Educational Focus**: Tools should teach while they calculate
- **Professional Reliability**: Calculations must be accurate and safe
- **Scalable Architecture**: Designed for hundreds of cards

### **Design Ethos**
- **Glassmorphism**: Semi-transparent layers with blur effects
- **Motion as Personality**: Subtle animations that feel alive
- **Consistency**: Every card follows the same visual language
- **Accessibility**: Works for everyone, regardless of ability
- **Mobile-First**: Perfect experience on any device

---

## 2. üèóÔ∏è **FILE STRUCTURE** {#structure}

```
your-site/
‚îÇ
‚îú‚îÄ‚îÄ üìÑ index.html                    # MAIN PAGE - DO NOT MODIFY STRUCTURE
‚îú‚îÄ‚îÄ üìÅ cards/                        # ALL TOOLS GO HERE
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ battery-sizing.html      # Example card 1
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ cable-calculator.html    # Example card 2
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ chord-finder.html        # Example card 3
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ circuit-calculator.html  # Example card 4
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ evolution-walker.html    # Example card 5
‚îÇ
‚îú‚îÄ‚îÄ üìÅ assets/                       # Optional: images, icons
‚îú‚îÄ‚îÄ üìÑ README.md                     # Project documentation
‚îî‚îÄ‚îÄ üìÑ .gitignore                    # Git ignore file
```

**RULE #1**: Never modify `index.html` structure unless you're the architect. Only add cards to `/cards/` folder.

---

## 3. üìÑ **INDEX.HTML: THE MASTER TEMPLATE** {#index}

### **Essential Components That Must Never Change**

```html
<!doctype html>
<html lang="en">
<head>
    <!-- METADATA - NEVER CHANGE ORDER -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>The Most Useful Site in the World</title>
    
    <!-- CORE STYLES - DO NOT MODIFY SELECTORS -->
    <style>
        :root {
            /* CSS VARIABLES - THESE CONTROL THEME */
            --accent: #2dd4ff;            /* PRIMARY ACCENT COLOR */
            --muted: #e6faff;             /* MUTED TEXT COLOR */
            --text: #e6faff;              /* PRIMARY TEXT COLOR */
            --glass: rgba(255,255,255,0.06);  /* GLASS EFFECT */
            --panel: rgba(20,20,20,0.92);     /* PANEL BACKGROUND */
            --border: rgba(255,255,255,0.10); /* BORDER COLOR */
            --card-min: 260px;            /* MINIMUM CARD WIDTH */
        }
        
        /* BACKGROUND IS SET DIRECTLY, NOT WITH VARIABLES */
        html, body {
            background: linear-gradient(135deg, #0a0f14, #141e28);
            /* This stays fixed in CSS */
        }
        
        /* CRITICAL COMPONENTS - NEVER RENAME THESE CLASSES */
        .card { }          /* Individual tool container */
        .dashboard { }     /* Grid container for cards */
        .toolbox { }       /* Floating toolbox panel */
        .widget-wrap { }   /* Widget inside toolbox */
        .search-bar { }    /* Search input container */
        .control-btn { }   /* Floating control buttons */
    </style>
</head>
<body>
    <!-- FLOATING CONTROLS - DO NOT MODIFY IDS -->
    <button id="toolboxToggle" class="control-btn">üß∞</button>
    <button id="paletteToggle" class="control-btn">üé®</button>
    <button id="readerToggle" class="control-btn">üëì</button>
    
    <!-- THEME PANEL - DO NOT MODIFY -->
    <div id="palettePanel" class="palette-panel">
        <!-- Theme selection UI -->
    </div>
    
    <!-- TOOLBOX - DO NOT MODIFY -->
    <div id="toolbox" class="toolbox hidden">
        <!-- Toolbox content -->
    </div>
    
    <!-- HEADER - YOU CAN CHANGE TEXT ONLY -->
    <header><h1>The Most Useful Site in the World</h1></header>
    
    <!-- MAIN CONTENT AREA -->
    <main>
        <!-- SEARCH - DO NOT MODIFY IDS -->
        <div class="search-bar">
            <input id="searchInput" placeholder="Search cards..." autofocus />
        </div>
        
        <!-- CONTROLS - YOU CAN ADD BUTTONS BUT KEEP THESE IDS -->
        <div class="controls">
            <button id="sortAlphaBtn">Sort A‚ÜíZ</button>
            <button id="sortRandomBtn">Random</button>
            <!-- Add more buttons here if needed -->
        </div>
        
        <!-- STATUS MESSAGE -->
        <div id="status">Loading cards...</div>
        
        <!-- CARD GRID - DO NOT MODIFY THIS ID -->
        <div id="gridContainer" class="dashboard"></div>
    </main>
    
    <!-- EXTERNAL LIBRARIES - DO NOT REMOVE -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    
    <!-- MAIN SCRIPT - DO NOT MODIFY -->
    <script>
        // ALL SITE LOGIC LIVES HERE
        // This handles: loading cards, theming, toolbox, search, etc.
    </script>
</body>
</html>
```

### **What You CAN Modify:**
- `<title>` text
- `<header><h1>` text
- Add more buttons to `.controls` div
- Card content (in `/cards/` folder only)

### **What You CANNOT Modify:**
- Element IDs (like `#toolboxToggle`, `#searchInput`)
- Core class names (like `.card`, `.dashboard`)
- The loading system logic
- The theming system variables
- The toolbox/widget system

---

## 4. üÉè **CARD CREATION GUIDE** {#cards}

### **THE RIGID RULE: No Extra Wrappers!**

**WRONG:**
```html
<div class="card-content"> <!-- EXTRA WRAPPER - DON'T DO THIS! -->
    <h2>My Tool</h2>
    <!-- content -->
</div>
```

**RIGHT:**
```html
<h2 id="my-tool-title">My Tool</h2>
<!-- content starts directly -->
```

### **Card Structure Template**

```html
<!-- cards/your-tool-name.html -->
<!-- START DIRECTLY WITH CONTENT - NO WRAPPERS! -->

<h2 id="your-tool-title">Descriptive Tool Name</h2>

<form aria-describedby="tool-description">
    <p id="tool-description" class="small">
        Brief description of what this tool does. 
        <span style="color:var(--accent)">Optional highlight.</span>
    </p>
    
    <!-- INPUT SECTION -->
    <div class="field" style="margin-bottom:16px;">
        <label for="tool-input" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Input Label
        </label>
        <input id="tool-input" type="text" placeholder="Example value" 
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <!-- ACTIONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="toolCalculate(this)" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;">
            Calculate
        </button>
        <button type="button" onclick="toolReset(this)"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Reset
        </button>
    </div>
</form>

<!-- RESULTS -->
<div class="results" aria-live="polite" style="margin-top:16px;">
    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">Results</h3>
    <textarea id="tool-output" rows="6" 
              style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.2);background:rgba(0,0,0,0.2);color:inherit;font-family:monospace;"></textarea>
</div>

<!-- SCRIPT - MUST BE SCOPED WITH PREFIX -->
<script>
/* your-tool-name.html
   - Description of tool
   - Scoped with PREFIX (ytn- for "your tool name")
*/

// ALWAYS USE UNIQUE PREFIX FOR ALL FUNCTIONS AND IDS
function ytnCalculate(btn) {
    const card = btn.closest('.card') || document;
    // Your logic here
}

function ytnReset(btn) {
    const card = btn.closest('.card') || document;
    // Reset logic
}

// Initialize if needed
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        // Initialization code
    });
} else {
    // Run immediately if already loaded
}
</script>

<!-- OPTIONAL STYLE OVERRIDES -->
<style>
/* Card-specific styles only */
#your-tool-title {
    color: var(--accent);
    margin-top: 0;
}

@media (max-width: 768px) {
    /* Mobile adjustments */
}
</style>
```

### **Naming Conventions**

| Element | Pattern | Example |
|---------|---------|---------|
| File name | `kebab-case-description.html` | `battery-sizing.html` |
| Title ID | `filename-title` | `battery-sizing-title` |
| Function prefix | `2-3 letter prefix` | `bs` for battery sizing |
| Input IDs | `prefix-inputname` | `bs-voltage`, `bs-load` |

### **Prefix Examples:**
- Battery Sizing: `bs` ‚Üí `bsCalculate()`, `bsReset()`
- Chord Finder: `ch` ‚Üí `chFind()`, `chReset()`
- Circuit Calculator: `cc` ‚Üí `ccCalculate()`, `ccReset()`
- Evolution Walker: `evo` ‚Üí `evoStart()`, `evoPause()`

---

## 5. üé® **THEMING SYSTEM** {#theming}

### **How Theming Works**

1. **Background Themes** (set directly in CSS):
   ```css
   /* In index.html - NOT using CSS variables */
   html, body {
       background: linear-gradient(135deg, #0a0f14, #141e28);
   }
   ```

2. **Accent Colors** (CSS variables):
   ```css
   :root {
       --accent: #2dd4ff;  /* Change this to theme */
       --muted: #e6faff;
       --text: #e6faff;
   }
   ```

### **Available Color Palette**

```html
<!-- Accent Colors -->
<div class="palette-color" data-accent="#2dd4ff" style="background:#2dd4ff"></div>
<div class="palette-color" data-accent="#ff2d55" style="background:#ff2d55"></div>
<div class="palette-color" data-accent="#00ff99" style="background:#00ff99"></div>
<div class="palette-color" data-accent="#ffcc00" style="background:#ffcc00"></div>
<div class="palette-color" data-accent="#9d4edd" style="background:#9d4edd"></div>

<!-- Background Themes -->
<button class="theme-btn" data-color="default" style="background:linear-gradient(135deg, #0a0f14, #141e28)"></button>
<button class="theme-btn" data-color="deep-blue" style="background:linear-gradient(135deg, #05080c, #0f151f)"></button>
<button class="theme-btn" data-color="deep-purple" style="background:linear-gradient(135deg, #12081a, #1f1229)"></button>
```

### **Using Theme Colors in Cards**

```html
<!-- In your card HTML -->
<style>
/* Reference theme colors */
.my-element {
    color: var(--accent);          /* Uses current accent color */
    border-color: var(--border);   /* Uses current border color */
    background: var(--glass);      /* Uses glass effect */
}
</style>

<!-- Inline styles also work -->
<div style="color:var(--accent); border:1px solid var(--border);">
    Themed content
</div>
```

---

## 6. ‚öôÔ∏è **JAVASCRIPT ARCHITECTURE** {#javascript}

### **Core System Functions**

```javascript
// In index.html - DO NOT MODIFY THESE

// 1. CARD LOADING SYSTEM
function loadDashboard() {
    // Loads cards from /cards/ folder
    // Handles lazy loading
    // Adds plus/minus buttons
}

// 2. SEARCH SYSTEM
searchInput.addEventListener('input', function() {
    // Real-time filtering
    // Searches card titles and content
});

// 3. TOOLBOX SYSTEM
function createWidget(name, content) {
    // Creates draggable widget in toolbox
    // Saves to localStorage
}

// 4. THEME SYSTEM
function applyTheme(themeName) {
    // Changes background gradient
    // Updates CSS variables
}

// 5. SORTING SYSTEM
// Alphabetical and random sort
```

### **Card JavaScript Best Practices**

```javascript
/* IN CARD FILES */

// 1. ALWAYS SCOPE YOUR FUNCTIONS
function myPrefixFunction(btn) {
    // 'btn' is the clicked button
    const card = btn.closest('.card') || document;
    // Use 'card' to find elements within this specific card
}

// 2. HANDLE ERRORS GRACEFULLY
try {
    // Risky operations
} catch (error) {
    console.error('Tool error:', error);
    // Show user-friendly error
}

// 3. USE LOCALSTORAGE FOR PERSISTENCE
function saveSettings() {
    const settings = { /* your settings */ };
    localStorage.setItem('prefix-settings', JSON.stringify(settings));
}

// 4. MAKE IT RESPONSIVE
function handleResize() {
    if (window.innerWidth < 768) {
        // Mobile adjustments
    }
}
```

---

## 7. üì± **RESPONSIVE DESIGN** {#responsive}

### **Breakpoints**

```css
/* In index.html or card styles */
@media (max-width: 768px) {
    /* Tablet */
    .dashboard {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
}

@media (max-width: 480px) {
    /* Mobile */
    .dashboard {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .actions {
        flex-direction: column;
    }
    
    button {
        width: 100%;
        margin: 4px 0 !important;
    }
}
```

### **Touch-Friendly Design**

```html
<!-- In your cards -->
<button style="padding:12px;min-height:44px;">
    <!-- Minimum 44px for touch targets -->
</button>

<input style="font-size:16px;">
<!-- Prevents iOS zoom on focus -->
```

---

## 8. üîß **DEVELOPMENT WORKFLOW** {#workflow}

### **Step-by-Step Card Creation**

1. **Plan Your Tool**
   ```markdown
   Tool Name: Currency Converter
   File Name: currency-converter.html
   Prefix: cu (currency)
   Inputs: amount, fromCurrency, toCurrency
   Output: converted amount
   ```

2. **Create File Structure**
   ```html
   <!-- cards/currency-converter.html -->
   <h2 id="currency-converter-title">Currency Converter</h2>
   
   <form>
       <!-- Inputs -->
   </form>
   
   <div class="results">
       <!-- Output -->
   </div>
   
   <script>
   function cuConvert(btn) { /* logic */ }
   function cuReset(btn) { /* logic */ }
   </script>
   ```

3. **Add Visual Polish**
   - Use theme colors (`var(--accent)`)
   - Add appropriate spacing
   - Include helpful examples
   - Add error handling

4. **Test Thoroughly**
   - Test on desktop
   - Test on mobile
   - Test keyboard navigation
   - Test screen reader (aria labels)

5. **Verify Integration**
   - Card loads in dashboard
   - Search finds it
   - Can add to toolbox
   - Themes apply correctly

### **Debugging Checklist**

```javascript
// Add to your card script for debugging
console.log('Currency Converter: Initializing...');

// Check if elements exist
const input = document.getElementById('cu-amount');
if (!input) {
    console.error('Input not found!');
}

// Log user actions
input.addEventListener('input', function() {
    console.log('User entered:', this.value);
});
```

---

## 9. üìö **EXAMPLE CARDS** {#examples}

### **Example 1: Simple Calculator**

```html
<!-- cards/tip-calculator.html -->
<h2 id="tip-calculator-title">üí∏ Tip Calculator</h2>

<form aria-describedby="tip-calculator-desc">
    <p id="tip-calculator-desc" class="small">
        Calculate tips for restaurants. Perfect for dining out!
    </p>
    
    <div class="field" style="margin-bottom:16px;">
        <label for="tc-bill" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Bill Amount ($)
        </label>
        <input id="tc-bill" type="number" placeholder="e.g. 45.50" min="0" step="0.01"
               style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
    </div>
    
    <div class="field" style="margin-bottom:16px;">
        <label for="tc-tip" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
            Tip Percentage
        </label>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="tcSetTip(15)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;">15%</button>
            <button type="button" onclick="tcSetTip(18)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;">18%</button>
            <button type="button" onclick="tcSetTip(20)" style="padding:8px 12px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;">20%</button>
            <input type="number" id="tc-tip" value="15" min="0" max="100" step="1"
                   style="flex:1;padding:8px;border-radius:6px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;text-align:center;">
            <div style="color:rgba(45,212,255,0.8);align-self:center;">%</div>
        </div>
    </div>
    
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="tcCalculate(this)" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
            Calculate Tip
        </button>
        <button type="button" onclick="tcReset(this)"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Reset
        </button>
    </div>
</form>

<div class="results" aria-live="polite" style="margin-top:16px;">
    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üí∞ Tip Calculation</h3>
    <div id="tc-output" style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);font-family:monospace;white-space:pre-line;">
        Enter bill amount to calculate.
    </div>
</div>

<script>
/* tip-calculator.html
   - Simple tip calculator
   - Scoped with tc- prefix
*/

function tcSetTip(percent) {
    const card = document.currentScript?.closest('.card') || document;
    const tipInput = card.querySelector('#tc-tip');
    tipInput.value = percent;
}

function tcCalculate(btn) {
    const card = btn.closest('.card') || document;
    const bill = parseFloat(card.querySelector('#tc-bill').value);
    const tipPercent = parseFloat(card.querySelector('#tc-tip').value);
    
    if (!bill || bill <= 0) {
        card.querySelector('#tc-output').textContent = 'Please enter a valid bill amount.';
        return;
    }
    
    const tipAmount = bill * (tipPercent / 100);
    const total = bill + tipAmount;
    
    const result = `Bill: $${bill.toFixed(2)}\n`;
    result += `Tip (${tipPercent}%): $${tipAmount.toFixed(2)}\n`;
    result += `Total: $${total.toFixed(2)}\n\n`;
    result += `Per person (2 people): $${(total/2).toFixed(2)}\n`;
    result += `Per person (4 people): $${(total/4).toFixed(2)}`;
    
    card.querySelector('#tc-output').textContent = result;
}

function tcReset(btn) {
    const card = btn.closest('.card') || document;
    card.querySelector('#tc-bill').value = '';
    card.querySelector('#tc-tip').value = '15';
    card.querySelector('#tc-output').textContent = 'Enter bill amount to calculate.';
}

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Tip Calculator ready');
    });
}
</script>

<style>
#tip-calculator-title {
    color: var(--accent);
    margin-top: 0;
}

@media (max-width: 768px) {
    #tc-tip {
        width: 100%;
        margin-top: 8px;
    }
}
</style>
```

### **Example 2: Unit Converter**

```html
<!-- cards/unit-converter.html -->
<h2 id="unit-converter-title">üìè Unit Converter</h2>

<form aria-describedby="unit-converter-desc">
    <p id="unit-converter-desc" class="small">
        Convert between different units of measurement.
    </p>
    
    <div style="display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:end;">
        <div>
            <label for="uc-value" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Value
            </label>
            <input id="uc-value" type="number" placeholder="Enter value" step="any"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;" />
        </div>
        
        <div style="text-align:center;padding-bottom:8px;">
            <button type="button" onclick="ucSwapUnits()" style="background:transparent;border:none;color:var(--accent);cursor:pointer;font-size:20px;">‚áÑ</button>
        </div>
        
        <div>
            <label for="uc-result" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Result
            </label>
            <input id="uc-result" type="text" readonly
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(57,255,20,0.3);background:rgba(57,255,20,0.05);color:#39ff14;" />
        </div>
    </div>
    
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px;">
        <div>
            <label for="uc-from" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                From Unit
            </label>
            <select id="uc-from" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                <option value="meter">Meter (m)</option>
                <option value="kilometer">Kilometer (km)</option>
                <option value="mile">Mile (mi)</option>
                <option value="foot">Foot (ft)</option>
                <option value="inch">Inch (in)</option>
            </select>
        </div>
        
        <div>
            <label for="uc-to" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                To Unit
            </label>
            <select id="uc-to" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                <option value="meter">Meter (m)</option>
                <option value="kilometer">Kilometer (km)</option>
                <option value="mile" selected>Mile (mi)</option>
                <option value="foot">Foot (ft)</option>
                <option value="inch">Inch (in)</option>
            </select>
        </div>
    </div>
    
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="ucConvert()" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
            Convert
        </button>
        <button type="button" onclick="ucReset()"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Reset
        </button>
    </div>
</form>

<script>
/* unit-converter.html
   - Unit conversion tool
   - Scoped with uc- prefix
*/

// Conversion factors relative to meters
const ucConversionFactors = {
    meter: 1,
    kilometer: 1000,
    mile: 1609.34,
    foot: 0.3048,
    inch: 0.0254
};

function ucConvert() {
    const card = document.currentScript?.closest('.card') || document;
    const value = parseFloat(card.querySelector('#uc-value').value);
    const fromUnit = card.querySelector('#uc-from').value;
    const toUnit = card.querySelector('#uc-to').value;
    
    if (isNaN(value)) {
        card.querySelector('#uc-result').value = 'Enter a number';
        return;
    }
    
    // Convert to meters first, then to target unit
    const valueInMeters = value * ucConversionFactors[fromUnit];
    const result = valueInMeters / ucConversionFactors[toUnit];
    
    card.querySelector('#uc-result').value = result.toFixed(6);
}

function ucSwapUnits() {
    const card = document.currentScript?.closest('.card') || document;
    const fromSelect = card.querySelector('#uc-from');
    const toSelect = card.querySelector('#uc-to');
    
    const temp = fromSelect.value;
    fromSelect.value = toSelect.value;
    toSelect.value = temp;
    
    // Recalculate if there's a value
    const value = card.querySelector('#uc-value').value;
    if (value) {
        ucConvert();
    }
}

function ucReset() {
    const card = document.currentScript?.closest('.card') || document;
    card.querySelector('#uc-value').value = '';
    card.querySelector('#uc-result').value = '';
    card.querySelector('#uc-from').value = 'meter';
    card.querySelector('#uc-to').value = 'mile';
}

// Auto-convert when input changes
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.currentScript?.closest('.card') || document;
        const valueInput = card.querySelector('#uc-value');
        const fromSelect = card.querySelector('#uc-from');
        const toSelect = card.querySelector('#uc-to');
        
        valueInput.addEventListener('input', ucConvert);
        fromSelect.addEventListener('change', ucConvert);
        toSelect.addEventListener('change', ucConvert);
        
        console.log('Unit Converter ready');
    });
}
</script>
```

### **Example 3: Countdown Timer**

```html
<!-- cards/countdown-timer.html -->
<h2 id="countdown-timer-title">‚è±Ô∏è Countdown Timer</h2>

<form aria-describedby="countdown-timer-desc">
    <p id="countdown-timer-desc" class="small">
        Set a countdown timer for any event. Visual progress bar included!
    </p>
    
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:20px;">
        <div>
            <label for="ct-hours" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Hours
            </label>
            <input id="ct-hours" type="number" min="0" max="24" value="0"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;text-align:center;" />
        </div>
        
        <div>
            <label for="ct-minutes" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Minutes
            </label>
            <input id="ct-minutes" type="number" min="0" max="59" value="5"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;text-align:center;" />
        </div>
        
        <div>
            <label for="ct-seconds" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                Seconds
            </label>
            <input id="ct-seconds" type="number" min="0" max="59" value="0"
                   style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;text-align:center;" />
        </div>
    </div>
    
    <!-- Quick Presets -->
    <div style="margin-bottom:20px;">
        <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">Quick Presets:</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="ctSetTime(0,5,0)" style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">5 min</button>
            <button type="button" onclick="ctSetTime(0,10,0)" style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">10 min</button>
            <button type="button" onclick="ctSetTime(0,15,0)" style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">15 min</button>
            <button type="button" onclick="ctSetTime(0,25,0)" style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">25 min</button>
            <button type="button" onclick="ctSetTime(0,30,0)" style="padding:6px 10px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;color:#e6faff;cursor:pointer;font-size:12px;">30 min</button>
        </div>
    </div>
    
    <!-- Progress Bar -->
    <div style="margin-bottom:20px;">
        <div id="ct-progress-container" style="height:8px;background:rgba(255,255,255,0.1);border-radius:4px;overflow:hidden;display:none;">
            <div id="ct-progress-bar" style="height:100%;background:linear-gradient(90deg, #2dd4ff, #39ff14);width:0%;transition:width 0.3s;"></div>
        </div>
    </div>
    
    <!-- Timer Display -->
    <div id="ct-timer-display" style="text-align:center;font-size:48px;font-weight:600;color:var(--accent);margin:20px 0;font-family:monospace;">
        00:05:00
    </div>
    
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="ctStartTimer()" id="ct-start-btn"
                style="flex:1;padding:12px;background:linear-gradient(135deg, #39ff14, #2dd4ff);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:600;">
            ‚ñ∂Ô∏è Start Timer
        </button>
        <button type="button" onclick="ctPauseTimer()" id="ct-pause-btn" disabled
                style="padding:12px 16px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);color:#ffa500;border-radius:8px;cursor:pointer;">
            ‚è∏Ô∏è Pause
        </button>
        <button type="button" onclick="ctResetTimer()"
                style="padding:12px 16px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff4d4d;border-radius:8px;cursor:pointer;">
            üîÑ Reset
        </button>
    </div>
</form>

<script>
/* countdown-timer.html
   - Countdown timer with progress bar
   - Scoped with ct- prefix
*/

let ctTimerInterval = null;
let ctTotalSeconds = 0;
let ctRemainingSeconds = 0;
let ctIsRunning = false;

function ctSetTime(hours, minutes, seconds) {
    const card = document.currentScript?.closest('.card') || document;
    card.querySelector('#ct-hours').value = hours;
    card.querySelector('#ct-minutes').value = minutes;
    card.querySelector('#ct-seconds').value = seconds;
    ctUpdateDisplay();
}

function ctUpdateDisplay() {
    const card = document.currentScript?.closest('.card') || document;
    const hours = parseInt(card.querySelector('#ct-hours').value) || 0;
    const minutes = parseInt(card.querySelector('#ct-minutes').value) || 0;
    const seconds = parseInt(card.querySelector('#ct-seconds').value) || 0;
    
    const display = card.querySelector('#ct-timer-display');
    display.textContent = 
        hours.toString().padStart(2, '0') + ':' +
        minutes.toString().padStart(2, '0') + ':' +
        seconds.toString().padStart(2, '0');
    
    ctTotalSeconds = (hours * 3600) + (minutes * 60) + seconds;
    ctRemainingSeconds = ctTotalSeconds;
}

function ctStartTimer() {
    if (ctIsRunning) return;
    
    const card = document.currentScript?.closest('.card') || document;
    const startBtn = card.querySelector('#ct-start-btn');
    const pauseBtn = card.querySelector('#ct-pause-btn');
    const progressContainer = card.querySelector('#ct-progress-container');
    
    // Get current time from inputs
    ctUpdateDisplay();
    
    if (ctTotalSeconds <= 0) {
        alert('Please set a time greater than 0');
        return;
    }
    
    ctIsRunning = true;
    startBtn.disabled = true;
    pauseBtn.disabled = false;
    startBtn.textContent = '‚è≥ Running...';
    progressContainer.style.display = 'block';
    
    ctTimerInterval = setInterval(function() {
        ctRemainingSeconds--;
        
        // Update display
        const hours = Math.floor(ctRemainingSeconds / 3600);
        const minutes = Math.floor((ctRemainingSeconds % 3600) / 60);
        const seconds = ctRemainingSeconds % 60;
        
        const display = card.querySelector('#ct-timer-display');
        display.textContent = 
            hours.toString().padStart(2, '0') + ':' +
            minutes.toString().padStart(2, '0') + ':' +
            seconds.toString().padStart(2, '0');
        
        // Update progress bar
        const progress = ((ctTotalSeconds - ctRemainingSeconds) / ctTotalSeconds) * 100;
        const progressBar = card.querySelector('#ct-progress-bar');
        progressBar.style.width = progress + '%';
        
        // Change color as time runs low
        if (ctRemainingSeconds < 60) {
            progressBar.style.background = 'linear-gradient(90deg, #ff2d55, #ffcc00)';
            display.style.color = '#ff2d55';
        } else if (ctRemainingSeconds < 300) {
            progressBar.style.background = 'linear-gradient(90deg, #ffcc00, #2dd4ff)';
            display.style.color = '#ffcc00';
        }
        
        // Timer finished
        if (ctRemainingSeconds <= 0) {
            ctTimerFinished();
        }
    }, 1000);
}

function ctPauseTimer() {
    if (!ctIsRunning) return;
    
    const card = document.currentScript?.closest('.card') || document;
    const startBtn = card.querySelector('#ct-start-btn');
    const pauseBtn = card.querySelector('#ct-pause-btn');
    
    ctIsRunning = false;
    clearInterval(ctTimerInterval);
    startBtn.disabled = false;
    pauseBtn.disabled = true;
    startBtn.textContent = '‚ñ∂Ô∏è Resume';
}

function ctResetTimer() {
    ctPauseTimer();
    
    const card = document.currentScript?.closest('.card') || document;
    const startBtn = card.querySelector('#ct-start-btn');
    const progressContainer = card.querySelector('#ct-progress-container');
    const display = card.querySelector('#ct-timer-display');
    const progressBar = card.querySelector('#ct-progress-bar');
    
    startBtn.textContent = '‚ñ∂Ô∏è Start Timer';
    startBtn.disabled = false;
    progressContainer.style.display = 'none';
    progressBar.style.width = '0%';
    progressBar.style.background = 'linear-gradient(90deg, #2dd4ff, #39ff14)';
    display.style.color = 'var(--accent)';
    
    // Reset to current input values
    ctUpdateDisplay();
}

function ctTimerFinished() {
    clearInterval(ctTimerInterval);
    ctIsRunning = false;
    
    const card = document.currentScript?.closest('.card') || document;
    const startBtn = card.querySelector('#ct-start-btn');
    const pauseBtn = card.querySelector('#ct-pause-btn');
    const display = card.querySelector('#ct-timer-display');
    
    startBtn.disabled = false;
    startBtn.textContent = '‚ñ∂Ô∏è Start Timer';
    pauseBtn.disabled = true;
    display.style.color = '#39ff14';
    
    // Visual alert
    display.style.animation = 'pulse 1s infinite';
    setTimeout(() => {
        display.style.animation = '';
    }, 3000);
    
    // Play sound if available
    try {
        const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
        audio.play().catch(() => {});
    } catch (e) {}
    
    alert('‚è∞ Time\'s up!');
}

// Initialize
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        const card = document.currentScript?.closest('.card') || document;
        
        // Update display when inputs change
        const inputs = card.querySelectorAll('#ct-hours, #ct-minutes, #ct-seconds');
        inputs.forEach(input => {
            input.addEventListener('input', ctUpdateDisplay);
        });
        
        // Initial display
        ctUpdateDisplay();
        
        console.log('Countdown Timer ready');
    });
}
</script>

<style>
@keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}

#countdown-timer-title {
    color: var(--accent);
    margin-top: 0;
}

@media (max-width: 768px) {
    #ct-timer-display {
        font-size: 36px !important;
    }
}
</style>
```

---

## 10. üöÄ **DEPLOYMENT CHECKLIST** {#deployment}

### **Pre-Launch Testing**

1. **Card Validation**
   - [ ] All cards have unique prefixes
   - [ ] No extra wrapper divs
   - [ ] All IDs are properly scoped
   - [ ] No global variable conflicts

2. **Functionality Testing**
   - [ ] Search works for all cards
   - [ ] Sorting works (A-Z and Random)
   - [ ] Toolbox can pin/unpin cards
   - [ ] Themes apply correctly
   - [ ] Reader mode works

3. **Responsive Testing**
   - [ ] Desktop (1200px+)
   - [ ] Tablet (768px)
   - [ ] Mobile (480px)
   - [ ] Touch targets are large enough

4. **Performance Testing**
   - [ ] Cards load within 3 seconds
   - [ ] No memory leaks
   - [ ] Smooth animations
   - [ ] localStorage usage is reasonable

5. **Accessibility Testing**
   - [ ] Screen reader navigation
   - [ ] Keyboard navigation
   - [ ] Color contrast ratios
   - [ ] ARIA labels where needed

### **Common Pitfalls to Avoid**

```javascript
// PITFALL 1: Global variable conflicts
var myVariable = 1; // BAD - global
let myVariable = 1; // STILL BAD - global

function myCardFunction() {
    const myVariable = 1; // GOOD - scoped
}

// PITFALL 2: Missing error handling
function calculate() {
    const value = parseFloat(input.value); // BAD - no validation
    // ... calculation
}

function calculate() {
    const value = parseFloat(input.value);
    if (isNaN(value)) { // GOOD - validation
        showError('Please enter a valid number');
        return;
    }
    // ... calculation
}

// PITFALL 3: Not using theme variables
color: #2dd4ff; // BAD - hardcoded
color: var(--accent); // GOOD - uses theme

// PITFALL 4: Forgetting mobile users
button { padding: 5px; } // BAD - too small for touch
button { padding: 12px; min-height: 44px; } // GOOD - touch-friendly
```

### **Maintenance Tips**

1. **Regularly Update Dependencies**
   ```bash
   # Check for updates to:
   # - Three.js (if using 3D)
   # - Sortable.js
   # - Any other libraries
   ```

2. **Monitor Performance**
   - Use browser DevTools
   - Check loading times
   - Monitor memory usage
   - Test on slower connections

3. **User Feedback**
   - Add a feedback button to cards
   - Monitor console for errors
   - Track most-used cards
   - Consider user suggestions

4. **Backup Strategy**
   ```bash
   # Regular backups of:
   # - cards/ folder
   # - localStorage data
   # - User preferences
   ```

---

## üéâ **CONGRATULATIONS!**

You now have a complete, comprehensive manual for "The Most Useful Site in the World." This system is:

1. **Scalable**: Add unlimited cards without breaking anything
2. **Maintainable**: Clear separation of concerns
3. **Themable**: Users can customize their experience
4. **Accessible**: Works for everyone
5. **Professional**: Looks and feels polished
6. **Educational**: Teaches while it calculates

**Remember the Golden Rules:**
1. Never modify `index.html` structure
2. Always use prefixes in cards
3. No extra wrapper divs
4. Test on mobile
5. Handle errors gracefully

Now go build something amazing! üöÄ

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Most Useful Site in the World</title>
<style>
  /* DARK DEFAULTS DIRECTLY IN CSS - NO VARIABLES FOR BACKGROUND */
  html,body{
    height:100%;
    margin:0;
    font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
    background:linear-gradient(135deg, #0a0f14, #141e28); /* DARK DEFAULT */
    color:#e6faff;
    -webkit-font-smoothing:antialiased;
    /* FIX 1: Ensure background covers entire page */
    background-attachment: fixed;
    background-size: cover;
  }
  
  /* CSS VARIABLES ONLY FOR THINGS THAT CHANGE */
  :root{
    --accent:#2dd4ff; 
    --muted:#e6faff; 
    --text:#e6faff;
    --glass: rgba(255,255,255,0.06);
    --panel: rgba(20,20,20,0.92);
    --card-grad-1: rgba(255,255,255,0.02);
    --card-grad-2: rgba(255,255,255,0.04);
    --border: rgba(255,255,255,0.10);
    --card-min: 260px;
    --card-scale: 1;
    --card-translateY: 18px;
    --toolbox-width: 520px;
    --toolbox-height: 420px;
  }

  header{padding:20px;text-align:center;z-index:2}
  header h1{margin:0;color:var(--accent);font-size:1.6rem}

  .control-btn{
    position:fixed;bottom:18px;z-index:14000;width:48px;height:48px;border-radius:10px;
    background:var(--glass);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;
    cursor:pointer;backdrop-filter:blur(6px);box-shadow:0 8px 30px rgba(0,0,0,0.45);color:var(--accent);
  }
  .control-btn:hover{transform:scale(1.06)}
  #toolboxToggle{left:18px}
  #paletteToggle{left:78px}
  #readerToggle{left:138px}

  .palette-panel{
    position:fixed;left:78px;bottom:74px;z-index:13900;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:12px;box-shadow:0 12px 36px rgba(0,0,0,0.6);backdrop-filter:blur(8px);
    display:none;pointer-events:none;
  }
  .palette-panel.open{display:block;pointer-events:auto}

  .toolbox {
    position:fixed;
    right:18px;
    bottom:18px;
    width:var(--toolbox-width);
    height:var(--toolbox-height);
    z-index:13700;
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:12px;
    box-shadow:0 18px 48px rgba(0,0,0,0.6);
    display:flex;
    flex-direction:column;
    overflow:hidden;
    resize:both;
    min-width:300px;
    min-height:200px;
  }
  .toolbox.hidden{display:none}

  .toolbox .titlebar{
    display:flex;align-items:center;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);
    background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);cursor:grab;z-index:13750;
  }

  .toolbox .content{
    position:relative;
    flex:1;
    background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    overflow:auto;
    min-height:100px;
  }

  .widget-wrap{
    position:absolute;
    box-sizing:border-box;
    background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));
    border-radius:10px;border:1px solid rgba(255,255,255,0.04);
    min-width:120px; min-height:80px;
    max-width:calc(100% - 20px);
    max-height:calc(100% - 20px);
    overflow:hidden;
    resize:both;
    z-index:1;
    box-shadow:0 8px 20px rgba(0,0,0,0.35);
    /* NEW: Advanced font scaling with min/max sizes */
    --widget-font-size: 14px;
    --widget-font-scale: 1;
    --widget-min-font: 8px;
    --widget-max-font: 32px;
    --widget-ideal-area: 30000; /* 200x150 = 30000px¬≤ */
  }

  .widget-titlebar{
    display:flex;align-items:center;justify-content:space-between;padding:8px 10px;border-bottom:1px solid rgba(255,255,255,0.03);
    background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
    cursor:move;
    user-select:none;
  }
  .widget-titlebar strong{
    color:var(--accent);
    font-size: calc(var(--widget-font-size) * 1.1);
  }
  
  .widget-body{
    padding:10px;
    overflow:auto;
    max-height:60vh;
    font-size: var(--widget-font-size);
    line-height: calc(var(--widget-font-size) * 1.4);
  }

  .widget-close, #toolboxClose { 
    z-index: 13800; 
    position: relative; 
    background:transparent;
    border:0;
    color:var(--muted);
    cursor:pointer;
    font-size: var(--widget-font-size);
  }

  main{
    position:relative;
    z-index:2;
    /* FIX 1: Auto-scroll to top when loading */
    scroll-margin-top: 0;
  }
  
  .search-bar{
    max-width:1100px;
    margin:14px auto 16px;
    display:flex;
    background:linear-gradient(180deg,var(--glass),rgba(255,255,255,0.02));
    border-radius:12px;
    padding:12px 16px;
    border:1px solid rgba(255,255,255,0.04);
    /* FIX 1: Anchor point for scrolling */
    scroll-margin-top: 20px;
  }
  
  .search-bar input{flex:1;border:none;background:transparent;color:var(--text);font-size:1rem;outline:none}

  .controls{display:flex;gap:8px;justify-content:center;margin-bottom:12px}
  .controls button{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--muted);cursor:pointer}

  .dashboard{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(var(--card-min), 1fr));
    gap:20px;
    padding:20px;
    align-items:start;
    box-sizing:border-box;
  }

  .card{
    box-sizing:border-box;
    background:linear-gradient(135deg,var(--card-grad-1),var(--card-grad-2));
    border:1px solid var(--border);
    border-radius:12px;
    padding:16px;
    min-height:120px;
    width:100%;
    max-width:100%;
    opacity:0;
    transform: translateY(var(--card-translateY)) scale(var(--card-scale));
    transition:opacity .36s ease, transform .36s ease;
    box-shadow:0 8px 24px rgba(0,0,0,0.35);
    overflow:hidden;
  }
  .card.visible{opacity:1; transform: translateY(0) scale(var(--card-scale));}
  .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
  .card-header h3{margin:0;color:var(--accent);font-size:1.05rem}

  /* ===== SIMPLE EMBED SECTION ===== */
  .embed-section {
    margin-top: 16px;
    padding-top: 12px;
    border-top: 1px solid rgba(255,255,255,0.06);
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
  }
  
  .embed-section span {
    color: rgba(230,250,255,0.7);
    white-space: nowrap;
  }
  
  .embed-btn {
    background: rgba(45,212,255,0.1);
    color: var(--accent);
    border: 1px solid rgba(45,212,255,0.3);
    padding: 4px 10px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    white-space: nowrap;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }
  
  .embed-btn:hover {
    background: rgba(45,212,255,0.2);
    transform: translateY(-1px);
  }
  
  .embed-btn.copied {
    background: rgba(57,255,20,0.1);
    color: #39ff14;
    border-color: rgba(57,255,20,0.3);
  }

  body.reader-mode{font-size:1.12rem;line-height:1.6}
  body.reader-mode .dashboard{grid-template-columns:1fr;gap:18px}
  body.reader-mode .card{padding:20px;background:linear-gradient(135deg,rgba(255,255,255,0.02),rgba(255,255,255,0.04));border-color:rgba(255,255,255,0.06)}

  /* ===== MOBILE-FRIENDLY SCROLLING FIX ===== */
  @media (max-width: 768px) {
    .card {
      touch-action: pan-y; /* Allows vertical scrolling while preventing other gestures */
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    }
    
    .dashboard {
      gap: 16px; /* Slightly reduce gap on mobile */
    }
    
    /* Make cards a bit easier to tap */
    .card-header h3 {
      padding: 4px 0; /* Add padding to make title easier to tap */
    }
    
    /* Ensure search bar is easier to use on mobile */
    .search-bar input {
      font-size: 16px; /* Prevent zoom on iOS */
    }
  }
</style>
</head>
<body>

  <button id="toolboxToggle" class="control-btn" title="Open toolbox">üß∞</button>
  <button id="paletteToggle" class="control-btn" title="Theme">üé®</button>
  <button id="readerToggle" class="control-btn" title="Reader mode">üëì</button>

  <div id="palettePanel" class="palette-panel" aria-hidden="true">
    <div style="color:var(--accent);font-weight:600;margin-bottom:8px">Accent color</div>
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:8px">
      <div class="palette-color active" data-accent="#2dd4ff" style="background:#2dd4ff;height:34px;border-radius:8px;cursor:pointer"></div>
      <div class="palette-color" data-accent="#ff2d55" style="background:#ff2d55;height:34px;border-radius:8px;cursor:pointer"></div>
      <div class="palette-color" data-accent="#00ff99" style="background:#00ff99;height:34px;border-radius:8px;cursor:pointer"></div>
      <div class="palette-color" data-accent="#ffcc00" style="background:#ffcc00;height:34px;border-radius:8px;cursor:pointer"></div>
      <div class="palette-color" data-accent="#9d4edd" style="background:#9d4edd;height:34px;border-radius:8px;cursor:pointer"></div>
    </div>
    
    <!-- SIMPLIFIED BACKGROUND THEMES - DIRECT COLOR VALUES -->
    <div style="color:var(--accent);font-weight:600;margin-bottom:8px;margin-top:12px">Background theme</div>
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:8px">
      <button class="theme-btn active" data-color="default" style="background:linear-gradient(135deg, #0a0f14, #141e28);height:34px;border-radius:8px;cursor:pointer;border:2px solid var(--accent)"></button>
      <button class="theme-btn" data-color="deep-blue" style="background:linear-gradient(135deg, #05080c, #0f151f);height:34px;border-radius:8px;cursor:pointer;border:1px solid var(--border)"></button>
      <button class="theme-btn" data-color="deep-purple" style="background:linear-gradient(135deg, #12081a, #1f1229);height:34px;border-radius:8px;cursor:pointer;border:1px solid var(--border)"></button>
      <button class="theme-btn" data-color="deep-teal" style="background:linear-gradient(135deg, #061616, #0f2525);height:34px;border-radius:8px;cursor:pointer;border:1px solid var(--border)"></button>
      <button class="theme-btn" data-color="deep-red" style="background:linear-gradient(135deg, #160606, #251010);height:34px;border-radius:8px;cursor:pointer;border:1px solid var(--border)"></button>
    </div>
  </div>

  <div id="toolbox" class="toolbox hidden" role="dialog" aria-hidden="true">
    <div class="titlebar" id="toolboxTitle">
      <div style="font-weight:600;color:var(--accent)">Toolbox</div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="dockBtn" title="Dock/undock" style="background:transparent;border:0;color:var(--muted);cursor:pointer">‚á±</button>
        <button id="toolboxClose" title="Close" style="background:transparent;border:0;color:var(--muted);cursor:pointer">‚úï</button>
      </div>
    </div>
    <div class="content" id="toolboxContent" aria-live="polite"></div>
  </div>

  <header><h1>The Most Useful Site in the World</h1></header>

  <main>
    <div class="search-bar"><input id="searchInput" placeholder="Search cards..." autofocus /></div>

    <div class="controls">
      <button id="sortAlphaBtn">Sort A‚ÜíZ</button>
      <button id="sortRandomBtn">Random</button>
    </div>

    <div id="status" class="muted" style="text-align:center;margin-bottom:6px">Loading cards...</div>
    <div id="gridContainer" class="dashboard" aria-live="polite"></div>
  </main>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<script>
// MINIMAL, WORKING CODE - NO COMPLEXITY

console.log("=== STARTING APP ===");

// Background themes - SIMPLE OBJECT MAPPING
const themes = {
  'default': { bg1: '#0a0f14', bg2: '#141e28' },
  'deep-blue': { bg1: '#05080c', bg2: '#0f151f' },
  'deep-purple': { bg1: '#12081a', bg2: '#1f1229' },
  'deep-teal': { bg1: '#061616', bg2: '#0f2525' },
  'deep-red': { bg1: '#160606', bg2: '#251010' }
};

// Apply background directly (no CSS variables for background)
function applyTheme(themeName) {
  console.log("Applying theme:", themeName);
  const theme = themes[themeName];
  if (!theme) return;
  
  // Apply to html AND body for full coverage
  const gradient = `linear-gradient(135deg, ${theme.bg1}, ${theme.bg2})`;
  document.documentElement.style.background = gradient;
  document.body.style.background = gradient;
  
  // Also update theme buttons for consistency
  document.querySelectorAll('.theme-btn').forEach(btn => {
    if (btn.dataset.color === themeName) {
      btn.style.background = gradient;
    }
  });
  
  // Save to localStorage
  localStorage.setItem('theme', themeName);
  console.log("Theme saved to localStorage:", themeName);
}

// ===== SIMPLE EMBED SYSTEM =====
function addEmbedSectionToCard(card, fileName) {
  console.log(`Adding simple embed section to card: ${fileName}`);
  
  const cardName = fileName.replace('.html', '');
  const displayName = cardName.replace(/-/g, ' ');
  
  const embedHTML = `
    <div class="embed-section">
      <span>Share this tool:</span>
      <button class="embed-btn" data-card="${cardName}" data-file="${fileName}">
        üîó Copy Embed Code
      </button>
    </div>
  `;
  
  // Add the embed section to the card
  const contentDiv = card.querySelector('.content');
  if (contentDiv) {
    contentDiv.insertAdjacentHTML('beforeend', embedHTML);
    
    // Add click event to the embed button
    const embedBtn = contentDiv.querySelector('.embed-btn');
    if (embedBtn) {
      embedBtn.addEventListener('click', function() {
        copyEmbedCode(cardName, fileName, displayName);
      });
    }
  }
}

// Function to copy embed code
function copyEmbedCode(cardName, fileName, displayName) {
  // Generate clean embed code
  const embedCode = `<iframe src="https://mrpr0phecy.github.io/mrpr0phecy/cards/${fileName}" width="100%" height="400" style="border:none;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.3);" title="${displayName} - The Most Useful Site"></iframe>`;
  
  // Copy to clipboard
  navigator.clipboard.writeText(embedCode).then(() => {
    // Visual feedback
    const embedBtn = document.querySelector(`.embed-btn[data-card="${cardName}"]`);
    if (embedBtn) {
      const originalText = embedBtn.textContent;
      embedBtn.textContent = '‚úÖ Copied!';
      embedBtn.classList.add('copied');
      
      setTimeout(() => {
        embedBtn.textContent = originalText;
        embedBtn.classList.remove('copied');
      }, 2000);
    }
    
    // Optional: Show a small notification
    console.log(`Embed code for ${displayName} copied to clipboard!`);
  }).catch(err => {
    console.error('Failed to copy: ', err);
    // Fallback: Create a temporary textarea
    const textArea = document.createElement('textarea');
    textArea.value = embedCode;
    document.body.appendChild(textArea);
    textArea.select();
    try {
      document.execCommand('copy');
      console.log('Fallback copy successful');
    } catch (e) {
      console.error('Fallback copy failed: ', e);
    }
    document.body.removeChild(textArea);
  });
}

// NEW: Advanced font scaling based on widget size and user preference
function updateWidgetFontScale(widget, userScale = null) {
  const width = parseInt(widget.style.width) || widget.offsetWidth;
  const height = parseInt(widget.style.height) || widget.offsetHeight;
  
  // Calculate widget area
  const area = width * height;
  
  // Base font size calculation based on area
  // Formula: font size = base * (area / ideal)^0.25 (square root of square root)
  const areaRatio = area / 30000; // 30000 = 200x150 (ideal size)
  const areaScale = Math.pow(areaRatio, 0.25); // Gentle scaling curve
  
  // Apply user scaling if provided
  const userScaleFactor = userScale !== null ? userScale : (widget.dataset.userScale || 1);
  widget.dataset.userScale = userScaleFactor;
  
  // Combined scale
  const combinedScale = areaScale * userScaleFactor;
  
  // Calculate final font size (clamped between min and max)
  const baseSize = 14; // Base font size at ideal area (200x150)
  let fontSize = baseSize * combinedScale;
  
  // Clamp between min and max
  const minFont = parseInt(widget.style.getPropertyValue('--widget-min-font')) || 8;
  const maxFont = parseInt(widget.style.getPropertyValue('--widget-max-font')) || 32;
  fontSize = Math.max(minFont, Math.min(maxFont, fontSize));
  
  // Apply the font size
  widget.style.setProperty('--widget-font-size', `${fontSize}px`);
  
  // Update line height proportionally
  const lineHeight = fontSize * 1.4;
  widget.querySelector('.widget-body').style.lineHeight = `${lineHeight}px`;
  
  // Save user scale preference to widget data
  if (userScale !== null) {
    const widgetObj = widgets.find(w => w.id === widget.id);
    if (widgetObj) {
      widgetObj.userScale = userScaleFactor;
      saveWidgets();
    }
  }
}

// NEW: Widget scaling controls (add to each widget)
function addWidgetScalingControls(widget) {
  const titlebar = widget.querySelector('.widget-titlebar');
  const titleText = titlebar.querySelector('strong');
  
  // Create scaling controls container
  const scaleControls = document.createElement('div');
  scaleControls.className = 'widget-scale-controls';
  scaleControls.style.display = 'flex';
  scaleControls.style.gap = '4px';
  scaleControls.style.alignItems = 'center';
  scaleControls.style.marginLeft = '8px';
  
  // Smaller text button
  const smallerBtn = document.createElement('button');
  smallerBtn.innerHTML = 'A‚Åª';
  smallerBtn.title = 'Make text smaller (fit more tools)';
  smallerBtn.style.background = 'transparent';
  smallerBtn.style.border = 'none';
  smallerBtn.style.color = 'var(--muted)';
  smallerBtn.style.cursor = 'pointer';
  smallerBtn.style.fontSize = '12px';
  smallerBtn.style.padding = '2px 4px';
  smallerBtn.style.borderRadius = '4px';
  smallerBtn.style.border = '1px solid var(--border)';
  
  // Text size display
  const sizeDisplay = document.createElement('span');
  sizeDisplay.className = 'widget-size-display';
  sizeDisplay.textContent = '100%';
  sizeDisplay.style.fontSize = '11px';
  sizeDisplay.style.color = 'var(--muted)';
  sizeDisplay.style.minWidth = '36px';
  sizeDisplay.style.textAlign = 'center';
  
  // Larger text button
  const largerBtn = document.createElement('button');
  largerBtn.innerHTML = 'A‚Å∫';
  largerBtn.title = 'Make text larger (better readability)';
  largerBtn.style.background = 'transparent';
  largerBtn.style.border = 'none';
  largerBtn.style.color = 'var(--muted)';
  largerBtn.style.cursor = 'pointer';
  largerBtn.style.fontSize = '14px';
  largerBtn.style.padding = '2px 4px';
  largerBtn.style.borderRadius = '4px';
  largerBtn.style.border = '1px solid var(--border)';
  
  // Reset button
  const resetBtn = document.createElement('button');
  resetBtn.innerHTML = '‚ü≤';
  resetBtn.title = 'Reset to auto size';
  resetBtn.style.background = 'transparent';
  resetBtn.style.border = 'none';
  resetBtn.style.color = 'var(--muted)';
  resetBtn.style.cursor = 'pointer';
  resetBtn.style.fontSize = '11px';
  resetBtn.style.padding = '2px 4px';
  resetBtn.style.borderRadius = '4px';
  resetBtn.style.border = '1px solid var(--border)';
  resetBtn.style.marginLeft = '4px';
  
  // Add controls to container
  scaleControls.appendChild(smallerBtn);
  scaleControls.appendChild(sizeDisplay);
  scaleControls.appendChild(largerBtn);
  scaleControls.appendChild(resetBtn);
  
  // Insert after title text
  titleText.parentNode.insertBefore(scaleControls, titleText.nextSibling);
  
  // Event handlers
  smallerBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    const currentScale = parseFloat(widget.dataset.userScale || 1);
    const newScale = Math.max(0.5, currentScale * 0.8); // Reduce by 20%
    updateWidgetFontScale(widget, newScale);
    sizeDisplay.textContent = `${Math.round(newScale * 100)}%`;
  });
  
  largerBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    const currentScale = parseFloat(widget.dataset.userScale || 1);
    const newScale = Math.min(2.0, currentScale * 1.2); // Increase by 20%
    updateWidgetFontScale(widget, newScale);
    sizeDisplay.textContent = `${Math.round(newScale * 100)}%`;
  });
  
  resetBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    updateWidgetFontScale(widget, 1); // Reset to auto
    sizeDisplay.textContent = '100%';
  });
  
  // Initialize display
  const currentScale = parseFloat(widget.dataset.userScale || 1);
  sizeDisplay.textContent = `${Math.round(currentScale * 100)}%`;
  
  return scaleControls;
}

// ===== TOOLBOX WIDGET MANAGEMENT =====
let widgets = [];
let toolboxDocked = false;

// Make toolbox draggable and resizable
function initToolbox() {
  const toolbox = document.getElementById('toolbox');
  const toolboxTitle = document.getElementById('toolboxTitle');
  
  // Make toolbox draggable
  let isDragging = false;
  let dragOffset = { x: 0, y: 0 };
  
  toolboxTitle.addEventListener('mousedown', startDrag);
  
  function startDrag(e) {
    if (e.target.tagName === 'BUTTON') return;
    
    isDragging = true;
    const rect = toolbox.getBoundingClientRect();
    dragOffset.x = e.clientX - rect.left;
    dragOffset.y = e.clientY - rect.top;
    
    document.addEventListener('mousemove', onDrag);
    document.addEventListener('mouseup', stopDrag);
    toolboxTitle.style.cursor = 'grabbing';
  }
  
  function onDrag(e) {
    if (!isDragging) return;
    
    e.preventDefault();
    toolbox.style.left = 'auto';
    toolbox.style.right = 'auto';
    toolbox.style.top = e.clientY - dragOffset.y + 'px';
    toolbox.style.left = e.clientX - dragOffset.x + 'px';
  }
  
  function stopDrag() {
    isDragging = false;
    document.removeEventListener('mousemove', onDrag);
    document.removeEventListener('mouseup', stopDrag);
    toolboxTitle.style.cursor = '';
  }
  
  // Dock/undock button
  document.getElementById('dockBtn').addEventListener('click', function() {
    toolboxDocked = !toolboxDocked;
    
    if (toolboxDocked) {
      // Dock to right
      toolbox.style.left = 'auto';
      toolbox.style.right = '18px';
      toolbox.style.top = 'auto';
      toolbox.style.bottom = '18px';
      this.textContent = '‚á≤';
    } else {
      // Undock
      this.textContent = '‚á±';
    }
  });
  
  // Load saved widgets
  loadSavedWidgets();
}

// Create a widget in toolbox
function createWidget(name, contentHTML) {
  const widgetId = 'widget-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
  const widget = document.createElement('div');
  widget.className = 'widget-wrap';
  widget.id = widgetId;
  widget.dataset.name = name;
  
  // Random position within toolbox
  const toolboxContent = document.getElementById('toolboxContent');
  const tRect = toolboxContent.getBoundingClientRect();
  
  widget.style.left = Math.random() * (tRect.width - 200) + 'px';
  widget.style.top = Math.random() * (tRect.height - 150) + 'px';
  widget.style.width = '200px';
  widget.style.height = '150px';
  
  widget.innerHTML = `
    <div class="widget-titlebar">
      <strong>${name}</strong>
      <button class="widget-close" title="Close widget">‚úï</button>
    </div>
    <div class="widget-body">${contentHTML}</div>
  `;
  
  toolboxContent.appendChild(widget);
  
  // Initialize font scale (load saved user scale if exists)
  const savedWidget = widgets.find(w => w.id === widgetId) || {};
  const savedScale = savedWidget.userScale || 1;
  updateWidgetFontScale(widget, savedScale);
  
  // Add scaling controls
  addWidgetScalingControls(widget);
  
  // Make widget draggable
  makeWidgetDraggable(widget);
  
  // Make widget resizable
  makeWidgetResizable(widget);
  
  // Close button
  widget.querySelector('.widget-close').addEventListener('click', function() {
    removeWidget(widgetId);
  });
  
  // Save widget
  widgets.push({
    id: widgetId,
    name: name,
    content: contentHTML,
    x: widget.style.left,
    y: widget.style.top,
    width: widget.style.width,
    height: widget.style.height,
    userScale: savedScale
  });
  
  saveWidgets();
  
  return widgetId;
}

// Make widget draggable
function makeWidgetDraggable(widget) {
  const titlebar = widget.querySelector('.widget-titlebar');
  let isDragging = false;
  let dragOffset = { x: 0, y: 0 };
  
  titlebar.addEventListener('mousedown', startDrag);
  
  function startDrag(e) {
    if (e.target.tagName === 'BUTTON' && !e.target.closest('.widget-scale-controls')) return;
    
    isDragging = true;
    const rect = widget.getBoundingClientRect();
    dragOffset.x = e.clientX - rect.left;
    dragOffset.y = e.clientY - rect.top;
    
    document.addEventListener('mousemove', onDrag);
    document.addEventListener('mouseup', stopDrag);
    widget.style.zIndex = '1000';
  }
  
  function onDrag(e) {
    if (!isDragging) return;
    
    e.preventDefault();
    const parentRect = widget.parentElement.getBoundingClientRect();
    const x = e.clientX - parentRect.left - dragOffset.x;
    const y = e.clientY - parentRect.top - dragOffset.y;
    
    // Keep within bounds
    const maxX = parentRect.width - widget.offsetWidth;
    const maxY = parentRect.height - widget.offsetHeight;
    
    widget.style.left = Math.max(0, Math.min(x, maxX)) + 'px';
    widget.style.top = Math.max(0, Math.min(y, maxY)) + 'px';
  }
  
  function stopDrag() {
    isDragging = false;
    document.removeEventListener('mousemove', onDrag);
    document.removeEventListener('mouseup', stopDrag);
    widget.style.zIndex = '1';
    
    // Update saved position
    const widgetObj = widgets.find(w => w.id === widget.id);
    if (widgetObj) {
      widgetObj.x = widget.style.left;
      widgetObj.y = widget.style.top;
      saveWidgets();
    }
  }
}

// Make widget resizable
function makeWidgetResizable(widget) {
  const resizeHandle = document.createElement('div');
  resizeHandle.style.position = 'absolute';
  resizeHandle.style.right = '0';
  resizeHandle.style.bottom = '0';
  resizeHandle.style.width = '16px';
  resizeHandle.style.height = '16px';
  resizeHandle.style.cursor = 'se-resize';
  resizeHandle.style.background = 'transparent';
  resizeHandle.style.zIndex = '10';
  
  widget.appendChild(resizeHandle);
  
  let isResizing = false;
  let startWidth, startHeight, startX, startY;
  
  resizeHandle.addEventListener('mousedown', startResize);
  
  function startResize(e) {
    e.stopPropagation();
    isResizing = true;
    startWidth = parseInt(getComputedStyle(widget).width);
    startHeight = parseInt(getComputedStyle(widget).height);
    startX = e.clientX;
    startY = e.clientY;
    
    document.addEventListener('mousemove', onResize);
    document.addEventListener('mouseup', stopResize);
  }
  
  function onResize(e) {
    if (!isResizing) return;
    
    e.preventDefault();
    
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;
    
    const newWidth = Math.max(120, startWidth + dx);
    const newHeight = Math.max(80, startHeight + dy);
    
    widget.style.width = newWidth + 'px';
    widget.style.height = newHeight + 'px';
    
    // Update font scale when resizing (auto-scale based on new size)
    updateWidgetFontScale(widget);
  }
  
  function stopResize() {
    isResizing = false;
    document.removeEventListener('mousemove', onResize);
    document.removeEventListener('mouseup', stopResize);
    
    // Update saved size
    const widgetObj = widgets.find(w => w.id === widget.id);
    if (widgetObj) {
      widgetObj.width = widget.style.width;
      widgetObj.height = widget.style.height;
      saveWidgets();
    }
  }
}

// Remove widget
function removeWidget(widgetId) {
  const widget = document.getElementById(widgetId);
  if (widget) {
    widget.remove();
  }
  
  widgets = widgets.filter(w => w.id !== widgetId);
  saveWidgets();
}

// Save widgets to localStorage
function saveWidgets() {
  localStorage.setItem('toolboxWidgets', JSON.stringify(widgets));
}

// Load saved widgets
function loadSavedWidgets() {
  const saved = localStorage.getItem('toolboxWidgets');
  if (saved) {
    try {
      widgets = JSON.parse(saved) || [];
      widgets.forEach(widgetData => {
        const widget = document.createElement('div');
        widget.className = 'widget-wrap';
        widget.id = widgetData.id;
        widget.dataset.name = widgetData.name;
        widget.style.left = widgetData.x;
        widget.style.top = widgetData.y;
        widget.style.width = widgetData.width;
        widget.style.height = widgetData.height;
        
        widget.innerHTML = `
          <div class="widget-titlebar">
            <strong>${widgetData.name}</strong>
            <button class="widget-close" title="Close widget">‚úï</button>
          </div>
          <div class="widget-body">${widgetData.content}</div>
        `;
        
        document.getElementById('toolboxContent').appendChild(widget);
        
        // Initialize font scale with saved user scale
        const savedScale = widgetData.userScale || 1;
        updateWidgetFontScale(widget, savedScale);
        
        // Add scaling controls
        addWidgetScalingControls(widget);
        
        makeWidgetDraggable(widget);
        makeWidgetResizable(widget);
        
        widget.querySelector('.widget-close').addEventListener('click', function() {
          removeWidget(widgetData.id);
        });
      });
    } catch (e) {
      console.error('Failed to load widgets:', e);
      widgets = [];
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  console.log("DOM ready");
  
  // FIX 1: Scroll to top immediately
  window.scrollTo(0, 0);
  
  // Apply saved theme or default
  const savedTheme = localStorage.getItem('theme') || 'default';
  applyTheme(savedTheme);
  
  // Activate saved theme button
  document.querySelectorAll('.theme-btn').forEach(btn => {
    if (btn.dataset.color === savedTheme) {
      btn.classList.add('active');
      btn.style.border = '2px solid var(--accent)';
    } else {
      btn.classList.remove('active');
      btn.style.border = '1px solid var(--border)';
    }
  });
  
  // Apply saved accent
  const savedAccent = localStorage.getItem('accent') || '#2dd4ff';
  document.documentElement.style.setProperty('--accent', savedAccent);
  document.querySelectorAll('.palette-color').forEach(c => {
    c.classList.toggle('active', c.dataset.accent === savedAccent);
  });
  
  // Apply reader mode
  if(localStorage.getItem('readerMode') === 'on') {
    document.body.classList.add('reader-mode');
  }
  
  // Initialize toolbox
  initToolbox();
  
  // Load dashboard with improved loading
  loadDashboard();
});

// FIX 1: Scroll to search bar when page loads or refreshes
window.addEventListener('load', function() {
  // Small delay to ensure everything is rendered
  setTimeout(() => {
    const searchBar = document.querySelector('.search-bar');
    if (searchBar) {
      searchBar.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
    // Also focus the search input
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
      searchInput.focus();
    }
  }, 100);
});

// FIX 1: Also scroll to top when clicking home/reloading
window.addEventListener('beforeunload', function() {
  window.scrollTo(0, 0);
});

// ===== PALETTE HANDLING =====
document.getElementById('paletteToggle').addEventListener('click', function() {
  const panel = document.getElementById('palettePanel');
  panel.classList.toggle('open');
});

// Accent colors
document.querySelectorAll('.palette-color').forEach(c => {
  c.addEventListener('click', function() {
    document.querySelectorAll('.palette-color').forEach(x => x.classList.remove('active'));
    this.classList.add('active');
    const col = this.dataset.accent;
    document.documentElement.style.setProperty('--accent', col);
    localStorage.setItem('accent', col);
  });
});

// Background themes - SIMPLE
document.querySelectorAll('.theme-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.theme-btn').forEach(b => {
      b.classList.remove('active');
      b.style.border = '1px solid var(--border)';
    });
    this.classList.add('active');
    this.style.border = '2px solid var(--accent)';
    
    const themeName = this.dataset.color;
    applyTheme(themeName);
  });
});

// ===== TOOLBOX =====
const toolbox = document.getElementById('toolbox');
document.getElementById('toolboxToggle').addEventListener('click', function() {
  toolbox.classList.toggle('hidden');
});
document.getElementById('toolboxClose').addEventListener('click', function(e) {
  e.stopPropagation();
  toolbox.classList.add('hidden');
});

// ===== READER MODE =====
document.getElementById('readerToggle').addEventListener('click', function() {
  document.body.classList.toggle('reader-mode');
  localStorage.setItem('readerMode', document.body.classList.contains('reader-mode') ? 'on' : 'off');
});

// ===== SEARCH =====
const searchInput = document.getElementById('searchInput');
searchInput.addEventListener('input', function(e) {
  const q = e.target.value.toLowerCase();
  document.querySelectorAll('.card').forEach(card => {
    const name = card.dataset.name.toLowerCase();
    const text = card.textContent.toLowerCase();
    card.style.display = name.includes(q) || text.includes(q) ? '' : 'none';
  });
});

// ===== SORT BUTTONS =====
document.getElementById('sortAlphaBtn').addEventListener('click', function() {
  const grid = document.getElementById('gridContainer');
  const cards = Array.from(grid.children);
  cards.sort((a,b) => a.dataset.name.localeCompare(b.dataset.name));
  cards.forEach(card => grid.appendChild(card));
});

document.getElementById('sortRandomBtn').addEventListener('click', function() {
  const grid = document.getElementById('gridContainer');
  const cards = Array.from(grid.children);
  for (let i = cards.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [cards[i], cards[j]] = [cards[j], cards[i]];
  }
  cards.forEach(card => grid.appendChild(card));
});

// FIX 2: Improved card loading - loads in batches
let cardQueue = [];
let isCardLoading = false;
const BATCH_SIZE = 5;
const BATCH_DELAY = 50;

// Load cards in batches
function loadCardBatch() {
  if (isCardLoading || cardQueue.length === 0) return;
  
  isCardLoading = true;
  const batch = cardQueue.splice(0, BATCH_SIZE);
  
  let loadedCount = 0;
  
  batch.forEach((cardData, index) => {
    setTimeout(() => {
      const { card, file, name } = cardData;
      const content = card.querySelector('.content');
      
      fetch(`cards/${file}`)
        .then(r => r.ok ? r.text() : Promise.reject())
        .then(html => {
          // ‚úÖ Load HTML with scripts intact
          content.innerHTML = html;
          
          // ‚úÖ Add simple embed section to every card
          addEmbedSectionToCard(card, file);
          
          // Execute any scripts in the loaded content
          const scripts = content.querySelectorAll('script');
          scripts.forEach(script => {
            const newScript = document.createElement('script');
            if (script.src) {
              newScript.src = script.src;
            } else {
              newScript.textContent = script.textContent;
            }
            // Copy attributes
            [...script.attributes].forEach(attr => {
              newScript.setAttribute(attr.name, attr.value);
            });
            
            // Replace old script with new one (which will execute)
            script.parentNode.replaceChild(newScript, script);
          });
        })
        .catch(() => {
          content.textContent = 'Preview unavailable';
          // Still add embed section even if card failed to load
          addEmbedSectionToCard(card, file);
        })
        .finally(() => {
          loadedCount++;
          
          // Show card with animation
          setTimeout(() => {
            card.classList.add('visible');
          }, index * 30);
          
          // Update status
          const totalCards = document.querySelectorAll('.card').length;
          const loadedCards = document.querySelectorAll('.card.visible').length;
          document.getElementById('status').textContent = 
            `Loaded ${loadedCards} of ${totalCards} tools`;
          
          // Load next batch when this one is done
          if (loadedCount === batch.length) {
            isCardLoading = false;
            if (cardQueue.length > 0) {
              setTimeout(loadCardBatch, BATCH_DELAY);
            } else {
              document.getElementById('status').textContent = 
                `${totalCards} tools loaded`;
            }
          }
        });
    }, index * 20); // Stagger requests
  });
}

// ===== LOAD CARDS WITH IMPROVED PERFORMANCE =====
async function loadDashboard() {
  try {
    const DEFAULT_REPO = 'mrpr0phecy/mrpr0phecy';
    const DEFAULT_BRANCH = 'main';
    
    // Parse repo
    const [owner, repo] = DEFAULT_REPO.split('/');
    
    document.getElementById('status').textContent = 'Fetching card list...';
    
    // Fetch card files
    const url = `https://api.github.com/repos/${owner}/${repo}/git/trees/${DEFAULT_BRANCH}?recursive=1`;
    const response = await fetch(url);
    const data = await response.json();
    
    const cardFiles = (data.tree || [])
      .filter(item => item.path.startsWith('cards/') && item.path.endsWith('.html'))
      .map(item => item.path.replace(/^cards\//, ''));
    
    console.log("Found", cardFiles.length, "cards");
    
    // Display cards
    const grid = document.getElementById('gridContainer');
    const status = document.getElementById('status');
    
    if (!cardFiles.length) {
      status.textContent = 'No cards found';
      return;
    }
    
    grid.innerHTML = '';
    cardQueue = [];
    
    // Create all card containers first (fast)
    cardFiles.sort().forEach(file => {
      const name = file.replace('.html', '');
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.file = file;
      card.dataset.name = name;
      
      const header = document.createElement('div');
      header.className = 'card-header';
      header.innerHTML = `<h3>${name}</h3><div style="display:flex;gap:8px"><div class="add-to-toolbox" title="Add to toolbox" style="cursor:pointer;font-weight:bold;color:var(--accent)">+</div></div>`;
      
      const content = document.createElement('div');
      content.className = 'content';
      content.textContent = 'Loading‚Ä¶';
      
      card.appendChild(header);
      card.appendChild(content);
      grid.appendChild(card);
      
      // Add to queue for batch loading
      cardQueue.push({ card, file, name });
    });
    
    status.textContent = `Loading 0 of ${cardFiles.length} tools...`;
    
    // Start batch loading
    setTimeout(loadCardBatch, 300);
    
  } catch (error) {
    console.error("Error loading dashboard:", error);
    document.getElementById('status').textContent = 'Error loading cards';
  }
}

// Add event listener for adding cards to toolbox
document.addEventListener('click', function(e) {
  // Check if click is on "Add to toolbox" button
  if (e.target.classList.contains('add-to-toolbox') || 
      e.target.closest('.add-to-toolbox')) {
    
    const card = e.target.closest('.card');
    if (!card) return;
    
    const cardName = card.dataset.name;
    const contentElement = card.querySelector('.content');
    const contentHTML = contentElement.innerHTML;
    
    // Create widget in toolbox
    createWidget(cardName, contentHTML);
    
    // Show toolbox if hidden
    toolbox.classList.remove('hidden');
    
    // Visual feedback
    const addBtn = e.target.closest('.add-to-toolbox');
    addBtn.textContent = '‚úì';
    addBtn.style.color = 'var(--accent)';
    setTimeout(() => {
      addBtn.textContent = '+';
      addBtn.style.color = '';
    }, 1000);
  }
});

// Make Sortable
new Sortable(document.getElementById('gridContainer'), { animation: 150 });

// ===== MOBILE-FRIENDLY SCROLLING FIX =====
// This prevents card content from interfering with page scrolling
document.addEventListener('DOMContentLoaded', function() {
  // Add passive event listeners for better scrolling performance
  document.addEventListener('touchmove', function(e) {
    // Allow default scrolling behavior for the main page
    if (!e.target.closest('.card, .widget-wrap, .toolbox')) {
      return;
    }
  }, { passive: true });
  
  // For cards with interactive content, add a scroll indicator
  document.querySelectorAll('.card .content').forEach(content => {
    // If content has its own scrollbar, make it more mobile-friendly
    if (content.scrollHeight > content.clientHeight) {
      content.style.maxHeight = '40vh';
      content.style.overflowY = 'auto';
      content.style.webkitOverflowScrolling = 'touch';
    }
  });
});

// Helper function to detect touch devices
function isTouchDevice() {
  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;
}

// If on mobile, adjust some settings for better UX
if (isTouchDevice()) {
  // Make buttons slightly larger for touch
  document.documentElement.style.setProperty('--card-min', '280px');
  
  // Adjust toolbox dimensions for mobile
  const toolbox = document.getElementById('toolbox');
  if (toolbox) {
    toolbox.style.minWidth = '280px';
    toolbox.style.minHeight = '300px';
  }
}

console.log("=== APP INITIALIZED ===");
</script>
</body>
</html> improve cards according to this guide when i pass them to you
