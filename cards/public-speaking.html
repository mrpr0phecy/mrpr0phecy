<h2 id="public-speaking-coach-title">üé§ Public Speaking Coach</h2>

<form aria-describedby="public-speaking-coach-desc">
    <p id="public-speaking-coach-desc" class="small">
        Improve your speeches with AI-powered analysis, practice tools, and personalized feedback.
        <span style="color:var(--accent)">Practice timing, structure, delivery, and confidence.</span>
    </p>
    
    <!-- SPEECH INPUT -->
    <div style="margin-bottom:20px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <label for="psc-speech" style="color:var(--accent);font-weight:500;">Your Speech Text</label>
            <div id="psc-char-count" style="font-size:12px;color:rgba(230,250,255,0.6);">0 characters</div>
        </div>
        <textarea id="psc-speech" rows="10" placeholder="Paste or type your speech here. The coach will analyze structure, timing, and delivery..."
                  style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(255,255,255,0.05);color:inherit;resize:vertical;font-family:inherit;"
                  oninput="pscUpdateCharCount()"></textarea>
    </div>
    
    <!-- ANALYSIS SETTINGS -->
    <div style="margin-bottom:20px;padding:16px;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(157,78,221,0.05));border-radius:12px;border:1px solid rgba(45,212,255,0.2);">
        <h3 style="color:var(--accent);margin-top:0;margin-bottom:16px;font-size:1.1rem;">‚öôÔ∏è Analysis Settings</h3>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:16px;margin-bottom:16px;">
            <div>
                <label for="psc-focus" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Primary Focus
                </label>
                <select id="psc-focus" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                    <option value="clarity">Clarity & Structure</option>
                    <option value="persuasion">Persuasion & Impact</option>
                    <option value="delivery">Delivery & Timing</option>
                    <option value="confidence">Confidence & Presence</option>
                    <option value="engagement">Audience Engagement</option>
                    <option value="comprehensive">Comprehensive Analysis</option>
                </select>
            </div>
            
            <div>
                <label for="psc-speaking-rate" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Speaking Rate (wpm)
                </label>
                <select id="psc-speaking-rate" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                    <option value="slow">Slow (100 wpm)</option>
                    <option value="moderate" selected>Moderate (130 wpm)</option>
                    <option value="fast">Fast (160 wpm)</option>
                    <option value="presentation">Presentation (120 wpm)</option>
                </select>
            </div>
        </div>
        
        <!-- CHECKBOX OPTIONS -->
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
            <div>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0;">
                    <input type="checkbox" id="psc-check-structure" checked style="accent-color:var(--accent);">
                    <span style="color:rgba(230,250,255,0.9);">Speech Structure</span>
                </label>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0;">
                    <input type="checkbox" id="psc-check-vocabulary" checked style="accent-color:var(--accent);">
                    <span style="color:rgba(230,250,255,0.9);">Vocabulary Analysis</span>
                </label>
            </div>
            
            <div>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0;">
                    <input type="checkbox" id="psc-check-pauses" checked style="accent-color:var(--accent);">
                    <span style="color:rgba(230,250,255,0.9);">Pause Recommendations</span>
                </label>
                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;padding:8px 0;">
                    <input type="checkbox" id="psc-check-engagement" checked style="accent-color:var(--accent);">
                    <span style="color:rgba(230,250,255,0.9);">Engagement Strategies</span>
                </label>
            </div>
        </div>
    </div>
    
    <!-- QUICK SPEECH TEMPLATES -->
    <div style="margin-bottom:20px;">
        <div style="color:rgba(230,250,255,0.8);margin-bottom:8px;font-size:14px;">Quick Templates:</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button type="button" onclick="pscLoadTemplate('elevator')" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">üéØ Elevator Pitch</button>
            <button type="button" onclick="pscLoadTemplate('presentation')" style="padding:6px 10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:12px;">üìä Business Presentation</button>
            <button type="button" onclick="pscLoadTemplate('wedding')" style="padding:6px 10px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);border-radius:6px;color:#ffa500;cursor:pointer;font-size:12px;">üíí Wedding Toast</button>
            <button type="button" onclick="pscLoadTemplate('persuasive')" style="padding:6px 10px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);border-radius:6px;color:#9d4edd;cursor:pointer;font-size:12px;">üé≠ Persuasive Speech</button>
            <button type="button" onclick="pscLoadTemplate('inspirational')" style="padding:6px 10px;background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);border-radius:6px;color:#ff2d55;cursor:pointer;font-size:12px;">‚ú® Inspirational Talk</button>
        </div>
    </div>
    
    <!-- PRACTICE TOOLS -->
    <div style="margin-bottom:20px;padding:16px;background:rgba(255,255,255,0.03);border-radius:8px;border:1px solid rgba(255,255,255,0.1);">
        <h3 style="color:var(--accent);margin-top:0;margin-bottom:12px;font-size:1.1rem;">‚è±Ô∏è Practice Tools</h3>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;margin-bottom:12px;">
            <div>
                <label for="psc-practice-time" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Target Time (minutes)
                </label>
                <input id="psc-practice-time" type="number" min="1" max="60" step="1" value="5"
                       style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;" />
            </div>
            
            <div>
                <label for="psc-practice-mode" style="display:block;margin-bottom:6px;color:var(--accent);font-weight:500;">
                    Practice Mode
                </label>
                <select id="psc-practice-mode" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(45,212,255,0.3);background:rgba(45,212,255,0.05);color:inherit;">
                    <option value="read">Read Aloud</option>
                    <option value="memorize">Memorize Key Points</option>
                    <option value="timing">Timing Practice</option>
                    <option value="record">Record & Review</option>
                </select>
            </div>
        </div>
        
        <div style="display:flex;gap:10px;margin-top:12px;">
            <button type="button" onclick="pscStartPractice()" 
                    style="flex:1;padding:10px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;font-weight:600;">
                ‚ñ∂Ô∏è Start Practice
            </button>
            <button type="button" onclick="pscStartTimer()" id="psc-timer-btn"
                    style="padding:10px 16px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:8px;color:var(--accent);cursor:pointer;">
                ‚è±Ô∏è Timer
            </button>
        </div>
    </div>
    
    <!-- ACTIONS -->
    <div class="actions" style="margin-top:20px;display:flex;gap:10px;">
        <button type="button" onclick="pscAnalyzeSpeech()" 
                style="flex:1;padding:12px;background:linear-gradient(135deg, rgba(45,212,255,0.2), rgba(45,212,255,0.1));border:1px solid rgba(45,212,255,0.4);border-radius:8px;color:var(--accent);cursor:pointer;font-weight:600;">
            üé§ Analyze Speech
        </button>
        <button type="button" onclick="pscResetForm()"
                style="padding:12px 16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:inherit;cursor:pointer;">
            Reset
        </button>
        <button type="button" onclick="pscSaveAnalysis()" id="psc-save-btn"
                style="padding:12px 16px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:8px;color:#39ff14;cursor:pointer;display:none;">
            üíæ Save
        </button>
    </div>
</form>

<!-- ANALYSIS RESULTS -->
<div class="results" aria-live="polite" style="margin-top:16px;">
    <!-- SPEECH STATISTICS -->
    <div id="psc-statistics" style="display:none;margin-bottom:20px;">
        <h3 class="small" style="color:var(--accent);margin-bottom:12px;">üìä Speech Statistics</h3>
        
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:12px;margin-bottom:20px;">
            <div style="padding:12px;background:rgba(45,212,255,0.1);border-radius:8px;border:1px solid rgba(45,212,255,0.3);text-align:center;">
                <div style="color:rgba(230,250,255,0.8);font-size:13px;">Duration</div>
                <div id="psc-duration" style="font-size:28px;font-weight:700;color:var(--accent);">‚Äì</div>
            </div>
            
            <div style="padding:12px;background:rgba(57,255,20,0.1);border-radius:8px;border:1px solid rgba(57,255,20,0.3);text-align:center;">
                <div style="color:rgba(230,250,255,0.8);font-size:13px;">Word Count</div>
                <div id="psc-word-count" style="font-size:28px;font-weight:700;color:#39ff14;">0</div>
            </div>
            
            <div style="padding:12px;background:rgba(255,165,0,0.1);border-radius:8px;border:1px solid rgba(255,165,0,0.3);text-align:center;">
                <div style="color:rgba(230,250,255,0.8);font-size:13px;">Sentences</div>
                <div id="psc-sentence-count" style="font-size:28px;font-weight:700;color:#ffa500;">0</div>
            </div>
            
            <div style="padding:12px;background:rgba(157,78,221,0.1);border-radius:8px;border:1px solid rgba(157,78,221,0.3);text-align:center;">
                <div style="color:rgba(230,250,255,0.8);font-size:13px;">Reading Grade</div>
                <div id="psc-grade-level" style="font-size:28px;font-weight:700;color:#9d4edd;">‚Äì</div>
            </div>
        </div>
        
        <!-- DETAILED METRICS -->
        <div style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border:1px solid rgba(45,212,255,0.2);">
            <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
                <div>
                    <div style="color:rgba(230,250,255,0.8);font-size:13px;margin-bottom:4px;">Avg. Sentence Length</div>
                    <div id="psc-avg-sentence" style="font-size:20px;font-weight:600;color:var(--accent);">‚Äì words</div>
                </div>
                <div>
                    <div style="color:rgba(230,250,255,0.8);font-size:13px;margin-bottom:4px;">Speaking Rate</div>
                    <div id="psc-speaking-rate-display" style="font-size:20px;font-weight:600;color:#39ff14;">‚Äì wpm</div>
                </div>
                <div>
                    <div style="color:rgba(230,250,255,0.8);font-size:13px;margin-bottom:4px;">Complex Words</div>
                    <div id="psc-complex-words" style="font-size:20px;font-weight:600;color:#ff2d55;">0%</div>
                </div>
                <div>
                    <div style="color:rgba(230,250,255,0.8);font-size:13px;margin-bottom:4px;">Pause Opportunities</div>
                    <div id="psc-pause-count" style="font-size:20px;font-weight:600;color:#ffa500;">‚Äì</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- FEEDBACK ANALYSIS -->
    <div id="psc-feedback-section" style="display:none;margin-top:20px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
            <h3 class="small" style="color:var(--accent);margin:0;">üí° Coaching Feedback</h3>
            <div style="display:flex;gap:8px;align-items:center;">
                <button type="button" onclick="pscExportFeedback()" style="padding:6px 10px;background:rgba(45,212,255,0.1);border:1px solid rgba(45,212,255,0.3);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Export</button>
            </div>
        </div>
        
        <!-- FEEDBACK CATEGORIES -->
        <div id="psc-feedback-tabs" style="display:flex;gap:8px;margin-bottom:16px;border-bottom:1px solid rgba(255,255,255,0.1);padding-bottom:12px;">
            <button type="button" onclick="pscShowFeedbackTab('structure')" class="psc-feedback-tab active" data-tab="structure" style="padding:8px 12px;background:rgba(45,212,255,0.2);border:1px solid rgba(45,212,255,0.4);border-radius:6px;color:var(--accent);cursor:pointer;font-size:12px;">Structure</button>
            <button type="button" onclick="pscShowFeedbackTab('delivery')" class="psc-feedback-tab" data-tab="delivery" style="padding:8px 12px;background:rgba(57,255,20,0.1);border:1px solid rgba(57,255,20,0.3);border-radius:6px;color:#39ff14;cursor:pointer;font-size:12px;">Delivery</button>
            <button type="button" onclick="pscShowFeedbackTab('language')" class="psc-feedback-tab" data-tab="language" style="padding:8px 12px;background:rgba(255,165,0,0.1);border:1px solid rgba(255,165,0,0.3);border-radius:6px;color:#ffa500;cursor:pointer;font-size:12px;">Language</button>
            <button type="button" onclick="pscShowFeedbackTab('engagement')" class="psc-feedback-tab" data-tab="engagement" style="padding:8px 12px;background:rgba(157,78,221,0.1);border:1px solid rgba(157,78,221,0.3);border-radius:6px;color:#9d4edd;cursor:pointer;font-size:12px;">Engagement</button>
        </div>
        
        <!-- FEEDBACK CONTENT -->
        <div id="psc-feedback-content" style="min-height:200px;">
            <!-- Feedback will be loaded here -->
        </div>
    </div>
    
    <!-- PRACTICE TIMER -->
    <div id="psc-timer-section" style="display:none;margin-top:20px;padding:20px;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(57,255,20,0.05));border-radius:12px;border:1px solid rgba(45,212,255,0.2);">
        <div style="text-align:center;">
            <div style="font-size:14px;color:rgba(230,250,255,0.8);margin-bottom:8px;">Practice Timer</div>
            <div id="psc-timer-display" style="font-size:48px;font-weight:700;color:var(--accent);margin-bottom:16px;">05:00</div>
            <div style="display:flex;justify-content:center;gap:12px;">
                <button type="button" onclick="pscTimerControl('start')" style="padding:10px 20px;background:rgba(57,255,20,0.2);border:1px solid rgba(57,255,20,0.4);border-radius:8px;color:#39ff14;cursor:pointer;font-weight:600;">‚ñ∂ Start</button>
                <button type="button" onclick="pscTimerControl('pause')" style="padding:10px 20px;background:rgba(255,165,0,0.2);border:1px solid rgba(255,165,0,0.4);border-radius:8px;color:#ffa500;cursor:pointer;font-weight:600;">‚è∏ Pause</button>
                <button type="button" onclick="pscTimerControl('reset')" style="padding:10px 20px;background:rgba(255,77,77,0.2);border:1px solid rgba(255,77,77,0.4);border-radius:8px;color:#ff2d55;cursor:pointer;font-weight:600;">‚ü≤ Reset</button>
            </div>
            <div id="psc-timer-hint" style="color:rgba(230,250,255,0.6);margin-top:12px;font-size:13px;">Set your target time and start practicing!</div>
        </div>
    </div>
</div>

<!-- PUBLIC SPEAKING TIPS -->
<div style="margin-top:20px;padding:16px;background:linear-gradient(135deg, rgba(45,212,255,0.05), rgba(255,165,0,0.05));border-radius:8px;border:1px solid rgba(45,212,255,0.3);">
    <h3 class="small" style="color:var(--accent);margin-bottom:8px;">üéØ Public Speaking Tips</h3>
    <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:12px;">
        <div>
            <div style="color:#39ff14;font-weight:600;margin-bottom:4px;">üé§ Delivery</div>
            <ul style="margin:0;padding-left:18px;color:rgba(230,250,255,0.9);font-size:13px;line-height:1.5;">
                <li>Speak at 120-150 words per minute</li>
                <li>Pause for emphasis (2-3 seconds)</li>
                <li>Vary your tone and pace</li>
                <li>Maintain eye contact</li>
            </ul>
        </div>
        <div>
            <div style="color:var(--accent);font-weight:600;margin-bottom:4px;">üìù Structure</div>
            <ul style="margin:0;padding-left:18px;color:rgba(230,250,255,0.9);font-size:13px;line-height:1.5;">
                <li>Clear opening, body, conclusion</li>
                <li>3-5 main points maximum</li>
                <li>Use signposting language</li>
                <li>End with a strong call to action</li>
            </ul>
        </div>
        <div>
            <div style="color:#ffa500;font-weight:600;margin-bottom:4px;">üòä Confidence</div>
            <ul style="margin:0;padding-left:18px;color:rgba(230,250,255,0.9);font-size:13px;line-height:1.5;">
                <li>Practice in front of a mirror</li>
                <li>Record and review yourself</li>
                <li>Use confident body language</li>
                <li>Breathe deeply before starting</li>
            </ul>
        </div>
    </div>
</div>

<script>
/* public-speaking-coach.html
   - Comprehensive public speaking coaching tool
   - Scoped with psc- prefix
*/

// Global variables
let pscCurrentAnalysis = null;
let pscTimerInterval = null;
let pscTimerSeconds = 300; // 5 minutes default
let pscTimerRunning = false;

// Character count update
function pscUpdateCharCount() {
    const textarea = document.getElementById('psc-speech');
    const charCount = document.getElementById('psc-char-count');
    const count = textarea.value.length;
    charCount.textContent = `${count} character${count !== 1 ? 's' : ''}`;
}

// Load speech templates
function pscLoadTemplate(template) {
    const templates = {
        elevator: `Good morning! I'm [Your Name], founder of [Your Company]. We help businesses [Core Benefit] through our innovative [Solution]. In just 30 seconds, I'd like to share how we've already helped [Example Client] achieve [Specific Result]. Would you be open to a brief conversation about how we might help your organization?`,
        
        presentation: `Thank you for joining me today. Over the next 15 minutes, I'll share three key insights about [Topic]. First, we'll explore the current landscape. Second, I'll present our innovative approach. Finally, we'll discuss actionable next steps. By the end, you'll have a clear understanding of [Key Takeaway]. Let's begin...`,
        
        wedding: `For those who don't know me, I'm [Your Name], and I've had the honor of being [Person's] friend for [Number] years. When I first met [Person], I immediately noticed their [Quality]. Today, as I see them standing with [Spouse], I'm reminded of [Story]. To [Person] and [Spouse] - may your marriage be filled with love, laughter, and lifelong adventures. Cheers!`,
        
        persuasive: `Imagine a world where [Desired Outcome]. Today, I'm going to show you how we can make that a reality. The problem we face is [Problem]. But there's hope. Through [Solution], we can achieve [Benefits]. I've seen this work firsthand with [Example]. Join me in making a difference. Together, we can [Call to Action].`,
        
        inspirational: `Look around this room. Every person here has overcome challenges. Every person has dreams. Today, I want to remind you of your own strength. There was a time when I [Personal Story]. What I learned was [Lesson]. That lesson applies to all of us. No matter what you're facing, remember [Key Message]. You are capable of more than you know.`
    };
    
    const textarea = document.getElementById('psc-speech');
    textarea.value = templates[template] || '';
    pscUpdateCharCount();
    
    // Visual feedback
    textarea.style.borderColor = '#9d4edd';
    setTimeout(() => {
        textarea.style.borderColor = 'rgba(45,212,255,0.3)';
    }, 1000);
}

// Calculate speech statistics
function pscCalculateStatistics(text) {
    // Word count
    const words = text.match(/\b[\w']+\b/g) || [];
    const wordCount = words.length;
    
    // Sentence count
    const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
    const sentenceCount = sentences.length;
    
    // Average sentence length
    const avgSentenceLength = sentenceCount > 0 ? (wordCount / sentenceCount).toFixed(1) : 0;
    
    // Speaking rate calculation
    const speakingRate = document.getElementById('psc-speaking-rate').value;
    let wpm = 130; // Default moderate
    switch(speakingRate) {
        case 'slow': wpm = 100; break;
        case 'moderate': wpm = 130; break;
        case 'fast': wpm = 160; break;
        case 'presentation': wpm = 120; break;
    }
    
    // Duration calculation
    const durationMinutes = wordCount / wpm;
    const durationSeconds = Math.round(durationMinutes * 60);
    
    // Format duration
    const minutes = Math.floor(durationSeconds / 60);
    const seconds = durationSeconds % 60;
    const durationDisplay = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    
    // Reading grade level (simplified)
    const complexWords = words.filter(word => word.length > 6).length;
    const complexPercent = wordCount > 0 ? Math.round((complexWords / wordCount) * 100) : 0;
    const gradeLevel = Math.min(12, Math.max(6, Math.round(wordCount / sentences.length / 2 + complexPercent / 10)));
    
    // Pause opportunities (based on punctuation and sentence length)
    const pauseCount = (text.match(/[.,;:!?]/g) || []).length + Math.floor(sentenceCount / 3);
    
    return {
        wordCount,
        sentenceCount,
        avgSentenceLength,
        durationMinutes: durationMinutes.toFixed(1),
        durationDisplay,
        wpm,
        gradeLevel,
        complexPercent,
        pauseCount
    };
}

// Generate feedback based on focus
function pscGenerateFeedback(text, statistics, focus) {
    const feedback = {
        structure: [],
        delivery: [],
        language: [],
        engagement: []
    };
    
    // Structure feedback
    feedback.structure.push({
        title: "Opening & Closing",
        content: statistics.sentenceCount >= 3 ? 
            "Your speech has a clear beginning and end. Consider starting with a hook and ending with a memorable conclusion." :
            "Consider adding a strong opening to grab attention and a clear conclusion to summarize key points.",
        rating: statistics.sentenceCount >= 3 ? "good" : "needs-improvement"
    });
    
    feedback.structure.push({
        title: "Organization",
        content: statistics.avgSentenceLength > 15 ? 
            "Your ideas are well-organized. Consider using signposting language like 'First, Second, Finally' to guide your audience." :
            "Try organizing your content into 3-5 main points for better clarity.",
        rating: "good"
    });
    
    // Delivery feedback
    const targetWPM = statistics.wpm;
    const actualWPM = statistics.wordCount / statistics.durationMinutes;
    
    feedback.delivery.push({
        title: "Speaking Pace",
        content: Math.abs(actualWPM - targetWPM) < 20 ?
            `Good pacing at approximately ${Math.round(actualWPM)} words per minute. This is within the ideal range for ${targetWPM === 120 ? 'presentations' : 'general speaking'}.` :
            `Consider adjusting your pace. Current estimate: ${Math.round(actualWPM)} wpm. Ideal for your setting: ${targetWPM} wpm.`,
        rating: Math.abs(actualWPM - targetWPM) < 20 ? "excellent" : "needs-improvement"
    });
    
    feedback.delivery.push({
        title: "Pause Opportunities",
        content: statistics.pauseCount > statistics.sentenceCount ?
            `Great use of natural pause points (${statistics.pauseCount} identified). Use these for emphasis and breathing.` :
            `Consider adding more pauses. Currently ${statistics.pauseCount} natural pause points identified.`,
        rating: statistics.pauseCount > statistics.sentenceCount ? "good" : "needs-improvement"
    });
    
    // Language feedback
    feedback.language.push({
        title: "Vocabulary Level",
        content: statistics.complexPercent < 20 ?
            "Your vocabulary is accessible and clear. Perfect for audience understanding." :
            `Consider simplifying some complex words (${statistics.complexPercent}% of words have 7+ letters).`,
        rating: statistics.complexPercent < 20 ? "excellent" : "needs-improvement"
    });
    
    // Check for filler words
    const fillerWords = ['um', 'uh', 'like', 'you know', 'actually', 'basically'];
    let fillerCount = 0;
    fillerWords.forEach(word => {
        const regex = new RegExp(`\\b${word}\\b`, 'gi');
        const matches = text.match(regex);
        if (matches) fillerCount += matches.length;
    });
    
    if (fillerCount > 0) {
        feedback.language.push({
            title: "Filler Words",
            content: `Try reducing filler words (${fillerCount} detected). Practice pausing instead of using "um" or "uh".`,
            rating: "needs-improvement"
        });
    }
    
    // Engagement feedback
    const questionCount = (text.match(/\?/g) || []).length;
    const storyCount = (text.match(/I\s|\bmy\b|\bme\b/gi) || []).length / 10; // Rough estimate
    
    feedback.engagement.push({
        title: "Audience Connection",
        content: questionCount > 0 ?
            `Good use of questions (${questionCount} found) to engage your audience.` :
            "Consider adding rhetorical questions to involve your audience.",
        rating: questionCount > 0 ? "good" : "needs-improvement"
    });
    
    feedback.engagement.push({
        title: "Storytelling",
        content: storyCount > 2 ?
            "Excellent use of personal stories and examples to connect with your audience." :
            "Consider adding a personal story or example to make your speech more relatable.",
        rating: storyCount > 2 ? "excellent" : "needs-improvement"
    });
    
    // Focus-specific feedback
    switch(focus) {
        case 'clarity':
            feedback.structure.unshift({
                title: "Clarity Focus",
                content: "For maximum clarity: Use short sentences, clear transitions, and repeat key points.",
                rating: "tip"
            });
            break;
        case 'persuasion':
            feedback.engagement.unshift({
                title: "Persuasion Focus",
                content: "For persuasive impact: Use the problem-solution-benefit structure and emotional appeals.",
                rating: "tip"
            });
            break;
        case 'delivery':
            feedback.delivery.unshift({
                title: "Delivery Focus",
                content: "For better delivery: Practice vocal variety, strategic pauses, and confident body language.",
                rating: "tip"
            });
            break;
        case 'confidence':
            feedback.engagement.unshift({
                title: "Confidence Focus",
                content: "For confidence: Practice power poses, positive self-talk, and visualization techniques.",
                rating: "tip"
            });
            break;
    }
    
    return feedback;
}

// Analyze speech
function pscAnalyzeSpeech() {
    const textarea = document.getElementById('psc-speech');
    const text = textarea.value.trim();
    
    if (!text) {
        alert('Please enter your speech text.');
        return;
    }
    
    const focus = document.getElementById('psc-focus').value;
    
    // Calculate statistics
    const statistics = pscCalculateStatistics(text);
    
    // Generate feedback
    const feedback = pscGenerateFeedback(text, statistics, focus);
    
    // Store current analysis
    pscCurrentAnalysis = {
        text,
        statistics,
        feedback,
        timestamp: new Date().toISOString()
    };
    
    // Update display
    pscUpdateStatisticsDisplay(statistics);
    pscUpdateFeedbackDisplay(feedback);
    
    // Show sections
    document.getElementById('psc-statistics').style.display = 'block';
    document.getElementById('psc-feedback-section').style.display = 'block';
    document.getElementById('psc-save-btn').style.display = 'block';
}

// Update statistics display
function pscUpdateStatisticsDisplay(statistics) {
    document.getElementById('psc-duration').textContent = statistics.durationDisplay;
    document.getElementById('psc-word-count').textContent = statistics.wordCount;
    document.getElementById('psc-sentence-count').textContent = statistics.sentenceCount;
    document.getElementById('psc-grade-level').textContent = statistics.gradeLevel;
    document.getElementById('psc-avg-sentence').textContent = `${statistics.avgSentenceLength} words`;
    document.getElementById('psc-speaking-rate-display').textContent = `${statistics.wpm} wpm`;
    document.getElementById('psc-complex-words').textContent = `${statistics.complexPercent}%`;
    document.getElementById('psc-pause-count').textContent = statistics.pauseCount;
}

// Update feedback display
function pscUpdateFeedbackDisplay(feedback) {
    // Show first tab by default
    pscShowFeedbackTab('structure');
}

// Show feedback tab
function pscShowFeedbackTab(tabName) {
    // Update active tab
    document.querySelectorAll('.psc-feedback-tab').forEach(tab => {
        tab.classList.remove('active');
        const bgColor = getComputedStyle(tab).backgroundColor;
        tab.style.background = bgColor.replace('0.2', '0.1');
    });
    
    const activeTab = document.querySelector(`.psc-feedback-tab[data-tab="${tabName}"]`);
    if (activeTab) {
        activeTab.classList.add('active');
        const bgColor = getComputedStyle(activeTab).backgroundColor;
        activeTab.style.background = bgColor.replace('0.1', '0.2');
    }
    
    // Update content
    const feedbackContent = document.getElementById('psc-feedback-content');
    const feedback = pscCurrentAnalysis?.feedback[tabName] || [];
    
    if (feedback.length === 0) {
        feedbackContent.innerHTML = `
            <div style="text-align:center;padding:40px 20px;color:rgba(230,250,255,0.6);">
                <div style="font-size:48px;margin-bottom:16px;">üìù</div>
                <h3 style="color:var(--accent);margin-bottom:8px;">No ${tabName} feedback</h3>
                <p>Select different analysis options to get feedback in this category.</p>
            </div>
        `;
        return;
    }
    
    let html = '<div style="display:flex;flex-direction:column;gap:16px;">';
    
    feedback.forEach((item, index) => {
        // Rating colors
        let ratingColor = 'var(--accent)';
        let ratingIcon = 'üí°';
        
        switch(item.rating) {
            case 'excellent':
                ratingColor = '#39ff14';
                ratingIcon = '‚≠ê';
                break;
            case 'good':
                ratingColor = 'var(--accent)';
                ratingIcon = '‚úì';
                break;
            case 'needs-improvement':
                ratingColor = '#ffa500';
                ratingIcon = 'üìù';
                break;
            case 'tip':
                ratingColor = '#9d4edd';
                ratingIcon = 'üí°';
                break;
        }
        
        html += `
            <div style="padding:16px;background:rgba(0,0,0,0.2);border-radius:8px;border-left:4px solid ${ratingColor};">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <div style="color:${ratingColor};font-size:20px;">${ratingIcon}</div>
                    <div style="font-weight:600;color:${ratingColor};font-size:16px;">${item.title}</div>
                </div>
                <div style="color:rgba(230,250,255,0.9);font-size:14px;line-height:1.5;">
                    ${item.content}
                </div>
            </div>
        `;
    });
    
    html += '</div>';
    feedbackContent.innerHTML = html;
}

// Start practice session
function pscStartPractice() {
    const practiceTime = parseInt(document.getElementById('psc-practice-time').value) || 5;
    const practiceMode = document.getElementById('psc-practice-mode').value;
    
    // Convert minutes to seconds
    pscTimerSeconds = practiceTime * 60;
    
    // Show timer section
    document.getElementById('psc-timer-section').style.display = 'block';
    
    // Update timer display
    pscUpdateTimerDisplay();
    
    // Set hint based on mode
    const hints = {
        read: "Read your speech aloud. Focus on clear pronunciation and natural pacing.",
        memorize: "Practice without notes. Focus on remembering key points, not exact words.",
        timing: "Focus on hitting your target time. Adjust your pace as needed.",
        record: "Record yourself and review. Pay attention to body language and tone."
    };
    
    document.getElementById('psc-timer-hint').textContent = hints[practiceMode] || "Practice makes perfect!";
}

// Timer controls
function pscTimerControl(action) {
    switch(action) {
        case 'start':
            if (!pscTimerRunning) {
                pscTimerRunning = true;
                pscTimerInterval = setInterval(() => {
                    if (pscTimerSeconds > 0) {
                        pscTimerSeconds--;
                        pscUpdateTimerDisplay();
                    } else {
                        pscTimerControl('pause');
                        document.getElementById('psc-timer-hint').textContent = "Time's up! Great practice session.";
                    }
                }, 1000);
            }
            break;
            
        case 'pause':
            pscTimerRunning = false;
            if (pscTimerInterval) {
                clearInterval(pscTimerInterval);
                pscTimerInterval = null;
            }
            break;
            
        case 'reset':
            pscTimerControl('pause');
            const practiceTime = parseInt(document.getElementById('psc-practice-time').value) || 5;
            pscTimerSeconds = practiceTime * 60;
            pscUpdateTimerDisplay();
            document.getElementById('psc-timer-hint').textContent = "Timer reset. Ready when you are!";
            break;
    }
}

// Update timer display
function pscUpdateTimerDisplay() {
    const minutes = Math.floor(pscTimerSeconds / 60);
    const seconds = pscTimerSeconds % 60;
    document.getElementById('psc-timer-display').textContent = 
        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    
    // Color change when time is low
    if (pscTimerSeconds < 60) {
        document.getElementById('psc-timer-display').style.color = '#ff2d55';
    } else if (pscTimerSeconds < 120) {
        document.getElementById('psc-timer-display').style.color = '#ffa500';
    } else {
        document.getElementById('psc-timer-display').style.color = 'var(--accent)';
    }
}

// Start timer from button
function pscStartTimer() {
    const timerSection = document.getElementById('psc-timer-section');
    if (timerSection.style.display === 'none') {
        pscStartPractice();
    } else {
        pscTimerControl('start');
    }
}

// Save analysis
function pscSaveAnalysis() {
    if (!pscCurrentAnalysis) {
        alert('Analyze a speech first!');
        return;
    }
    
    const speechName = prompt('Name this speech:', `Speech ${new Date().toLocaleDateString()}`);
    if (!speechName) return;
    
    // In a real app, you would save to localStorage or a database
    // For now, just show success message
    
    const saveBtn = document.getElementById('psc-save-btn');
    const originalText = saveBtn.textContent;
    saveBtn.textContent = '‚úÖ Saved!';
    saveBtn.style.background = 'rgba(57,255,20,0.2)';
    saveBtn.style.borderColor = 'rgba(57,255,20,0.4)';
    saveBtn.style.color = '#39ff14';
    
    setTimeout(() => {
        saveBtn.textContent = originalText;
        saveBtn.style.background = 'rgba(57,255,20,0.1)';
        saveBtn.style.borderColor = 'rgba(57,255,20,0.3)';
        saveBtn.style.color = '#39ff14';
    }, 2000);
}

// Export feedback
function pscExportFeedback() {
    if (!pscCurrentAnalysis) {
        alert('No analysis to export.');
        return;
    }
    
    let report = `PUBLIC SPEAKING COACH REPORT\n`;
    report += `Generated: ${new Date().toLocaleString()}\n\n`;
    report += `STATISTICS\n`;
    report += `Duration: ${pscCurrentAnalysis.statistics.durationDisplay}\n`;
    report += `Word Count: ${pscCurrentAnalysis.statistics.wordCount}\n`;
    report += `Sentence Count: ${pscCurrentAnalysis.statistics.sentenceCount}\n`;
    report += `Average Sentence Length: ${pscCurrentAnalysis.statistics.avgSentenceLength} words\n`;
    report += `Speaking Rate: ${pscCurrentAnalysis.statistics.wpm} wpm\n`;
    report += `Reading Grade Level: ${pscCurrentAnalysis.statistics.gradeLevel}\n`;
    report += `Complex Words: ${pscCurrentAnalysis.statistics.complexPercent}%\n\n`;
    
    report += `FEEDBACK SUMMARY\n`;
    Object.entries(pscCurrentAnalysis.feedback).forEach(([category, items]) => {
        if (items.length > 0) {
            report += `${category.toUpperCase()}:\n`;
            items.forEach((item, i) => {
                report += `  ${i + 1}. ${item.title}: ${item.content}\n`;
            });
            report += '\n';
        }
    });
    
    report += `SPEECH TEXT\n`;
    report += `${pscCurrentAnalysis.text}\n`;
    
    // Create download
    const blob = new Blob([report], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `speech-analysis-${new Date().toISOString().split('T')[0]}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

// Reset form
function pscResetForm() {
    document.getElementById('psc-speech').value = '';
    document.getElementById('psc-statistics').style.display = 'none';
    document.getElementById('psc-feedback-section').style.display = 'none';
    document.getElementById('psc-timer-section').style.display = 'none';
    document.getElementById('psc-save-btn').style.display = 'none';
    pscUpdateCharCount();
    pscCurrentAnalysis = null;
    
    // Stop timer if running
    pscTimerControl('pause');
}

// Initialize on load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Public Speaking Coach ready');
    });
}
</script>

<style>
@keyframes pscPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

#public-speaking-coach-title {
    color: var(--accent);
    margin-top: 0;
    background: linear-gradient(135deg, var(--accent), #ff2d55);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Timer animation */
#psc-timer-section {
    animation: pscPulse 2s ease-in-out infinite;
}

/* Tab hover effects */
.psc-feedback-tab:hover {
    transform: translateY(-2px);
    transition: transform 0.2s;
}

/* Timer display glow effect */
#psc-timer-display {
    text-shadow: 0 0 10px currentColor;
}

/* Responsive design */
@media (max-width: 768px) {
    .actions {
        flex-direction: column;
    }
    
    .actions button {
        width: 100% !important;
        margin: 4px 0 !important;
    }
    
    #psc-statistics > div:first-child {
        grid-template-columns: repeat(2, 1fr) !important;
    }
    
    #psc-feedback-tabs {
        flex-wrap: wrap;
    }
}

/* Template button hover effects */
button[onclick^="pscLoadTemplate"]:hover {
    transform: translateY(-2px);
    transition: transform 0.2s;
}

/* Practice timer button states */
#psc-timer-btn {
    transition: all 0.3s;
}

#psc-timer-btn:hover {
    background: rgba(45,212,255,0.2) !important;
}
</style>
