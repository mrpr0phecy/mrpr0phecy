<script>
  const sections = {
    "Finance & Money": [
      "mortgage.html","tipcalculator.html","currency.html","retirement.html",
      "loan.html","investment.html","budget.html"
    ],
    "Health & Fitness": [
      "bmi.html","calorie.html","waterintake.html","heartrate.html","steps.html","sleep.html"
    ],
    "Utilities": [
      "qr.html","password.html","unitconverter.html","stopwatch.html","timer.html","calendar.html"
    ],
    "Fun & Games": [
      "dice.html","coinflip.html","randomname.html","colorpicker.html","trivia.html","magic8ball.html"
    ],
    "Education & Study": [
      "algebra.html","geometry.html","periodictable.html","flashcards.html","quiz.html"
    ],
    "Travel & Geography": [
      "timezone.html","distance.html","map.html","currencytravel.html"
    ],
    "Food & Cooking": [
      "recipe.html","unitconvertcooking.html","nutrition.html","shoppinglist.html"
    ],
    "Science & Tech": [
      "physics.html","chemistry.html","astronomy.html","binary.html","hex.html"
    ],
    "Lifestyle & Productivity": [
      "todo.html","habit.html","expense.html","goal.html","pomodoro.html"
    ],
    "Creative Tools": [
      "textformatter.html","markdown.html","emoji.html","storyprompt.html","namegenerator.html"
    ]
  };

  const playground = document.getElementById("playground");

  Object.entries(sections).forEach(([sectionName, files]) => {
    const section = document.createElement("section");
    const heading = document.createElement("h2");
    heading.textContent = sectionName;
    section.appendChild(heading);

    const grid = document.createElement("div");
    grid.className = "grid";

    files.forEach(file => {
      const wrapper = document.createElement("article");
      wrapper.className = "card";
      wrapper.dataset.name = file.replace('.html','');
      wrapper.innerHTML = `<p>Loading ${file.replace('.html','')}...</p>`;
      grid.appendChild(wrapper);

      // Lazy load
      const io = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            fetch("cards/" + file)
              .then(res => res.ok ? res.text() : Promise.reject())
              .then(html => { wrapper.innerHTML = html; })
              .catch(() => { wrapper.innerHTML = `<p>Error loading ${file}</p>`; });
            io.unobserve(wrapper);
          }
        });
      }, { threshold: 0.1 });
      io.observe(wrapper);
    });

    section.appendChild(grid);
    playground.appendChild(section);
  });

  // Search filter
  document.getElementById("searchInput").addEventListener("input", e => {
    const term = e.target.value.toLowerCase();
    document.querySelectorAll("#playground .card").forEach(card => {
      const name = card.dataset.name.toLowerCase();
      card.style.display = name.includes(term) ? "" : "none";
    });
  });
</script>
