<h2 id="spelling-check-title" style="margin-top:0;">Spelling Check</h2>

<form aria-describedby="spelling-check-desc">
  <p id="spelling-check-desc" class="small">Check text for common spelling mistakes and typos. Paste your text, run the check, and apply fixes individually or all at once.</p>

  <div class="row">
    <div class="field" style="flex:1;">
      <label for="sc-text">Text</label>
      <textarea id="sc-text" rows="8" style="width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:inherit;" placeholder="Paste text here..."></textarea>
    </div>
  </div>

  <div class="row" style="margin-top:8px;align-items:center;">
    <div class="field">
      <label style="display:inline-flex;align-items:center;gap:8px;">
        <input id="sc-ignore-case" type="checkbox" />
        <span class="small">Ignore case differences</span>
      </label>
    </div>
  </div>

  <div class="actions" style="margin-top:10px;">
    <button type="button" onclick="scCheck(this)">Check Spelling</button>
    <button type="button" class="secondary" onclick="scReset(this)">Reset</button>
    <button type="button" onclick="scApplyAll(this)">Apply All</button>
    <button type="button" onclick="scCopy(this)">Copy Text</button>
  </div>
</form>

<div class="results" aria-live="polite" style="margin-top:12px;">
  <div class="result">
    <div class="label">Summary</div>
    <div class="value small" id="sc-summary">No check performed yet.</div>
  </div>

  <h3 class="small" style="margin-top:12px;">Suggestions</h3>
  <ul id="sc-suggestions" class="small" style="list-style:none;padding-left:0;max-height:260px;overflow:auto;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px;"></ul>
</div>

<script>
/* spelling-check.html
   - Lightweight spelling checker for common misspellings
   - Scoped with sc- prefix so multiple cards can coexist safely
*/

const SC_COMMON = {
  "teh":"the","recieve":"receive","definately":"definitely","accomodate":"accommodate",
  "occurence":"occurrence","seperate":"separate","embarass":"embarrass","goverment":"government",
  "arguement":"argument","recomend":"recommend","beleive":"believe","acheive":"achieve",
  "independant":"independent","occassion":"occasion","priviledge":"privilege","succesful":"successful",
  "untill":"until","wierd":"weird","adress":"address","thier":"their","wich":"which","alot":"a lot",
  "occured":"occurred","tommorow":"tomorrow","becuase":"because"
};

function scReset(btn){
  const card=btn.closest('.card');
  card.querySelector('#sc-text').value="";
  card.querySelector('#sc-suggestions').innerHTML="";
  card.querySelector('#sc-summary').textContent="Cleared.";
}

function scCopy(btn){
  const card=btn.closest('.card');
  const text=card.querySelector('#sc-text').value||"";
  if(!text.trim())return;
  navigator.clipboard?.writeText(text).then(()=>{
    const prev=card.querySelector('#sc-summary').textContent;
    card.querySelector('#sc-summary').textContent="Copied.";
    setTimeout(()=>{card.querySelector('#sc-summary').textContent=prev;},1200);
  }).catch(()=>alert("Copy failed."));
}

function scCheck(btn){
  const card=btn.closest('.card');
  const text=(card.querySelector('#sc-text').value||"").trim();
  const ignoreCase=card.querySelector('#sc-ignore-case').checked;
  if(!text){card.querySelector('#sc-summary').textContent="Paste text to check.";return;}
  const tokens=text.split(/\s+/);
  const suggestions=[];
  tokens.forEach(tok=>{
    const raw=ignoreCase?tok.toLowerCase():tok;
    if(SC_COMMON[raw]){
      suggestions.push({original:tok,replacement:SC_COMMON[raw],reason:"common misspelling"});
    }
    if(/(.)\1{2,}/.test(tok)){
      const cleaned=tok.replace(/(.)\1{1,}/g,"$1$1");
      suggestions.push({original:tok,replacement:cleaned,reason:"excessive repeated letters"});
    }
  });
  scRender(card,suggestions);
  card.querySelector('#sc-summary').textContent=`${suggestions.length} suggestion(s) found.`;
}

function scRender(card,suggestions){
  const list=card.querySelector('#sc-suggestions');
  list.innerHTML="";
  if(!suggestions.length){list.innerHTML=`<li class="small" style="padding:8px;">No obvious spelling issues found.</li>`;return;}
  suggestions.forEach(s=>{
    const li=document.createElement('li');
    li.style.padding="8px";li.style.borderBottom="1px solid rgba(255,255,255,0.03)";
    li.style.display="flex";li.style.justifyContent="space-between";li.style.alignItems="center";
    const left=document.createElement('div');
    left.innerHTML=`<div style="font-weight:600;">${escapeHtml(s.original)}</div><div class="small" style="opacity:0.9;margin-top:6px;">${escapeHtml(s.reason)}</div>`;
    li.appendChild(left);
    const actions=document.createElement('div');actions.style.display="flex";actions.style.gap="8px";
    const applyBtn=document.createElement('button');applyBtn.className="tiny";applyBtn.textContent=`Apply "${s.replacement}"`;
    applyBtn.onclick=()=>{const textEl=card.querySelector('#sc-text');textEl.value=textEl.value.replace(s.original,s.replacement);scCheck(card.querySelector('button'));};
    actions.appendChild(applyBtn);
    li.appendChild(actions);list.appendChild(li);
  });
}

function scApplyAll(btn){
  const card=btn.closest('.card');
  let text=card.querySelector('#sc-text').value||"";
  Object.keys(SC_COMMON).forEach(m=>{
    const regex=new RegExp(`\\b${m}\\b`,"gi");
    text=text.replace(regex,SC_COMMON[m]);
  });
  card.querySelector('#sc-text').value=text;
  scCheck(card.querySelector('button'));
}

function escapeHtml(s){if(!s)return"";return s.replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[m]));}
</script>
